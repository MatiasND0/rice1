"use strict";const overrideCanvasRender=()=>{const t={SQUIGGLE_COLORS:["#4285f4","#dd0000","rgba(255, 255, 255, 0.850980392156863)"],HIGHLIGHT_COLORS:["#fce8e6","#e8f0fe"],PATTERN_OFFSET:2};CanvasRenderingContext2D.prototype._msSaveContext=function(){try{this.msExtraContext||(this.msExtraContext=[]);const{strokeStyle:t,fillStyle:e,globalAlpha:i,lineWidth:s,lineCap:n,lineJoin:o,miterLimit:r,lineDashOffset:l,shadowOffsetX:a,shadowOffsetY:h,shadowBlur:c,shadowColor:d,globalCompositeOperation:p,font:g,textAlign:C,textBaseline:u,direction:f,imageSmoothingEnabled:x}=this,m=this.getTransform();this.msExtraContext.push({strokeStyle:t,fillStyle:e,globalAlpha:i,lineWidth:s,lineCap:n,lineJoin:o,miterLimit:r,lineDashOffset:l,shadowOffsetX:a,shadowOffsetY:h,shadowBlur:c,shadowColor:d,globalCompositeOperation:p,font:g,textAlign:C,textBaseline:u,direction:f,imageSmoothingEnabled:x,transform:m})}catch(t){console.error(t)}},CanvasRenderingContext2D.prototype._msRestoreContext=function(){try{const{strokeStyle:t,fillStyle:e,globalAlpha:i,lineWidth:s,lineCap:n,lineJoin:o,miterLimit:r,lineDashOffset:l,shadowOffsetX:a,shadowOffsetY:h,shadowBlur:c,shadowColor:d,globalCompositeOperation:p,font:g,textAlign:C,textBaseline:u,direction:f,imageSmoothingEnabled:x,transform:m}=this.msExtraContext.pop();this.setTransform(m),this.strokeStyle=t,this.fillStyle=e,this.globalAlpha=i,this.lineWidth=s,this.lineCap=n,this.lineJoin=o,this.miterLimit=r,this.lineDashOffset=l,this.shadowOffsetX=a,this.shadowOffsetY=h,this.shadowBlur=c,this.shadowColor=d,this.globalCompositeOperation=p,this.font=g,this.textAlign=C,this.textBaseline=u,this.direction=f,this.imageSmoothingEnabled=x}catch(t){console.error(t)}},CanvasRenderingContext2D.prototype._fillRect=CanvasRenderingContext2D.prototype.fillRect,CanvasRenderingContext2D.prototype.fillRect=function(e,i,s,n){try{if(t.HIGHLIGHT_COLORS.includes(this.fillStyle)){this.msExtrasHighlightRects||(this.msExtrasHighlightRects=[]);const t={x:e,y:i,width:s,height:n,transform:this.getTransform()};return this.msExtrasHighlightRects.push(t),void this._msSaveContext()}}catch(t){console.error(t)}return this._fillRect(e,i,s,n)},CanvasRenderingContext2D.prototype._beginPath=CanvasRenderingContext2D.prototype.beginPath,CanvasRenderingContext2D.prototype.beginPath=function(){try{this.msEditorExtras={previousX:null,previousY:null,initialY:null,initialX:null,breaksSquigglePattern:!1,lineCount:0}}catch(t){console.error(t)}return this._beginPath()},CanvasRenderingContext2D.prototype._lineTo=CanvasRenderingContext2D.prototype.lineTo,CanvasRenderingContext2D.prototype.lineTo=function(e,i){try{let s=this.msEditorExtras;s&&!s.breaksSquigglePattern&&(s.previousX&&s.previousY?s.breaksSquigglePattern=t.PATTERN_OFFSET!==Math.abs(e-s.previousX)||t.PATTERN_OFFSET!==Math.abs(i-s.previousY):(s.initialX=e-t.PATTERN_OFFSET,s.initialY=i+t.PATTERN_OFFSET),s.previousX=e,s.previousY=i,s.lineCount++)}catch(t){console.error(t)}return this._lineTo(e,i)},CanvasRenderingContext2D.prototype._stroke=CanvasRenderingContext2D.prototype.stroke,CanvasRenderingContext2D.prototype.stroke=function(e){try{const e=this.msEditorExtras;if(e&&e.lineCount>1&&!e.breaksSquigglePattern&&t.SQUIGGLE_COLORS.includes(this.strokeStyle)){const i=this.getTransform();return void(this.msExtrasHighlightRects&&(this.msExtrasHighlightRects=this.msExtrasHighlightRects.filter(({x:s,y:n,width:o,height:r,transform:{a:l,d:a,e:h,f:c}})=>!(Math.abs(i.e/i.a+e.initialX-(h/l+s))<=t.PATTERN_OFFSET&&Math.abs(i.f/i.d+e.initialY-(c/a+n+r))<=t.PATTERN_OFFSET&&Math.abs(e.previousX-e.initialX-o)<=t.PATTERN_OFFSET))))}}catch(t){console.error(t)}return e?this._stroke(e):this._stroke()},CanvasRenderingContext2D.prototype._fillText=CanvasRenderingContext2D.prototype.fillText,CanvasRenderingContext2D.prototype.fillText=function(t,e,i,s){try{if(this.msExtrasHighlightRects){this.save();for(let t=this.msExtrasHighlightRects.length-1;t>=0;t--){this._msRestoreContext();const{x:e,y:i,width:s,height:n}=this.msExtrasHighlightRects[t];this._fillRect(e,i,s,n)}this.restore(),this.msExtrasHighlightRects=null,this.msExtraContext=null}}catch(t){console.error(t)}return s?this._fillText(t,e,i,s):this._fillText(t,e,i)}},injectCSSRule=(t,e)=>{const i=document.createElement("style");document.head.appendChild(i);const s=i.sheet;s.insertRule?s.insertRule(`${t} { ${e} }`,0):s.addRule&&s.addRule(t,e,0)},injectSuppressSquigglesCode=t=>{if(!editorBxScriptPolicy&&window.trustedTypes&&trustedTypes.createPolicy&&(editorBxScriptPolicy=trustedTypes.createPolicy("editorBxScriptPolicy",{createScript:t=>t})),editorBxScriptPolicy){const e=document.createElement("script");e.textContent=editorBxScriptPolicy.createScript(t),(document.head||document.documentElement).appendChild(e)}},suppressNativeSquiggles=()=>{injectSuppressSquigglesCode(`(${overrideCanvasRender})();`),injectCSSRule(".kix-spellcheck-with-explanation-bubble","display: none !important;")};injectSuppressSquigglesCode(`(${overrideCanvasRender})();`),injectCSSRule(".kix-spellcheck-with-explanation-bubble","display: none !important;");