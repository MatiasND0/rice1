/*! For license information please see background.js.LICENSE.txt */
!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=852)}([,,function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"b",(function(){return f}));var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function s(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function u(e,t){return function(n,r){t(n,r,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}Object.create;function l(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function d(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function f(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=l(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}Object.create;"function"==typeof SuppressedError&&SuppressedError},function(e,t,n){"use strict";e.exports=n(357)},,,function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"$mobx",(function(){return W})),n.d(t,"FlowCancellationError",(function(){return dn})),n.d(t,"ObservableMap",(function(){return wr})),n.d(t,"ObservableSet",(function(){return Tr})),n.d(t,"Reaction",(function(){return Ct})),n.d(t,"_allowStateChanges",(function(){return ze})),n.d(t,"_allowStateChangesInsideComputed",(function(){return Wt})),n.d(t,"_allowStateReadsEnd",(function(){return ct})),n.d(t,"_allowStateReadsStart",(function(){return ut})),n.d(t,"_autoAction",(function(){return zt})),n.d(t,"_endAction",(function(){return qe})),n.d(t,"_getAdministration",(function(){return Gr})),n.d(t,"_getGlobalState",(function(){return mt})),n.d(t,"_interceptReads",(function(){return vn})),n.d(t,"_isComputingDerivation",(function(){return tt})),n.d(t,"_resetGlobalState",(function(){return yt})),n.d(t,"_startAction",(function(){return Ue})),n.d(t,"action",(function(){return qt})),n.d(t,"autorun",(function(){return Gt})),n.d(t,"comparer",(function(){return $})),n.d(t,"computed",(function(){return je})),n.d(t,"configure",(function(){return rn})),n.d(t,"createAtom",(function(){return H})),n.d(t,"defineProperty",(function(){return xn})),n.d(t,"entries",(function(){return An})),n.d(t,"extendObservable",(function(){return on})),n.d(t,"flow",(function(){return gn})),n.d(t,"flowResult",(function(){return yn})),n.d(t,"get",(function(){return Rn})),n.d(t,"getAtom",(function(){return Vr})),n.d(t,"getDebugName",(function(){return Hr})),n.d(t,"getDependencyTree",(function(){return an})),n.d(t,"getObserverTree",(function(){return un})),n.d(t,"has",(function(){return jn})),n.d(t,"intercept",(function(){return wn})),n.d(t,"isAction",(function(){return Vt})),n.d(t,"isBoxedObservable",(function(){return $e})),n.d(t,"isComputed",(function(){return _n})),n.d(t,"isComputedProp",(function(){return Tn})),n.d(t,"isFlow",(function(){return bn})),n.d(t,"isFlowCancellationError",(function(){return fn})),n.d(t,"isObservable",(function(){return Cn})),n.d(t,"isObservableArray",(function(){return pr})),n.d(t,"isObservableMap",(function(){return Sr})),n.d(t,"isObservableObject",(function(){return Nr})),n.d(t,"isObservableProp",(function(){return En})),n.d(t,"isObservableSet",(function(){return Or})),n.d(t,"keys",(function(){return In})),n.d(t,"makeAutoObservable",(function(){return er})),n.d(t,"makeObservable",(function(){return Xn})),n.d(t,"observable",(function(){return ke})),n.d(t,"observe",(function(){return Mn})),n.d(t,"onBecomeObserved",(function(){return Yt})),n.d(t,"onBecomeUnobserved",(function(){return Xt})),n.d(t,"onReactionError",(function(){return Et})),n.d(t,"override",(function(){return Y})),n.d(t,"ownKeys",(function(){return Dn})),n.d(t,"reaction",(function(){return Kt})),n.d(t,"remove",(function(){return Nn})),n.d(t,"runInAction",(function(){return Wt})),n.d(t,"set",(function(){return Pn})),n.d(t,"spy",(function(){return jt})),n.d(t,"toJS",(function(){return Fn})),n.d(t,"trace",(function(){return Un})),n.d(t,"transaction",(function(){return qn})),n.d(t,"untracked",(function(){return ot})),n.d(t,"values",(function(){return kn})),n.d(t,"when",(function(){return zn}));function r(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw new Error("number"==typeof e?"[MobX] minified error nr: "+e+(n.length?" "+n.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+e)}var i={};function o(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:i}var a=Object.assign,s=Object.getOwnPropertyDescriptor,u=Object.defineProperty,c=Object.prototype,l=[];Object.freeze(l);var d={};Object.freeze(d);var f="undefined"!=typeof Proxy,h=Object.toString();function p(){f||r("Proxy not available")}function g(e){var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}}var m=function(){};function y(e){return"function"==typeof e}function b(e){switch(typeof e){case"string":case"symbol":case"number":return!0}return!1}function v(e){return null!==e&&"object"==typeof e}function w(e){if(!v(e))return!1;var t=Object.getPrototypeOf(e);if(null==t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n.toString()===h}function S(e){var t=null==e?void 0:e.constructor;return!!t&&("GeneratorFunction"===t.name||"GeneratorFunction"===t.displayName)}function _(e,t,n){u(e,t,{enumerable:!1,writable:!0,configurable:!0,value:n})}function T(e,t,n){u(e,t,{enumerable:!1,writable:!1,configurable:!0,value:n})}function O(e,t){var n="isMobX"+e;return t.prototype[n]=!0,function(e){return v(e)&&!0===e[n]}}function C(e){return e instanceof Map}function E(e){return e instanceof Set}var I=void 0!==Object.getOwnPropertySymbols;var k="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:I?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function A(e){return null===e?null:"object"==typeof e?""+e:e}function P(e,t){return c.hasOwnProperty.call(e,t)}var N=Object.getOwnPropertyDescriptors||function(e){var t={};return k(e).forEach((function(n){t[n]=s(e,n)})),t};function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t,n){return t&&j(e.prototype,t),n&&j(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function x(){return x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},x.apply(this,arguments)}function D(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,M(e,t)}function M(e,t){return M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},M(e,t)}function L(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function F(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var U=Symbol("mobx-stored-annotations");function q(e){return Object.assign((function(t,n){z(t,n,e)}),e)}function z(e,t,n){P(e,U)||_(e,U,x({},e[U])),function(e){return e.annotationType_===Q}(n)||(e[U][t]=n)}var W=Symbol("mobx administration"),V=function(){function e(e){void 0===e&&(e="Atom"),this.name_=void 0,this.isPendingUnobservation_=!1,this.isBeingObserved_=!1,this.observers_=new Set,this.diffValue_=0,this.lastAccessedBy_=0,this.lowestObserverState_=Ke.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=e}var t=e.prototype;return t.onBO=function(){this.onBOL&&this.onBOL.forEach((function(e){return e()}))},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach((function(e){return e()}))},t.reportObserved=function(){return Tt(this)},t.reportChanged=function(){St(),Ot(this),_t()},t.toString=function(){return this.name_},e}(),G=O("Atom",V);function H(e,t,n){void 0===t&&(t=m),void 0===n&&(n=m);var r=new V(e);return t!==m&&Yt(r,t),n!==m&&Xt(r,n),r}var $={identity:function(e,t){return e===t},structural:function(e,t){return Kr(e,t)},default:function(e,t){return Object.is?Object.is(e,t):e===t?0!==e||1/e==1/t:e!=e&&t!=t},shallow:function(e,t){return Kr(e,t,1)}};function K(e,t,n){return Cn(e)?e:Array.isArray(e)?ke.array(e,{name:n}):w(e)?ke.object(e,void 0,{name:n}):C(e)?ke.map(e,{name:n}):E(e)?ke.set(e,{name:n}):"function"!=typeof e||Vt(e)||bn(e)?e:S(e)?gn(e):zt(n,e)}function J(e){return e}var Q="override",Y=q({annotationType_:Q,make_:function(e,t){0;0;return 0},extend_:function(e,t,n,i){r("'"+this.annotationType_+"' can only be used with 'makeObservable'")}});function X(e,t){return{annotationType_:e,options_:t,make_:Z,extend_:ee}}function Z(e,t,n,r){var i;if(null!=(i=this.options_)&&i.bound)return null===this.extend_(e,t,n,!1)?0:1;if(r===e.target_)return null===this.extend_(e,t,n,!1)?0:2;if(Vt(n.value))return 1;var o=te(e,this,t,n,!1);return u(r,t,o),2}function ee(e,t,n,r){var i=te(e,this,t,n);return e.defineProperty_(t,i,r)}function te(e,t,n,r,i){var o,a,s,u,c,l,d,f;void 0===i&&(i=gt.safeDescriptors),f=r,t.annotationType_,f.value;var h,p=r.value;null!=(o=t.options_)&&o.bound&&(p=p.bind(null!=(h=e.proxy_)?h:e.target_));return{value:Be(null!=(a=null==(s=t.options_)?void 0:s.name)?a:n.toString(),p,null!=(u=null==(c=t.options_)?void 0:c.autoAction)&&u,null!=(l=t.options_)&&l.bound?null!=(d=e.proxy_)?d:e.target_:void 0),configurable:!i||e.isPlainObject_,enumerable:!1,writable:!i}}function ne(e,t){return{annotationType_:e,options_:t,make_:re,extend_:ie}}function re(e,t,n,r){var i;if(r===e.target_)return null===this.extend_(e,t,n,!1)?0:2;if(null!=(i=this.options_)&&i.bound&&(!P(e.target_,t)||!bn(e.target_[t]))&&null===this.extend_(e,t,n,!1))return 0;if(bn(n.value))return 1;var o=oe(e,this,t,n,!1,!1);return u(r,t,o),2}function ie(e,t,n,r){var i,o=oe(e,this,t,n,null==(i=this.options_)?void 0:i.bound);return e.defineProperty_(t,o,r)}function oe(e,t,n,r,i,o){var a;void 0===o&&(o=gt.safeDescriptors),a=r,t.annotationType_,a.value;var s,u=r.value;(bn(u)||(u=gn(u)),i)&&((u=u.bind(null!=(s=e.proxy_)?s:e.target_)).isMobXFlow=!0);return{value:u,configurable:!o||e.isPlainObject_,enumerable:!1,writable:!o}}function ae(e,t){return{annotationType_:e,options_:t,make_:se,extend_:ue}}function se(e,t,n){return null===this.extend_(e,t,n,!1)?0:1}function ue(e,t,n,r){return function(e,t,n,r){t.annotationType_,r.get;0}(0,this,0,n),e.defineComputedProperty_(t,x({},this.options_,{get:n.get,set:n.set}),r)}function ce(e,t){return{annotationType_:e,options_:t,make_:le,extend_:de}}function le(e,t,n){return null===this.extend_(e,t,n,!1)?0:1}function de(e,t,n,r){var i,o;return function(e,t){t.annotationType_;0}(0,this),e.defineObservableProperty_(t,n.value,null!=(i=null==(o=this.options_)?void 0:o.enhancer)?i:K,r)}var fe="true",he=pe();function pe(e){return{annotationType_:fe,options_:e,make_:ge,extend_:me}}function ge(e,t,n,r){var i,o,a,s;if(n.get)return je.make_(e,t,n,r);if(n.set){var c=Be(t.toString(),n.set);return r===e.target_?null===e.defineProperty_(t,{configurable:!gt.safeDescriptors||e.isPlainObject_,set:c})?0:2:(u(r,t,{configurable:!0,set:c}),2)}if(r!==e.target_&&"function"==typeof n.value)return S(n.value)?(null!=(s=this.options_)&&s.autoBind?gn.bound:gn).make_(e,t,n,r):(null!=(a=this.options_)&&a.autoBind?zt.bound:zt).make_(e,t,n,r);var l,d=!1===(null==(i=this.options_)?void 0:i.deep)?ke.ref:ke;"function"==typeof n.value&&null!=(o=this.options_)&&o.autoBind&&(n.value=n.value.bind(null!=(l=e.proxy_)?l:e.target_));return d.make_(e,t,n,r)}function me(e,t,n,r){var i,o,a;if(n.get)return je.extend_(e,t,n,r);if(n.set)return e.defineProperty_(t,{configurable:!gt.safeDescriptors||e.isPlainObject_,set:Be(t.toString(),n.set)},r);"function"==typeof n.value&&null!=(i=this.options_)&&i.autoBind&&(n.value=n.value.bind(null!=(a=e.proxy_)?a:e.target_));return(!1===(null==(o=this.options_)?void 0:o.deep)?ke.ref:ke).extend_(e,t,n,r)}var ye={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};function be(e){return e||ye}Object.freeze(ye);var ve=ce("observable"),we=ce("observable.ref",{enhancer:J}),Se=ce("observable.shallow",{enhancer:function(e,t,n){return null==e||Nr(e)||pr(e)||Sr(e)||Or(e)?e:Array.isArray(e)?ke.array(e,{name:n,deep:!1}):w(e)?ke.object(e,void 0,{name:n,deep:!1}):C(e)?ke.map(e,{name:n,deep:!1}):E(e)?ke.set(e,{name:n,deep:!1}):void 0}}),_e=ce("observable.struct",{enhancer:function(e,t){return Kr(e,t)?t:e}}),Te=q(ve);function Oe(e){return!0===e.deep?K:!1===e.deep?J:(t=e.defaultDecorator)&&null!=(n=null==(r=t.options_)?void 0:r.enhancer)?n:K;var t,n,r}function Ce(e,t,n){if(!b(t))return Cn(e)?e:w(e)?ke.object(e,t,n):Array.isArray(e)?ke.array(e,t):C(e)?ke.map(e,t):E(e)?ke.set(e,t):"object"==typeof e&&null!==e?e:ke.box(e,t);z(e,t,ve)}Object.assign(Ce,Te);var Ee,Ie,ke=a(Ce,{box:function(e,t){var n=be(t);return new He(e,Oe(n),n.name,!0,n.equals)},array:function(e,t){var n=be(t);return(!1===gt.useProxies||!1===n.proxy?Wr:or)(e,Oe(n),n.name)},map:function(e,t){var n=be(t);return new wr(e,Oe(n),n.name)},set:function(e,t){var n=be(t);return new Tr(e,Oe(n),n.name)},object:function(e,t,n){return on(!1===gt.useProxies||!1===(null==n?void 0:n.proxy)?kr({},n):function(e,t){var n,r;return p(),e=kr(e,t),null!=(r=(n=e[W]).proxy_)?r:n.proxy_=new Proxy(e,Gn)}({},n),e,t)},ref:q(we),shallow:q(Se),deep:Te,struct:q(_e)}),Ae="computed",Pe=ae(Ae),Ne=ae("computed.struct",{equals:$.structural}),je=function(e,t){if(b(t))return z(e,t,Pe);if(w(e))return q(ae(Ae,e));var n=w(t)?t:{};return n.get=e,n.name||(n.name=e.name||""),new Qe(n)};Object.assign(je,Pe),je.struct=q(Ne);var Re,xe=0,De=1,Me=null!=(Ee=null==(Ie=s((function(){}),"name"))?void 0:Ie.configurable)&&Ee,Le={value:"action",configurable:!0,writable:!1,enumerable:!1};function Be(e,t,n,r){function i(){return Fe(e,n,t,r||this,arguments)}return void 0===n&&(n=!1),i.isMobxAction=!0,Me&&(Le.value=e,Object.defineProperty(i,"name",Le)),i}function Fe(e,t,n,r,i){var o=Ue(e,t,r,i);try{return n.apply(r,i)}catch(e){throw o.error_=e,e}finally{qe(o)}}function Ue(e,t,n,r){var i=gt.trackingDerivation,o=!t||!i;St();var a=gt.allowStateChanges;o&&(at(),a=We(!0));var s={runAsAction_:o,prevDerivation_:i,prevAllowStateChanges_:a,prevAllowStateReads_:ut(!0),notifySpy_:!1,startTime_:0,actionId_:De++,parentActionId_:xe};return xe=s.actionId_,s}function qe(e){xe!==e.actionId_&&r(30),xe=e.parentActionId_,void 0!==e.error_&&(gt.suppressReactionErrors=!0),Ve(e.prevAllowStateChanges_),ct(e.prevAllowStateReads_),_t(),e.runAsAction_&&st(e.prevDerivation_),gt.suppressReactionErrors=!1}function ze(e,t){var n=We(e);try{return t()}finally{Ve(n)}}function We(e){var t=gt.allowStateChanges;return gt.allowStateChanges=e,t}function Ve(e){gt.allowStateChanges=e}Re=Symbol.toPrimitive;var Ge,He=function(e){function t(t,n,r,i,o){var a;return void 0===r&&(r="ObservableValue"),void 0===i&&(i=!0),void 0===o&&(o=$.default),(a=e.call(this,r)||this).enhancer=void 0,a.name_=void 0,a.equals=void 0,a.hasUnreportedChange_=!1,a.interceptors_=void 0,a.changeListeners_=void 0,a.value_=void 0,a.dehancer=void 0,a.enhancer=n,a.name_=r,a.equals=o,a.value_=n(t,void 0,r),a}D(t,e);var n=t.prototype;return n.dehanceValue=function(e){return void 0!==this.dehancer?this.dehancer(e):e},n.set=function(e){this.value_;if((e=this.prepareNewValue_(e))!==gt.UNCHANGED){0,this.setNewValue_(e)}},n.prepareNewValue_=function(e){if(nt(this),Hn(this)){var t=Kn(this,{object:this,type:nr,newValue:e});if(!t)return gt.UNCHANGED;e=t.newValue}return e=this.enhancer(e,this.value_,this.name_),this.equals(this.value_,e)?gt.UNCHANGED:e},n.setNewValue_=function(e){var t=this.value_;this.value_=e,this.reportChanged(),Jn(this)&&Yn(this,{type:nr,object:this,newValue:e,oldValue:t})},n.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},n.intercept_=function(e){return $n(this,e)},n.observe_=function(e,t){return t&&e({observableKind:"value",debugObjectName:this.name_,object:this,type:nr,newValue:this.value_,oldValue:void 0}),Qn(this,e)},n.raw=function(){return this.value_},n.toJSON=function(){return this.get()},n.toString=function(){return this.name_+"["+this.value_+"]"},n.valueOf=function(){return A(this.get())},n[Re]=function(){return this.valueOf()},t}(V),$e=O("ObservableValue",He);Ge=Symbol.toPrimitive;var Ke,Je,Qe=function(){function e(e){this.dependenciesState_=Ke.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.isBeingObserved_=!1,this.isPendingUnobservation_=!1,this.observers_=new Set,this.diffValue_=0,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=Ke.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new Xe(null),this.name_=void 0,this.triggeredBy_=void 0,this.isComputing_=!1,this.isRunningSetter_=!1,this.derivation=void 0,this.setter_=void 0,this.isTracing_=Je.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,e.get||r(31),this.derivation=e.get,this.name_=e.name||"ComputedValue",e.set&&(this.setter_=Be("ComputedValue-setter",e.set)),this.equals_=e.equals||(e.compareStructural||e.struct?$.structural:$.default),this.scope_=e.context,this.requiresReaction_=e.requiresReaction,this.keepAlive_=!!e.keepAlive}var t=e.prototype;return t.onBecomeStale_=function(){!function(e){if(e.lowestObserverState_!==Ke.UP_TO_DATE_)return;e.lowestObserverState_=Ke.POSSIBLY_STALE_,e.observers_.forEach((function(e){e.dependenciesState_===Ke.UP_TO_DATE_&&(e.dependenciesState_=Ke.POSSIBLY_STALE_,e.onBecomeStale_())}))}(this)},t.onBO=function(){this.onBOL&&this.onBOL.forEach((function(e){return e()}))},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach((function(e){return e()}))},t.get=function(){if(this.isComputing_&&r(32,this.name_,this.derivation),0!==gt.inBatch||0!==this.observers_.size||this.keepAlive_){if(Tt(this),et(this)){var e=gt.trackingContext;this.keepAlive_&&!e&&(gt.trackingContext=this),this.trackAndCompute()&&function(e){if(e.lowestObserverState_===Ke.STALE_)return;e.lowestObserverState_=Ke.STALE_,e.observers_.forEach((function(t){t.dependenciesState_===Ke.POSSIBLY_STALE_?t.dependenciesState_=Ke.STALE_:t.dependenciesState_===Ke.UP_TO_DATE_&&(e.lowestObserverState_=Ke.UP_TO_DATE_)}))}(this),gt.trackingContext=e}}else et(this)&&(this.warnAboutUntrackedRead_(),St(),this.value_=this.computeValue_(!1),_t());var t=this.value_;if(Ze(t))throw t.cause;return t},t.set=function(e){if(this.setter_){this.isRunningSetter_&&r(33,this.name_),this.isRunningSetter_=!0;try{this.setter_.call(this.scope_,e)}finally{this.isRunningSetter_=!1}}else r(34,this.name_)},t.trackAndCompute=function(){var e=this.value_,t=this.dependenciesState_===Ke.NOT_TRACKING_,n=this.computeValue_(!0),r=t||Ze(e)||Ze(n)||!this.equals_(e,n);return r&&(this.value_=n),r},t.computeValue_=function(e){this.isComputing_=!0;var t,n=We(!1);if(e)t=rt(this,this.derivation,this.scope_);else if(!0===gt.disableErrorBoundaries)t=this.derivation.call(this.scope_);else try{t=this.derivation.call(this.scope_)}catch(e){t=new Xe(e)}return Ve(n),this.isComputing_=!1,t},t.suspend_=function(){this.keepAlive_||(it(this),this.value_=void 0)},t.observe_=function(e,t){var n=this,r=!0,i=void 0;return Gt((function(){var o=n.get();if(!r||t){var a=at();e({observableKind:"computed",debugObjectName:n.name_,type:nr,object:n,newValue:o,oldValue:i}),st(a)}r=!1,i=o}))},t.warnAboutUntrackedRead_=function(){},t.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},t.valueOf=function(){return A(this.get())},t[Ge]=function(){return this.valueOf()},e}(),Ye=O("ComputedValue",Qe);!function(e){e[e.NOT_TRACKING_=-1]="NOT_TRACKING_",e[e.UP_TO_DATE_=0]="UP_TO_DATE_",e[e.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",e[e.STALE_=2]="STALE_"}(Ke||(Ke={})),function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"}(Je||(Je={}));var Xe=function(e){this.cause=void 0,this.cause=e};function Ze(e){return e instanceof Xe}function et(e){switch(e.dependenciesState_){case Ke.UP_TO_DATE_:return!1;case Ke.NOT_TRACKING_:case Ke.STALE_:return!0;case Ke.POSSIBLY_STALE_:for(var t=ut(!0),n=at(),r=e.observing_,i=r.length,o=0;o<i;o++){var a=r[o];if(Ye(a)){if(gt.disableErrorBoundaries)a.get();else try{a.get()}catch(e){return st(n),ct(t),!0}if(e.dependenciesState_===Ke.STALE_)return st(n),ct(t),!0}}return lt(e),st(n),ct(t),!1}}function tt(){return null!==gt.trackingDerivation}function nt(e){}function rt(e,t,n){var r=ut(!0);lt(e),e.newObserving_=new Array(e.observing_.length+100),e.unboundDepsCount_=0,e.runId_=++gt.runId;var i,o=gt.trackingDerivation;if(gt.trackingDerivation=e,gt.inBatch++,!0===gt.disableErrorBoundaries)i=t.call(n);else try{i=t.call(n)}catch(e){i=new Xe(e)}return gt.inBatch--,gt.trackingDerivation=o,function(e){for(var t=e.observing_,n=e.observing_=e.newObserving_,r=Ke.UP_TO_DATE_,i=0,o=e.unboundDepsCount_,a=0;a<o;a++){var s=n[a];0===s.diffValue_&&(s.diffValue_=1,i!==a&&(n[i]=s),i++),s.dependenciesState_>r&&(r=s.dependenciesState_)}n.length=i,e.newObserving_=null,o=t.length;for(;o--;){var u=t[o];0===u.diffValue_&&vt(u,e),u.diffValue_=0}for(;i--;){var c=n[i];1===c.diffValue_&&(c.diffValue_=0,bt(c,e))}r!==Ke.UP_TO_DATE_&&(e.dependenciesState_=r,e.onBecomeStale_())}(e),ct(r),i}function it(e){var t=e.observing_;e.observing_=[];for(var n=t.length;n--;)vt(t[n],e);e.dependenciesState_=Ke.NOT_TRACKING_}function ot(e){var t=at();try{return e()}finally{st(t)}}function at(){var e=gt.trackingDerivation;return gt.trackingDerivation=null,e}function st(e){gt.trackingDerivation=e}function ut(e){var t=gt.allowStateReads;return gt.allowStateReads=e,t}function ct(e){gt.allowStateReads=e}function lt(e){if(e.dependenciesState_!==Ke.UP_TO_DATE_){e.dependenciesState_=Ke.UP_TO_DATE_;for(var t=e.observing_,n=t.length;n--;)t[n].lowestObserverState_=Ke.UP_TO_DATE_}}var dt=["mobxGuid","spyListeners","enforceActions","computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","allowStateReads","disableErrorBoundaries","runId","UNCHANGED","useProxies"],ft=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0},ht=!0,pt=!1,gt=function(){var e=o();return e.__mobxInstanceCount>0&&!e.__mobxGlobals&&(ht=!1),e.__mobxGlobals&&e.__mobxGlobals.version!==(new ft).version&&(ht=!1),ht?e.__mobxGlobals?(e.__mobxInstanceCount+=1,e.__mobxGlobals.UNCHANGED||(e.__mobxGlobals.UNCHANGED={}),e.__mobxGlobals):(e.__mobxInstanceCount=1,e.__mobxGlobals=new ft):(setTimeout((function(){pt||r(35)}),1),new ft)}();function mt(){return gt}function yt(){var e=new ft;for(var t in e)-1===dt.indexOf(t)&&(gt[t]=e[t]);gt.allowStateChanges=!gt.enforceActions}function bt(e,t){e.observers_.add(t),e.lowestObserverState_>t.dependenciesState_&&(e.lowestObserverState_=t.dependenciesState_)}function vt(e,t){e.observers_.delete(t),0===e.observers_.size&&wt(e)}function wt(e){!1===e.isPendingUnobservation_&&(e.isPendingUnobservation_=!0,gt.pendingUnobservations.push(e))}function St(){gt.inBatch++}function _t(){if(0==--gt.inBatch){At();for(var e=gt.pendingUnobservations,t=0;t<e.length;t++){var n=e[t];n.isPendingUnobservation_=!1,0===n.observers_.size&&(n.isBeingObserved_&&(n.isBeingObserved_=!1,n.onBUO()),n instanceof Qe&&n.suspend_())}gt.pendingUnobservations=[]}}function Tt(e){var t=gt.trackingDerivation;return null!==t?(t.runId_!==e.lastAccessedBy_&&(e.lastAccessedBy_=t.runId_,t.newObserving_[t.unboundDepsCount_++]=e,!e.isBeingObserved_&&gt.trackingContext&&(e.isBeingObserved_=!0,e.onBO())),e.isBeingObserved_):(0===e.observers_.size&&gt.inBatch>0&&wt(e),!1)}function Ot(e){e.lowestObserverState_!==Ke.STALE_&&(e.lowestObserverState_=Ke.STALE_,e.observers_.forEach((function(e){e.dependenciesState_===Ke.UP_TO_DATE_&&e.onBecomeStale_(),e.dependenciesState_=Ke.STALE_})))}var Ct=function(){function e(e,t,n,r){void 0===e&&(e="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=Ke.NOT_TRACKING_,this.diffValue_=0,this.runId_=0,this.unboundDepsCount_=0,this.isDisposed_=!1,this.isScheduled_=!1,this.isTrackPending_=!1,this.isRunning_=!1,this.isTracing_=Je.NONE,this.name_=e,this.onInvalidate_=t,this.errorHandler_=n,this.requiresObservable_=r}var t=e.prototype;return t.onBecomeStale_=function(){this.schedule_()},t.schedule_=function(){this.isScheduled_||(this.isScheduled_=!0,gt.pendingReactions.push(this),At())},t.isScheduled=function(){return this.isScheduled_},t.runReaction_=function(){if(!this.isDisposed_){St(),this.isScheduled_=!1;var e=gt.trackingContext;if(gt.trackingContext=this,et(this)){this.isTrackPending_=!0;try{this.onInvalidate_()}catch(e){this.reportExceptionInDerivation_(e)}}gt.trackingContext=e,_t()}},t.track=function(e){if(!this.isDisposed_){St();0,this.isRunning_=!0;var t=gt.trackingContext;gt.trackingContext=this;var n=rt(this,e,void 0);gt.trackingContext=t,this.isRunning_=!1,this.isTrackPending_=!1,this.isDisposed_&&it(this),Ze(n)&&this.reportExceptionInDerivation_(n.cause),_t()}},t.reportExceptionInDerivation_=function(e){var t=this;if(this.errorHandler_)this.errorHandler_(e,this);else{if(gt.disableErrorBoundaries)throw e;var n="[mobx] uncaught error in '"+this+"'";gt.suppressReactionErrors||console.error(n,e),gt.globalReactionErrorHandlers.forEach((function(n){return n(e,t)}))}},t.dispose=function(){this.isDisposed_||(this.isDisposed_=!0,this.isRunning_||(St(),it(this),_t()))},t.getDisposer_=function(){var e=this.dispose.bind(this);return e[W]=this,e},t.toString=function(){return"Reaction["+this.name_+"]"},t.trace=function(e){void 0===e&&(e=!1),Un(this,e)},e}();function Et(e){return gt.globalReactionErrorHandlers.push(e),function(){var t=gt.globalReactionErrorHandlers.indexOf(e);t>=0&&gt.globalReactionErrorHandlers.splice(t,1)}}var It=100,kt=function(e){return e()};function At(){gt.inBatch>0||gt.isRunningReactions||kt(Pt)}function Pt(){gt.isRunningReactions=!0;for(var e=gt.pendingReactions,t=0;e.length>0;){++t===It&&(console.error("[mobx] cycle in reaction: "+e[0]),e.splice(0));for(var n=e.splice(0),r=0,i=n.length;r<i;r++)n[r].runReaction_()}gt.isRunningReactions=!1}var Nt=O("Reaction",Ct);function jt(e){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var Rt="action",xt="autoAction",Dt="<unnamed action>",Mt=X(Rt),Lt=X("action.bound",{bound:!0}),Bt=X(xt,{autoAction:!0}),Ft=X("autoAction.bound",{autoAction:!0,bound:!0});function Ut(e){return function(t,n){return y(t)?Be(t.name||Dt,t,e):y(n)?Be(t,n,e):b(n)?z(t,n,e?Bt:Mt):b(t)?q(X(e?xt:Rt,{name:t,autoAction:e})):void 0}}var qt=Ut(!1);Object.assign(qt,Mt);var zt=Ut(!0);function Wt(e){return Fe(e.name||Dt,!1,e,this,void 0)}function Vt(e){return y(e)&&!0===e.isMobxAction}function Gt(e,t){var n,r;void 0===t&&(t=d);var i,o=null!=(n=null==(r=t)?void 0:r.name)?n:"Autorun";if(!t.scheduler&&!t.delay)i=new Ct(o,(function(){this.track(u)}),t.onError,t.requiresObservable);else{var a=$t(t),s=!1;i=new Ct(o,(function(){s||(s=!0,a((function(){s=!1,i.isDisposed_||i.track(u)})))}),t.onError,t.requiresObservable)}function u(){e(i)}return i.schedule_(),i.getDisposer_()}Object.assign(zt,Bt),qt.bound=q(Lt),zt.bound=q(Ft);var Ht=function(e){return e()};function $t(e){return e.scheduler?e.scheduler:e.delay?function(t){return setTimeout(t,e.delay)}:Ht}function Kt(e,t,n){var r;void 0===n&&(n=d);var i,o,a,s,u=null!=(r=n.name)?r:"Reaction",c=qt(u,n.onError?(i=n.onError,o=t,function(){try{return o.apply(this,arguments)}catch(e){i.call(this,e)}}):t),l=!n.scheduler&&!n.delay,f=$t(n),h=!0,p=!1,g=n.compareStructural?$.structural:n.equals||$.default,m=new Ct(u,(function(){h||l?y():p||(p=!0,f(y))}),n.onError,n.requiresObservable);function y(){if(p=!1,!m.isDisposed_){var t=!1;m.track((function(){var n=ze(!1,(function(){return e(m)}));t=h||!g(a,n),s=a,a=n})),(h&&n.fireImmediately||!h&&t)&&c(a,s,m),h=!1}}return m.schedule_(),m.getDisposer_()}var Jt="onBO",Qt="onBUO";function Yt(e,t,n){return Zt(Jt,e,t,n)}function Xt(e,t,n){return Zt(Qt,e,t,n)}function Zt(e,t,n,r){var i="function"==typeof r?Vr(t,n):Vr(t),o=y(r)?r:n,a=e+"L";return i[a]?i[a].add(o):i[a]=new Set([o]),function(){var e=i[a];e&&(e.delete(o),0===e.size&&delete i[a])}}var en="never",tn="always",nn="observed";function rn(e){!0===e.isolateGlobalState&&function(){if((gt.pendingReactions.length||gt.inBatch||gt.isRunningReactions)&&r(36),pt=!0,ht){var e=o();0==--e.__mobxInstanceCount&&(e.__mobxGlobals=void 0),gt=new ft}}();var t,n,i=e.useProxies,a=e.enforceActions;if(void 0!==i&&(gt.useProxies=i===tn||i!==en&&"undefined"!=typeof Proxy),"ifavailable"===i&&(gt.verifyProxies=!0),void 0!==a){var s=a===tn?tn:a===nn;gt.enforceActions=s,gt.allowStateChanges=!0!==s&&s!==tn}["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach((function(t){t in e&&(gt[t]=!!e[t])})),gt.allowStateReads=!gt.observableRequiresReaction,e.reactionScheduler&&(t=e.reactionScheduler,n=kt,kt=function(e){return t((function(){return n(e)}))})}function on(e,t,n,r){var i=N(t),o=kr(e,r)[W];St();try{k(i).forEach((function(e){o.extend_(e,i[e],!n||(!(e in n)||n[e]))}))}finally{_t()}return e}function an(e,t){return sn(Vr(e,t))}function sn(e){var t,n={name:e.name_};return e.observing_&&e.observing_.length>0&&(n.dependencies=(t=e.observing_,Array.from(new Set(t))).map(sn)),n}function un(e,t){return cn(Vr(e,t))}function cn(e){var t={name:e.name_};return function(e){return e.observers_&&e.observers_.size>0}(e)&&(t.observers=Array.from(function(e){return e.observers_}(e)).map(cn)),t}var ln=0;function dn(){this.message="FLOW_CANCELLED"}function fn(e){return e instanceof dn}dn.prototype=Object.create(Error.prototype);var hn=ne("flow"),pn=ne("flow.bound",{bound:!0}),gn=Object.assign((function(e,t){if(b(t))return z(e,t,hn);var n=e,r=n.name||"<unnamed flow>",i=function(){var e,t=arguments,i=++ln,o=qt(r+" - runid: "+i+" - init",n).apply(this,t),a=void 0,s=new Promise((function(t,n){var s=0;function u(e){var t;a=void 0;try{t=qt(r+" - runid: "+i+" - yield "+s++,o.next).call(o,e)}catch(e){return n(e)}l(t)}function c(e){var t;a=void 0;try{t=qt(r+" - runid: "+i+" - yield "+s++,o.throw).call(o,e)}catch(e){return n(e)}l(t)}function l(e){if(!y(null==e?void 0:e.then))return e.done?t(e.value):(a=Promise.resolve(e.value)).then(u,c);e.then(l,n)}e=n,u(void 0)}));return s.cancel=qt(r+" - runid: "+i+" - cancel",(function(){try{a&&mn(a);var t=o.return(void 0),n=Promise.resolve(t.value);n.then(m,m),mn(n),e(new dn)}catch(t){e(t)}})),s};return i.isMobXFlow=!0,i}),hn);function mn(e){y(e.cancel)&&e.cancel()}function yn(e){return e}function bn(e){return!0===(null==e?void 0:e.isMobXFlow)}function vn(e,t,n){var r;return Sr(e)||pr(e)||$e(e)?r=Gr(e):Nr(e)&&(r=Gr(e,t)),r.dehancer="function"==typeof t?t:n,function(){r.dehancer=void 0}}function wn(e,t,n){return y(n)?function(e,t,n){return Gr(e,t).intercept_(n)}(e,t,n):function(e,t){return Gr(e).intercept_(t)}(e,t)}function Sn(e,t){if(void 0===t)return Ye(e);if(!1===Nr(e))return!1;if(!e[W].values_.has(t))return!1;var n=Vr(e,t);return Ye(n)}function _n(e){return Sn(e)}function Tn(e,t){return Sn(e,t)}function On(e,t){return!!e&&(void 0!==t?!!Nr(e)&&e[W].values_.has(t):Nr(e)||!!e[W]||G(e)||Nt(e)||Ye(e))}function Cn(e){return On(e)}function En(e,t){return On(e,t)}function In(e){return Nr(e)?e[W].keys_():Sr(e)||Or(e)?Array.from(e.keys()):pr(e)?e.map((function(e,t){return t})):void r(5)}function kn(e){return Nr(e)?In(e).map((function(t){return e[t]})):Sr(e)?In(e).map((function(t){return e.get(t)})):Or(e)?Array.from(e.values()):pr(e)?e.slice():void r(6)}function An(e){return Nr(e)?In(e).map((function(t){return[t,e[t]]})):Sr(e)?In(e).map((function(t){return[t,e.get(t)]})):Or(e)?Array.from(e.entries()):pr(e)?e.map((function(e,t){return[t,e]})):void r(7)}function Pn(e,t,n){if(2!==arguments.length||Or(e))Nr(e)?e[W].set_(t,n):Sr(e)?e.set(t,n):Or(e)?e.add(t):pr(e)?("number"!=typeof t&&(t=parseInt(t,10)),t<0&&r("Invalid index: '"+t+"'"),St(),t>=e.length&&(e.length=t+1),e[t]=n,_t()):r(8);else{St();var i=t;try{for(var o in i)Pn(e,o,i[o])}finally{_t()}}}function Nn(e,t){Nr(e)?e[W].delete_(t):Sr(e)||Or(e)?e.delete(t):pr(e)?("number"!=typeof t&&(t=parseInt(t,10)),e.splice(t,1)):r(9)}function jn(e,t){return Nr(e)?e[W].has_(t):Sr(e)||Or(e)?e.has(t):pr(e)?t>=0&&t<e.length:void r(10)}function Rn(e,t){if(jn(e,t))return Nr(e)?e[W].get_(t):Sr(e)?e.get(t):pr(e)?e[t]:void r(11)}function xn(e,t,n){if(Nr(e))return e[W].defineProperty_(t,n);r(39)}function Dn(e){if(Nr(e))return e[W].ownKeys_();r(38)}function Mn(e,t,n,r){return y(n)?function(e,t,n,r){return Gr(e,t).observe_(n,r)}(e,t,n,r):function(e,t,n){return Gr(e).observe_(t,n)}(e,t,n)}function Ln(e,t,n){return e.set(t,n),n}function Bn(e,t){if(null==e||"object"!=typeof e||e instanceof Date||!Cn(e))return e;if($e(e)||Ye(e))return Bn(e.get(),t);if(t.has(e))return t.get(e);if(pr(e)){var n=Ln(t,e,new Array(e.length));return e.forEach((function(e,r){n[r]=Bn(e,t)})),n}if(Or(e)){var r=Ln(t,e,new Set);return e.forEach((function(e){r.add(Bn(e,t))})),r}if(Sr(e)){var i=Ln(t,e,new Map);return e.forEach((function(e,n){i.set(n,Bn(e,t))})),i}var o=Ln(t,e,{});return Dn(e).forEach((function(n){c.propertyIsEnumerable.call(e,n)&&(o[n]=Bn(e[n],t))})),o}function Fn(e,t){return Bn(e,new Map)}function Un(){r("trace() is not available in production builds");for(var e=!1,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];"boolean"==typeof n[n.length-1]&&(e=n.pop());var o=function(e){switch(e.length){case 0:return gt.trackingDerivation;case 1:return Vr(e[0]);case 2:return Vr(e[0],e[1])}}(n);if(!o)return r("'trace(break?)' can only be used inside a tracked computed value or a Reaction. Consider passing in the computed value or reaction explicitly");o.isTracing_===Je.NONE&&console.log("[mobx.trace] '"+o.name_+"' tracing enabled"),o.isTracing_=e?Je.BREAK:Je.LOG}function qn(e,t){void 0===t&&(t=void 0),St();try{return e.apply(t)}finally{_t()}}function zn(e,t,n){return 1===arguments.length||t&&"object"==typeof t?function(e,t){var n,r,i;0;if(null!=t&&null!=(n=t.signal)&&n.aborted)return Object.assign(Promise.reject(new Error("WHEN_ABORTED")),{cancel:function(){return null}});var o=new Promise((function(n,o){var a,s=Wn(e,n,x({},t,{onError:o}));r=function(){s(),o(new Error("WHEN_CANCELLED"))},i=function(){s(),o(new Error("WHEN_ABORTED"))},null==t||null==(a=t.signal)||a.addEventListener("abort",i)})).finally((function(){var e;return null==t||null==(e=t.signal)?void 0:e.removeEventListener("abort",i)}));return o.cancel=r,o}(e,t):Wn(e,t,n||{})}function Wn(e,t,n){var r;if("number"==typeof n.timeout){var i=new Error("WHEN_TIMEOUT");r=setTimeout((function(){if(!a[W].isDisposed_){if(a(),!n.onError)throw i;n.onError(i)}}),n.timeout)}n.name="When";var o=Be("When-effect",t),a=Gt((function(t){ze(!1,e)&&(t.dispose(),r&&clearTimeout(r),o())}),n);return a}function Vn(e){return e[W]}gn.bound=q(pn);var Gn={has:function(e,t){return Vn(e).has_(t)},get:function(e,t){return Vn(e).get_(t)},set:function(e,t,n){var r;return!!b(t)&&(null==(r=Vn(e).set_(t,n,!0))||r)},deleteProperty:function(e,t){var n;return!!b(t)&&(null==(n=Vn(e).delete_(t,!0))||n)},defineProperty:function(e,t,n){var r;return null==(r=Vn(e).defineProperty_(t,n))||r},ownKeys:function(e){return Vn(e).ownKeys_()},preventExtensions:function(e){r(13)}};function Hn(e){return void 0!==e.interceptors_&&e.interceptors_.length>0}function $n(e,t){var n=e.interceptors_||(e.interceptors_=[]);return n.push(t),g((function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)}))}function Kn(e,t){var n=at();try{for(var i=[].concat(e.interceptors_||[]),o=0,a=i.length;o<a&&((t=i[o](t))&&!t.type&&r(14),t);o++);return t}finally{st(n)}}function Jn(e){return void 0!==e.changeListeners_&&e.changeListeners_.length>0}function Qn(e,t){var n=e.changeListeners_||(e.changeListeners_=[]);return n.push(t),g((function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)}))}function Yn(e,t){var n=at(),r=e.changeListeners_;if(r){for(var i=0,o=(r=r.slice()).length;i<o;i++)r[i](t);st(n)}}function Xn(e,t,n){var r=kr(e,n)[W];St();try{0,null!=t||(t=function(e){return P(e,U)||_(e,U,x({},e[U])),e[U]}(e)),k(t).forEach((function(e){return r.make_(e,t[e])}))}finally{_t()}return e}var Zn=Symbol("mobx-keys");function er(e,t,n){if(w(e))return on(e,e,t,n);var r=kr(e,n)[W];if(!e[Zn]){var i=Object.getPrototypeOf(e),o=new Set([].concat(k(e),k(i)));o.delete("constructor"),o.delete(W),_(i,Zn,o)}St();try{e[Zn].forEach((function(e){return r.make_(e,!t||(!(e in t)||t[e]))}))}finally{_t()}return e}var tr="splice",nr="update",rr={get:function(e,t){var n=e[W];return t===W?n:"length"===t?n.getArrayLength_():"string"!=typeof t||isNaN(t)?P(ar,t)?ar[t]:e[t]:n.get_(parseInt(t))},set:function(e,t,n){var r=e[W];return"length"===t&&r.setArrayLength_(n),"symbol"==typeof t||isNaN(t)?e[t]=n:r.set_(parseInt(t),n),!0},preventExtensions:function(){r(15)}},ir=function(){function e(e,t,n,r){void 0===e&&(e="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=n,this.legacyMode_=r,this.atom_=new V(e),this.enhancer_=function(e,n){return t(e,n,"ObservableArray[..]")}}var t=e.prototype;return t.dehanceValue_=function(e){return void 0!==this.dehancer?this.dehancer(e):e},t.dehanceValues_=function(e){return void 0!==this.dehancer&&e.length>0?e.map(this.dehancer):e},t.intercept_=function(e){return $n(this,e)},t.observe_=function(e,t){return void 0===t&&(t=!1),t&&e({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),Qn(this,e)},t.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},t.setArrayLength_=function(e){("number"!=typeof e||isNaN(e)||e<0)&&r("Out of range: "+e);var t=this.values_.length;if(e!==t)if(e>t){for(var n=new Array(e-t),i=0;i<e-t;i++)n[i]=void 0;this.spliceWithArray_(t,0,n)}else this.spliceWithArray_(e,t-e)},t.updateArrayLength_=function(e,t){e!==this.lastKnownLength_&&r(16),this.lastKnownLength_+=t,this.legacyMode_&&t>0&&zr(e+t+1)},t.spliceWithArray_=function(e,t,n){var r=this;this.atom_;var i=this.values_.length;if(void 0===e?e=0:e>i?e=i:e<0&&(e=Math.max(0,i+e)),t=1===arguments.length?i-e:null==t?0:Math.max(0,Math.min(t,i-e)),void 0===n&&(n=l),Hn(this)){var o=Kn(this,{object:this.proxy_,type:tr,index:e,removedCount:t,added:n});if(!o)return l;t=o.removedCount,n=o.added}if(n=0===n.length?n:n.map((function(e){return r.enhancer_(e,void 0)})),this.legacyMode_){var a=n.length-t;this.updateArrayLength_(i,a)}var s=this.spliceItemsIntoValues_(e,t,n);return 0===t&&0===n.length||this.notifyArraySplice_(e,n,s),this.dehanceValues_(s)},t.spliceItemsIntoValues_=function(e,t,n){var r;if(n.length<1e4)return(r=this.values_).splice.apply(r,[e,t].concat(n));var i=this.values_.slice(e,e+t),o=this.values_.slice(e+t);this.values_.length+=n.length-t;for(var a=0;a<n.length;a++)this.values_[e+a]=n[a];for(var s=0;s<o.length;s++)this.values_[e+n.length+s]=o[s];return i},t.notifyArrayChildUpdate_=function(e,t,n){var r=!this.owned_&&!1,i=Jn(this),o=i||r?{observableKind:"array",object:this.proxy_,type:nr,debugObjectName:this.atom_.name_,index:e,newValue:t,oldValue:n}:null;this.atom_.reportChanged(),i&&Yn(this,o)},t.notifyArraySplice_=function(e,t,n){var r=!this.owned_&&!1,i=Jn(this),o=i||r?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:tr,index:e,removed:n,added:t,removedCount:n.length,addedCount:t.length}:null;this.atom_.reportChanged(),i&&Yn(this,o)},t.get_=function(e){if(!(this.legacyMode_&&e>=this.values_.length))return this.atom_.reportObserved(),this.dehanceValue_(this.values_[e]);console.warn("[mobx] Out of bounds read: "+e)},t.set_=function(e,t){var n=this.values_;if(this.legacyMode_&&e>n.length&&r(17,e,n.length),e<n.length){this.atom_;var i=n[e];if(Hn(this)){var o=Kn(this,{type:nr,object:this.proxy_,index:e,newValue:t});if(!o)return;t=o.newValue}(t=this.enhancer_(t,i))!==i&&(n[e]=t,this.notifyArrayChildUpdate_(e,t,i))}else{for(var a=new Array(e+1-n.length),s=0;s<a.length-1;s++)a[s]=void 0;a[a.length-1]=t,this.spliceWithArray_(n.length,0,a)}},e}();function or(e,t,n,r){void 0===n&&(n="ObservableArray"),void 0===r&&(r=!1),p();var i=new ir(n,t,r,!1);T(i.values_,W,i);var o=new Proxy(i.values_,rr);if(i.proxy_=o,e&&e.length){var a=We(!0);i.spliceWithArray_(0,0,e),Ve(a)}return o}var ar={clear:function(){return this.splice(0)},replace:function(e){var t=this[W];return t.spliceWithArray_(0,t.values_.length,e)},toJSON:function(){return this.slice()},splice:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o=this[W];switch(arguments.length){case 0:return[];case 1:return o.spliceWithArray_(e);case 2:return o.spliceWithArray_(e,t)}return o.spliceWithArray_(e,t,r)},spliceWithArray:function(e,t,n){return this[W].spliceWithArray_(e,t,n)},push:function(){for(var e=this[W],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.spliceWithArray_(e.values_.length,0,n),e.values_.length},pop:function(){return this.splice(Math.max(this[W].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var e=this[W],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.spliceWithArray_(0,0,n),e.values_.length},reverse:function(){return gt.trackingDerivation&&r(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){gt.trackingDerivation&&r(37,"sort");var e=this.slice();return e.sort.apply(e,arguments),this.replace(e),this},remove:function(e){var t=this[W],n=t.dehanceValues_(t.values_).indexOf(e);return n>-1&&(this.splice(n,1),!0)}};function sr(e,t){"function"==typeof Array.prototype[e]&&(ar[e]=t(e))}function ur(e){return function(){var t=this[W];t.atom_.reportObserved();var n=t.dehanceValues_(t.values_);return n[e].apply(n,arguments)}}function cr(e){return function(t,n){var r=this,i=this[W];return i.atom_.reportObserved(),i.dehanceValues_(i.values_)[e]((function(e,i){return t.call(n,e,i,r)}))}}function lr(e){return function(){var t=this,n=this[W];n.atom_.reportObserved();var r=n.dehanceValues_(n.values_),i=arguments[0];return arguments[0]=function(e,n,r){return i(e,n,r,t)},r[e].apply(r,arguments)}}sr("concat",ur),sr("flat",ur),sr("includes",ur),sr("indexOf",ur),sr("join",ur),sr("lastIndexOf",ur),sr("slice",ur),sr("toString",ur),sr("toLocaleString",ur),sr("every",cr),sr("filter",cr),sr("find",cr),sr("findIndex",cr),sr("flatMap",cr),sr("forEach",cr),sr("map",cr),sr("some",cr),sr("reduce",lr),sr("reduceRight",lr);var dr,fr,hr=O("ObservableArrayAdministration",ir);function pr(e){return v(e)&&hr(e[W])}var gr={},mr="add",yr="delete";dr=Symbol.iterator,fr=Symbol.toStringTag;var br,vr,wr=function(){function e(e,t,n){var i=this;void 0===t&&(t=K),void 0===n&&(n="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[W]=gr,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=t,this.name_=n,y(Map)||r(18),this.keysAtom_=H("ObservableMap.keys()"),this.data_=new Map,this.hasMap_=new Map,ze(!0,(function(){i.merge(e)}))}var t=e.prototype;return t.has_=function(e){return this.data_.has(e)},t.has=function(e){var t=this;if(!gt.trackingDerivation)return this.has_(e);var n=this.hasMap_.get(e);if(!n){var r=n=new He(this.has_(e),J,"ObservableMap.key?",!1);this.hasMap_.set(e,r),Xt(r,(function(){return t.hasMap_.delete(e)}))}return n.get()},t.set=function(e,t){var n=this.has_(e);if(Hn(this)){var r=Kn(this,{type:n?nr:mr,object:this,newValue:t,name:e});if(!r)return this;t=r.newValue}return n?this.updateValue_(e,t):this.addValue_(e,t),this},t.delete=function(e){var t=this;if((this.keysAtom_,Hn(this))&&!Kn(this,{type:yr,object:this,name:e}))return!1;if(this.has_(e)){var n=Jn(this),r=n?{observableKind:"map",debugObjectName:this.name_,type:yr,object:this,oldValue:this.data_.get(e).value_,name:e}:null;return qn((function(){var n;t.keysAtom_.reportChanged(),null==(n=t.hasMap_.get(e))||n.setNewValue_(!1),t.data_.get(e).setNewValue_(void 0),t.data_.delete(e)})),n&&Yn(this,r),!0}return!1},t.updateValue_=function(e,t){var n=this.data_.get(e);if((t=n.prepareNewValue_(t))!==gt.UNCHANGED){var r=Jn(this),i=r?{observableKind:"map",debugObjectName:this.name_,type:nr,object:this,oldValue:n.value_,name:e,newValue:t}:null;0,n.setNewValue_(t),r&&Yn(this,i)}},t.addValue_=function(e,t){var n=this;this.keysAtom_,qn((function(){var r,i=new He(t,n.enhancer_,"ObservableMap.key",!1);n.data_.set(e,i),t=i.value_,null==(r=n.hasMap_.get(e))||r.setNewValue_(!0),n.keysAtom_.reportChanged()}));var r=Jn(this),i=r?{observableKind:"map",debugObjectName:this.name_,type:mr,object:this,name:e,newValue:t}:null;r&&Yn(this,i)},t.get=function(e){return this.has(e)?this.dehanceValue_(this.data_.get(e).get()):this.dehanceValue_(void 0)},t.dehanceValue_=function(e){return void 0!==this.dehancer?this.dehancer(e):e},t.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},t.values=function(){var e=this,t=this.keys();return Yr({next:function(){var n=t.next(),r=n.done,i=n.value;return{done:r,value:r?void 0:e.get(i)}}})},t.entries=function(){var e=this,t=this.keys();return Yr({next:function(){var n=t.next(),r=n.done,i=n.value;return{done:r,value:r?void 0:[i,e.get(i)]}}})},t[dr]=function(){return this.entries()},t.forEach=function(e,t){for(var n,r=F(this);!(n=r()).done;){var i=n.value,o=i[0],a=i[1];e.call(t,a,o,this)}},t.merge=function(e){var t=this;return Sr(e)&&(e=new Map(e)),qn((function(){w(e)?function(e){var t=Object.keys(e);if(!I)return t;var n=Object.getOwnPropertySymbols(e);return n.length?[].concat(t,n.filter((function(t){return c.propertyIsEnumerable.call(e,t)}))):t}(e).forEach((function(n){return t.set(n,e[n])})):Array.isArray(e)?e.forEach((function(e){var n=e[0],r=e[1];return t.set(n,r)})):C(e)?(e.constructor!==Map&&r(19,e),e.forEach((function(e,n){return t.set(n,e)}))):null!=e&&r(20,e)})),this},t.clear=function(){var e=this;qn((function(){ot((function(){for(var t,n=F(e.keys());!(t=n()).done;){var r=t.value;e.delete(r)}}))}))},t.replace=function(e){var t=this;return qn((function(){for(var n,i=function(e){if(C(e)||Sr(e))return e;if(Array.isArray(e))return new Map(e);if(w(e)){var t=new Map;for(var n in e)t.set(n,e[n]);return t}return r(21,e)}(e),o=new Map,a=!1,s=F(t.data_.keys());!(n=s()).done;){var u=n.value;if(!i.has(u))if(t.delete(u))a=!0;else{var c=t.data_.get(u);o.set(u,c)}}for(var l,d=F(i.entries());!(l=d()).done;){var f=l.value,h=f[0],p=f[1],g=t.data_.has(h);if(t.set(h,p),t.data_.has(h)){var m=t.data_.get(h);o.set(h,m),g||(a=!0)}}if(!a)if(t.data_.size!==o.size)t.keysAtom_.reportChanged();else for(var y=t.data_.keys(),b=o.keys(),v=y.next(),S=b.next();!v.done;){if(v.value!==S.value){t.keysAtom_.reportChanged();break}v=y.next(),S=b.next()}t.data_=o})),this},t.toString=function(){return"[object ObservableMap]"},t.toJSON=function(){return Array.from(this)},t.observe_=function(e,t){return Qn(this,e)},t.intercept_=function(e){return $n(this,e)},R(e,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:fr,get:function(){return"Map"}}]),e}(),Sr=O("ObservableMap",wr);var _r={};br=Symbol.iterator,vr=Symbol.toStringTag;var Tr=function(){function e(e,t,n){void 0===t&&(t=K),void 0===n&&(n="ObservableSet"),this.name_=void 0,this[W]=_r,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=n,y(Set)||r(22),this.atom_=H(this.name_),this.enhancer_=function(e,r){return t(e,r,n)},e&&this.replace(e)}var t=e.prototype;return t.dehanceValue_=function(e){return void 0!==this.dehancer?this.dehancer(e):e},t.clear=function(){var e=this;qn((function(){ot((function(){for(var t,n=F(e.data_.values());!(t=n()).done;){var r=t.value;e.delete(r)}}))}))},t.forEach=function(e,t){for(var n,r=F(this);!(n=r()).done;){var i=n.value;e.call(t,i,i,this)}},t.add=function(e){var t=this;if((this.atom_,Hn(this))&&!Kn(this,{type:mr,object:this,newValue:e}))return this;if(!this.has(e)){qn((function(){t.data_.add(t.enhancer_(e,void 0)),t.atom_.reportChanged()}));var n=!1,r=Jn(this),i=r?{observableKind:"set",debugObjectName:this.name_,type:mr,object:this,newValue:e}:null;n,r&&Yn(this,i)}return this},t.delete=function(e){var t=this;if(Hn(this)&&!Kn(this,{type:yr,object:this,oldValue:e}))return!1;if(this.has(e)){var n=Jn(this),r=n?{observableKind:"set",debugObjectName:this.name_,type:yr,object:this,oldValue:e}:null;return qn((function(){t.atom_.reportChanged(),t.data_.delete(e)})),n&&Yn(this,r),!0}return!1},t.has=function(e){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(e))},t.entries=function(){var e=0,t=Array.from(this.keys()),n=Array.from(this.values());return Yr({next:function(){var r=e;return e+=1,r<n.length?{value:[t[r],n[r]],done:!1}:{done:!0}}})},t.keys=function(){return this.values()},t.values=function(){this.atom_.reportObserved();var e=this,t=0,n=Array.from(this.data_.values());return Yr({next:function(){return t<n.length?{value:e.dehanceValue_(n[t++]),done:!1}:{done:!0}}})},t.replace=function(e){var t=this;return Or(e)&&(e=new Set(e)),qn((function(){Array.isArray(e)||E(e)?(t.clear(),e.forEach((function(e){return t.add(e)}))):null!=e&&r("Cannot initialize set from "+e)})),this},t.observe_=function(e,t){return Qn(this,e)},t.intercept_=function(e){return $n(this,e)},t.toJSON=function(){return Array.from(this)},t.toString=function(){return"[object ObservableSet]"},t[br]=function(){return this.values()},R(e,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:vr,get:function(){return"Set"}}]),e}(),Or=O("ObservableSet",Tr),Cr=Object.create(null),Er="remove",Ir=function(){function e(e,t,n,r){void 0===t&&(t=new Map),void 0===r&&(r=he),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=e,this.values_=t,this.name_=n,this.defaultAnnotation_=r,this.keysAtom_=new V("ObservableObject.keys"),this.isPlainObject_=w(this.target_)}var t=e.prototype;return t.getObservablePropValue_=function(e){return this.values_.get(e).get()},t.setObservablePropValue_=function(e,t){var n=this.values_.get(e);if(n instanceof Qe)return n.set(t),!0;if(Hn(this)){var r=Kn(this,{type:nr,object:this.proxy_||this.target_,name:e,newValue:t});if(!r)return null;t=r.newValue}if((t=n.prepareNewValue_(t))!==gt.UNCHANGED){var i=Jn(this),o=i?{type:nr,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:n.value_,name:e,newValue:t}:null;0,n.setNewValue_(t),i&&Yn(this,o)}return!0},t.get_=function(e){return gt.trackingDerivation&&!P(this.target_,e)&&this.has_(e),this.target_[e]},t.set_=function(e,t,n){return void 0===n&&(n=!1),P(this.target_,e)?this.values_.has(e)?this.setObservablePropValue_(e,t):n?Reflect.set(this.target_,e,t):(this.target_[e]=t,!0):this.extend_(e,{value:t,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,n)},t.has_=function(e){if(!gt.trackingDerivation)return e in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var t=this.pendingKeys_.get(e);return t||(t=new He(e in this.target_,J,"ObservableObject.key?",!1),this.pendingKeys_.set(e,t)),t.get()},t.make_=function(e,t){if(!0===t&&(t=this.defaultAnnotation_),!1!==t){if(Rr(this,t,e),!(e in this.target_)){var n;if(null!=(n=this.target_[U])&&n[e])return;r(1,t.annotationType_,this.name_+"."+e.toString())}for(var i=this.target_;i&&i!==c;){var o=s(i,e);if(o){var a=t.make_(this,e,o,i);if(0===a)return;if(1===a)break}i=Object.getPrototypeOf(i)}jr(this,t,e)}},t.extend_=function(e,t,n,r){if(void 0===r&&(r=!1),!0===n&&(n=this.defaultAnnotation_),!1===n)return this.defineProperty_(e,t,r);Rr(this,n,e);var i=n.extend_(this,e,t,r);return i&&jr(this,n,e),i},t.defineProperty_=function(e,t,n){void 0===n&&(n=!1);try{St();var r=this.delete_(e);if(!r)return r;if(Hn(this)){var i=Kn(this,{object:this.proxy_||this.target_,name:e,type:mr,newValue:t.value});if(!i)return null;var o=i.newValue;t.value!==o&&(t=x({},t,{value:o}))}if(n){if(!Reflect.defineProperty(this.target_,e,t))return!1}else u(this.target_,e,t);this.notifyPropertyAddition_(e,t.value)}finally{_t()}return!0},t.defineObservableProperty_=function(e,t,n,r){void 0===r&&(r=!1);try{St();var i=this.delete_(e);if(!i)return i;if(Hn(this)){var o=Kn(this,{object:this.proxy_||this.target_,name:e,type:mr,newValue:t});if(!o)return null;t=o.newValue}var a=Pr(e),s={configurable:!gt.safeDescriptors||this.isPlainObject_,enumerable:!0,get:a.get,set:a.set};if(r){if(!Reflect.defineProperty(this.target_,e,s))return!1}else u(this.target_,e,s);var c=new He(t,n,"ObservableObject.key",!1);this.values_.set(e,c),this.notifyPropertyAddition_(e,c.value_)}finally{_t()}return!0},t.defineComputedProperty_=function(e,t,n){void 0===n&&(n=!1);try{St();var r=this.delete_(e);if(!r)return r;if(Hn(this))if(!Kn(this,{object:this.proxy_||this.target_,name:e,type:mr,newValue:void 0}))return null;t.name||(t.name="ObservableObject.key"),t.context=this.proxy_||this.target_;var i=Pr(e),o={configurable:!gt.safeDescriptors||this.isPlainObject_,enumerable:!1,get:i.get,set:i.set};if(n){if(!Reflect.defineProperty(this.target_,e,o))return!1}else u(this.target_,e,o);this.values_.set(e,new Qe(t)),this.notifyPropertyAddition_(e,void 0)}finally{_t()}return!0},t.delete_=function(e,t){if(void 0===t&&(t=!1),!P(this.target_,e))return!0;if(Hn(this)&&!Kn(this,{object:this.proxy_||this.target_,name:e,type:Er}))return null;try{var n,r;St();var i,o=Jn(this),a=this.values_.get(e),u=void 0;if(!a&&o)u=null==(i=s(this.target_,e))?void 0:i.value;if(t){if(!Reflect.deleteProperty(this.target_,e))return!1}else delete this.target_[e];if(a&&(this.values_.delete(e),a instanceof He&&(u=a.value_),Ot(a)),this.keysAtom_.reportChanged(),null==(n=this.pendingKeys_)||null==(r=n.get(e))||r.set(e in this.target_),o){var c={type:Er,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:u,name:e};0,o&&Yn(this,c)}}finally{_t()}return!0},t.observe_=function(e,t){return Qn(this,e)},t.intercept_=function(e){return $n(this,e)},t.notifyPropertyAddition_=function(e,t){var n,r,i=Jn(this);if(i){var o=i?{type:mr,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:e,newValue:t}:null;0,i&&Yn(this,o)}null==(n=this.pendingKeys_)||null==(r=n.get(e))||r.set(!0),this.keysAtom_.reportChanged()},t.ownKeys_=function(){return this.keysAtom_.reportObserved(),k(this.target_)},t.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},e}();function kr(e,t){var n;if(P(e,W))return e;var r=null!=(n=null==t?void 0:t.name)?n:"ObservableObject",i=new Ir(e,new Map,String(r),function(e){var t;return e?null!=(t=e.defaultDecorator)?t:pe(e):void 0}(t));return _(e,W,i),e}var Ar=O("ObservableObjectAdministration",Ir);function Pr(e){return Cr[e]||(Cr[e]={get:function(){return this[W].getObservablePropValue_(e)},set:function(t){return this[W].setObservablePropValue_(e,t)}})}function Nr(e){return!!v(e)&&Ar(e[W])}function jr(e,t,n){var r;null==(r=e.target_[U])||delete r[n]}function Rr(e,t,n){}var xr,Dr,Mr=Ur(0),Lr=0,Br=function(){};xr=Br,Dr=Array.prototype,Object.setPrototypeOf?Object.setPrototypeOf(xr.prototype,Dr):void 0!==xr.prototype.__proto__?xr.prototype.__proto__=Dr:xr.prototype=Dr;var Fr=function(e,t,n){function r(t,n,r,i){var o;void 0===r&&(r="ObservableArray"),void 0===i&&(i=!1),o=e.call(this)||this;var a=new ir(r,n,i,!0);if(a.proxy_=L(o),T(L(o),W,a),t&&t.length){var s=We(!0);o.spliceWithArray(0,0,t),Ve(s)}return Object.defineProperty(L(o),"0",Mr),o}D(r,e);var i=r.prototype;return i.concat=function(){this[W].atom_.reportObserved();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Array.prototype.concat.apply(this.slice(),t.map((function(e){return pr(e)?e.slice():e})))},i[n]=function(){var e=this,t=0;return Yr({next:function(){return t<e.length?{value:e[t++],done:!1}:{done:!0,value:void 0}}})},R(r,[{key:"length",get:function(){return this[W].getArrayLength_()},set:function(e){this[W].setArrayLength_(e)}},{key:t,get:function(){return"Array"}}]),r}(Br,Symbol.toStringTag,Symbol.iterator);function Ur(e){return{enumerable:!1,configurable:!0,get:function(){return this[W].get_(e)},set:function(t){this[W].set_(e,t)}}}function qr(e){u(Fr.prototype,""+e,Ur(e))}function zr(e){if(e>Lr){for(var t=Lr;t<e+100;t++)qr(t);Lr=e}}function Wr(e,t,n){return new Fr(e,t,n)}function Vr(e,t){if("object"==typeof e&&null!==e){if(pr(e))return void 0!==t&&r(23),e[W].atom_;if(Or(e))return e[W];if(Sr(e)){if(void 0===t)return e.keysAtom_;var n=e.data_.get(t)||e.hasMap_.get(t);return n||r(25,t,Hr(e)),n}if(Nr(e)){if(!t)return r(26);var i=e[W].values_.get(t);return i||r(27,t,Hr(e)),i}if(G(e)||Ye(e)||Nt(e))return e}else if(y(e)&&Nt(e[W]))return e[W];r(28)}function Gr(e,t){return e||r(29),void 0!==t?Gr(Vr(e,t)):G(e)||Ye(e)||Nt(e)||Sr(e)||Or(e)?e:e[W]?e[W]:void r(24,e)}function Hr(e,t){var n;if(void 0!==t)n=Vr(e,t);else{if(Vt(e))return e.name;n=Nr(e)||Sr(e)||Or(e)?Gr(e):Vr(e)}return n.name_}Object.entries(ar).forEach((function(e){var t=e[0],n=e[1];"concat"!==t&&_(Fr.prototype,t,n)})),zr(1e3);var $r=c.toString;function Kr(e,t,n){return void 0===n&&(n=-1),Jr(e,t,n)}function Jr(e,t,n,r,i){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var o=typeof e;if("function"!==o&&"object"!==o&&"object"!=typeof t)return!1;var a=$r.call(e);if(a!==$r.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return"undefined"!=typeof Symbol&&Symbol.valueOf.call(e)===Symbol.valueOf.call(t);case"[object Map]":case"[object Set]":n>=0&&n++}e=Qr(e),t=Qr(t);var s="[object Array]"===a;if(!s){if("object"!=typeof e||"object"!=typeof t)return!1;var u=e.constructor,c=t.constructor;if(u!==c&&!(y(u)&&u instanceof u&&y(c)&&c instanceof c)&&"constructor"in e&&"constructor"in t)return!1}if(0===n)return!1;n<0&&(n=-1),i=i||[];for(var l=(r=r||[]).length;l--;)if(r[l]===e)return i[l]===t;if(r.push(e),i.push(t),s){if((l=e.length)!==t.length)return!1;for(;l--;)if(!Jr(e[l],t[l],n-1,r,i))return!1}else{var d,f=Object.keys(e);if(l=f.length,Object.keys(t).length!==l)return!1;for(;l--;)if(!P(t,d=f[l])||!Jr(e[d],t[d],n-1,r,i))return!1}return r.pop(),i.pop(),!0}function Qr(e){return pr(e)?e.slice():C(e)||Sr(e)||E(e)||Or(e)?Array.from(e.entries()):e}function Yr(e){return e[Symbol.iterator]=Xr,e}function Xr(){return this}["Symbol","Map","Set"].forEach((function(e){void 0===o()[e]&&r("MobX requires global '"+e+"' to be available or polyfilled")})),"object"==typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:jt,extras:{getDebugName:Hr},$mobx:W})}.call(this,n(69))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(14),i=n(148),o=Object(i.a)(r.b)},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.AppId="appId",e.EnableCopilotInsert="enableCopilotInsert",e.EnableCopilotRewrite="enableCopilotRewrite",e.EnableSpelling="enableSpelling",e.EnableGrammar="enableGrammar",e.EnableRefinements="enableRefinements",e.EnableSynonymsToggle="enableSynonymsToggle",e.Descriptors="descriptors",e.ProofingLanguages="proofingLanguages",e.DefaultProofingLanguageInitialized="defaultProofingLanguageInitialized",e.ProofingLanguageListInitialized="proofingLanguageListInitialized",e.HashedUserDictionary="hashedUserDictionary",e.EnableEditor="enableEditor",e.OverriddenCritiqueTypeOptions="overriddenCritiqueTypeOptions",e.OverriddenInlineEditingSettings="overriddenInlineEditingSettings",e.PaneOverriddenCritiqueTypeOptions="paneOverriddenCritiqueTypeOptions",e.StealthOverriddenCritiqueTypeOptions="stealthOverriddenCritiqueTypeOptions",e.ShowSynonyms="showSynonyms",e.DefaultLoggingLevel="defaultLoggingLevel",e.DebugMode="debugMode",e.EnableTelemetry="enableTelemetry",e.ConfigurationId="configurationId",e.ClientId="clientId",e.CritiqueValuePerLanguage="critiqueValuePerLanguage",e.EnableTextPrediction="enableTextPrediction",e.EnableCIQFlags="enableCIQFlags",e.EnableCIQMenu="enableCIQMenu",e.IsLanguageAutoDetectEnabled="isLanguageAutoDetectEnabled",e.TonalFREAccepted="tonalFREAccepted"}(r||(r={}))},function(e,t,n){"use strict";function r(e){return Symbol.for(e)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var r={};n.r(r),n.d(r,"extractTextContent",(function(){return o})),n.d(r,"getMinimalDifferenceBounds",(function(){return a})),n.d(r,"trimDifferenceBounds",(function(){return s})),n.d(r,"getDifferenceBounds",(function(){return u})),n.d(r,"containsEmoji",(function(){return d})),n.d(r,"containsLanguageCharactersThatDoNotUseSpacesToDelimitWords",(function(){return f})),n.d(r,"isWhitespace",(function(){return h})),n.d(r,"isSpace",(function(){return p})),n.d(r,"isNewLine",(function(){return g})),n.d(r,"isLowSurrogateCharAt",(function(){return m})),n.d(r,"isHighSurrogateCharAt",(function(){return y})),n.d(r,"isAlpha",(function(){return b})),n.d(r,"numbers",(function(){return v})),n.d(r,"isNumeric",(function(){return w})),n.d(r,"isAlphaNum",(function(){return S}));var i=n(487);function o(e,t){const n=new Map;let r,i=0,o=0;if(!t)return e.textContent&&n.set(i,e.textContent),n;const a=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:e=>(o+=e.length,t&&e.parentElement&&e.parentElement.closest(t)?(r&&(n.set(i,r),r=void 0),i=o,NodeFilter.FILTER_REJECT):e.length?(r||(r=""),r+=e.nodeValue,NodeFilter.FILTER_ACCEPT):NodeFilter.FILTER_REJECT)});for(;a.nextNode(););return r&&n.set(i,r),n}function a(e,t){let n,r,i={firstDiffLeft:0,firstDiffRight:t.length};e.length<t.length?(n=e,r=t):(n=t,r=e),n=n.replace(""," "),r=r.replace(""," "),r.startsWith(n)?(i.firstDiffLeft=n.length,i.firstDiffRight=0):r.endsWith(n)?(i.firstDiffLeft=0,i.firstDiffRight=n.length):(i=u(e,t),i.firstDiffLeft+i.firstDiffRight>n.length&&(i.firstDiffRight=n.length-i.firstDiffLeft)),s(i,e,t);i.firstDiffLeft<e.length&&m(e,i.firstDiffLeft)||i.firstDiffLeft<t.length&&m(t,i.firstDiffLeft),i.firstDiffRight>0&&(i.firstDiffRight<e.length&&m(e,e.length-i.firstDiffRight)||i.firstDiffRight<t.length&&m(t,t.length-i.firstDiffRight));return i}function s(e,t,n){if(e.firstDiffLeft>0){const r=e.firstDiffLeft<t.length&&m(t,e.firstDiffLeft),i=e.firstDiffLeft<n.length&&m(n,e.firstDiffLeft);(r||i)&&(e.firstDiffLeft-=1)}if(e.firstDiffRight<=1)return;const r=e.firstDiffRight<t.length&&m(t,t.length-e.firstDiffRight),i=e.firstDiffRight<n.length&&m(n,n.length-e.firstDiffRight);(r||i)&&(e.firstDiffRight-=1)}function u(e,t){const n={firstDiffLeft:0,firstDiffRight:t.length};return n.firstDiffLeft=c(e,t,!0),n.firstDiffRight=c(e,t,!1),n}function c(e,t,n){let r;for(r=0;r<e.length&&r<t.length;r+=1){const i=e.charCodeAt(n?r:e.length-r-1),o=t.charCodeAt(n?r:t.length-r-1);if(i!==o&&!(h(i,!0)&&h(o,!0)||g(i)&&g(o)))break}return r}let l;function d(e){try{return l||(l=new RegExp("[\\p{Extended_Pictographic}\\u{1F3FB}-\\u{1F3FF}\\u{1F9B0}-\\u{1F9B3}]","u")),l.test(e)}catch(e){return!1}}function f(e){return!!e&&/[\u0E81-\u0EDF\u0f00-\u0FFF\u1000-\u109F\u1780-\u17F9\u1980-\u19DF\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\u0E00-\u0E7F\uff66-\uff9f]/g.test(e)}function h(e,t=!1){if(g(e))return!t;if(p(e))return!0;switch(e){case 11:case 9:return!0}return!1}function p(e){switch(e){case 12288:case 8194:case 8195:case 8197:case 32:case 160:return!0}return!1}function g(e){switch(e){case 13:case 10:case 65532:return!0}return!1}function m(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343}function y(e,t){return e.charCodeAt(t)>=55296&&e.charCodeAt(t)<=56319}function b(e){const t=e.toString();return t.toLowerCase()!==t.toUpperCase()}const v="0123456789";function w(e){return v.includes(e)}function S(e){return b(e)||w(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(15),i=n(14);function o(){return function(e){if(Reflect.hasOwnMetadata(i.h,e))throw new Error(r.k);var t=Reflect.getMetadata(i.a,e)||[];return Reflect.defineMetadata(i.h,t,e),e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));var r={Request:"Request",Singleton:"Singleton",Transient:"Transient"},i={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},o={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"}},function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return s})),function(e){e[e.Remote=0]="Remote",e[e.System=1]="System",e[e.User=2]="User"}(r||(r={}));const i=(e,t)=>({name:e,storeEntryType:r.Remote,defaultValue:t,lastValueFromStorage:void 0}),o=(e,t,n)=>({name:e,storeEntryType:r.User,defaultValue:t,lastValueFromStorage:void 0,shouldNotWriteDefaultValue:n}),a=(e,t)=>({name:e,storeEntryType:r.System,defaultValue:t,lastValueFromStorage:void 0});var s;!function(e){e.FeatureFlags="featureFlags",e.DynamicSettings="dynamicSettings"}(s||(s={}))},function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"m",(function(){return o})),n.d(t,"g",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"k",(function(){return c})),n.d(t,"l",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"i",(function(){return h})),n.d(t,"j",(function(){return p})),n.d(t,"f",(function(){return g}));var r="named",i="name",o="unmanaged",a="optional",s="inject",u="multi_inject",c="inversify:tagged",l="inversify:tagged_props",d="inversify:paramtypes",f="design:paramtypes",h="post_construct",p="pre_destroy";var g=[s,u,i,o,r,a]},function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"l",(function(){return i})),n.d(t,"x",(function(){return o})),n.d(t,"r",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"v",(function(){return c})),n.d(t,"t",(function(){return l})),n.d(t,"u",(function(){return d})),n.d(t,"C",(function(){return f})),n.d(t,"e",(function(){return h})),n.d(t,"m",(function(){return p})),n.d(t,"w",(function(){return g})),n.d(t,"p",(function(){return m})),n.d(t,"o",(function(){return y})),n.d(t,"s",(function(){return b})),n.d(t,"q",(function(){return v})),n.d(t,"n",(function(){return w})),n.d(t,"b",(function(){return S})),n.d(t,"j",(function(){return _})),n.d(t,"h",(function(){return T})),n.d(t,"g",(function(){return O})),n.d(t,"i",(function(){return C})),n.d(t,"c",(function(){return E})),n.d(t,"z",(function(){return I})),n.d(t,"A",(function(){return k})),n.d(t,"y",(function(){return A})),n.d(t,"f",(function(){return P})),n.d(t,"B",(function(){return N}));var r="Cannot apply @injectable decorator multiple times.",i="Metadata key was used more than once in a parameter:",o="NULL argument",a="Key Not Found",s="Ambiguous match found for serviceIdentifier:",u="Could not unbind serviceIdentifier:",c="No matching bindings found for serviceIdentifier:",l="Missing required @injectable annotation in:",d="Missing required @inject or @multiInject annotation in:",f=function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},h="Circular dependency found:",p="Invalid binding type:",g="No snapshot available to restore.",m="Invalid return type in middleware. Middleware must return!",y="Value provided to function binding must be a function!",b=function(e){return"You are attempting to construct '"+e+"' in a synchronous way\n but it has asynchronous dependencies."},v="The toSelf function can only be applied when a constructor is used as service identifier",w="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",S=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},_="Invalid Container constructor argument. Container options must be an object.",T="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",O="Invalid Container option. Auto bind injectable must be a boolean",C="Invalid Container option. Skip base check must be a boolean",E="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)",I=function(e,t){return"@postConstruct error in class "+e+": "+t},k=function(e,t){return"@preDestroy error in class "+e+": "+t},A=function(e,t){return"onDeactivation() error in class "+e+": "+t},P=function(e,t){return"It looks like there is a circular dependency in one of the '"+e+"' bindings. Please investigate bindings withservice identifier '"+t+"'."},N="Maximum call stack size exceeded"},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.CleanupContentScriptOnExtensionDisable="cleanupContentScriptOnExtensionDisable",e.InjectContentScriptsOnExtensionLoad="injectContentScriptsOnExtensionLoad",e.EnableTeachingUiOnPageBoot="enableTeachingUiOnPageBoot",e.IsTeachingUiDismissed="isTeachingUiDismissed",e.EditorClientState="editorClientState",e.EditorClientInitState="editorClientInitState",e.EditorPriorityShutdown="editorPriorityShutdown",e.WebsitesWithNativeIntegration="websitesWithNativeIntegration",e.ConflictDetected="conflictDetected",e.ConflictDetectionAnnouncementDismissed="conflictDetectionAnnouncementDismissed",e.FirstInstallVersion="firstInstallVersion",e.DisabledWebSites="disabledWebSites",e.DisabledGrammars="disabledGrammars",e.ConflictingElements="conflictingElements",e.EvaluationData="evaluationData",e.EnableUninstallSurvey="enableUninstallSurvey"}(r||(r={}))},,function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"j",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"k",(function(){return a})),n.d(t,"i",(function(){return s})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return p}));var r="function",i="object",o="undefined",a="prototype",s="hasOwnProperty",u="default",c=Object,l=c[a],d=c.assign,f=c.create,h=c.defineProperty,p=l[s]},,,function(e,t,n){"use strict";function r(e,t,n){return a(e,1,t,n)}function i(e,t,n){return a(e,2,t,n)}function o(e,t,n){return a(e,0,t,n)}function a(e,t,n,r){return{name:e,dataType:t,value:n,classification:r||4}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}))},,,,,function(e,t,n){"use strict";var r,i,o,a,s,u;n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return u})),function(e){e.O365="o365UserService",e.MSA="msaUserService",e.NONE="noneUserService"}(r||(r={})),function(e){e[e.MSA=0]="MSA",e[e.AAD=1]="AAD"}(i||(i={})),function(e){e.AAD="aad",e.MSA="msa",e.NONE="none"}(o||(o={})),function(e){e.GCC="GCC",e.Worldwide="WW"}(a||(a={})),function(e){e.NoLicense="NoLicense",e.Perpetual="Perpetual",e.Subscription="Subscription",e.SubscriptionPreview="SubscriptionPreview"}(s||(s={})),function(e){e[e.Unknown=0]="Unknown",e[e.MinorWithoutParentalConsent=1]="MinorWithoutParentalConsent",e[e.MinorWithParentalConsent=2]="MinorWithParentalConsent",e[e.Adult=3]="Adult",e[e.NotAdult=4]="NotAdult",e[e.MinorNoParentalConsentRequired=5]="MinorNoParentalConsentRequired"}(u||(u={}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"}}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r}));var r,i=n(9),o=Object(i.a)("IContentScriptEmitter");!function(e){e.seenEventTriggered="seenEventTriggered",e.counterpartyDisconnected="counterpartyDisconnected",e.loadLanguages="loadLanguages",e.languagesLoaded="languagesLoaded",e.openOptionsPage="openOptionsPage",e.getClientState="getClientState",e.clientState="clientState",e.sessionContextRequest="sessionContextRequest",e.sessionContextResponse="sessionContextResponse",e.userInfoRequest="userInfoRequest",e.userInfoResponse="userInfoResponse",e.uninstallParametersChangedEvent="uninstallParametersChangedEvent",e.authorization="authorization",e.initReactApp="initReactApp",e.suggestionAccepted="suggestionAccepted",e.showGenericRatingPrompt="showGenericRatingPrompt",e.showFpsSurveyPrompt="showFpsSurveyPrompt",e.roamingDictionaryBackgroundUpdate="roamingDictionaryBackgroundUpdate",e.roamingDictionaryContentUpdate="roamingDictionaryContentUpdate",e.showFeedbackDialog="showFeedbackDialog",e.enableBetaExperience="enableBetaExperience"}(r||(r={}))},,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(9);const i=Object(r.a)("IHostEmitter"),o=Object(r.a)("IHostEmitterArray");var a;!function(e){e.tileCheckRequestV1="tileCheckRequestV1",e.configV2RequestEvent="configV2RequestEvent",e.hostModelTileStateReset="hostModelTileStateReset",e.hostModelVisualStateChange="hostModelTileVisualStateChange",e.hostModelDelta="hostModelDelta",e.hostModelFormattingDelta="hostModelFormattingDelta",e.hostModelTextTile="hostModelTextTile",e.hostModelParagraphTextTiles="hostModelParagraphTextTiles",e.hostModelMoveTextTile="hostModelMoveTextTile",e.hostModelRehydrateTiles="hostModelRehydrateTiles",e.hostModelRehydrateTilesFinished="hostModelRehydrateTilesFinished",e.hostModelAddedRootNode="hostModelAddedRootNode",e.hostModelRemovedRootNode="hostModelRemovedRootNode",e.hostModelCritiques="hostModelCritiques",e.hostModelCritiqueAction="hostModelCritiqueAction",e.hostModelFlags="hostModelFlags",e.hostModelTextTileEmittedToAugloop="hostModelTextTileEmittedToAugloop",e.oaRankedAnnotations="oaRankedAnnotations",e.oaAnnotationsTriggered="oaAnnotationsTriggered",e.oaFlagAnnotationsTriggered="oaFlagAnnotationsTriggered",e.oaMenuControlSignal="oaMenuControlSignal",e.predictionTriggered="predictionTriggered",e.nudgeTriggered="nudgeTriggered",e.nudgeAccepted="nudgeAccepted",e.headingDetectionRecognized="headingDetectionRecognized",e.instrumentationRequestV1="instrumentationRequestV1",e.tileCheckResponseV1="tileCheckResponseV1",e.configV2ResponseEvent="configV2ResponseEvent",e.clearTileCritiques="clearTileCritiques",e.clearCritiquesForNode="clearCritiquesForNode",e.restoreNodeForCritiqueStore="restoreNodeForCritiqueStore",e.telemetryEvent="telemetryEvent",e.newActivityTelemetryEvent="newActivityTelemetryEvent",e.activitySetSuccessTelemetryEvent="activitySetSuccessTelemetryEvent",e.activitySetResultTelemetryEvent="activitySetResultTelemetryEvent",e.activityAddDataFieldTelemetryEvent="activityAddDataFieldTelemetryEvent",e.activityEndNowTelemetryEvent="activityEndNowTelemetryEvent",e.saveCritiqueSettings="saveCritiqueSettings",e.critiqueSettingsChange="critiqueSettingsChange",e.ciqSettingsChange="ciqSettingsChange",e.critiqueValuePerLanguageChanged="critiqueValuePerLanguageChanged",e.saveInlineEditingSettings="saveInlineEditingSettings",e.autoCorrectLanguagesUpdated="autoCorrectLanguagesUpdated",e.addWordToDictionaryLocally="addWordToDictionaryLocally",e.setRoamingDictionaryState="setRoamingDictionaryState",e.enableRoamingDictionary="enableRoamingDictionary",e.updateCurrentSessionDictionary="updateCurrentSessionDictionary",e.setAugLoopState="setAugLoopState",e.getAugLoopState="getAugLoopState",e.squiggleClick="squiggleClick",e.taskRecognitionSignal="taskRecognitionSignal",e.toneDetection="toneDetection",e.autoCorrectionTriggered="autoCorrectionTriggered",e.writeProofingLanguage="writeProofingLanguage",e.readProofingLanguage="readProofingLanguage",e.readProofingUserDictionary="readProofingUserDictionary",e.readRoamingProofingOverriddenOptions="readRoamingProofingOverriddenOptions",e.copywriterRequestSuggestions="copywriterRequestSuggestions",e.copywriterSuggestionsReady="copywriterSuggestionsReady",e.seenEventTriggered="seenEventTriggered",e.addWordsToRoamingUserDictionary="addWordsToRoamingUserDictionary",e.requestSynonyms="requestSynonyms",e.receivedSynonyms="receivedSynonyms",e.writeProofingSettingsToRoaming="writeProofingSettingsToRoaming",e.readOASettings="readOASettings",e.writeOASettings="writeOASettings",e.conditionalOrchestratorSettingsChanged="conditionalOrchestratorSettingsChanged",e.aiInsertRequestSuggestions="aiInsertRequestSuggestions",e.aiInsertSuggestionsReady="aiInsertSuggestionsReady",e.logout="logout",e.textAugmentationCoreResponse="textAugmentationCoreResponse",e.textAugmentationCoreRemovalResponse="textAugmentationCoreRemovalResponse",e.textAugmentationCoreRequest="textAugmentationCoreRequest"}(a||(a={}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.PostUpsellAnnouncementVisible="postUpsellAnnouncementVisible",e.PostUpsellAnnouncementDismissed="postUpsellAnnouncementDismissed",e.PostUpsellAnnouncementHadSubscription="postUpsellAnnouncementHadSubscription",e.MultiLanguageAnnouncementVisible="multiLanguageAnnouncementVisible",e.MultiLanguageAnnouncementDismissed="multiLanguageAnnouncementDismissed",e.SignInAnnouncementVisible="SignInAnnouncementVisible",e.SignInAnnouncementDismissed="SignInAnnouncementDismissed",e.RoamingDictionaryLoggedInAnnouncementVisible="RoamingDictionaryLoggedInAnnouncementVisible",e.RoamingDictionaryLoggedOutAnnouncementVisible="RoamingDictionaryLoggedOutAnnouncementVisible",e.RoamingDictionaryLoggedInAnnouncementDismissed="RoamingDictionaryLoggedInAnnouncementDismissed",e.RoamingDictionaryLoggedOutAnnouncementDismissed="RoamingDictionaryLoggedOutAnnouncementDismissed",e.EligibleForRoamingDictionaryAnnouncement="EligibleForRoamingDictionaryAnnouncement",e.GDocsNativeSquigglesAnnouncementVisible="GDocsNativeSquigglesAnnouncementVisible",e.GDocsNativeSquigglesAnnouncementDismissed="GDocsNativeSquigglesAnnouncementDismissed"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c}));var r=n(2),i=n(207),o=n(11),a=n(9);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=Object(a.a)("WebsiteConfiguration");var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"isWebsiteActive",value:function(){return this.websiteUrlRegexes().some((function(e){return Object(i.a)(window.location.href,e)}))}},{key:"websiteUrlRegexes",value:function(){return[]}},{key:"regexForDomain",value:function(e){return"^(http|https):\\/\\/([a-zA-Z0-9_.-]*\\.)?".concat(e.replace(".","\\."))}}],(n=[{key:"nonProveableElements",value:function(){return[]}}])&&s(t.prototype,n),r&&s(t,r),e}();c=Object(r.c)([Object(o.a)(),function(e){return e}],c)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e){r.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]}static getAllTypesFor(e){const t=r.getTypeNameFor(e);return t?[t,...r.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const n=r.getTypeNameFor(e),i=r.getBaseTypesFor(e);for(const e of t){if(e===n)return!0;if(i.indexOf(e)>=0)return!0}return!1}static assign(e,t,n){if(n)for(const e of Object.keys(n))t[e]=n[e];return t.H_=e.H_,t}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},function(e,t,n){"use strict";var r,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e.ExtensionInstalled="ExtensionInstalled",e.BackgroundScriptInitialization="BackgroundScriptInitialization",e.ClientStateChanged="ClientStateChanged",e.ContentScriptCleanup="ContentScriptCleanup",e.OptionsInitialization="OptionsInitialization",e.GoPremiumInitialization="GoPremiumInitialization",e.Diagnostics="Diagnostics",e.EditorCall="EditorCall",e.LanguageInfoCall="LanguageInfoCall",e.ActionEnableEditorChangedFromOptions="ActionEnableEditorChangedFromOptions",e.ActionEnableEditorChangedFromAnnouncementPane="ActionEnableEditorChangedFromAnnouncementPane",e.ActionShowSynonymsChangedFromOptions="ActionShowSynonymsChangedFromOptions",e.ActionCheckSpellingChangedFromOptions="ActionCheckSpellingChangedFromOptions",e.ActionCheckGrammarChangedFromOptions="ActionCheckGrammarChangedFromOptions",e.ActionCheckRefinementsChangedFromOptions="ActionCheckRefinementsChangedFromOptions",e.ActionSynonymsToggleChangedFromOptions="ActionSynonymsToggleChangedFromOptions",e.ActionAddedBlockedWebsiteFromOptions="ActionAddedBlockedWebsiteFromOptions",e.ActionPrivacyOptionTelemetryEnabledChangedFromOptions="ActionPrivacyOptionTelemetryEnabledChangedFromOptions",e.ActionProofingLanguageChangedFromOptions="ActionProofingLanguageChangedFromOptions",e.AnnouncementShown="AnnouncementShown",e.AnnouncementDismissed="AnnouncementDismissed",e.AnnouncementClickedThrough="AnnouncementClickedThrough",e.ExtensionUsageInfo="ExtensionUsageInfo",e.GeneralOcvFeedbackDialog="GeneralOcvFeedbackDialog",e.WordAddedToRoamingDictionary="WordAddedToRoamingDictionary",e.RoamingSettingsLoaded="RoamingSettingsLoaded",e.RoamingCrossPromoSettingSaved="RoamingCrossPromoSettingSaved",e.AnchorElementClass="AnchorElementClass",e.SettingsOpenedFromPopup="SettingsOpenedFromPopup",e.ClickOnSignInLinkFromPopup="ClickOnSignInLinkFromPopup",e.ClickOnDisableLinkFromPopup="ClickOnDisableLinkFromPopup",e.ClickOnEnableLinkFromPopup="ClickOnEnableLinkFromPopup",e.ClickOnTurnOnEditorFromPopup="ClickOnTurnOnEditorFromPopup",e.ClickOnUpsellLinkFromPopup="ClickOnUpsellLinkFromPopup",e.ClickOnSignOutFromPopup="ClickOnSignOutFromPopup"}(r||(r={})),function(e){e.BackgroundScriptInitializationError="RunTimeErrors.BackgroundScriptInitializationError",e.ContentScriptInjectionError="RunTimeErrors.ContentScriptInjectionError",e.GetMinimalDifferenceBoundsError="RunTimeErrors.GetMinimalDifferenceBoundsError",e.SelectionApiException="RunTimeErrors.SelectionApiException",e.SettingInvalidDescriptorJson="RunTimeErrors.SettingInvalidDescriptorJson",e.SettingReadOverrideError="RunTimeErrors.SettingReadOverrideError",e.SettingManualOverrideWarning="RunTimeErrors.SettingManualOverrideWarning",e.SettingReadingException="RunTimeErrors.SettingReadingException",e.FlightingJsonDescriptorInvalid="RunTimeErrors.FlightingJsonDescriptorInvalid",e.HostInfoInvalid="RunTimeErrors.HostInfoInvalid",e.UnhandledContentError="RunTimeErrors.UnhandledContentError",e.UnhandledBackgroundError="RunTimeErrors.UnhandledBackgroundError",e.UnhandledOptionsPageError="RunTimeErrors.UnhandledOptionsPageError",e.UnhandledPopupError="RunTimeErrors.UnhandledPopupError",e.RoamingDictionarySaveError="RunTimeErrors.RoamingDictionarySaveError",e.RoamingDictionaryInitError="RunTimeErrors.RoamingDictionaryInitError",e.RoamingServiceLoadError="RunTimeErrors.RoamingServiceLoadError",e.RoamingCrossPromoSaveError="RunTimeErrors.RoamingCrossPromoSaveError"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return u}));var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function a(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function u(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e.MSA="msa",e.O365="aad",e.NONE="none"}(r||(r={}));var i={ACTIVITY:{AUTHENTICATION:{NAME:"authentication"},AUTHORIZATION:{NAME:"authorization"},TELEMETRY:{NAME:"telemetry"},USERINFO_AVAILABLE:{NAME:"userInfoAvailable"},LOGOUT:{NAME:"logout"},REQUEST_TOKEN:{NAME:"requestToken"}},APPINFO_NAME:"EditorExtension",APP_ID:"EditorBX_Online",LINKS:{PROGRESSPAGE_URL:"https://onedrive.live.com",POST_INSTALL_CHROME_URL:"https://aka.ms/editorbxchromeinstall",POST_INSTALL_EDGE_URL:"https://aka.ms/editorbxedgeinstall",POST_INSTALL_CHROME_AUTO_URL:"https://aka.ms/editorbxchromeinstallauto",POST_INSTALL_EDGE_AUTO_URL:"https://aka.ms/editorbxedgeinstallauto",POST_INSTALL_URL:"https://aka.ms/editorbxhelp",LOGIN_SUPPORT_URL:"https://aka.ms/editorbxloginhelp",MYACCOUNT_MSA_URL:"https://account.microsoft.com/profile",MYACCOUNT_O365_URL:"https://portal.office.com/Account",EDITOR_GO_PREMIUM_URL:"https://aka.ms/editorupsell/sbx/control/popup",FLIGHT_INFO_URL:"https://nleditor.osi.office.net/NLEditor/api/V1/BrowserExtension"},O365CONFIG:{PHOTO_URL:"https://graph.microsoft.com/v1.0/me/photo/$value",AUGLOOP_URL:"https://augloop.office.com/v2",ROAMING_URL:"https://api.office.net/.default",LICENSE_ENDPOINT:"https://webshell.suite.office.com/api/shell/NewTab?culture=en-US"},MSACONFIG:{ROAMING_SCOPE:"service::officeapps.live.com::MBI_SSL",ROAMING_URL:"https://officeapps.live.com",PHOTO_URL:"https://graph.microsoft.com/beta/me/photo/$value",LICENSE_ENDPOINT:"https://consumer.suite.office.com/api/licensing/licensingdata"},TELEMETRY:{COMMAND:{TRACK_TRACE:"trackTrace",TRACK_EVENT:"trackEvent"},FETCHLICENSINGINFO_REASON:{AMC:"amc",RENEW:"renew",LOGIN:"login"}},USER_SERVICE_TYPE:{MSID:"msidUserService",NONE:"noneUserService"},BROWSER_ICON:{DEFAULT:"./assets/icon_20.png",INACTIVE:"./assets/icon_inactive_20.png",BETA:"./assets/icon_beta_20.png"},LICENSE_TYPE:{SUBSCRIPTION:"Subscription",PERPETUAL:"Perpetual",NO_LICENSE:"NoLicense",UNKNOWN:"Unknown"}}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r,i=n(9);!function(e){e.StorageUserInfoV2Strategy="StorageUserInfoV2Strategy",e.None="None"}(r||(r={}));const o=Object(i.a)("IUserInfoStrategy")},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return l}));var r=n(15);function i(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function o(e,t,n){var r="",i=n(e,t);return 0!==i.length&&(r="\nRegistered bindings:",i.forEach((function(e){var t="Object";null!==e.implementationType&&(t=c(e.implementationType)),r=r+"\n "+t,e.constraint.metaData&&(r=r+" - "+e.constraint.metaData)}))),r}function a(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||a(e.parentRequest,t))}function s(e){e.childRequests.forEach((function(e){if(a(e,e.serviceIdentifier)){var t=function(e){var t=function e(t,n){void 0===n&&(n=[]);var r=i(t.serviceIdentifier);return n.push(r),null!==t.parentRequest?e(t.parentRequest,n):n}(e);return t.reverse().join(" --\x3e ")}(e);throw new Error(r.e+" "+t)}s(e)}))}function u(e,t){if(t.isTagged()||t.isNamed()){var n="",r=t.getNamedTag(),i=t.getCustomTags();return null!==r&&(n+=r.toString()+"\n"),null!==i&&i.forEach((function(e){n+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+n}return" "+e}function c(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}function l(e){return e.toString().slice(7,-1)}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(14),i=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===r.d?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},e}()},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"g",(function(){return c}));const r=1,i="https://aka.ms/editorservice/critiqueguidance",o=["ar","cs","da","de","en","es","fi","fr","he","hu","it","ko","nb","nl","pl","pt-BR","pt-PT","ru","se","tr","zh-s","zh-t"];var a,s,u;!function(e){e[e.mixed=-1]="mixed",e[e.off=0]="off",e[e.on=1]="on"}(a||(a={})),function(e){e[e.Spelling=0]="Spelling",e[e.Grammar=1]="Grammar",e[e.Refinement=2]="Refinement"}(s||(s={})),function(e){e.CategoryCollapse="CategoryCollapsedAriaDescription",e.CategoryCollapseDisabled="CategoryCollapsedDisabledAriaDescription",e.CategoryExpanded="CategoryExpandedAriaDescription",e.CategoryExpandedDisabled="CategoryExpandedDisabledAriaDescription",e.CategoryOff="CategoryOff",e.EmptyCategory="EmptyCategoryAriaDescription",e.EditorPaneSetting="EditorPaneSettingAriaDescription",e.MultilingualSpelling="MultilingualSpellingAriaDescription",e.TextPredictions="TextPredictionsAriaDescription",e.LinkSuggestions="LinkSuggestionsAriaDescription",e.CIQMenu="CIQMenuAriaDescription",e.ProofingPreferences="ProofingPreferencesAriaDescription"}(u||(u={}));const c={af:1,"af-ZA":1,ar:1,"ar-AE":5,"ar-BH":5,"ar-DZ":5,"ar-EG":5,"ar-IQ":5,"ar-JO":5,"ar-KW":5,"ar-LB":5,"ar-LY":5,"ar-MA":5,"ar-OM":5,"ar-QA":5,"ar-SA":5,"ar-SY":5,"ar-TN":5,"ar-YE":5,as:1,"az-Latn-AZ":1,"as-IN":1,bg:1,"bg-BG":1,bn:1,"bn-BD":1,"bn-IN":1,"bs-Latn-BA":1,ca:1,"ca-ES":1,"ca-ES-valencia":1,cs:1,"cs-CZ":5,cy:1,"cy-GB":1,da:1,"da-DK":5,de:3,"de-AT":7,"de-CH":7,"de-DE":7,"de-LI":7,"de-LU":7,el:1,"el-GR":1,en:3,"en-029":7,"en-AU":7,"en-BZ":7,"en-CA":7,"en-GB":7,"en-HK":7,"en-IE":7,"en-IN":7,"en-JM":7,"en-MY":7,"en-NZ":7,"en-PH":7,"en-SG":7,"en-TT":7,"en-US":7,"en-ZA":7,"en-ZW":7,es:3,"es-419":7,"es-AR":7,"es-BO":7,"es-CL":7,"es-CO":7,"es-CR":7,"es-DO":7,"es-EC":7,"es-ES":7,"es-ES_tradnl":7,"es-GT":7,"es-HN":7,"es-MX":7,"es-NI":7,"es-PA":7,"es-PE":7,"es-PR":7,"es-PY":7,"es-SV":7,"es-US":7,"es-UY":7,"es-VE":7,et:1,"et-EE":1,eu:1,"eu-ES":1,fa:1,"fa-IR":1,fi:1,"fi-FI":5,fr:3,"fr-BE":7,"fr-CA":7,"fr-CD":7,"fr-CH":7,"fr-CI":7,"fr-CM":7,"fr-FR":7,"fr-HT":7,"fr-LU":7,"fr-MA":7,"fr-MC":7,"fr-ML":7,"fr-RE":7,"fr-SN":7,ga:1,"ga-IE":1,gd:1,"gd-GB":1,gl:1,"gl-ES":1,gu:1,"gu-IN":1,ha:1,"ha-Latn-NG":1,he:1,"he-IL":5,hi:1,"hi-IN":1,hr:1,"hr-BA":1,"hr-HR":1,hu:1,"hu-HU":5,hy:1,"hy-AM":1,id:1,"id-ID":1,ig:1,"ig-NG":1,is:1,"is-IS":1,it:3,"it-CH":7,"it-IT":7,ka:1,"ka-GE":1,kk:1,"kk-KZ":1,kn:1,"kn-IN":1,ko:1,"ko-KR":5,kok:1,"kok-IN":1,ky:1,"ky-KG":1,lb:1,"lb-LU":1,lt:1,"lt-LT":1,lv:1,"lv-LV":1,mi:1,"mi-NZ":1,mk:1,"mk-MK":1,ml:1,"ml-IN":1,mr:1,"mr-IN":1,ms:1,"ms-BN":1,"ms-MY":1,mt:1,"mt-MT":1,"nb-NO":7,ne:1,"ne-IN":1,"ne-NP":1,nl:1,"nl-BE":5,"nl-NL":5,"nn-NO":1,nso:1,"nso-ZA":1,or:1,"or-IN":1,pa:1,"pa-IN":1,pl:1,"pl-PL":5,ps:1,"ps-AF":1,"pt-BR":7,"pt-PT":5,rm:1,"rm-CH":1,ro:1,"ro-MD":1,"ro-RO":1,ru:1,"ru-MD":1,"ru-RU":5,rw:1,"rw-RW":1,si:1,"si-LK":1,sk:1,"sk-SK":1,sl:1,"sl-SI":1,sq:1,"sq-AL":1,"sr-Cyrl-BA":1,"sr-Cyrl-CS":1,"sr-Cyrl-ME":1,"sr-Cyrl-RS":1,"sr-Latn-BA":1,"sr-Latn-CS":1,"sr-Latn-ME":1,"sr-Latn-RS":1,sv:1,"sv-FI":5,"sv-SE":5,sw:1,"sw-KE":1,ta:1,"ta-IN":1,te:1,"te-IN":1,th:1,"th-TH":1,tn:1,"tn-BW":1,"tn-ZA":1,tr:1,"tr-TR":5,tt:1,"tt-RU":1,uk:1,"uk-UA":1,ur:1,"ur-IN":1,"ur-PK":1,uz:1,"uz-Latn-UZ":1,vi:1,"vi-VN":1,wo:1,"wo-SN":1,xh:1,"xh-ZA":1,yo:1,"yo-NG":1,zu:1,"zu-ZA":1,"en-ID":6,"en-CB":4,"ja-JP":4,"zh-CN":4,"zh-TW":4}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),i=n(11);let o=class{constructor(e){this._userInfoStrategy=e}check(){return this._userInfoStrategy.execute(!1,(e=>(this.setUserInfo(e),e))),this.checkUserInfo()}setUserInfo(e){e&&(this.licenseType=e.licenseType,this.identityProvider=e.identityProvider,this.ageGroup=e.ageGroup,this.ctry=e.ctry),this.isLoggedIn=!!e}};o=Object(r.c)([Object(i.a)()],o)},function(e,t,n){"use strict";var r,i,o;n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),function(e){e[e.Add=0]="Add",e[e.Delete=1]="Delete",e[e.Update=2]="Update",e[e.CursorUpdate=3]="CursorUpdate",e[e.FormattingUpdate=4]="FormattingUpdate",e[e.OtherNonContentUpdate=5]="OtherNonContentUpdate"}(r||(r={})),function(e){e[e.Chars=0]="Chars",e[e.Word=1]="Word",e[e.PartialSentence=2]="PartialSentence",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(i||(i={})),function(e){e[e.SessionUser=0]="SessionUser",e[e.Programmatic=1]="Programmatic",e[e.Collaborator=2]="Collaborator"}(o||(o={}))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return h})),n.d(t,"f",(function(){return p})),n.d(t,"i",(function(){return g})),n.d(t,"j",(function(){return m}));const r="[\0-\b\n--\u2028-\u2029]",i="[!-#%-*,-/:-;?-@_{}--------------------------------]",o="[----]",a="[?!.]",s="[]",u="[ -\t]",c="[\"']",l="[)]}]|[]|[]",d="[\u2028\u2029\n\r]",f=`[.]{2,6}|[.]([ ][.]){1,5}|([--])[.]|${`${`(${u}|${r}|${i}|${o})`}((((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]|((([]?[]{1,3}|[][]|[])?([]?[]{1,3}|[][]|[]))|([]?[]{1,3}|[][]|[])|(([]?[]{1,3}|[][]|[])?([]?[]{1,3}|[][]|[]))|([]?[]{1,3}|[][]|[]))[.]|([0-9]{1,4}[.]|[-]{1,4}[.])|([0-9]+(([ao])|((er)[ao]?)|(([][])[]?)|([mdtvn][ao])|([][]))[.]|[A-Za-z]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z]+((STR)|(str))[.]))`}|${`${`(${u}|${r}|${i}|[$+<=>^\`|~------------]|${o}|[0-9-------------------]|[-------])`}((([A-Za-z--------------]|[------------------------------------------------------------------------------------------------]|[--])[.])+|(([------])[.])+)`}`,h=new RegExp(`${a}|${s}`,"ig"),p=new RegExp(`${a}|${s}|${d}`,"ig"),g=new RegExp(f,"g");function m(e,t,n=0){const r=[];let i=t.exec(e);for(;null!==i;){if(i[n]){const e=i.index;r.push({begin:e,end:e+i[n].length})}i=t.exec(e)}return r}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var r,i=n(9);!function(e){e[e.Extension=0]="Extension",e[e.OWA_New_Email=1]="OWA_New_Email",e[e.OWA_Draft_Email=2]="OWA_Draft_Email",e[e.EditorLandingPage=3]="EditorLandingPage"}(r||(r={}));const o=Object(i.a)("IHostSettings")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("ILogger")},,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Info=0]="Info",e[e.Warn=1]="Warn",e[e.Error=2]="Error",e[e.Debug=3]="Debug"}(r||(r={}))},,function(e,t,n){"use strict";var r,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e.RemoteSettingSync="RemoteSettingSync"}(r||(r={})),function(e){e.SettingsSyncWriteError="RunTimeErrors.SettingSyncWriteError",e.SettingsSyncEditorRequestBuildError="RunTimeErrors.SettingsSyncEditorRequestBuildError",e.SettingsSyncEditorServiceError="RunTimeErrors.SettingSyncEditorServiceError",e.SettingsSyncReadOverrideError="RunTimeErrors.SettingSyncReadOverrideError",e.SettingReadError="RunTimeErrors.SettingReadError",e.SettingInitializeError="RunTimeErrors.SettingInitializeError",e.SettingManualOverrideWarning="RunTimeErrors.SettingManualOverrideWarning",e.SettingWriteError="RunTimeErrors.SettingWriteError",e.FeatureFlagParsingError="RunTimeErrors.FeatureFlagParsingError",e.DynamicSettingsParsingError="RunTimeErrors.DynamicSettingsParsingError"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9),i=Object(r.a)("ISystemPersistedStore")},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),i=n(11),o=n(121);let a=class{constructor(){this._listenerId=0,this._callbacks=new Map,this.ignoreDisablers=!1,this.disablers=[],this.enablers=[]}triggerListeners(e){const t=this._callbacks.get(e.eventId);if(!t||0===t.length)return;let n=!0;return t.forEach((t=>{const[r,i]=t.callback(e);n=this.processCallBackResult(n,r,i)})),n}processCallBackResult(e,t,n){return t!==o.a.NoReaction?e&&t===o.a.EnableFeature:e}nextListenerId(){return this._listenerId+=1,this._listenerId}addListener(e,t){const n={callback:t,id:this.nextListenerId()};let r=this._callbacks.get(e);return r||(r=[],this._callbacks.set(e,r)),r.push(n),n.id}removeListener(e){e&&this._callbacks.forEach(((t,n,r)=>{if(t){if(-1!==t.findIndex((t=>t.id===e)))return void r.set(n,t.filter((t=>t.id!==e)))}}))}emitAndEvaluate(e){const t=this.triggerListeners(e);if(!this.ignoreDisablers)for(const e of this.disablers){if(!0===e)return!1;if(!1!==e&&e.check())return!1}let n=!1;for(const e of this.enablers)if(!0===e||!1!==e&&e.check()){n=!0;break}return void 0===t?n:n&&t}};a=Object(r.c)([Object(i.a)()],a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(27);function i(e,t,n,i){return{name:e,value:t,dataType:(null!=i?i:"boolean"==typeof t)?r.a.DataFieldType.Boolean.valueOf():"number"==typeof t?r.a.DataFieldType.Int64.valueOf():r.a.DataFieldType.String.valueOf(),classification:null!=n?n:r.a.DataClassification.EssentialServiceMetadata}}function o(...e){return e.map((([e,t,n,r])=>i(e,t,n,r)))}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r,i=n(9);!function(e){e.LocalStorageApi="LocalStorageApi"}(r||(r={}));const o=Object(i.a)("IBrowserStorageApi")},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return l}));var r="https://docs.google.com/document/",i=function(){return window.location.href.search("docs.google.com")>=0},o=function(){return null!==document.querySelector(".kix-page-content-wrapper")},a=function(){return null!==document.querySelector(".kix-canvas-tile-content")},s=function(){var e=document.querySelector(".kix-cursor-caret");if(null!==e)return e.getBoundingClientRect()},u=function(e){var t,n=document.querySelector(".kix-rotatingtilemanager-content");n&&n.querySelectorAll(".kix-canvas-tile-selection").forEach((function(n){var r,i;e&&(r=n.getBoundingClientRect(),i=e.getBoundingClientRect(),r.top<i.top&&r.left<i.left&&r.right>i.right&&r.bottom>i.bottom)&&(t=n)}));return t},c=function(){var e=document.querySelector("iframe.docs-texteventtarget-iframe");if(null!==e)return"iframe"===e.nodeName.toLowerCase()?e.contentDocument:e},l=function(e){return e.find((function(e){var t;return null!==(t=e.classList.contains("ms-Callout-main"))&&void 0!==t&&t}))}},,function(e,t,n){"use strict";(function(e){n.d(t,"i",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"d",(function(){return h}));var r=n(330);n(234),void 0!==e&&!!e.version&&!!e.versions&&e.versions.node;function i(e){var t={};return t.body=e.bodyAsText,t.headers=e.headers,t.status=e.status,t}function o(e){var t=e.clone();return t.headers&&t.headers.remove("authorization"),t}function a(e){return new RegExp("^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$","ig").test(e)}function s(){return Object(r.a)()}function u(e,t){return new Promise((function(n){return setTimeout((function(){return n(t)}),e)}))}function c(e,t){var n;return Array.isArray(e)||(e=[e]),(n={})[t]=e,n}var l=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function d(e){return l.test(e)}function f(e,t,n){return e&&t?e.split(t).join(n||""):e}function h(e){return"object"!=typeof e&&"function"!=typeof e||null===e}}).call(this,n(123))},,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9),i=Object(r.a)("IExtensionSettings")},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IFeatureFlagsReader")},,function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r,i=(r=[],{fireEvent:function(e){r.forEach((function(t){return t(e)}))},addListener:function(e){e&&r.push(e)}});function o(e,t,n){i.fireEvent({level:e,category:t,message:n})}function a(e,t,n){o(0,e,(function(){var e=n instanceof Error?n.message:"";return"".concat(t,": ").concat(e)}))}},,function(e,t,n){"use strict";var r,i,o,a;n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(r||(r={})),function(e){e[e.NotificationOnly=0]="NotificationOnly",e[e.Delete=1]="Delete",e[e.Ignore=2]="Ignore",e[e.IgnoreAll=4]="IgnoreAll",e[e.IgnoreCritiqueType=8]="IgnoreCritiqueType",e[e.AddToDictionary=16]="AddToDictionary",e[e.ShowDetails=32]="ShowDetails"}(i||(i={})),function(e){e[e.None=0]="None",e[e.ChangeOnce=1]="ChangeOnce",e[e.ChangeAll=2]="ChangeAll",e[e.AutoCorrect=4]="AutoCorrect",e[e.ReadAloud=8]="ReadAloud",e[e.PersonalizedAutoCorrect=16]="PersonalizedAutoCorrect"}(o||(o={})),function(e){e[e.None=0]="None",e[e.CAT_Spelling=1]="CAT_Spelling",e[e.CAT_Grammar=2]="CAT_Grammar",e[e.CAT_Clarity=3]="CAT_Clarity",e[e.CAT_Conciseness=4]="CAT_Conciseness",e[e.CAT_Formality=5]="CAT_Formality",e[e.CAT_Inclusiveness=6]="CAT_Inclusiveness",e[e.CAT_PunctuationConventions=7]="CAT_PunctuationConventions",e[e.CAT_Resume=8]="CAT_Resume",e[e.CAT_SensitiveGeopoliticalReferences=9]="CAT_SensitiveGeopoliticalReferences",e[e.CAT_Vocabulary=10]="CAT_Vocabulary",e[e.CAT_ConsistentWrittenForms=11]="CAT_ConsistentWrittenForms",e[e.CAT_ErrorCorrections=12]="CAT_ErrorCorrections",e[e.CAT_WritingConventions=13]="CAT_WritingConventions",e[e.CAT_Acronyms=14]="CAT_Acronyms",e[e.CAT_Perspectives=15]="CAT_Perspectives",e[e.CAT_UncommonWords=16]="CAT_UncommonWords",e[e.CAT_TypingErrors=17]="CAT_TypingErrors",e[e.CAT_Rewrite=18]="CAT_Rewrite"}(a||(a={}))},,function(e,t,n){"use strict";var r,i,o;function a(e){return e?Object.values(i).find((t=>t===e)):void 0}function s(e){const t=new Set([i.CIQFlag_DateEntityRecognition,i.CIQFlag_PersonEntityRecognition,i.CIQFlag_Location,i.CIQFlag_LocalBusiness,i.CIQFlag_TaskRecognition,i.HeadingDetection,i.CIQFlag_Topic,i.CIQFlag_SatoriEntityRecognition,i.CIQFlag_File,i.CIQFlag_Time]);return!!e&&t.has(e)}n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return o})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(r||(r={})),function(e){e.ContextualSpelling="818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",e.WrongSpelling="363d7011-83dd-4cc0-bdec-ea4af4df4dbb",e.TonalRewrite="965c8b90-32a3-4451-8c09-eba2c163dcec",e.TopicSuggestion="9bf58f9f-4159-40a1-80b8-4fe1f87c010d",e.CIQFlag_Location="1d456e3c-f436-4b8f-a315-1cc430bc2ee1",e.CIQFlag_LocalBusiness="1ECDDA98-C954-9863-87BD-4B0F493558FB",e.CIQFlag_PersonEntityRecognition="ffa21afe-fab3-423c-b579-8de8-128429f1cc8e",e.CIQFlag_DateEntityRecognition="349483fb-b654-4b4c-aefe-9f22bf147cd7",e.CIQFlag_TaskRecognition="c45ba192-bfae-4965-a833-694b55b1bd1d",e.CIQFlag_Topic="21422617-6650-456a-97cd-a7cd3116c39c",e.HeadingDetection="37e3346c-be6a-462c-afd7-282da13f6328",e.CIQFlag_SatoriEntityRecognition="9d9ccfb3-598c-e24c-3cda-11d260ae57d3",e.CIQFlag_File="17f49c82-b9f8-42d0-ab4e-dc076355d77a",e.CIQFlag_Time="9bd06192-906b-4693-99d3-7d58a1cf1770",e.Synonyms="23bd41d4-28ac-4cbc-ba24-2bba684c07da",e.DoubleSpaceGrammar="6d1d8c3d-62d5-45d1-b850-d8a98a24964b"}(i||(i={})),function(e){e.IgnoreOnce="IgnoreOnce",e.IgnoreAll="IgnoreAll",e.ApplySuggestion="ApplySuggestion",e.DisableCritiqueType="DisableCritiqueType",e.ShowFeedback="ShowFeedback"}(o||(o={}))},,,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.CourtesyAttributes="CourtesyAttributes",e.RootContentMaxLengthInChars="RootContentMaxLengthInChars"}(r||(r={}))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("ISettingsEmitterBase")},,,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),function(e){e[e.OFF=0]="OFF",e[e.ERROR=1]="ERROR",e[e.WARNING=2]="WARNING",e[e.INFO=3]="INFO"}(r||(r={}));var i=function(){function e(e,t){this._nextPolicy=e,this._options=t}return e.prototype.shouldLog=function(e){return this._options.shouldLog(e)},e.prototype.log=function(e,t){this._options.log(e,t)},e}(),o=function(){function e(e){this._logger=e}return e.prototype.shouldLog=function(e){return!!this._logger&&e!==r.OFF&&e<=this._logger.minimumLogLevel},e.prototype.log=function(e,t){this._logger&&this.shouldLog(e)&&this._logger.log(e,t)},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IProofingPersistedStore")},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return g})),n.d(t,"d",(function(){return m})),n.d(t,"g",(function(){return y})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return v}));var r,i,o,a=n(26),s=25,u=10,c=3,l=5,d=3;!function(e){e.FirstTimeNotification="FirstTimeNotification",e.LeftFeedback="LeftFeedback",e.NegativeExperience="NegativeExperience",e.NoFeedback="NoFeedback",e.PositiveExperience="PositiveExperience",e.Postponed="Postponed",e.Rated="Rated",e.RatedAfterPostponed="RatedAfterPostponed"}(r||(r={})),function(e){e.FirstTimeNotification="FirstTimeNotification",e.NotificationDismissed="NotificationDismissed",e.NotificationShown="NotificationShown",e.NotificationOpened="NotificationOpened"}(i||(i={})),function(e){e.DismissInitialPrompt="DismissInitialPrompt",e.DismissRatingPrompt="DismissRatingPrompt",e.DismissFeedbackPrompt="DismissFeedbackPrompt"}(o||(o={}));var f={shownTimes:0,totalAcceptedSuggestions:0,sources:[],acceptedSuggestionsTimestamps:[],state:r.FirstTimeNotification,fpsSurvey:{shownTimes:0},seenEvents:[]};function h(e,t,n){var r=new Date,i=new Date(r).setDate(r.getDate()-l),o=0,a=!0,s=!1,u=void 0;try{for(var c,d=e[Symbol.iterator]();!(a=(c=d.next()).done);a=!0){if(t(c.value)>i)break;o+=1}}catch(e){s=!0,u=e}finally{try{a||null==d.return||d.return()}finally{if(s)throw u}}return e.slice(Math.max(e.length-n,o))}function p(e){var t=new Date,n=Math.abs(t.getTime()-e.getTime());return Math.ceil(n/864e5)}function g(e){var t,n,r=e.lastShown&&new Date(e.lastShown),i=(null===(t=e.fpsSurvey)||void 0===t?void 0:t.lastShown)&&new Date(null===(n=e.fpsSurvey)||void 0===n?void 0:n.lastShown);return r&&i?p(r)>90&&p(i)>90:r?p(r)>90:!i||p(i)>90}function m(e){var t,n=null===(t=e.fpsSurvey)||void 0===t?void 0:t.lastShown;return!n||p(new Date(n))>180}function y(e,t,n){return t&&m(e)&&function(e){return!!e.seenEvents&&e.seenEvents.length>=d}(e)&&n===a.e.MSA}function b(e,t){var n=e.acceptedSuggestionsTimestamps.length>=s||e.sources.length>=u;return t&&function(e){var t=e.lastShown;return!t||p(new Date(t))>90}(e)&&n&&e.shownTimes<=c}function v(e,t){var n=function(e){for(var t=0,n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t}(t),r=new Date;e.totalAcceptedSuggestions+=1,e.acceptedSuggestionsTimestamps.push(r.getTime()),e.acceptedSuggestionsTimestamps=h(e.acceptedSuggestionsTimestamps,(function(e){return e}),s),e.sources=e.sources.filter((function(e){return e.sourceHash!==n})),e.sources.push({sourceHash:n,acceptedAt:r.getTime()}),e.sources=h(e.sources,(function(e){return e.acceptedAt}),u)}},,function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var a=e.apply(t,n);function s(e){r(a,i,o,s,u,"next",e)}function u(e){r(a,i,o,s,u,"throw",e)}s(void 0)}))}}function o(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function a(e){return null==e}function s(e){return!a(e)}function u(e,t){return c.apply(this,arguments)}function c(){return(c=i((function(e,t){return o(this,(function(n){switch(n.label){case 0:return[4,chrome.tabs.create({url:e,active:!!a(t)||t})];case 1:return[2,n.sent()]}}))}))).apply(this,arguments)}function l(e){return d.apply(this,arguments)}function d(){return d=i((function(e){var t,n=arguments;return o(this,(function(r){switch(r.label){case 0:return t=!(n.length>1&&void 0!==n[1])||n[1],[4,chrome.windows.getAll()];case 1:return 0===r.sent().length?[2,new Promise((function(n){chrome.windows.onCreated.addListener(i((function(){var r;return o(this,(function(i){switch(i.label){case 0:return[4,u(e,!!a(t)||t)];case 1:return r=i.sent(),n(r),[2]}}))})))}))]:[2,u(e,!!a(t)||t)]}}))})),d.apply(this,arguments)}function f(){if("object"!=typeof chrome.runtime||"function"!=typeof chrome.runtime.getManifest)return null;var e=chrome.runtime.getManifest();return null==e?null:e}function h(){return Math.round((new Date).getTime()/1e3)}function p(){return self.navigator.userAgent.indexOf("Edg")>-1}function g(){return!p()}function m(e){var t;null===(t=chrome.action)||void 0===t||t.setIcon({path:e})}function y(e){var t,n,r=f();if(!(null==r?void 0:r.content_scripts))return!1;var i=r.content_scripts.some((function(t){var n;return null===(n=t.matches)||void 0===n?void 0:n.some((function(t){return new RegExp(t.replace("*",".*")).test(e)}))}));if(i)return!1;var o=r.content_scripts.filter((function(e){var t;return!!(null===(t=e.matches)||void 0===t?void 0:t.find((function(e){return"<all_urls>"===e})))}));return 1===o.length&&(null!==(n=null===(t=o[0].exclude_matches)||void 0===t?void 0:t.some((function(t){return new RegExp(t.replace("*",".*")).test(e)})))&&void 0!==n&&n)}function b(e,t){if(e[t]){var n=JSON.parse(e[t]);if(void 0!==n.value)return JSON.parse(n.value)}}function v(){return w.apply(this,arguments)}function w(){return(w=i((function(){var e,t,n,r;return o(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e={active:!0,currentWindow:!0},[4,chrome.tabs.query(e)];case 1:if((t=i.sent()).length<1||!t[0].url)throw new Error("Couldn't get the active tab URL");return n=t[0].url,!(r=new URL(n)).hostname||"http:"!==r.protocol&&"https:"!==r.protocol?[3,3]:[2,{url:n,hostname:r.hostname}];case 2:return i.sent(),[3,3];case 3:return[2,{}]}}))}))).apply(this,arguments)}n.d(t,"g",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"j",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return h})),n.d(t,"e",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"k",(function(){return m})),n.d(t,"l",(function(){return y})),n.d(t,"i",(function(){return b})),n.d(t,"a",(function(){return v}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));const r=(e,t)=>{let n=!1;for(let r=0;r<e.length;r+=1)e[r]===t&&(n=!0,e.splice(r,1),r-=1);return n},i=()=>({listeners:[]})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IRegistrable")},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.OutlineNode=0]="OutlineNode",e[e.TerminalNode=1]="TerminalNode",e[e.TileNode=2]="TileNode",e[e.ParagraphNode=3]="ParagraphNode"}(r||(r={}))},,function(e,t,n){"use strict";(function(e){var r,i;n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));class o{constructor(e){this[r]="WeakRef",this.weakMap=new WeakMap,this.weakMap.set(this,e)}deref(){return this.weakMap.get(this)}}r=Symbol.toStringTag;class a{constructor(t){this[i]="WeakRef","object"==typeof e&&e&&void 0===e.WeakRef?this.weakRef=new o(t):this.weakRef=new e.WeakRef(t)}deref(){return this.weakRef.deref()}}function s(e){return"WeakRef"===e[Symbol.toStringTag]}i=Symbol.toStringTag}).call(this,n(69))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(14),i=n(45),o=n(133);function a(){return Object(o.a)(new i.a(r.g,!0))}},,,function(e,t,n){"use strict";function r(e){return e&&(e.formattedRanges||e.attributionRanges)}function i(e,t){const n=e.start<t.start?e:t,r=n===e?t:e;if(!(n.end<r.start))return{start:r.start,end:n.end<r.end?n.end:r.end}}function o(e,t,n){if(!e)return;const r=e.content.substring(t,n);let o;if(e.formattedRanges){o=[];for(const r of e.formattedRanges){const e=i({start:r.start,end:r.start+r.length},{start:t,end:n});e&&o.push(Object.assign(Object.assign({},r),{start:e.start,length:e.end-e.start}))}}return Object.assign(Object.assign({},e),{content:r,formattedRanges:o})}function a(e,t,n){const r=[];for(const i of e){const e=i.start+i.length,o=Math.max(t,i.start),a=Math.min(n,e);a<=o||r.push(Object.assign(Object.assign({},i),{start:o,length:a-o}))}return r}function s(e,t,n){return e.formattedRanges?a(e.formattedRanges,t,n):[]}function u(e,t,n){return{formattedRanges:e.formattedRanges?a(e.formattedRanges,t,n):[],attributionRanges:e.attributionRanges?a(e.attributionRanges,t,n):[]}}n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return f}));const c=["queryRange","ipPosition","isColdIp","content","formattedRanges","attributionRanges","objectReferences"];function l(e,t){if(!e!=!t)return!1;if(!e||!t)return!0;const n=d(e);return!!f(n,d(e))&&n.every((n=>e[n]===t[n]))}function d(e){return Object.keys(e).filter((e=>!c.includes(e)))}function f(e,t){return!e==!t&&(!e||!t||e.length===t.length&&e.every(((n,r)=>function(e,t){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const r of n)if(Array.isArray(e[r])&&Array.isArray(t[r])){if(!f(e[r],t[r]))return!1}else if(e[r]!==t[r])return!1;return!0}(e[r],t[r]))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IStoreEntryReader")},,function(e,t,n){"use strict";var r,i,o,a,s,u,c,l,d,f,h;n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return f})),function(e){e[e.Success=0]="Success",e[e.PartialSuccess=1]="PartialSuccess",e[e.Error=2]="Error",e[e.Disabled=3]="Disabled"}(r||(r={})),function(e){e[e.Default=0]="Default",e[e.Word=1]="Word",e[e.Phrase=2]="Phrase",e[e.Sentence=4]="Sentence",e[e.Paragraph=8]="Paragraph",e[e.Page=16]="Page",e[e.Section=32]="Section",e[e.Chapter=64]="Chapter",e[e.Document=256]="Document",e[e.RawChars=16384]="RawChars"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Paragraph=1]="Paragraph",e[e.Group=2]="Group",e[e.Page=3]="Page",e[e.Document=4]="Document"}(o||(o={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low"}(a||(a={})),function(e){e[e.None=0]="None",e[e.OfficeOrthospeller=1]="OfficeOrthospeller",e[e.BingOneSpeller=2]="BingOneSpeller",e[e.ContextSpeller=3]="ContextSpeller",e[e.Grammar=4]="Grammar"}(s||(s={})),function(e){e[e.None=0]="None",e[e.Active=1]="Active",e[e.Provisional=2]="Provisional"}(u||(u={})),function(e){e[e.None=0]="None",e[e.Consistency=1]="Consistency"}(c||(c={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(l||(l={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(d||(d={})),function(e){e[e.Ignore=0]="Ignore",e[e.IgnoreAll=1]="IgnoreAll",e[e.AddToDictionary=2]="AddToDictionary",e[e.Delete=3]="Delete",e[e.ChangeSugg0=4]="ChangeSugg0",e[e.ChangeSugg1=5]="ChangeSugg1",e[e.ChangeSugg2=6]="ChangeSugg2",e[e.ChangeSuggOther=7]="ChangeSuggOther",e[e.ChangeAllSugg0=8]="ChangeAllSugg0",e[e.ChangeAllSugg1=9]="ChangeAllSugg1",e[e.ChangeAllSugg2=10]="ChangeAllSugg2",e[e.ChangeAllSuggOther=11]="ChangeAllSuggOther",e[e.ClickNoAction=12]="ClickNoAction",e[e.DoNotCheckThisIssue=13]="DoNotCheckThisIssue",e[e.ManualEdit=14]="ManualEdit",e[e.Autoreplace=15]="Autoreplace",e[e.AutoreplaceUndo=16]="AutoreplaceUndo",e[e.IgnoreUndo=17]="IgnoreUndo",e[e.IgnoreAllUndo=18]="IgnoreAllUndo",e[e.ChangeSugg0Undo=19]="ChangeSugg0Undo",e[e.ChangeSugg1Undo=20]="ChangeSugg1Undo",e[e.ChangeSugg2Undo=21]="ChangeSugg2Undo"}(f||(f={})),function(e){e[e.Zero=0]="Zero",e[e.One=1]="One"}(h||(h={}))},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9),i=Object(r.a)("IClientStateEmitter")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(18),i=null;function o(t){return void 0===t&&(t=!0),i&&t||(typeof globalThis!==r.l&&globalThis&&(i=globalThis),typeof self!==r.l&&self&&(i=self),typeof window!==r.l&&window&&(i=window),typeof e!==r.l&&e&&(i=e)),i}function a(e){throw new TypeError(e)}function s(e){var t=r.c;if(t)return t(e);if(null==e)return{};var n=typeof e;function i(){}return n!==r.j&&n!==r.h&&a("Object prototype may only be an Object:"+e),i[r.k]=e,new i}}).call(this,n(69))},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(35),i=function(e){function t(n,r,i,o,a,s){var u=e.call(this,n)||this;return u.code=r,u.statusCode=i,u.request=o,u.response=a,u.body=s,Object.setPrototypeOf(u,t.prototype),u}return Object(r.c)(t,e),t.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",t.REQUEST_ABORTED_ERROR="REQUEST_ABORTED_ERROR",t.PARSE_ERROR="PARSE_ERROR",t}(Error)},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Default=0]="Default",e[e.ShowTUI=1]="ShowTUI",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled",e[e.ShowSupportEndedTUI=4]="ShowSupportEndedTUI",e[e.SupportEnded=5]="SupportEnded"}(r||(r={}))},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IProofingDom")},,,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NoReaction=0]="NoReaction",e[e.EnableFeature=1]="EnableFeature",e[e.DisableFeature=2]="DisableFeature"}(r||(r={}))},,function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var u,c=[],l=!1,d=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):d=-1,c.length&&h())}function h(){if(!l){var e=s(f);l=!0;for(var t=c.length;t;){for(u=c,c=[];++d<t;)u&&u[d].run();d=-1,t=c.length}u=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||l||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IHostModelSettings")},,,,,,function(e,t,n){"use strict";var r,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e.ActionHideSynonymsFromCallout="ActionHideSynonymsFromCallout",e.ActionShowCallout="ActionShowCallout",e.ActionShowSynonymsFromCallout="ActionShowSynonymsFromCallout",e.ActionUpsellButtonClicked="ActionUpsellButtonClicked",e.SignInInitialized="SignInInitialized",e.ActionDisableCritique="ActionDisableCritique",e.OverflowMenuClicked="OverflowMenuClicked",e.UndoCalloutShown="UndoCalloutShown",e.PersonalizedUndoCalloutShown="PersonalizedUndoCalloutShown",e.SquiggleTooltipShown="SquiggleTooltipShown",e.CritiquesShown="CritiquesShown"}(r||(r={})),function(e){e.AriaError="RunTimeErrors.AriaError",e.GetNewActivityError="RunTimeErrors.GetNewActivityError",e.EnvelopeFormatError="RunTimeErrors.EnvelopeFormatError",e.TelemetryError="RunTimeErrors.TelemetryError",e.RoamingDictionarySaveError="RunTimeErrors.RoamingDictionarySaveError",e.RoamingDictionaryInitError="RunTimeErrors.RoamingDictionaryInitError"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return u}));var r=n(15),i=n(14);function o(e,t,n,o){!function(e){if(void 0!==e)throw new Error(r.n)}(t),s(i.k,e,n.toString(),o)}function a(e){var t=[];if(Array.isArray(e)){var n=function(e){for(var t=new Set,n=0,r=e;n<r.length;n++){var i=r[n];if(t.has(i))return i;t.add(i)}}((t=e).map((function(e){return e.key})));if(void 0!==n)throw new Error(r.l+" "+n.toString())}else t=[e];return t}function s(e,t,n,i){var o=a(i),s={};Reflect.hasOwnMetadata(e,t)&&(s=Reflect.getMetadata(e,t));var u=s[n];if(void 0===u)u=[];else for(var c=function(e){if(o.some((function(t){return t.key===e.key})))throw new Error(r.l+" "+e.key.toString())},l=0,d=u;l<d.length;l++){c(d[l])}u.push.apply(u,o),s[n]=u,Reflect.defineMetadata(e,s,t)}function u(e){return function(t,n,a){"number"==typeof a?o(t,n,a,e):function(e,t,n){if(void 0!==e.prototype)throw new Error(r.n);s(i.l,e.constructor,t,n)}(t,n,e)}}function c(e,t){Reflect.decorate(e,t)}function l(e,t){return function(n,r){t(n,r,e)}}function d(e,t,n){"number"==typeof n?c([l(n,e)],t):"string"==typeof n?Reflect.decorate([e],t,n):c([e],t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(164),i=n(3);class o extends r.a{constructor(e){super(r.a.createContainer(),e)}onAddModule(e){"configureRootServices"in e?e.configureRootServices(this.container):e.providers&&this.bindProvidersToContainer(this.container,e.providers)}}const a=Object(i.createContext)(void 0)},function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return m}));var r=n(2),i=n(8),o=n(180),a=n(21),s=n(381),u=n(152),c=n(11),l=n(7),d=n(9);function f(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){f(o,r,i,a,s,"next",e)}function s(e){f(o,r,i,a,s,"throw",e)}a(void 0)}))}}function p(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var g=Object(d.a)("IExtensionTelemetrySink"),m=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_guidGenerator",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_telemetrySink",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_enableOptionalDiagnostic",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"getTelemetrySink",{enumerable:!0,configurable:!0,writable:!0,value:function(){return n._telemetrySink}});var r,o=this;Object.defineProperty(this,"manualInitialize",{enumerable:!0,configurable:!0,writable:!0,value:(r=h((function(e,t){return p(this,(function(n){switch(n.label){case 0:return[4,e.read(i.a.EnableTelemetry)];case 1:return o._enableOptionalDiagnostic=n.sent(),o._telemetrySink.setFullEventsEnabled(o._enableOptionalDiagnostic),t.on(i.a.EnableTelemetry,h((function(){return p(this,(function(t){switch(t.label){case 0:return[4,e.read(i.a.EnableTelemetry)];case 1:return o._enableOptionalDiagnostic=t.sent(),o._telemetrySink.setFullEventsEnabled(o._enableOptionalDiagnostic),[2]}}))}))),[2]}}))})),function(e,t){return r.apply(this,arguments)})}),Object.defineProperty(this,"initialize",{enumerable:!0,configurable:!0,writable:!0,value:h((function(){return p(this,(function(e){return[2,Promise.resolve()]}))}))}),Object.defineProperty(this,"shutDown",{enumerable:!0,configurable:!0,writable:!0,value:function(){n._telemetrySink.shutdown()}});var c=[Object(a.c)("Session.Id",this._guidGenerator.generate()),Object(a.c)("App.Platform","Web"),Object(a.c)("App.Name","EditorBX")];this._telemetrySink=new s.a(c,{endpointUrl:u.a.PUBLIC})};m=Object(r.c)([Object(c.a)(),Object(r.f)(0,Object(l.a)(o.a)),Object(r.e)("design:paramtypes",[Object])],m)},,function(e,t,n){"use strict";function r(e){return e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.NewData="NewData",e.RemoveData="RemoveData",e.ChangeData="ChangeData"}(r||(r={}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.AllowedUrls="allowedUrls",e.UserExcludedUrls="userExcludedUrls"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a}));var r=n(9);Object(r.a)("IOnCanvasKpiHelper");const i=Object(r.a)("ILoggerSettings"),o=Object(r.a)("IEditorSdkLogger"),a=(Object(r.a)("IKpiTracker"),Object(r.a)("TelemetrySink"))},function(e,t,n){"use strict";t.__esModule=!0;var r=function(e,t){for(var n=!1,r=0;r<e.length;r+=1)e[r]===t&&(n=!0,e.splice(r,1),r-=1);return n},i=function(){function e(){this.anyRegistrations=[],this.registrations={}}return e.prototype.on=function(e,t){this.safelyGetRegistration(e).listeners.push(t)},e.prototype.onFirst=function(e,t){var n=this.safelyGetRegistration(e);void 0!==n.firstArgs&&t.apply(void 0,n.firstArgs),n.firstOnlyListeners.push(t)},e.prototype.onAny=function(e){this.anyRegistrations.push(e)},e.prototype.off=function(e,t){if(void 0!==e)if(void 0!==t){var n=this.safelyGetRegistration(e),i=r(n.listeners,t),o=r(n.firstOnlyListeners,t);if(!i&&!o)throw new Error("Tried to remove a non-existent listener for event name '"+e+"'.")}else this.registrations[e]={firstOnlyListeners:[],listeners:[]};else this.registrations={}},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.safelyGetRegistration(e);if(void 0===r.firstArgs){for(var i=0,o=r.firstOnlyListeners;i<o.length;i++){o[i].apply(void 0,t)}r.firstArgs=t,r.firstOnlyListeners=[]}for(var a=0,s=r.listeners;a<s.length;a++){s[a].apply(void 0,t)}for(var u=0,c=this.anyRegistrations;u<c.length;u++){c[u].apply(void 0,[e].concat(t))}},e.prototype.waitFor=function(e){var t=this;return new Promise((function(n){var r=function(i){n(i),t.off(e,r)};t.on(e,r)}))},e.prototype.waitForFirst=function(e){var t=this;return new Promise((function(n){var r=function(i){n(i),t.off(e,r)};t.onFirst(e,r)}))},e.prototype.safelyGetRegistration=function(e){return void 0===this.registrations[e]&&(this.registrations[e]={firstOnlyListeners:[],listeners:[]}),this.registrations[e]},e}();t.EventEmitter=i,t.Squee=i},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),i=n(11),o=n(7),a=n(64);let s=class{constructor(e){this._extensionStorage=e}getLastError(){return this._lastError}setLastError(e){this._lastError=e}async writeSetting(e,t){const n={value:JSON.stringify(t),lastUpdated:Date.now(),manualOverride:!1},r={};r[e]=JSON.stringify(n),await this._extensionStorage.set(r)}};s=Object(r.c)([Object(i.a)(),Object(r.f)(0,Object(o.a)(a.a))],s)},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15),i=n(45),o=n(133);function a(e){return function(t){return function(n,a,s){if(void 0===t){var u="function"==typeof n?n.name:n.constructor.name;throw new Error(Object(r.C)(u))}return Object(o.a)(new i.a(e,t))(n,a,s)}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9),i=Object(r.a)("ISendMessageStrategy")},function(e,t,n){"use strict";function r(e,t,n){var r;const o={isFaulted:!1,settingValueMap:new Map};try{const a=JSON.parse(e),s=null===(r=null==a?void 0:a.diagnostics_data)||void 0===r?void 0:r.http_status_code;if(o.resultCode=s,!function(e){if(!e)return!1;return e>=200&&e<300}(s))throw new Error(`Received error status code: ${s||0}`);const u=null==a?void 0:a.error_data;if(u)throw new Error(`Received error error data: ${u}`);const c=[...a.settings||[],...a.dictionaries||[]];if(t!==i.WriteSettingItem){if(!c)throw new Error("Settings not defined in response");c.forEach((e=>{n.has(e.id)&&o.settingValueMap.set(e.id,e.value)}))}}catch(e){o.isFaulted=!0,o.fault={errorMessage:e.errorMessage}}return o}var i;function o(e,{response:t},n){return{requestType:e,response:r(t.body,e,n)}}n.d(t,"a",(function(){return f})),function(e){e[e.ReadSetting=0]="ReadSetting",e[e.WriteSettingItem=1]="WriteSettingItem"}(i||(i={}));var a;!function(e){e.PUT="PUT",e.GET="GET",e.POST="POST"}(a||(a={}));const s=e=>Object.assign(Object.assign({},e),{value:JSON.stringify(e.settingIds)});function u(e,t,n){const r={headers:{"Content-Type":"application/json",Authorization:t,"X-CorrelationId":n.correlationId,"X-Office-Application":`${n.hostApplication}`,"X-Office-Platform":n.hostPlatform,"X-Office-Version":n.hostVersion},method:e};return n.value&&(r.body=`${n.value}`),r}const c={BlackForest:"https://roaming.osi.office.de/rs/v1/settings",Gallatin:"https://roaming.officeapps.partner.office365.cn/rs/v1/settings",PPE:"https://roaming.edog.officeapps.live.com/rs/v1/settings",PROD:"https://roaming.officeapps.live.com/rs/v1/settings",UsGov:"https://roaming.osi.office365.us/rs/v1/settings",UsGovDoD:"https://roaming.osi.apps.mil/rs/v1/settings"};class l{constructor(e,t){if(this.makeRequest=t,!e)throw new Error("Environment cannot be null or empty!");if(!c[e])throw new Error(`Environment is invalid. Valid values are [${Object.keys(c)}]`);this.endpoint=c[e]}async read(e){try{const r=s(e),c=(t=this.endpoint,n=r,u(a.POST,t,s(n))),l=await this.makeRequest(function(e,t){return`${e}?rs=${t.hostCulture}`}(this.endpoint,e),c),d=new Set(e.settingIds);return o(i.ReadSetting,l,d)}catch(t){throw new Error(`exception thrown during Read operation: ${t.message}, correlationId: ${e.correlationId}`)}var t,n}async write(e){try{const t=function(e,t){return u(a.PUT,e,t)}(this.endpoint,e),n=await this.makeRequest(function(e,t){return`${e}/${(t.isDictionaryItem?"dictionary/":"")+t.settingId}?rs=${t.hostCulture}`}(this.endpoint,e),t),r=new Set([e.settingId]);return o(i.WriteSettingItem,n,r)}catch(t){throw new Error(`exception thrown during Write operation: ${t.message}, correlationId: ${e.correlationId}`)}}}class d extends l{constructor(e,t){if(super(e,(async(e,t)=>{t.headers?t.headers.Authorization=this.accessToken:t.headers={Authorization:this.accessToken};const n=await fetch(e,t);return{response:{body:await n.text(),status:n.status,statusText:n.statusText}}})),this.accessToken=t,!t)throw new Error("access token cannot be null or empty")}}async function f(e,t){if(e){const n=await e();if(!n)throw new Error("No auth token");return new d(t,n)}throw new Error("AuthTokenCallback undefined")}},,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",e.CUSTOMER_CONTENT="https://office-c.events.data.microsoft.com/OneCollector/1.0/",e.EUDB="https://eu-office.events.data.microsoft.com/OneCollector/1.0/"}(r||(r={}))},,function(e,t,n){"use strict";var r,i;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e.TileNode="TileNode",e.ParagraphNode="ParagraphNode"}(r||(r={})),function(e){e[e.Local=0]="Local",e[e.Code=1]="Code",e[e.Remote=2]="Remote"}(i||(i={}))},function(e,t,n){"use strict";let r,i;async function o(){try{const e=await Promise.resolve().then(n.bind(null,6));r=e.makeObservable,i=e.makeAutoObservable}catch(e){}}function a(e,t,n){return r?r(e,t,n):e}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}))},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(187);function i(e,t=""){const n=null===t?e:Object(r.a)(e,t);window.open(n,"_blank","noopener,noreferrer")}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return u}));var r=n(27),i=n(61);const o=["facetCodes","statusCode","innerMostErrorCode","sprequestguid"];function a(e){return e.map((e=>e[1]?s(e[0],e[1]):void 0)).filter((e=>!!e))}function s(e,t,n){return Object(i.a)(e,t,r.a.DataClassification.SystemMetadata,n)}function u(e){const t={};return function(e,t){var n;const r="object"==typeof e&&null!==e;function i(t){if(!r)return;const n=e[t];return"string"==typeof n?n:void 0}t.errorMessage=null!==(n=i("message"))&&void 0!==n?n:String(e),t.errorName=i("name"),t.stack=i("stack"),t.errorType=i("errorType"),t.errorInstanceId=i("errorInstanceId"),o.forEach((n=>{const r=e[n];r&&(t[n]="object"==typeof r?JSON.stringify(r):r)}))}(e,t),t.message?t.message=`${t.message}\n${t.errorMessage}`:t.message=t.errorMessage,void 0===t.stack&&(t.stack=function(){let e=(new Error).stack;if(!e)try{throw new Error}catch(t){e=t.stack}return e}()),t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(575),i=n(264);var o=n(259);class a{constructor(e,t){this.addedModuleKeys=new Set,this._addedModuleClassNames=new Set,this._modulesSharingSameModuleKeyButDifferentClassname=new Set,this.container=e,this.generateModuleKey=t}static createContainer(e){return e?e.createChildContainer():function(){const e=new r.a(i.b);return new i.a(e)}()}clear(){this.container.unbindAll(),this.addedModuleKeys.clear(),this._addedModuleClassNames.clear(),this._modulesSharingSameModuleKeyButDifferentClassname.clear()}get addedModuleClassNames(){return this._addedModuleClassNames}get modulesSharingSameModuleKeyButDifferentClassname(){return this._modulesSharingSameModuleKeyButDifferentClassname}addModule(e){var t;const n="function"!=typeof e?e.constructor.name:e.name,r=this.getModuleKey(e);if(this.addedModuleKeys.has(r))return void(this._addedModuleClassNames.has(n)||this._modulesSharingSameModuleKeyButDifferentClassname.add(n));this._addedModuleClassNames.add(n),this.addedModuleKeys.add(r);const i=this.getModuleInstance(e);this.addModules(null!==(t=i.imports)&&void 0!==t?t:[]),this.onAddModule(i)}addModules(e){for(const t of e)t&&(Array.isArray(t)?this.addModules(t):this.addModule(t))}bindProvidersToContainer(e,t){for(const n of t)if(n)if(Object(o.a)(n))e.isBound(n)||e.bind(n).toSelf();else{const t=n.provide;if(!n.multiple&&e.isBound(t))throw new Error(`Duplicate provider type: ${String(t)}`);if("useClass"in n)e.bind(t).to(n.useClass);else if("useDynamicValue"in n)e.bind(t).toDynamicValue(n.useDynamicValue);else if("useExisting"in n)e.bind(t).toExisting(n.useExisting);else{if(!("useValue"in n))throw new Error("Unknown provider type");e.bind(t).toValue(n.useValue)}}}getModuleKey(e){var t,n;const r=this.getModuleInstance(e);return r.uniqueId?r.uniqueId:e instanceof Function&&null!==(n=null===(t=this.generateModuleKey)||void 0===t?void 0:t.call(this,e))&&void 0!==n?n:e}getModuleInstance(e){return e instanceof Function?new e:e}}},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("ITransportLogger")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("ITransportActivity")},,,,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Int="https://augloop-int.officeppe.com",e.Dogfood="https://augloop-dogfood.officeppe.com",e.Prod="https://augloop.office.com"}(r||(r={}))},,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.BetaEnrollment="BetaEnrollment"}(r||(r={}))},,function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return p}));var r,i,o=n(2),a=n(9),s=n(11),u=n(7),c=n(60),l=n(74),d=n(212),f=n(226);!function(e){e[e.SettingsShown=0]="SettingsShown",e[e.CalloutShown=1]="CalloutShown",e[e.PageContext=2]="PageContext"}(r||(r={})),function(e){e[e.SettingsPage=0]="SettingsPage",e[e.CritiqueCallout=1]="CritiqueCallout",e[e.PageContext=2]="PageContext"}(i||(i={}));const h=Object(a.a)("IUnsignedInEditorFeature");let p=class extends c.a{constructor(e,t,n){super(),this._featureFlagsReader=t,this._languageDetector=n,this.enablers=[!0],this.disablers.push(this),this.disablers.push(e)}check(){return!this._featureFlagsReader.flags.enableUnsignedInEditor}async emitAndEvaluateAsync(e){return this.emitAndEvaluate(e)&&this.checkForMultipleLanguages()}async checkForMultipleLanguages(){const e=await this.countUniqueLanguages();return!this._featureFlagsReader.flags.enableSuppressUnsignedInEditorForMultiLang||e<=1}async countUniqueLanguages(){return(await this._languageDetector.getBrowserLanguages()).reduce(((e,t)=>{const n=t.split("-");if(n.length>0){const t=n[0];e.add(t)}return e}),new Set).size}};p=Object(o.c)([Object(s.a)(),Object(o.f)(0,Object(u.a)(f.a)),Object(o.f)(1,Object(u.a)(l.a)),Object(o.f)(2,Object(u.a)(d.a))],p)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(161);function i(){var e=chrome.runtime.getURL("options.html");Object(r.a)(e,null)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IGuidGenerator")},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(){this.listeners={}}subscribe(e,t){var n;const r=null!==(n=this.listeners[e])&&void 0!==n?n:[];r.push(t),this.listeners[e]=r}unsubscribe(e,t){var n;let r=null!==(n=this.listeners[e])&&void 0!==n?n:[];r=r.filter((e=>e!==t)),this.listeners[e]=r}publishEvent(e,t){var n;const r=null!==(n=this.listeners[e])&&void 0!==n?n:[];for(const e of r)e(t)}}},,,function(e,t,n){"use strict";function r(e){if(0===e.trim().length)return!1;try{return new URL(e),!0}catch(e){return!1}}function i(e,t){if(!r(e))return e;const n=new URL(e),i=t.trim();return n.pathname.endsWith("/")?n.pathname+=i:n.pathname=`${n.pathname}/${i}`,n.toString()}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return u}));var r=n(2),i=n(78);function o(e){const{text:t,action:n,languages:i,metadataJSON:o,description:a}=e,s=Object(r.g)(e,["text","action","languages","metadataJSON","description"]);return Object.assign({text:t,action:u(n),languages:i,metadataJSON:o,description:a},s)}function a(e){const{text:t,action:n,languages:i,metadataJSON:o,description:a}=e,u=Object(r.g)(e,["text","action","languages","metadataJSON","description"]),{confidenceLevel:c,source:l}=u;return Object.assign({text:t,action:s(n),languages:i,metadataJSON:o,description:a,confidenceLevel:c||0,source:l||0},u)}function s(e){let t=0;return e.changeOnce&&(t|=i.b.ChangeOnce),e.changeAll&&(t|=i.b.ChangeAll),e.autoCorrect&&(t|=i.b.AutoCorrect),e.readAloud&&(t|=i.b.ReadAloud),e.personalizedAutoCorrect&&(t|=i.b.PersonalizedAutoCorrect),t}function u(e){return{changeOnce:(e&i.b.ChangeOnce)===i.b.ChangeOnce,changeAll:(e&i.b.ChangeAll)===i.b.ChangeAll,autoCorrect:(e&i.b.AutoCorrect)===i.b.AutoCorrect,readAloud:(e&i.b.ReadAloud)===i.b.ReadAloud,personalizedAutoCorrect:(e&i.b.PersonalizedAutoCorrect)===i.b.PersonalizedAutoCorrect}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(92);function i(e){var t=Object(r.b)();return!(e&&e>t+120)}},function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var r,i=n(41),o=n(15),a=n(12);!function(e){e.DynamicValue="toDynamicValue",e.Factory="toFactory",e.Provider="toProvider"}(r||(r={}));var s=function(e){return function(t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.forEach((function(n){return e.bind(n).toService(t)}))}}},u=function(e){var t=null;switch(e.type){case a.b.ConstantValue:case a.b.Function:t=e.cache;break;case a.b.Constructor:case a.b.Instance:t=e.implementationType;break;case a.b.DynamicValue:t=e.dynamicValue;break;case a.b.Provider:t=e.provider;break;case a.b.Factory:t=e.factory}if(null===t){var n=Object(i.c)(e.serviceIdentifier);throw new Error(o.m+" "+n)}},c=function(e){switch(e.type){case a.b.Factory:return{factory:e.factory,factoryType:r.Factory};case a.b.Provider:return{factory:e.provider,factoryType:r.Provider};case a.b.DynamicValue:return{factory:e.dynamicValue,factoryType:r.DynamicValue};default:throw new Error("Unexpected factory type "+e.type)}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IStoreEntryWriter")},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IProofingEmitter")},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a}));var r,i,o=n(9);!function(e){e[e.ClientInitialized=0]="ClientInitialized"}(r||(r={})),function(e){e[e.WordDictionaryInit=0]="WordDictionaryInit"}(i||(i={}));const a=Object(o.a)("IRoamingDictionaryFeature")},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(14),i=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(r.h,e),userGeneratedMetadata:Reflect.getMetadata(r.k,e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata(r.l,e)||[]},e}()},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r,i=n(9);!function(e){e[e.Undefined=0]="Undefined",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(r||(r={}));const o=Object(i.a)("IComponentInitializer")},,,function(e,t,n){"use strict";function r(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}function i(e){for(var t=atob(e),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return h}));var o=n(67),a=function(){function e(e,t){void 0===e&&(e={}),this.modelMappers=e,this.isXML=t}return e.prototype.validateConstraints=function(e,t,n){var r=function(e,r){throw new Error('"'+n+'" with value "'+t+'" should satisfy the constraint "'+e+'": '+r+".")};if(e.constraints&&null!=t){var i=e.constraints,o=i.ExclusiveMaximum,a=i.ExclusiveMinimum,s=i.InclusiveMaximum,u=i.InclusiveMinimum,c=i.MaxItems,l=i.MaxLength,d=i.MinItems,f=i.MinLength,h=i.MultipleOf,p=i.Pattern,g=i.UniqueItems;if(null!=o&&t>=o&&r("ExclusiveMaximum",o),null!=a&&t<=a&&r("ExclusiveMinimum",a),null!=s&&t>s&&r("InclusiveMaximum",s),null!=u&&t<u&&r("InclusiveMinimum",u),null!=c&&t.length>c&&r("MaxItems",c),null!=l&&t.length>l&&r("MaxLength",l),null!=d&&t.length<d&&r("MinItems",d),null!=f&&t.length<f&&r("MinLength",f),null!=h&&t%h!=0&&r("MultipleOf",h),p){var m="string"==typeof p?new RegExp(p):p;"string"==typeof t&&null!==t.match(m)||r("Pattern",p)}g&&t.some((function(e,t,n){return n.indexOf(e)!==t}))&&r("UniqueItems",g)}},e.prototype.serialize=function(e,t,n){var i={},a=e.type.name;n||(n=e.serializedName),null!==a.match(/^Sequence$/gi)&&(i=[]),e.isConstant&&(t=e.defaultValue);var c=e.required,f=e.nullable;if(c&&f&&void 0===t)throw new Error(n+" cannot be undefined.");if(c&&!f&&null==t)throw new Error(n+" cannot be null or undefined.");if(!c&&!1===f&&null===t)throw new Error(n+" cannot be null.");if(null==t)i=t;else if(this.validateConstraints(e,t,n),null!==a.match(/^any$/gi))i=t;else if(null!==a.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/gi))i=function(e,t,n){if(null!=n)if(null!==e.match(/^Number$/gi)){if("number"!=typeof n)throw new Error(t+" with value "+n+" must be of type number.")}else if(null!==e.match(/^String$/gi)){if("string"!=typeof n.valueOf())throw new Error(t+' with value "'+n+'" must be of type string.')}else if(null!==e.match(/^Uuid$/gi)){if("string"!=typeof n.valueOf()||!o.e(n))throw new Error(t+' with value "'+n+'" must be of type string and a valid uuid.')}else if(null!==e.match(/^Boolean$/gi)){if("boolean"!=typeof n)throw new Error(t+" with value "+n+" must be of type boolean.")}else if(null!==e.match(/^Stream$/gi)){var r=typeof n;if(!("string"===r||"function"===r||n instanceof ArrayBuffer||ArrayBuffer.isView(n)||"function"==typeof Blob&&n instanceof Blob))throw new Error(t+" must be a string, Blob, ArrayBuffer, ArrayBufferView, or a function returning NodeJS.ReadableStream.")}return n}(a,n,t);else if(null!==a.match(/^Enum$/gi)){i=function(e,t,n){if(!t)throw new Error("Please provide a set of allowedValues to validate "+e+" as an Enum Type.");if(!t.some((function(e){return"string"==typeof e.valueOf()?e.toLowerCase()===n.toLowerCase():e===n})))throw new Error(n+" is not a valid value for "+e+". The valid values are: "+JSON.stringify(t)+".");return n}(n,e.type.allowedValues,t)}else null!==a.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/gi)?i=function(e,t,n){if(null!=t)if(null!==e.match(/^Date$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(n+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString().substring(0,10):new Date(t).toISOString().substring(0,10)}else if(null!==e.match(/^DateTime$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(n+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString():new Date(t).toISOString()}else if(null!==e.match(/^DateTimeRfc1123$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(n+" must be an instanceof Date or a string in RFC-1123 format.");t=t instanceof Date?t.toUTCString():new Date(t).toUTCString()}else if(null!==e.match(/^UnixTime$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(n+" must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.");t=function(e){if(!e)return;"string"==typeof e.valueOf()&&(e=new Date(e));return Math.floor(e.getTime()/1e3)}(t)}else if(null!==e.match(/^TimeSpan$/gi)&&!o.c(t))throw new Error(n+' must be a string in ISO 8601 format. Instead was "'+t+'".');return t}(a,t,n):null!==a.match(/^ByteArray$/gi)?i=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");t=r(t)}return t}(n,t):null!==a.match(/^Base64Url$/gi)?i=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");t=function(e){if(!e)return;if(!(e instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(e,t){var n=e.length;for(;n-1>=0&&e[n-1]===t;)--n;return e.substr(0,n)}(r(e),"=").replace(/\+/g,"-").replace(/\//g,"_")}(t)}return t}(n,t):null!==a.match(/^Sequence$/gi)?i=function(e,t,n,r){if(!Array.isArray(n))throw new Error(r+" must be of type Array.");var i=t.type.element;if(!i||"object"!=typeof i)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+r+".");for(var o=[],a=0;a<n.length;a++)o[a]=e.serialize(i,n[a],r);return o}(this,e,t,n):null!==a.match(/^Dictionary$/gi)?i=function(e,t,n,r){if("object"!=typeof n)throw new Error(r+" must be of type object.");var i=t.type.value;if(!i||"object"!=typeof i)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+r+".");for(var o={},a=0,s=Object.keys(n);a<s.length;a++){var u=s[a];o[u]=e.serialize(i,n[u],r+"."+u)}return o}(this,e,t,n):null!==a.match(/^Composite$/gi)&&(i=function(e,t,n,r){var i;d(e,t)&&(t=l(e,t,n,"clientName"));if(null!=n){for(var o={},a=u(e,t,r),c=0,f=Object.keys(a);c<f.length;c++){var h=f[c],p=a[h];if(!p.readOnly){var g=void 0,m=o;if(e.isXML)g=p.xmlIsWrapped?p.xmlName:p.xmlElementName||p.xmlName;else{var y=s(p.serializedName);g=y.pop();for(var b=0,v=y;b<v.length;b++){var w=v[b];null==m[w]&&null!=n[h]&&(m[w]={}),m=m[w]}}if(null!=m){var S=""!==p.serializedName?r+"."+p.serializedName:r,_=n[h],T=d(e,t);T&&T.clientName===h&&null==_&&(_=t.serializedName);var O=e.serialize(p,_,S);void 0!==O&&null!=g&&(p.xmlIsAttribute?(m.$=m.$||{},m.$[g]=O):p.xmlIsWrapped?m[g]=((i={})[p.xmlElementName]=O,i):m[g]=O)}}}var C=t.type.additionalProperties;if(C){var E=Object.keys(a),I=function(t){E.every((function(e){return e!==t}))&&(o[t]=e.serialize(C,n[t],r+'["'+t+'"]'))};for(var k in n)I(k)}return o}return n}(this,e,t,n));return i},e.prototype.deserialize=function(e,t,n){if(null==t)return this.isXML&&"Sequence"===e.type.name&&!e.xmlIsWrapped&&(t=[]),void 0!==e.defaultValue&&(t=e.defaultValue),t;var r,o=e.type.name;return n||(n=e.serializedName),null!==o.match(/^Composite$/gi)?r=function(e,t,n,r){d(e,t)&&(t=l(e,t,n,"serializedName"));for(var i=u(e,t,r),o={},a=[],f=0,h=Object.keys(i);f<h.length;f++){var p=h[f],g=i[p],m=s(i[p].serializedName);a.push(m[0]);var y=g.serializedName,b=g.xmlName,v=g.xmlElementName,w=r;""!==y&&void 0!==y&&(w=r+"."+y);var S=g.headerCollectionPrefix;if(S){for(var _={},T=0,O=Object.keys(n);T<O.length;T++){var C=O[T];C.startsWith(S)&&(_[C.substring(S.length)]=e.deserialize(g.type.value,n[C],w)),a.push(C)}o[p]=_}else if(e.isXML)if(g.xmlIsAttribute&&n.$)o[p]=e.deserialize(g,n.$[b],w);else{var E=n[v||b||y];if(g.xmlIsWrapped)void 0===(E=(E=n[b])&&E[v])&&(E=[]);o[p]=e.deserialize(g,E,w)}else{for(var I=void 0,k=n,A=0,P=m;A<P.length;A++){var N=P[A];if(!k)break;k=k[N]}I=k;var j=t.type.polymorphicDiscriminator;j&&p===j.clientName&&null==I&&(I=t.serializedName);var R=void 0;if(Array.isArray(n[p])&&""===i[p].serializedName){I=n[p];for(var x=e.deserialize(g,I,w),D=0,M=Object.entries(o);D<M.length;D++){var L=M[D],B=L[0],F=L[1];x.hasOwnProperty(B)||(x[B]=F)}o=x}else void 0===I&&void 0===g.defaultValue||(R=e.deserialize(g,I,w),o[p]=R)}}var U=t.type.additionalProperties;if(U){var q=function(e){for(var t in i){if(s(i[t].serializedName)[0]===e)return!1}return!0};for(var z in n)q(z)&&(o[z]=e.deserialize(U,n[z],r+'["'+z+'"]'))}else if(n)for(var W=0,V=Object.keys(n);W<V.length;W++){void 0!==o[p=V[W]]||a.includes(p)||c(p)||(o[p]=n[p])}return o}(this,e,t,n):(this.isXML&&null!=t.$&&null!=t._&&(t=t._),null!==o.match(/^Number$/gi)?(r=parseFloat(t),isNaN(r)&&(r=t)):null!==o.match(/^Boolean$/gi)?r="true"===t||"false"!==t&&t:null!==o.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/gi)?r=t:null!==o.match(/^(Date|DateTime|DateTimeRfc1123)$/gi)?r=new Date(t):null!==o.match(/^UnixTime$/gi)?r=function(e){if(!e)return;return new Date(1e3*e)}(t):null!==o.match(/^ByteArray$/gi)?r=i(t):null!==o.match(/^Base64Url$/gi)?r=function(e){if(!e)return;if(e&&"string"!=typeof e.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return i(e=e.replace(/\-/g,"+").replace(/\_/g,"/"))}(t):null!==o.match(/^Sequence$/gi)?r=function(e,t,n,r){var i=t.type.element;if(!i||"object"!=typeof i)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+r);if(n){Array.isArray(n)||(n=[n]);for(var o=[],a=0;a<n.length;a++)o[a]=e.deserialize(i,n[a],r+"["+a+"]");return o}return n}(this,e,t,n):null!==o.match(/^Dictionary$/gi)&&(r=function(e,t,n,r){var i=t.type.value;if(!i||"object"!=typeof i)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+r);if(n){for(var o={},a=0,s=Object.keys(n);a<s.length;a++){var u=s[a];o[u]=e.deserialize(i,n[u],r)}return o}return n}(this,e,t,n))),e.isConstant&&(r=e.defaultValue),r},e}();function s(e){var t=[],n="";if(e)for(var r=0,i=e.split(".");r<i.length;r++){var o=i[r];"\\"===o.charAt(o.length-1)?n+=o.substr(0,o.length-1)+".":(n+=o,t.push(n),n="")}return t}function u(e,t,n){var r=t.type.modelProperties;if(!r){var i=t.type.className;if(!i)throw new Error('Class name for model "'+n+'" is not provided in the mapper "'+JSON.stringify(t,void 0,2)+'".');var o=e.modelMappers[i];if(!o)throw new Error('mapper() cannot be null or undefined for model "'+i+'".');if(!(r=o.type.modelProperties))throw new Error('modelProperties cannot be null or undefined in the mapper "'+JSON.stringify(o)+'" of type "'+i+'" for object "'+n+'".')}return r}function c(e){return["$","_"].includes(e)}function l(e,t,n,r){var i=d(e,t);if(i){var o=i[r];if(null!=o){var a=n[o];if(null!=a){var s=t.type.uberParent||t.type.className,u=a===s?a:s+"."+a,c=e.modelMappers.discriminators[u];c&&(t=c)}}}return t}function d(e,t){return t.type.polymorphicDiscriminator||f(e,t.type.uberParent)||f(e,t.type.className)}function f(e,t){return t&&e.modelMappers[t]&&e.modelMappers[t].type.polymorphicDiscriminator}var h=function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n];t[i]=i}return t}(["Base64Url","Boolean","ByteArray","Composite","Date","DateTime","DateTimeRfc1123","Dictionary","Enum","Number","Object","Sequence","String","Stream","TimeSpan","UnixTime"])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(104),i=n(48);function o(e){switch(e){case r.e.Word:return i.c.Word;case r.e.Sentence:return i.c.Sentence;case r.e.Paragraph:return i.c.Paragraph;default:return i.c.Sentence}}},,function(e,t,n){"use strict";var r,i;function o(e){return Object.values(i).includes(e)}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),function(e){e.Autocorrect="Autocorrect",e.Copywriter="Copywriter",e.AiInsert="AiInsert"}(r||(r={})),function(e){e.Autocorrect="0",e.Copywriter="1",e.AiInsert="2",e.Synonyms="3"}(i||(i={}))},function(e,t,n){"use strict";function r(e,t){return null!==new RegExp(t).exec(e)}n.d(t,"a",(function(){return r}))},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9),i=Object(r.a)("IExtensionPersistedStore")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IUxLanguageDetector")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9),i=Object(r.a)("IAnnouncementsPersistedStore")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9),i=Object(r.a)("IBetaEnrollmentPersistedStore")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var r=n(221);const i=new Set,o=void 0!==e&&e.env&&e.env.AZURE_LOG_LEVEL||void 0;let a;const s=Object(r.a)("azure");s.log=(...e)=>{r.a.log(...e)};const u=["verbose","info","warning","error"];o&&(p(o)?function(e){if(e&&!p(e))throw new Error(`Unknown log level '${e}'. Acceptable values: ${u.join(",")}`);a=e;const t=[];for(const e of i)h(e)&&t.push(e.namespace);r.a.enable(t.join(","))}(o):console.error(`AZURE_LOG_LEVEL set to unknown log level '${o}'; logging is not enabled. Acceptable values: ${u.join(", ")}.`));const c={verbose:400,info:300,warning:200,error:100};function l(e){const t=s.extend(e);return d(s,t),{error:f(t,"error"),warning:f(t,"warning"),info:f(t,"info"),verbose:f(t,"verbose")}}function d(e,t){t.log=(...t)=>{e.log(...t)}}function f(e,t){const n=Object.assign(e.extend(t),{level:t});if(d(e,n),h(n)){const e=r.a.disable();r.a.enable(e+","+n.namespace)}return i.add(n),n}function h(e){return!!(a&&c[e.level]<=c[a])}function p(e){return u.includes(e)}}).call(this,n(123))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),i=n(6),o=n(155);class a{constructor(e){this.equalsTo=e=>{if(!e||this._codesList.length!==e.length)return!1;for(let t=0;t<this._codesList.length;t+=1)if(this._codesList[t].toLocaleLowerCase()!==e[t].toLocaleLowerCase())return!1;return!0},this.add=e=>!this._codesList.includes(e)&&(this._codesList.push(e),!0),this.remove=e=>{const t=this._codesList.indexOf(e);return!(t<0)&&(this._codesList.splice(t,1),!0)},this.moveUp=e=>{const t=this._codesList.indexOf(e);if(t<=0)return!1;const n=this._codesList[t-1];return this._codesList[t-1]=this._codesList[t],this._codesList[t]=n,!0},this.moveDown=e=>{const t=this._codesList.indexOf(e);if(t<0||t===this._codesList.length-1)return!1;const n=this._codesList[t+1];return this._codesList[t+1]=this._codesList[t],this._codesList[t]=n,!0},this.moveToTop=e=>{const t=this._codesList.indexOf(e);if(t<=0)return!1;const n=this._codesList[t];for(let e=t;e>0;e-=1)this._codesList[e]=this._codesList[e-1];return this._codesList[0]=n,!0},this._codesList=e,Object(o.a)(this)}get count(){var e;return null!==(e=this._codesList.length)&&void 0!==e?e:0}get defaultLanguageCode(){return a.getDefaultLanguageCode(this._codesList)}static getDefaultLanguageCode(e){return e&&e.length>0?e[0]:""}get codesList(){return this._codesList||[]}}Object(r.c)([i.observable],a.prototype,"_codesList",void 0),Object(r.c)([i.computed],a.prototype,"count",null),Object(r.c)([i.computed],a.prototype,"defaultLanguageCode",null),Object(r.c)([i.computed],a.prototype,"codesList",null)},,function(e,t,n){"use strict";function r(e){let t=e.parent;for(;null==t?void 0:t.parent;)t=t.parent;return t}n.d(t,"a",(function(){return r}))},,function(e,t,n){"use strict";(function(e){var r=n(457);const i=void 0!==e&&e.env&&e.env.DEBUG||void 0;let o,a=[],s=[];const u=[];i&&l(i);const c=Object.assign((e=>f(e)),{enable:l,enabled:d,disable:function(){const e=o||"";return l(""),e},log:r.a});function l(e){o=e,a=[],s=[];const t=/\*/g,n=e.split(",").map((e=>e.trim().replace(t,".*?")));for(const e of n)e.startsWith("-")?s.push(new RegExp(`^${e.substr(1)}$`)):a.push(new RegExp(`^${e}$`));for(const e of u)e.enabled=d(e.namespace)}function d(e){if(e.endsWith("*"))return!0;for(const t of s)if(t.test(e))return!1;for(const t of a)if(t.test(e))return!0;return!1}function f(e){const t=Object.assign((function(...n){if(!t.enabled)return;n.length>0&&(n[0]=`${e} ${n[0]}`);t.log(...n)}),{enabled:d(e),destroy:h,log:c.log,namespace:e,extend:p});return u.push(t),t}function h(){const e=u.indexOf(this);return e>=0&&(u.splice(e,1),!0)}function p(e){const t=f(`${this.namespace}:${e}`);return t.log=this.log,t}t.a=c}).call(this,n(123))},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2),i=n(40),o=n(11),a=n(7),s=n(47);let u=class extends s.a{constructor(e){super(e)}checkUserInfo(){return!!this.isLoggedIn}};u=Object(r.c)([Object(o.a)(),Object(r.f)(0,Object(a.a)(i.a))],u)},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IDescriptorManager")},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={msRestVersion:"2.7.0",HTTP:"http:",HTTPS:"https:",HTTP_PROXY:"HTTP_PROXY",HTTPS_PROXY:"HTTPS_PROXY",NO_PROXY:"NO_PROXY",ALL_PROXY:"ALL_PROXY",HttpConstants:{HttpVerbs:{PUT:"PUT",GET:"GET",DELETE:"DELETE",POST:"POST",MERGE:"MERGE",HEAD:"HEAD",PATCH:"PATCH"},StatusCodes:{TooManyRequests:429}},HeaderConstants:{AUTHORIZATION:"authorization",AUTHORIZATION_SCHEME:"Bearer",RETRY_AFTER:"Retry-After",USER_AGENT:"User-Agent"}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),i=n(11),o=n(7),a=n(26),s=n(40),u=n(47);let c=class extends u.a{constructor(e){super(e)}checkUserInfo(){return void 0===this.ageGroup||this.ageGroup===a.a.Adult||this.ageGroup===a.a.MinorNoParentalConsentRequired||this.ageGroup===a.a.Unknown}};c=Object(r.c)([Object(i.a)(),Object(r.f)(0,Object(o.a)(s.a))],c)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),i=n(11),o=n(7),a=n(26),s=n(40),u=n(47);let c=class extends u.a{constructor(e){super(e)}checkUserInfo(){return this.ageGroup===a.a.NotAdult}};c=Object(r.c)([Object(i.a)(),Object(r.f)(0,Object(o.a)(s.a))],c)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),i=n(11),o=n(7),a=n(26),s=n(40),u=n(47);let c=class extends u.a{constructor(e){super(e)}checkUserInfo(){return this.ageGroup===a.a.MinorWithoutParentalConsent||this.ageGroup===a.a.MinorWithParentalConsent}};c=Object(r.c)([Object(i.a)(),Object(r.f)(0,Object(o.a)(s.a))],c)},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(206),i=n(46);class o{static parseToggleValueFromSettingsEvent(e){const t=JSON.parse(JSON.parse(e).value);return this.parseToggleValue(t)}static parseToggleValue(e){const t=e.find((e=>e.id===r.a.Copywriter));return t?t.value===i.f.on.toString():t}}o.debounceTimeout=500,o.indicatorCalloutSize=40,o.defaultLoadingTimeoutMs=15e3,o.intervalDelayMs=100,o.intervalIncrement=1*o.intervalDelayMs/o.defaultLoadingTimeoutMs},function(e,t,n){"use strict";function r(e){return e.toLowerCase()}function i(e){return!(!e||"object"!=typeof e)&&("function"==typeof e.rawHeaders&&"function"==typeof e.clone&&"function"==typeof e.get&&"function"==typeof e.set&&"function"==typeof e.contains&&"function"==typeof e.remove&&"function"==typeof e.headersArray&&"function"==typeof e.headerValues&&"function"==typeof e.headerNames&&"function"==typeof e.toJson)}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var o=function(){function e(e){if(this._headersMap={},e)for(var t in e)this.set(t,e[t])}return e.prototype.set=function(e,t){this._headersMap[r(e)]={name:e,value:t.toString()}},e.prototype.get=function(e){var t=this._headersMap[r(e)];return t?t.value:void 0},e.prototype.contains=function(e){return!!this._headersMap[r(e)]},e.prototype.remove=function(e){var t=this.contains(e);return delete this._headersMap[r(e)],t},e.prototype.rawHeaders=function(){var e={};for(var t in this._headersMap){var n=this._headersMap[t];e[n.name.toLowerCase()]=n.value}return e},e.prototype.headersArray=function(){var e=[];for(var t in this._headersMap)e.push(this._headersMap[t]);return e},e.prototype.headerNames=function(){for(var e=[],t=this.headersArray(),n=0;n<t.length;++n)e.push(t[n].name);return e},e.prototype.headerValues=function(){for(var e=[],t=this.headersArray(),n=0;n<t.length;++n)e.push(t[n].value);return e},e.prototype.toJson=function(){return this.rawHeaders()},e.prototype.toString=function(){return JSON.stringify(this.toJson())},e.prototype.clone=function(){return new e(this.rawHeaders())},e}()},,function(e,t,n){"use strict";function r(e,t,n){const r={};for(const i in n)r[e+"-"+i]=`${t} (${n[i]})`;return r}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));const i=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({"aa-dj":"Qafar (Yabuuti)","aa-er":"Qafar (Eretria)","aa-et":"Qafar (Otobbia)","af-na":"Afrikaans (Namibi)","af-za":"Afrikaans (Suid-Afrika)","agq-cm":"Aghem (Kml)","ak-gh":"Akan (Gaana)","am-et":" ()","ar-001":[" ()",!0],"ar-ae":[" (  )",!0],"ar-bh":[" ()",!0],"ar-dj":[" ()",!0],"ar-dz":[" ()",!0],"ar-eg":[" ()",!0],"ar-er":[" ()",!0],"ar-il":[" ()",!0],"ar-iq":[" ()",!0],"ar-jo":[" ()",!0],"ar-km":[" ( )",!0],"ar-kw":[" ()",!0],"ar-lb":[" ()",!0],"ar-ly":[" ()",!0],"ar-ma":[" ( )",!0],"ar-mr":[" ()",!0],"ar-om":[" ()",!0],"ar-ps":[" ( )",!0],"ar-qa":[" ()",!0],"ar-sa":[" (  )",!0],"ar-sd":[" ()",!0],"ar-so":[" ()",!0],"ar-ss":[" ( )",!0],"ar-sy":[" ()",!0],"ar-td":[" ()",!0],"ar-tn":[" ()",!0],"ar-ye":[" ()",!0],"arn-cl":"Mapudungun (Chile)","as-in":" ()","asa-tz":"Kipare (Tadhania)","ast-es":"asturianu (Espaa)","az-cyrl-az":" ()","az-latn-az":"azrbaycan (Azrbaycan)","ba-ru":" ()","bas-cm":"sa (Kmrn)","be-by":" ()","bem-zm":"Ichibemba (Zambia)","bez-tz":"Hibena (Hutanzania)","bg-bg":" ()","bin-ng":"d (Nigeria)","bm-latn-ml":"bamanakan (Mali)","bn-bd":" ()","bn-in":" ()","bo-cn":" ()","bo-in":" ()","br-fr":"brezhoneg (Fras)","brx-in":" ()","bs-cyrl-ba":" (  )","bs-latn-ba":"bosanski (Bosna i Hercegovina)","byn-er":" ()","ca-ad":"catal (Andorra)","ca-es":"catal (catal)","ca-es-valencia":"valenci (Espanya)","ca-fr":"catal (Frana)","ca-it":"catal (Itlia)","ccp-cakm-bd":" ()","ccp-cakm-in":" ()","ce-ru":" ()","ceb-latn-ph":"Cebuano (Pilipinas)","cgg-ug":"Rukiga (Uganda)","chr-cher-us":" (  )","co-fr":"Corsu (Francia)","cs-cz":"etina (esko)","cu-ru":" ()","cy-gb":"Cymraeg (Y Deyrnas Unedig)","da-dk":"dansk (Danmark)","da-gl":"dansk (Grnland)","dav-ke":"Kitaita (Kenya)"},r("de","Deutsch",{at:"sterreich",be:"Belgien",ch:"Schweiz",de:"Deutschland",it:"Italien",li:"Liechtenstein",lu:"Luxemburg"})),{"dje-ne":"Zarmaciine (Nier)","dsb-de":"dolnoserbina (Nimska)","dua-cm":"dul (Cameroun)","dv-mv":[" ( )",!0],"dyo-sn":"joola (Senegal)","dz-bt":" ()","ebu-ke":"Kembu (Kenya)","ee-gh":"Eegbe (Ghana nutome)","ee-tg":"Eegbe (Togo nutome)","el-cy":" ()","el-gr":" ()"}),r("en","English",{"001":"World","029":"Caribbean",150:"Europe",ae:"United Arab Emirates",ag:"Antigua & Barbuda",ai:"Anguilla",as:"American Samoa",at:"Austria",au:"Australia",bb:"Barbados",be:"Belgium",bi:"Burundi",bm:"Bermuda",bs:"Bahamas",bw:"Botswana",bz:"Belize",ca:"Canada",cc:"Cocos (Keeling) Islands",ch:"Switzerland",ck:"Cook Islands",cm:"Cameroon",cx:"Christmas Island",cy:"Cyprus",de:"Germany",dk:"Denmark",dm:"Dominica",er:"Eritrea",fi:"Finland",fj:"Fiji",fk:"Falkland Islands",fm:"Micronesia",gb:"United Kingdom",gd:"Grenada",gg:"Guernsey",gh:"Ghana",gi:"Gibraltar",gm:"Gambia",gu:"Guam",gy:"Guyana",hk:"Hong Kong SAR",id:"Indonesia",ie:"Ireland",il:"Israel",im:"Isle of Man",in:"India",io:"British Indian Ocean Territory",je:"Jersey",jm:"Jamaica",ke:"Kenya",ki:"Kiribati",kn:"St. Kitts & Nevis",ky:"Cayman Islands",lc:"St. Lucia",lr:"Liberia",ls:"Lesotho",mg:"Madagascar",mh:"Marshall Islands",mo:"Macao SAR",mp:"Northern Mariana Islands",ms:"Montserrat",mt:"Malta",mu:"Mauritius",mw:"Malawi",my:"Malaysia",na:"Namibia",nf:"Norfolk Island",ng:"Nigeria",nl:"Netherlands",nr:"Nauru",nu:"Niue",nz:"New Zealand",pg:"Papua New Guinea",ph:"Philippines",pk:"Pakistan",pn:"Pitcairn Islands",pr:"Puerto Rico",pw:"Palau",rw:"Rwanda",sb:"Solomon Islands",sc:"Seychelles",sd:"Sudan",se:"Sweden",sg:"Singapore",sh:"St Helena, Ascension, Tristan da Cunha",si:"Slovenia",sl:"Sierra Leone",ss:"South Sudan",sx:"Sint Maarten",sz:"Eswatini",tc:"Turks & Caicos Islands",tk:"Tokelau",to:"Tonga",tt:"Trinidad & Tobago",tv:"Tuvalu",tz:"Tanzania",ug:"Uganda",um:"U.S. Outlying Islands",us:"United States",vc:"St. Vincent & Grenadines",vg:"British Virgin Islands",vi:"U.S. Virgin Islands",vu:"Vanuatu",ws:"Samoa",za:"South Africa",zm:"Zambia",zw:"Zimbabwe"})),{"eo-001":"esperanto (Mondo)"}),r("es","espaol",{419:"Latinoamrica",ar:"Argentina",bo:"Bolivia",br:"Brasil",bz:"Belice",cl:"Chile",co:"Colombia",cr:"Costa Rica",cu:"Cuba",do:"Repblica Dominicana",ec:"Ecuador",es:"Espaa, alfabetizacin internacional",es_tradnl:"Espaa, alfabetizacin tradicional",gq:"Guinea Ecuatorial",gt:"Guatemala",hn:"Honduras",mx:"Mxico",ni:"Nicaragua",pa:"Panam",pe:"Per",ph:"Filipinas",pr:"Puerto Rico",py:"Paraguay",sv:"El Salvador",us:"Estados Unidos",uy:"Uruguay",ve:"Venezuela"})),{"et-ee":"eesti (Eesti)","eu-es":"euskara (euskara)","ewo-cm":"ewondo (Kamrn)","fa-ir":[" ()",!0]}),r("ff-latn","Pulaar",{bf:"Burkibaa Faaso",cm:"Kameruun",gh:"Ganaa",gm:"Gammbi",gn:"Gine",gw:"Gine-Bisaawo",lr:"Liberiyaa",mr:"Muritani",ne:"Nijeer",ng:"Nijeriyaa",sl:"Seraa liyon",sn:"Senegaal"})),{"fi-fi":"suomi (Suomi)","fil-ph":"Filipino (Pilipinas)","fo-dk":"froyskt (Danmark)","fo-fo":"froyskt (Froyar)"}),r("fr","franais",{"029":"carabes",be:"Belgique",bf:"Burkina Faso",bi:"Burundi",bj:"Bnin",bl:"Saint-Barthlemy",ca:"Canada",cd:"Congo, Rpublique dmocratique du",cf:"Rpublique centrafricaine",cg:"Congo",ch:"Suisse",ci:"Cte dIvoire",cm:"Cameroun",dj:"Djibouti",dz:"Algrie",fr:"France",ga:"Gabon",gf:"Guyane franaise",gn:"Guine",gp:"Guadeloupe",gq:"Guine quatoriale",ht:"Hati",km:"Comores",lu:"Luxembourg",ma:"Maroc",mc:"Monaco",mf:"Saint-Martin",mg:"Madagascar",ml:"Mali",mq:"Martinique",mr:"Mauritanie",mu:"Maurice",nc:"Nouvelle-Caldonie",ne:"Niger",pf:"Polynsie franaise",pm:"Saint-Pierre-et-Miquelon",re:"La Runion",rw:"Rwanda",sc:"Seychelles",sn:"Sngal",sy:"Syrie",td:"Tchad",tg:"Togo",tn:"Tunisie",vu:"Vanuatu",wf:"Wallis-et-Futuna",yt:"Mayotte"})),{"fur-it":"furlan (Italie)","fy-nl":"Frysk (Nederln)","ga-ie":"Gaeilge (ire)","gd-gb":"Gidhlig (An Roghachd Aonaichte)","gl-es":"galego (galego)","gn-py":"Avae (Paragui)","gsw-ch":"Schwiizerttsch (Schwiiz)","gsw-fr":"Elsssisch (Frnkrisch)","gsw-li":"Schwiizerttsch (Lichteschti)","gu-in":" ()","guz-ke":"Ekegusii (Kenya)","gv-im":"Gaelg (Ellan Vannin)","ha-latn-gh":"Hausa (Gana)","ha-latn-ne":"Hausa (Nijar)","ha-latn-ng":"Hausa (Najeriya)","haw-us":"lelo Hawaii (Amelika Hui P Ia)","he-il":[" ()",!0],"hi-in":" ()","hr-ba":"hrvatski (Bosna i Hercegovina)","hr-hr":"hrvatski (Hrvatska)","hsb-de":"hornjoserbina (Nmska)","hu-hu":"magyar (Magyarorszg)","hy-am":" ()","ia-001":"interlingua (Mundo)","ibb-ng":"Ibibio-Efik (Nigeria)","id-id":"Indonesia (Indonesia)","ig-ng":"Ass Igbo (Najra)","ii-cn":" ()","is-is":"slenska (sland)","it-ch":"italiano (Svizzera)","it-it":"italiano (Italia)","it-sm":"italiano (San Marino)","it-va":"italiano (Citt del Vaticano)","iu-cans-ca":" ()","iu-latn-ca":"Inuktitut (Kanatami)","ja-jp":" ()","jgo-cm":"Ndaa (Kamln)","jmc-tz":"Kimachame (Tanzania)","jv-java-id":" (Indonesia)","jv-latn-id":"Basa Jawa (Indonesia)","ka-ge":" ()","kab-dz":"Taqbaylit (Lezzayer)","kam-ke":"Kikamba (Kenya)","kde-tz":"Chimakonde (Tanzania)","kea-cv":"kabuverdianu (Kabu Verdi)","khq-ml":"Koyra ciini (Maali)","ki-ke":"Gikuyu (Kenya)","kk-kz":"  ()","kkj-cm":"kak (Kamrun)","kl-gl":"kalaallisut (Kalaallit Nunaat)","kln-ke":"Kalenjin (Emetab Kenya)","km-kh":" ()","kn-in":" ()","ko-kp":" ()","ko-kr":"()","kok-in":" ()","kr-latn-ng":"Kanuri (Nigeria)","ks-arab-in":" ()","ks-deva-in":"","ksb-tz":"Kishambaa (Tanzania)","ksf-cm":"rikpa (kamrn)","ksh-de":"Klsch (Dotschland)","ku-arab-iq":["  ()",!0],"ku-arab-ir":" ()","kw-gb":"kernewek (Rywvaneth Unys)","ky-kg":" ()","la-001":"lingua latna (World)","lag-tz":"Klaangi (Taansana)","lb-lu":"Ltzebuergesch (Ltzebuerg)","lg-ug":"Luganda (Yuganda)","lkt-us":"Lakliyapi (Mlahaska Tamkohe)","ln-ao":"lingla (Angla)","ln-cd":"lingla (Republki ya Kong Demokratki)","ln-cf":"lingla (Repibiki ya Afrka ya Kti)","ln-cg":"lingla (Kongo)","lo-la":" ()","lrc-iq":"  (Iraq)","lrc-ir":"  (Iran)","lt-lt":"lietuvi (Lietuva)","lu-cd":"Tshiluba (Ditunga wa Kongu)","luo-ke":"Dholuo (Kenya)","luy-ke":"Luluhia (Kenya)","lv-lv":"latvieu (Latvija)","mas-ke":"Maa (Kenya)","mas-tz":"Maa (Tansania)","mer-ke":"Kmr (Kenya)","mfe-mu":"kreol morisien (Moris)","mg-mg":"Malagasy (Madagasikara)","mgh-mz":"Makua (Umozambiki)","mgo-cm":"meta (Kamalun)","mi-nz":"te reo Mori (Aotearoa)","mk-mk":" ( )","ml-in":" ()","mn-mn":" ()","mn-mong-cn":"  (    )","mn-mong-mn":"  ( )","mni-in":" (India)","moh-ca":"Kanien'kha","mr-in":" ()","ms-bn":"Melayu (Brunei)","ms-my":"Melayu (Malaysia)","ms-sg":"Melayu (Singapura)","mt-mt":"Malti (Malta)","mua-cm":"MUNDA (kameru)","my-mm":" ()","mzn-ir":" ()","naq-na":"Khoekhoegowab (Namibiab)","nb-no":"norsk bokml (Norge)","nb-sj":"norsk bokml (Svalbard og Jan Mayen)","nd-zw":"isiNdebele (Zimbabwe)","nds-de":"Neddersasssch (Dtschland)","nds-nl":"Neddersasssch (Nedderlannen)","ne-in":" ()","ne-np":" ()"}),r("nl","Nederlands",{aw:"Aruba",be:"Belgi",bq:"Bonaire, Sint Eustatius en Saba",cw:"Curaao",nl:"Nederland",sr:"Suriname",sx:"Sint-Maarten"})),{"nmg-cm":"Kwasio (Kamerun)","nn-no":"nynorsk (Noreg)","nnh-cm":"Shw ngiembn (Kmalm)","nqo-gn":[" ( )",!0],"nr-za":"isiNdebele (South Africa)","nso-za":"Sesotho sa Leboa (Afrika Borwa)","nus-ss":"Thok Nath (South Sudan)","nyn-ug":"Runyankore (Uganda)","oc-fr":"Occitan (Frana)","om-et":"Oromoo (Itoophiyaa)","om-ke":"Oromoo (Keeniyaa)","or-in":" ()","os-ge":" ()","os-ru":" ()","pa-arab-pk":[" ()",!0],"pa-in":" ()","pap-029":"Papiamentu (Caribbean)","pl-pl":"polski (Polska)","prg-001":"prsiskan (swtai)","prs-af":[" ()",!0],"ps-af":[" ()",!0],"ps-pk":[" ()",!0]}),r("pt","portugus",{ao:"Angola",br:"Brasil",ch:"Sua",cv:"Cabo Verde",gq:"Guin Equatorial",gw:"Guin-Bissau",lu:"Luxemburgo",mo:"RAE de Macau",mz:"Moambique",pt:"Portugal",st:"So Tom e Prncipe",tl:"Timor-Leste"})),{"qps-latn-x-sh":"P Sfh","qps-ploc":"[ () !!! !!]","qps-ploca":"[  ( ) !!! !!! ]","qps-plocm":["[  ( ) !!! !!! !]",!0],"quc-latn-gt":"K'iche' (Guatemala)","quz-bo":"Runasimi (Bolivia)","quz-ec":"Runasimi (Ecuador)","quz-pe":"Runasimi (Per)","rm-ch":"rumantsch (Svizra)","rn-bi":"Ikirundi (Uburundi)","ro-md":"romn (Republica Moldova)","ro-ro":"romn (Romnia)","rof-tz":"Kihorombo (Tanzania)"}),r("ru","",{by:"",kg:"",kz:"",md:"",ru:"",ua:""})),{"rw-rw":"Kinyarwanda (U Rwanda)","rwk-tz":"Kiruwa (Tanzania)","sa-in":" ()","sah-ru":" ()","saq-ke":"Kisampur (Kenya)","sbp-tz":"Ishisangu (Tansaniya)","sd-arab-pk":[" ()",!0],"sd-deva-in":" (India)","se-fi":"davvismegiella (Suopma)","se-no":"davvismegiella (Norga)","se-se":"davvismegiella (Ruoa)","seh-mz":"sena (Moambique)","ses-ml":"Koyraboro senni (Maali)","sg-cf":"Sng (Kdrsse t Bafrka)","shi-latn-ma":"Tasheliyt (lmrib)","shi-tfng-ma":" ()","si-lk":" ( )","sk-sk":"slovenina (Slovensko)","sl-si":"slovenina (Slovenija)","sma-no":"arjelsaemiengele (Nrje)","sma-se":"arjelsaemiengele (Sveerje)","smj-no":"julevusmegiella (Vuodna)","smj-se":"julevusmegiella (Svierik)","smn-fi":"anarkiel (Suom)","sms-fi":"smill (Lddjnnam)","sn-latn-zw":"chiShona (Zimbabwe)"}),r("so","Soomaali",{dj:"Jabuuti",et:"Itoobiya",ke:"Kenya",so:"Soomaaliya"})),{"sq-al":"shqip (Shqipri)","sq-mk":"shqip (Maqedonia e Veriut)","sq-xk":"shqip (Kosov)"}),r("sr-cyrl","",{ba:"  ",cs:"    ()",me:" ",rs:"",xk:""})),r("sr-latn","srpski",{ba:"Bosna i Hercegovina",cs:"Srbija i Crna Gora (Biva)",me:"Crna Gora",rs:"Srbija",xk:"Kosovo"})),{"ss-sz":"siSwati (eSwatini)","ss-za":"siSwati (South Africa)","ssy-er":"Saho (Eretria)","st-ls":"Sesotho (Lesotho)","st-za":"Sesotho (South Africa)","sv-ax":"svenska (land)","sv-fi":"svenska (Finland)","sv-se":"svenska (Sverige)"}),r("sw","Kiswahili",{cd:"Jamhuri ya Kidemokrasia ya Kongo",ke:"Kenya",tz:"Tanzania",ug:"Uganda"})),{"syr-sy":[" ()",!0],"ta-in":" ()","ta-lk":" ()","ta-my":" ()","ta-sg":" ()","te-in":" ()","teo-ke":"Kiteso (Kenia)","teo-ug":"Kiteso (Uganda)","tg-cyrl-tj":" ()","th-th":" ()","ti-er":" ()","ti-et":" ()","tig-er":" ()","tk-tm":"Trkmen dili (Trkmenistan)","tn-bw":"Setswana (Botswana)","tn-za":"Setswana (Aforika Borwa)","to-to":"lea fakatonga (Tonga)","tr-cy":"Trke (Kbrs)","tr-tr":"Trke (Trkiye)","ts-za":"Xitsonga (South Africa)","tt-ru":" ()","twq-ne":"Tasawaq senni (Nier)","tzm-arab-ma":["   (Morocco)",!0],"tzm-latn-dz":"Tamazit n lala (Djazar)","tzm-latn-ma":"Tamazit n lala (Meuk)","tzm-tfng-ma":" ()","ug-cn":[" (  )",!0],"uk-ua":" ()","ur-in":[" ()",!0],"ur-pk":[" ()",!0],"uz-arab-af":" ()","uz-cyrl-uz":" ()","uz-latn-uz":"ozbek (Ozbekiston)","vai-latn-lr":"Vai (Laibhiya)","vai-vaii-lr":" ()","ve-za":"Tshivena (South Africa)","vi-vn":"Ting Vit (Vit Nam)","vo-001":"Volapk (World)","vun-tz":"Kyivunjo (Tanzania)","wae-ch":"Walser (Schwiz)","wal-et":" ()","wo-sn":"Wolof (Senegaal)","xh-za":"isiXhosa (eMzantsi Afrika)","xog-ug":"Olusoga (Yuganda)","yav-cm":"nuasue (Kemeln)","yi-001":[" ()",!0],"yo-bj":"d Yorb (Orlde Bn)","yo-ng":"d Yorb (Oril-d Njr)","zgh-tfng-ma":" ()","zh-cn":"()","zh-hk":"()","zh-hans-hk":" ()","zh-hans-mo":" ()","zh-mo":"()","zh-sg":"()","zh-tw":"()","zu-za":"isiZulu (iNingizimu Afrika)"});var o=n(490);const a=(e,t=!1,n)=>{let r;const a=e.toLocaleLowerCase(),s=i[a];if(s&&(r=Array.isArray(s)?{languageId:e,languageName:s[0],isRtl:s[1]}:{languageId:e,languageName:s,isRtl:!1}),!r&&t){const e=o.a[a];if(e){const t=Array.isArray(e)?e[0]:e,n=Array.isArray(e)?e[1]:void 0,o=i[t.toLocaleLowerCase()],a=!!Array.isArray(o)&&o[1],s=Array.isArray(o)?o[0]:o;r={languageId:t,languageName:null!=n?n:s,isRtl:a}}}if(r&&n){const e=r.languageId.toLocaleLowerCase();n.find((t=>t.toLocaleLowerCase()===e))||(r=void 0)}return r},s=e=>{const t=new Map;for(const n of e){if(!n.languageId)continue;const e=a(n.languageId);e&&!t.has(n.languageId)&&t.set(n.languageId,e)}return Array.from(t.values())}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),i=n(11);let o=class{constructor(e,t){this._storeEntryReader=e,this._storeEntryWriter=t,this._storeEntryMap=this.populateStoreEntryMap()}_fetchStoreEntry(e){const t=this._storeEntryMap.get(e);if(!t)throw Error("Cannot find the entry key.");return t}async read(e){const t=this._fetchStoreEntry(e).storeEntry;return this._storeEntryReader.readOrInitialize(t)}async write(e,t){await this._storeEntryWriter.write(this._fetchStoreEntry(e).storeEntry,t)}async getLastUpdatedTimestamp(e){const t=this._fetchStoreEntry(e).storeEntry;return this._storeEntryReader.readLastUpdatedTimestamp(t)}getCachedEntry(e){const t=this._fetchStoreEntry(e),n=t.storeEntry;return{storeEntryValue:void 0===n.lastValueFromStorage?n.defaultValue:n.lastValueFromStorage,isSynced:!!t.isSynced}}getDefaultValue(e){return this._fetchStoreEntry(e).storeEntry.defaultValue}async removePersistentKeys(){}};o=Object(r.c)([Object(i.a)()],o)},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r,i=n(2),o=n(30),a=n(93),s=n(11),u=n(7),c=n(28),l=n(149);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){f(o,r,i,a,s,"next",e)}function s(e){f(o,r,i,a,s,"throw",e)}a(void 0)}))}}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var y,b=r=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_sendMessageStrategy",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"registrations",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"eventNamesUsed",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"_messageDispatcher",{enumerable:!0,configurable:!0,writable:!0,value:function(e,t){var r,i=e;if(i&&i.eventId&&(i.eventId in o.a||i.eventId in c.a)&&i.data){var a=n.safelyGetRegistration(i.eventId);if(void 0!==(null===(r=null==t?void 0:t.tab)||void 0===r?void 0:r.id)){var s=t.frameId?Number("".concat(t.tab.id).concat(t.frameId)):t.tab.id;i.data.forEach((function(e){void 0===e.address?e.address=s:e.address="".concat(s,"/").concat(e.address)}))}var u=!0,l=!1,d=void 0;try{for(var f,h=a.listeners[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){f.value.apply(void 0,g(i.data))}}catch(e){l=!0,d=e}finally{try{u||null==h.return||h.return()}finally{if(l)throw d}}}}}),chrome.runtime.onMessage.addListener(this._messageDispatcher)}var t,n,i;return t=e,n=[{key:"initialize",value:function(){return h((function(){return m(this,(function(e){return[2]}))}))()}},{key:"shutDown",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.eventNamesUsed[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;try{this.off(o)}catch(e){}}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"connectToBackground",value:function(){var e=this,t=chrome.runtime.connect();t.onMessage.addListener((function(t){e._messageDispatcher(t)})),this._sendMessageStrategy.registerPort(t),t.onDisconnect.addListener((function(){return e._messageDispatcher({eventId:c.a.counterpartyDisconnected})}))}},{key:"listenForContentScriptConnections",value:function(e){var t=this;chrome.runtime.onConnect.addListener((function(e){if(e.sender){var n=e.sender;e.onMessage.addListener((function(e){t._messageDispatcher(e,n)})),t._sendMessageStrategy.registerPort(e)}e.onDisconnect.addListener((function(){return t._messageDispatcher({eventId:c.a.counterpartyDisconnected})}))}))}},{key:"on",value:function(e,t){this.safelyGetRegistration(e).listeners.push(t),this.eventNamesUsed.add(e)}},{key:"onFirst",value:function(e,t){var n=this;this.on(e,(function(r){t(r),n.off(e)}))}},{key:"onAny",value:function(e){throw Error("onAny is not implemented for EditorEmitter")}},{key:"waitFor",value:function(e){var t=this;return h((function(){return m(this,(function(n){return[2,new Promise((function(n,i){t.onFirst(e,(function(e){r._onAwaitedMessageReceived(e,n,i)}))}))]}))}))()}},{key:"waitForFirst",value:function(e){return h((function(){return m(this,(function(e){throw Error("waitForFirst is not implemented for EditorEmitter")}))}))()}},{key:"off",value:function(e,t){if(void 0!==e)if(void 0!==t){var n=this.safelyGetRegistration(e);if(!Object(a.b)(n.listeners,t))throw new Error("Tried to remove a non-existent listener for event name '".concat(e,"'."))}else this.registrations[e]=Object(a.a)();else this.registrations={}}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this._sendMessageStrategy.sendMessage({eventId:e,data:n})}},{key:"safelyGetRegistration",value:function(e){return this.registrations[e]||(this.registrations[e]=Object(a.a)()),this.registrations[e]}}],n&&p(t.prototype,n),i&&p(t,i),e}();Object.defineProperty(b,"_onAwaitedMessageReceived",{enumerable:!0,configurable:!0,writable:!0,value:(y=h((function(e,t,n){return m(this,(function(r){return e?(t(e),[2]):(n("received empty envelope from background script"),[2])}))})),function(e,t,n){return y.apply(this,arguments)})}),b=r=Object(i.c)([Object(s.a)(),Object(i.f)(0,Object(u.a)(l.a)),Object(i.e)("design:paramtypes",[Object])],b)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),i=n(11),o=n(104),a=n(34);var s=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"defaultUxLanguage",{enumerable:!0,configurable:!0,writable:!0,value:"en-US"}),Object.defineProperty(this,"editorSpellcheckAttribute",{enumerable:!0,configurable:!0,writable:!0,value:"data-ms-editor"}),Object.defineProperty(this,"completeTileTextUnit",{enumerable:!0,configurable:!0,writable:!0,value:o.e.Sentence}),Object.defineProperty(this,"partialTileTextUnit",{enumerable:!0,configurable:!0,writable:!0,value:o.e.Phrase}),Object.defineProperty(this,"emitRemoval",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"styleObserverIntervalTime",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"styleSampleTime",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"reconcileTileNodeTime",{enumerable:!0,configurable:!0,writable:!0,value:3e3}),Object.defineProperty(this,"enableTileNodeAutoReconciliation",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxSuggestionItemsDisplayNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"maxSuggestionDisplayPerLanguageNumber",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"maxProofingLanguages",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"fabricFontsDefinitionPath",{enumerable:!0,configurable:!0,writable:!0,value:"fonts/fabric-icons.css"}),Object.defineProperty(this,"ocvDialogStylesPath",{enumerable:!0,configurable:!0,writable:!0,value:"./ThirdPartyIP/node_modules/@ms-ofb/officebrowserfeedback/styles/officebrowserfeedback.min.css"}),Object.defineProperty(this,"ocvI18nFolderPath",{enumerable:!0,configurable:!0,writable:!0,value:"./ThirdPartyIP/node_modules/@ms-ofb/officebrowserfeedback/intl/"}),Object.defineProperty(this,"ocvAppId",{enumerable:!0,configurable:!0,writable:!0,value:2376}),Object.defineProperty(this,"ocvCustomFeedbackCampaignId",{enumerable:!0,configurable:!0,writable:!0,value:"8b4194ea-e8a3-4d5d-b682-9b49ba66b3c9"}),Object.defineProperty(this,"fpsCampaignId",{enumerable:!0,configurable:!0,writable:!0,value:"4639118f-eccc-4384-91ae-619d37d91dd2"}),Object.defineProperty(this,"aiInsertFeedbackSurveyId",{enumerable:!0,configurable:!0,writable:!0,value:"01eb09b6-789e-42a7-b56b-2b57e6cf61c9"}),Object.defineProperty(this,"aiInsertReportSurveyId",{enumerable:!0,configurable:!0,writable:!0,value:"160b7fa6-cdfb-42bc-8fa9-982674e4fce1"}),Object.defineProperty(this,"editorIconForAnnouncementPath",{enumerable:!0,configurable:!0,writable:!0,value:"assets/icon_48.png"}),Object.defineProperty(this,"editorIconForNotificationPath",{enumerable:!0,configurable:!0,writable:!0,value:"assets/icon_20.png"}),Object.defineProperty(this,"editorSparkleIconForNotificationPath",{enumerable:!0,configurable:!0,writable:!0,value:"assets/icon_sparkle_70.png"}),Object.defineProperty(this,"enableSplitSuggestionButton",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"narrowOnChangeReconciliation",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"schedulerDefaultWaitingTime",{enumerable:!0,configurable:!0,writable:!0,value:50}),Object.defineProperty(this,"schedulerDefaultMaxTime",{enumerable:!0,configurable:!0,writable:!0,value:2e3}),Object.defineProperty(this,"schedulerDefaultWaitingTimeIncrement",{enumerable:!0,configurable:!0,writable:!0,value:400}),Object.defineProperty(this,"maxServiceContentLengthInChars",{enumerable:!0,configurable:!0,writable:!0,value:350}),Object.defineProperty(this,"maxContentLengthInChars",{enumerable:!0,configurable:!0,writable:!0,value:2e4}),Object.defineProperty(this,"rateExtensionChromePageUrl",{enumerable:!0,configurable:!0,writable:!0,value:"https://aka.ms/editorbxchrome"}),Object.defineProperty(this,"rateExtensionEdgePageUrl",{enumerable:!0,configurable:!0,writable:!0,value:"https://aka.ms/editorbxedge"}),Object.defineProperty(this,"extensionFeedbackPageUrl",{enumerable:!0,configurable:!0,writable:!0,value:"https://aka.ms/editorbxuservoice"}),Object.defineProperty(this,"logGroupName",{enumerable:!0,configurable:!0,writable:!0,value:"EditorBx"}),Object.defineProperty(this,"tenant",{enumerable:!0,configurable:!0,writable:!0,value:{tenantName:"NaturalLanguage",ariaTenantToken:"71cc1046851042108843d90e5d3ef6c1-61e5de5c-238c-4de5-95de-3b40d20ea6e5-6899",nexusTenantToken:1733}}),Object.defineProperty(this,"defaultEventName",{enumerable:!0,configurable:!0,writable:!0,value:a.b.Diagnostics}),Object.defineProperty(this,"logToConsole",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"logToKusto",{enumerable:!0,configurable:!0,writable:!0,value:!0})};s=Object(r.c)([Object(i.a)()],s)},function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(2),i=n(52),o=n(26),a=n(174),s=n(74),u=n(40),c=n(270),l=n(11),d=n(7),f=n(189);function h(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){h(o,r,i,a,s,"next",e)}function s(e){h(o,r,i,a,s,"throw",e)}a(void 0)}))}}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var y=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"featureFlagsReader",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"userInfoStrategy",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"showOptionsButton",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"showCalloutBranding",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"appId",{enumerable:!0,configurable:!0,writable:!0,value:"EditorBX_Online"}),Object.defineProperty(this,"defaultLocale",{enumerable:!0,configurable:!0,writable:!0,value:"en-US"}),Object.defineProperty(this,"controlIconSetName",{enumerable:!0,configurable:!0,writable:!0,value:"FabricMDL2Icons"}),Object.defineProperty(this,"editorEndPoint",{enumerable:!0,configurable:!0,writable:!0,value:c.a.Prod}),Object.defineProperty(this,"synonymsEndPoint",{enumerable:!0,configurable:!0,writable:!0,value:c.b.Prod}),Object.defineProperty(this,"userId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sessionType",{enumerable:!0,configurable:!0,writable:!0,value:i.b.Extension}),Object.defineProperty(this,"showSquiggleTooltip",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"licenseType",{enumerable:!0,configurable:!0,writable:!0,value:o.c.Subscription}),Object.defineProperty(this,"enableCaretPositionRestore",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"upsellLink",{enumerable:!0,configurable:!0,writable:!0,value:"https://aka.ms/editorupsell/sbx/control"}),Object.defineProperty(this,"manageRtlInEditorUx",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"manageRtlForProofingLanguage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"sdkV2Enabled",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"ignoreAllEnabled",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"ignoreOnceEnabled",{enumerable:!0,configurable:!0,writable:!0,value:!0});var r=this;Object.defineProperty(this,"orchestratorSettings",{enumerable:!0,configurable:!0,writable:!0,value:{enableAugLoop:!0,augLoopEndpoint:"Production"===this.hostMetadata.releaseAudienceGroup?a.a.Prod:a.a.Dogfood,augLoopAuthTokenCallback:p((function(){var e;return m(this,(function(t){switch(t.label){case 0:return[4,r.userInfoStrategy.executeAsync(!0)];case 1:return(null==(e=t.sent())?void 0:e.augLoopToken)&&!Object(f.a)(e.augLoopToken.expiresOn.valueOf())?[2,e.augLoopToken.accessToken]:[2,void 0]}}))}))}}),Object.defineProperty(this,"enableRoamingDictionary",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"maxSuggestionItemsDisplayNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"maxSuggestionDisplayPerLanguageNumber",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"newLineSentenceSeparatorEnabled",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"wordCountDetectorEnabled",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"enableStopCheckingForThis",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"isMultilingualProofingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"undoCardShowEditorLogo",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"brandingMode",{enumerable:!0,configurable:!0,writable:!0,value:1})}var t,n,r;return t=e,(n=[{key:"enableOptimizedCallingPattern",get:function(){return this.featureFlagsReader.flags.enableOptimizedCallingPattern}},{key:"enableOrchestration",get:function(){return this.featureFlagsReader.flags.enableOrchestration}},{key:"enableE2eMetric",get:function(){return this.featureFlagsReader.flags.enableE2eMetric}},{key:"enableKeptMetric",get:function(){return this.featureFlagsReader.flags.enableKeptMetric}},{key:"enableV2RoamingDictionary",get:function(){return this.featureFlagsReader.flags.enableV2RoamingDictionary}},{key:"enableRoamingService",get:function(){return this.featureFlagsReader.flags.enableRoamingService}},{key:"enhancedUpsellEnabled",get:function(){return this.featureFlagsReader.flags.enableEnhancedUpsell}},{key:"premiumPreviewEnabled",get:function(){return this.featureFlagsReader.flags.enablePremiumPreview}},{key:"inferenceCritiqueCloudIconEnabled",get:function(){return this.featureFlagsReader.flags.inferenceCritiqueCloudIconEnabled}},{key:"enableUpsellFeature",get:function(){return this.featureFlagsReader.flags.enableUpsellFeature}},{key:"enableTargetedUpsell",get:function(){return this.featureFlagsReader.flags.enableTargetedUpsell}},{key:"enableAutoCorrect",get:function(){return this.featureFlagsReader.flags.enableAutoCorrect}},{key:"enablePersonalizedAutoCorrect",get:function(){return this.featureFlagsReader.flags.enablePersonalizedAutoCorrect}},{key:"hostMetadata",get:function(){return{releaseAudienceGroup:this.featureFlagsReader.flags.isMsitUser?"Microsoft":"Production",appName:"EditorBX",appPlatform:"Online"}}},{key:"disableTileNodeObserver",get:function(){return this.featureFlagsReader.flags.disableTileNodeObserver}},{key:"isCopywriterFeatureFlagEnabled",get:function(){return this.featureFlagsReader.flags.enableCopywriter}},{key:"isAiInsertFeatureFlagEnabled",get:function(){return this.featureFlagsReader.flags.enableAiInsert}},{key:"isSynonymsFeatureFlagEnabled",get:function(){return this.featureFlagsReader.flags.enableSynonyms}}])&&g(t.prototype,n),r&&g(t,r),e}();y=Object(r.c)([Object(l.a)(),Object(r.f)(0,Object(d.a)(s.a)),Object(r.f)(1,Object(d.a)(u.a)),Object(r.e)("design:paramtypes",[Object,Object])],y)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),i=n(11);function o(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function s(e){o(a,r,i,s,u,"next",e)}function u(e){o(a,r,i,s,u,"throw",e)}s(void 0)}))}}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"set",value:function(e){return a((function(){return u(this,(function(t){return[2,chrome.storage.local.set(e)]}))}))()}},{key:"remove",value:function(e){return a((function(){return u(this,(function(t){return[2,chrome.storage.local.remove(e)]}))}))()}},{key:"get",value:function(e){return a((function(){return u(this,(function(t){return[2,chrome.storage.local.get(e)]}))}))()}},{key:"addChangeListener",value:function(e){chrome.storage.onChanged.addListener(e)}},{key:"removeEventListener",value:function(e){chrome.storage.onChanged.removeListener(e)}},{key:"initialize",value:function(){return a((function(){return u(this,(function(e){return[2]}))}))()}},{key:"shutDown",value:function(){}}])&&s(t.prototype,n),r&&s(t,r),e}();c=Object(r.c)([Object(i.a)()],c)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(150);async function i(e,t,n,i,o,a,s,u,c,l){var d;let f;if(f=l||await Object(r.a)(e,t),!f)throw new Error("Web Service was not created");const h={hostApplication:n,hostVersion:i,hostPlatform:o,hostCulture:a,correlationId:s,settingIds:u},p=await f.read(h);if(!p.response)throw new Error(`No response from service, correlationId: ${s}`);if(p.response.isFaulted)throw new Error(`Got fault in response. ResultCode: ${p.response.resultCode}. ErrorMessage: ${null===(d=p.response.fault)||void 0===d?void 0:d.errorMessage}, correlationId: ${s}`);return u.reduce(((e,t)=>{var n;return e.set(t,null!==(n=p.response.settingValueMap.get(t))&&void 0!==n?n:""),e}),new Map)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(150);async function i(e,t,n,r,i,o,s,u,c,l,d){return a(e,t,{hostApplication:r,hostVersion:i,hostPlatform:o,hostCulture:s,correlationId:u,settingId:c,isDictionaryItem:!1,value:`"${n}"`},l,d)}async function o(e,t,n,r,i,o,s,u,c,l,d){return a(e,t,{hostApplication:r,hostVersion:i,hostPlatform:o,hostCulture:s,correlationId:u,settingId:c,isDictionaryItem:!0,value:JSON.stringify(n)},l,d)}async function a(e,t,n,i,o){var a,s;const u=null!=o?o:await Object(r.a)(e,t),c=await u.write(n);if(!c.response)throw new Error(`No response received, correlationID: ${n.correlationId}`);if(c.response.isFaulted)throw new Error(`Received fault when writing setting. ResultCode: ${c.response.resultCode}, ErrorCode: ${null===(a=c.response.fault)||void 0===a?void 0:a.errorCode}, ErrorMessage: ${null===(s=c.response.fault)||void 0===s?void 0:s.errorMessage}, correlationID: ${n.correlationId}`)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return ae}));var r=n(2),i=n(11),o=n(32);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function u(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(o,e);var t,n,r,i=l(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.apply(this,arguments)}return t=o,r=[{key:"websiteUrlRegexes",value:function(){return[this.regexForDomain("facebook.com")]}}],(n=[{key:"nonProveableElements",value:function(){return["reg_email__","reg_passwd__"]}}])&&a(t.prototype,n),r&&a(t,r),o}(o.a);function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function p(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}function g(e,t){return g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},g(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h(e);if(t){var i=h(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}d=Object(r.c)([Object(i.a)()],d);var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(o,e);var t,n,r,i=m(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.apply(this,arguments)}return t=o,r=[{key:"websiteUrlRegexes",value:function(){return[this.regexForDomain("google.com")]}}],(n=[{key:"nonProveableElements",value:function(){return["identifier","ConfirmPasswd"]}}])&&f(t.prototype,n),r&&f(t,r),o}(o.a);function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function w(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}function S(e,t){return S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},S(e,t)}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v(e);if(t){var i=v(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return w(this,n)}}y=Object(r.c)([Object(i.a)()],y);var T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(o,e);var t,n,r,i=_(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.apply(this,arguments)}return t=o,r=[{key:"websiteUrlRegexes",value:function(){return[this.regexForDomain("instagram.com")]}}],(n=[{key:"nonProveableElements",value:function(){return["emailOrPhone"]}}])&&b(t.prototype,n),r&&b(t,r),o}(o.a);function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e){return C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},C(e)}function E(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}function I(e,t){return I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},I(e,t)}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C(e);if(t){var i=C(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return E(this,n)}}T=Object(r.c)([Object(i.a)()],T);var A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(o,e);var t,n,r,i=k(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.apply(this,arguments)}return t=o,r=[{key:"websiteUrlRegexes",value:function(){return[this.regexForDomain("linkedin.com")]}}],(n=[{key:"nonProveableElements",value:function(){return["session_key","session_password","email-address"]}}])&&O(t.prototype,n),r&&O(t,r),o}(o.a);function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e){return N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},N(e)}function j(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}function R(e,t){return R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},R(e,t)}function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=N(e);if(t){var i=N(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return j(this,n)}}A=Object(r.c)([Object(i.a)()],A);var D=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(o,e);var t,n,r,i=x(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.apply(this,arguments)}return t=o,r=[{key:"websiteUrlRegexes",value:function(){return[this.regexForDomain("twitter.com")]}}],(n=[{key:"nonProveableElements",value:function(){return["tel","verfication_code","current_password","new_password","password_confirmation","typedScreenName"]}}])&&P(t.prototype,n),r&&P(t,r),o}(o.a);function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function L(e){return L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},L(e)}function B(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}function F(e,t){return F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},F(e,t)}function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L(e);if(t){var i=L(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return B(this,n)}}D=Object(r.c)([Object(i.a)()],D);var q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F(e,t)}(o,e);var t,n,r,i=U(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.apply(this,arguments)}return t=o,r=[{key:"websiteUrlRegexes",value:function(){return[this.regexForDomain("microsoft.com"),this.regexForDomain("microsoftonline.com")]}}],(n=[{key:"nonProveableElements",value:function(){return["loginfmt","MemberName","VerificationCode"]}}])&&M(t.prototype,n),r&&M(t,r),o}(o.a);function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W(e){return W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},W(e)}function V(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}function G(e,t){return G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},G(e,t)}function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=W(e);if(t){var i=W(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return V(this,n)}}q=Object(r.c)([Object(i.a)()],q);var $=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G(e,t)}(o,e);var t,n,r,i=H(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.apply(this,arguments)}return t=o,r=[{key:"websiteUrlRegexes",value:function(){return[this.regexForDomain("stackoverflow.com")]}}],(n=[{key:"nonProveableElements",value:function(){return["display-name"]}}])&&z(t.prototype,n),r&&z(t,r),o}(o.a);function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function J(e){return J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},J(e)}function Q(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}function Y(e,t){return Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Y(e,t)}function X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=J(e);if(t){var i=J(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Q(this,n)}}$=Object(r.c)([Object(i.a)()],$);var Z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(o,e);var t,n,r,i=X(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.apply(this,arguments)}return t=o,r=[{key:"websiteUrlRegexes",value:function(){return[this.regexForDomain("wordpress.com")]}}],(n=[{key:"nonProveableElements",value:function(){return["usernameOrEmail"]}}])&&K(t.prototype,n),r&&K(t,r),o}(o.a);function ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ne(e){return ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ne(e)}function re(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?ee(e):t;var n}function ie(e,t){return ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ie(e,t)}function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ne(e);if(t){var i=ne(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return re(this,n)}}Z=Object(r.c)([Object(i.a)()],Z);var ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ie(e,t)}(o,e);var t,n,r,i=oe(o);function o(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),e=i.call(this),Object.defineProperty(ee(e),"_activeWebsites",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(ee(e),"_nonProveableElements",{enumerable:!0,configurable:!0,writable:!0,value:void 0});var t=[d,y,T,A,q,$,D,Z];e._activeWebsites=t.filter((function(e){return e.isWebsiteActive()})).map((function(e){return new e}));return e._nonProveableElements=e._activeWebsites.reduce((function(e,t){return e.concat(t.nonProveableElements())}),["login","pass","passwd","password","name","username","email","e-mail","phone","phone-number","phone_number","telephone","tel","firstname","first-name","first_name","lastname","last-name","last_name","middlename","middle-name","middle_name"]),e}return t=o,r=[{key:"websiteUrlRegexes",value:function(){return[".*"]}}],(n=[{key:"nonProveableElements",value:function(){return this._nonProveableElements}}])&&te(t.prototype,n),r&&te(t,r),o}(o.a);ae=Object(r.c)([Object(i.a)(),Object(r.e)("design:paramtypes",[])],ae)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r=new(n(198).a);function i(e){if(!(e instanceof Function))return!1;return!!r.getConstructorMetadata(e).compilerGeneratedMetadata}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"b",(function(){return h})),n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return y}));var r=n(21);function i(e,t){return e?e+"."+t:t}function o(e,t,n,o,a){void 0===a&&(a=4),o&&e.push(Object(r.c)("".concat(i(t,n)),o,a))}function a(e,t,n,o){"boolean"==typeof o&&e.push(Object(r.a)("".concat(i(t,n)),o))}function s(e,t,n,o){"number"==typeof o&&e.push(Object(r.b)("".concat(i(t,n)),o))}var u,c=function(e){var t="Activity.Result",n=[];return s(n,t,"Code",e.code),o(n,t,"Type",e.type),s(n,t,"Tag",e.tag),a(n,t,"IsExpected",e.isExpected),n.push(Object(r.c)("zC.Activity.Result","Office.System.Result")),n},l={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",n=[];return o(n,t,"CV",e.cV),s(n,t,"Duration",e.duration),s(n,t,"Count",e.count),s(n,t,"AggMode",e.aggMode),a(n,t,"Success",e.success),e.result&&n.push.apply(n,c(e.result)),n.push(Object(r.c)("zC.Activity",this.contractName)),n}},d={getFields:function(e){var t="User",n=[];return o(n,t,"PrimaryIdentityHash",e.primaryIdentityHash),o(n,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),o(n,t,"TenantId",e.tenantId,1),o(n,t,"TenantGroup",e.tenantGroup,1),a(n,t,"IsAnonymous",e.isAnonymous),a(n,t,"IsSignedIn",e.isSignedIn),n}};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(u||(u={}));var f,h={getFields:function(e){var t="App",n=[];return o(n,t,"Name",e.name,1),o(n,t,"Platform",e.platform,1),o(n,t,"Version",e.version,1),n}},p={getFields:function(e){var t="Session",n=[];return o(n,t,"Id",e.id,1),o(n,t,"EcsETag",e.ecsETag,1),n}};!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(f||(f={}));var g,m,y={getFields:function(e){var t=[];return o(t,"Release","AudienceGroup",e.audienceGroup,1),t}};!function(e){var t="Copilot";!function(e){e.IsEnabled="IsEnabled",e.IsSeen="IsSeen",e.IsTried="IsTried",e.IsKept="IsKept",e.IsRejected="IsRejected"}(e.FeatureActionType||(e.FeatureActionType={})),function(e){e.ContentGeneration="Content Generation",e.Commanding="Commanding",e.QAandSummaries="QA and Summaries",e.Collaboration="Collaboration",e.Suggestions="Suggestions"}(e.Capability||(e.Capability={})),function(e){e.Chat="Chat",e.Canvas="Canvas"}(e.EntryPoint||(e.EntryPoint={})),function(e){e.Create="Create",e.Command="Command",e.Ask="Ask",e.Summarize="Summarize",e.Share="Share",e.Analyze="Analyze"}(e.Verb||(e.Verb={})),e.getFields=function(e){var n=[];return o(n,t,"FeatureActionType",e.featureActionType),a(n,t,"IsUserInitiated",e.isUserInitiated),o(n,t,"FeatureName",e.featureName),o(n,t,"SubFeatureName",e.subFeatureName),o(n,t,"Capability",e.capability),a(n,t,"IsThumbsUp",e.isThumbsUp),o(n,t,"EntryPoint",e.entryPoint),o(n,t,"Verb",e.verb),o(n,t,"InteractionId",e.interactionId),o(n,t,"ConversationId",e.conversationId),n.push(Object(r.c)("zC.".concat(t),"Office.System.Copilot")),n}}(g||(g={})),function(e){var t="Asha";!function(e){e.Pillar="Pillar",e.Error="Error"}(e.EventType||(e.EventType={})),e.getFields=function(e){var n=[];return o(n,t,"EventType",e.eventType),o(n,t,"Pillar",e.pillar),o(n,t,"Scenario",e.scenario),o(n,t,"Veto",e.veto),o(n,t,"Error",e.error),a(n,t,"InStaging",e.inStaging),a(n,t,"IsSessionEndingError",e.isSessionEndingError),a(n,t,"IsIntentional",e.isIntentional),a(n,t,"IsInternal",e.isInternal),n.push(Object(r.c)("zC.".concat(t),"Office.System.Asha")),n}}(m||(m={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));const r={defaultScope:"Singleton",skipBaseClassChecks:!0};class i{constructor(e){this.container=e}bind(e){return new o(this,this.container.bind(e))}rebind(e){return new o(this,this.container.rebind(e))}unbind(e){try{return this.container.unbind(e),!0}catch(e){return!1}}get(e){return this.container.get(e)}getOptional(e){return this.container.isBound(e)?this.container.get(e):void 0}getAll(e){return this.container.isBound(e)?this.container.getAll(e):[]}isBound(e){return this.container.isBound(e)}createChildContainer(){return new i(this.container.createChild(r))}unbindAll(){this.container.unbindAll()}resolveNew(e){return this.container.resolve(e)}getBindings(){const e=(t=this.container,t._bindingDictionary).getMap();var t;const n=[];for(const[t,r]of e)n.push({token:t,boundServices:r});return n}}class o{constructor(e,t){this.container=e,this.bindingTo=t}to(e){this.bindingTo.to(e)}toSelf(){this.bindingTo.toSelf()}toValue(e){this.bindingTo.toConstantValue(e)}toDynamicValue(e){this.bindingTo.toDynamicValue((()=>e(this.container)))}toFactory(e){this.bindingTo.toFactory((()=>e(this.container)))}toExisting(e){this.bindingTo.toService(e)}toTransient(e){this.bindingTo.to(e).inTransientScope()}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("ILocalizer")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("INodeTraverser")},,,,function(e,t,n){"use strict";var r,i;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e.Int="nleditor.osi.office-int.net",e.Staging="nleditor.osi.officeppe.net",e.Lab="wus-001.nleditor.osi.officeppe.net",e.Prod="nleditor.osi.office.net",e.GCC="nleditor.gcc.osi.office365.us",e.GCCHigh="nleditor.osi.office365.us",e.USDoD="nleditor.osi.apps.mil",e.USNat="nleditor.osi.eaglex.ic.gov",e.USSec="nleditor.osi.microsoft.scloud"}(r||(r={})),function(e){e.Int="editor-thesaurus.northeurope.cloudapp.azure.com:9443",e.Staging="editor-edog-thesaurus.trafficmanager.net:9443",e.Lab="editor-edog-thesaurus.trafficmanager.net:9443",e.Prod="editor-prod-thesaurus.trafficmanager.net:9443",e.GCCModerate="editor-gccm-thesaurus.usgovtrafficmanager.net:9443",e.GCCHigh="editor-trailblazer-thesaurus.usgovtrafficmanager.net:9443",e.USDoD="editor-pathfinder-thesaurus.usgovtrafficmanager.net:9443",e.USNat="editor-usnat-thesaurus.trafficmanager.eaglex.ic.gov:9443",e.USSec="editor-ussec-thesaurus.trafficmanager.microsoft.scloud:9443"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(14),i=n(148),o=Object(i.a)(r.c)},,,function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return d}));var r=n(2),i=n(78),o=n(80),a=n(188);function s(e){const{annotationId:t,typeId:n,traceId:i,priority:s,supportedActions:u,suggestions:c,textInContext:d,start:f,length:h,metadata:p,nodeId:g,tileId:m,categoryTitle:y,isStealth:b,endNode:v,explanationTitle:w,explanationLabel:S,explanation:_,shouldShowMultilingualFre:T,languageId:O,shouldAttemptLanguageDetection:C}=e,E=Object(r.g)(e,["annotationId","typeId","traceId","priority","supportedActions","suggestions","textInContext","start","length","metadata","nodeId","tileId","categoryTitle","isStealth","endNode","explanationTitle","explanationLabel","explanation","shouldShowMultilingualFre","languageId","shouldAttemptLanguageDetection"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t?{annotationId:t}:{}),{typeId:Object(o.d)(n)}),n?{typeIdRaw:n}:{}),i?{traceId:i}:{}),{priority:s,supportedActions:l(u),suggestions:c.map(a.c)}),d?{textInContext:d}:{}),{start:f,length:h}),p?{metadata:p}:{}),g?{nodeId:g}:{}),m?{tileId:m}:{}),y?{categoryTitle:y}:{}),b?{isStealth:b}:{}),v?{endNode:v}:{}),w?{explanationTitle:w}:{}),S?{explanationLabel:S}:{}),_?{explanation:_}:{}),T?{shouldShowMultilingualFre:T}:{}),O?{languageId:O}:{}),C?{shouldAttemptLanguageDetection:C}:{}),E)}function u(e){const{annotationId:t,typeIdRaw:n,traceId:i,priority:o,supportedActions:s,suggestions:u,textInContext:l,start:d,length:f,metadata:h,nodeId:p,tileId:g,categoryTitle:m,isStealth:y,endNode:b,explanationTitle:v,explanationLabel:w,explanation:S,shouldShowMultilingualFre:_,languageId:T,shouldAttemptLanguageDetection:O}=e,C=Object(r.g)(e,["annotationId","typeIdRaw","traceId","priority","supportedActions","suggestions","textInContext","start","length","metadata","nodeId","tileId","categoryTitle","isStealth","endNode","explanationTitle","explanationLabel","explanation","shouldShowMultilingualFre","languageId","shouldAttemptLanguageDetection"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t?{annotationId:t}:{}),n?{typeId:n}:{}),i?{traceId:i}:{}),{priority:o,supportedActions:c(s),suggestions:u.map(a.b)}),l?{textInContext:l}:{}),{start:d,length:f}),h?{metadata:h}:{}),p?{nodeId:p}:{}),g?{tileId:g}:{}),m?{categoryTitle:m}:{}),y?{isStealth:y}:{}),b?{endNode:b}:{}),v?{explanationTitle:v}:{}),w?{explanationLabel:w}:{}),S?{explanation:S}:{}),_?{shouldShowMultilingualFre:_}:{}),T?{languageId:T}:{}),O?{shouldAttemptLanguageDetection:O}:{}),C)}function c(e){let t=0;return e.notificationOnly&&(t|=i.a.NotificationOnly),e.delete&&(t|=i.a.Delete),e.ignore&&(t|=i.a.Ignore),e.ignoreAll&&(t|=i.a.IgnoreAll),e.ignoreCritiqueType&&(t|=i.a.IgnoreCritiqueType),e.addToDictionary&&(t|=i.a.AddToDictionary),e.showDetails&&(t|=i.a.ShowDetails),t}function l(e){return{notificationOnly:!!(e&i.a.NotificationOnly),delete:!!(e&i.a.Delete),ignore:!!(e&i.a.Ignore),ignoreAll:!!(e&i.a.IgnoreAll),ignoreCritiqueType:!!(e&i.a.IgnoreCritiqueType),addToDictionary:!!(e&i.a.AddToDictionary),showDetails:!!(e&i.a.ShowDetails)}}function d(e){return"isFlagCritique"in e}},function(e,t,n){"use strict";function r(e){return e instanceof Error?JSON.stringify(e,["name","message","stack"]):JSON.stringify(e)}n.d(t,"a",(function(){return r}))},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var r=n(2),i=n(52),o=n(97),a=n(9),s=n(11),u=n(7);const c=Object(a.a)("ISafeWindow"),l=1e4;let d=class{constructor(e){this._hostSettings=e,this._clearanceIntervalId=void 0,this._requestedFrames=[],this._requestedIdleFrames=[]}async initialize(){this._hostSettings.enableClearingOfRequestedAnimationFrames&&this.setIntervals()}shutDown(){var e;this._clearanceIntervalId&&(clearInterval(this._clearanceIntervalId),this._clearanceIntervalId=void 0);for(const{id:t,targetWindowRef:n}of this._requestedFrames)null===(e=n.deref())||void 0===e||e.cancelAnimationFrame(t);this._requestedFrames=[]}requestAnimationFrame(e,t=window){const n=Object(o.b)(t)?t:new o.a(t),r=n.deref();if(!r)return-1;const i=r.requestAnimationFrame(e);return this._hostSettings.enableClearingOfRequestedAnimationFrames&&this._requestedFrames.push({id:i,targetWindowRef:n,time:(new Date).getTime()}),i}cancelAnimationFrame(e,t=window){const n=(Object(o.b)(t)?t:new o.a(t)).deref();if(n&&(n.cancelAnimationFrame(e),this._hostSettings.enableClearingOfRequestedAnimationFrames)){const t=this._requestedFrames.findIndex((t=>t.id===e));-1!==t&&this._requestedFrames.splice(t,1)}}requestIdleCallback(e,t,n=window){const r=Object(o.b)(n)?n:new o.a(n),i=r.deref();if(!i)return-1;let a;return a="requestIdleCallback"in i?i.requestIdleCallback(e,{timeout:t}):i.setTimeout(e,t),this._hostSettings.enableClearingOfRequestedAnimationFrames&&this._requestedIdleFrames.push({id:a,targetWindowRef:r,time:(new Date).getTime()}),a}cancelIdleCallback(e,t=window){const n=(Object(o.b)(t)?t:new o.a(t)).deref();n&&("requestIdleCallback"in n?n.cancelIdleCallback(e):n.clearTimeout(e))}setIntervals(){this._clearanceIntervalId=setInterval((()=>{var e;const t=(new Date).getTime();let n=this._requestedFrames.findIndex((({time:e})=>t-e<l)),r=-1===n?this._requestedFrames.splice(0,this._requestedFrames.length):this._requestedFrames.splice(0,n);if(r.length)for(const{id:t,targetWindowRef:n}of r)null===(e=n.deref())||void 0===e||e.cancelAnimationFrame(t);if(n=this._requestedIdleFrames.findIndex((({time:e})=>t-e<l)),r=-1===n?this._requestedIdleFrames.splice(0,this._requestedIdleFrames.length):this._requestedIdleFrames.splice(0,n),r.length)for(const{id:e,targetWindowRef:t}of r){const n=t.deref();n&&("requestIdleCallback"in n?n.cancelIdleCallback(e):n.clearTimeout(e))}}),l)}};d=Object(r.c)([Object(s.a)(),Object(r.f)(0,Object(u.a)(i.a))],d)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(55),i=n(27);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"logUnhandledError",value:function(e,t,n,o){e.logEvent(508055842,n,r.a.Error,o,i.a.SamplingPolicy.CriticalExperimentation,t)}},{key:"addUnhandledExceptionsListeners",value:function(e,t,n){}}],(n=null)&&o(t.prototype,n),a&&o(t,a),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("ILanguageInfoProvider")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IPresentationSettings")},,,function(e,t,n){"use strict";var r,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e.WebSiteProvedOnce="WebSiteProvedOnce",e.ActionCritiqueSettingsChange="ActionCritiqueSettingsChange",e.TonalFRE="TonalFRE",e.ActionInlineSettingChange="ActionInlineSettingChange"}(r||(r={})),function(e){e.MutationError="MutationError",e.UpdateCritiqueException="RunTimeErrors.UpdateCritiqueException"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("INodePoller")},,,,,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Csv=",",e.Ssv=" ",e.Tsv="\t",e.Pipes="|",e.Multi="Multi"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(33);class i{constructor(e){r.a.assign(i,this,e)}static getTypeName(){return"AugLoop_Text_TextTileDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return r.a.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class o{constructor(e){r.a.assign(o,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTileDelta"}static getBaseTypes(){return["AugLoop_Text_TextTileDelta","AugLoop_Core_ItemDelta"]}static typeGuard(e){return r.a.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()}},,,,,function(e,t,n){(function(e,t){var n;!function(n){!function(){var r="object"==typeof t?t:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),i=o(n);function o(e,t){return function(n,r){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}void 0===r.Reflect?r.Reflect=n:i=o(r.Reflect,i),function(t){var n=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,i=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Object.create,s={__proto__:[]}instanceof Array,u=!a&&!s,c={create:a?function(){return ie(Object.create(null))}:s?function(){return ie({__proto__:null})}:function(){return ie({})},has:u?function(e,t){return n.call(e,t)}:function(e,t){return t in e},get:u?function(e,t){return n.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},l=Object.getPrototypeOf(Function),d="object"==typeof e&&e.env&&"true"===e.env.REFLECT_METADATA_USE_MAP_POLYFILL,f=d||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?te():Map,h=d||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?ne():Set,p=new(d||"function"!=typeof WeakMap?re():WeakMap);function g(e,t,n,r){if(M(n)){if(!G(e))throw new TypeError;if(!$(t))throw new TypeError;return C(e,t)}if(!G(e))throw new TypeError;if(!F(t))throw new TypeError;if(!F(r)&&!M(r)&&!L(r))throw new TypeError;return L(r)&&(r=void 0),E(e,t,n=V(n),r)}function m(e,t){function n(n,r){if(!F(n))throw new TypeError;if(!M(r)&&!K(r))throw new TypeError;j(e,t,n,r)}return n}function y(e,t,n,r){if(!F(n))throw new TypeError;return M(r)||(r=V(r)),j(e,t,n,r)}function b(e,t,n){if(!F(t))throw new TypeError;return M(n)||(n=V(n)),k(e,t,n)}function v(e,t,n){if(!F(t))throw new TypeError;return M(n)||(n=V(n)),A(e,t,n)}function w(e,t,n){if(!F(t))throw new TypeError;return M(n)||(n=V(n)),P(e,t,n)}function S(e,t,n){if(!F(t))throw new TypeError;return M(n)||(n=V(n)),N(e,t,n)}function _(e,t){if(!F(e))throw new TypeError;return M(t)||(t=V(t)),R(e,t)}function T(e,t){if(!F(e))throw new TypeError;return M(t)||(t=V(t)),x(e,t)}function O(e,t,n){if(!F(t))throw new TypeError;M(n)||(n=V(n));var r=I(t,n,!1);if(M(r))return!1;if(!r.delete(e))return!1;if(r.size>0)return!0;var i=p.get(t);return i.delete(n),i.size>0||p.delete(t),!0}function C(e,t){for(var n=e.length-1;n>=0;--n){var r=(0,e[n])(t);if(!M(r)&&!L(r)){if(!$(r))throw new TypeError;t=r}}return t}function E(e,t,n,r){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,n,r);if(!M(o)&&!L(o)){if(!F(o))throw new TypeError;r=o}}return r}function I(e,t,n){var r=p.get(e);if(M(r)){if(!n)return;r=new f,p.set(e,r)}var i=r.get(t);if(M(i)){if(!n)return;i=new f,r.set(t,i)}return i}function k(e,t,n){if(A(e,t,n))return!0;var r=ee(t);return!L(r)&&k(e,r,n)}function A(e,t,n){var r=I(t,n,!1);return!M(r)&&z(r.has(e))}function P(e,t,n){if(A(e,t,n))return N(e,t,n);var r=ee(t);return L(r)?void 0:P(e,r,n)}function N(e,t,n){var r=I(t,n,!1);if(!M(r))return r.get(e)}function j(e,t,n,r){I(n,r,!0).set(e,t)}function R(e,t){var n=x(e,t),r=ee(e);if(null===r)return n;var i=R(r,t);if(i.length<=0)return n;if(n.length<=0)return i;for(var o=new h,a=[],s=0,u=n;s<u.length;s++){var c=u[s];o.has(c)||(o.add(c),a.push(c))}for(var l=0,d=i;l<d.length;l++){c=d[l];o.has(c)||(o.add(c),a.push(c))}return a}function x(e,t){var n=[],r=I(e,t,!1);if(M(r))return n;for(var i=Q(r.keys()),o=0;;){var a=X(i);if(!a)return n.length=o,n;var s=Y(a);try{n[o]=s}catch(e){try{Z(i)}finally{throw e}}o++}}function D(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function M(e){return void 0===e}function L(e){return null===e}function B(e){return"symbol"==typeof e}function F(e){return"object"==typeof e?null!==e:"function"==typeof e}function U(e,t){switch(D(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",r=J(e,i);if(void 0!==r){var o=r.call(e,n);if(F(o))throw new TypeError;return o}return q(e,"default"===n?"number":n)}function q(e,t){if("string"===t){var n=e.toString;if(H(n))if(!F(i=n.call(e)))return i;if(H(r=e.valueOf))if(!F(i=r.call(e)))return i}else{var r;if(H(r=e.valueOf))if(!F(i=r.call(e)))return i;var i,o=e.toString;if(H(o))if(!F(i=o.call(e)))return i}throw new TypeError}function z(e){return!!e}function W(e){return""+e}function V(e){var t=U(e,3);return B(t)?t:W(t)}function G(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function H(e){return"function"==typeof e}function $(e){return"function"==typeof e}function K(e){switch(D(e)){case 3:case 4:return!0;default:return!1}}function J(e,t){var n=e[t];if(null!=n){if(!H(n))throw new TypeError;return n}}function Q(e){var t=J(e,o);if(!H(t))throw new TypeError;var n=t.call(e);if(!F(n))throw new TypeError;return n}function Y(e){return e.value}function X(e){var t=e.next();return!t.done&&t}function Z(e){var t=e.return;t&&t.call(e)}function ee(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===l)return t;if(t!==l)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var i=r.constructor;return"function"!=typeof i||i===e?t:i}function te(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[o]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,i)},t.prototype.entries=function(){return new n(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[o]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function i(e,t){return t}function a(e,t){return[e,t]}}function ne(){return function(){function e(){this._map=new f}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[o]=function(){return this.keys()},e}()}function re(){var e=16,t=c.create(),r=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+u()}while(c.has(t,e));return t[e]=!0,e}function o(e,t){if(!n.call(e,r)){if(!t)return;Object.defineProperty(e,r,{value:c.create()})}return e[r]}function a(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function s(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):a(new Uint8Array(e),e):a(new Array(e),e)}function u(){var t=s(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",r=0;r<e;++r){var i=t[r];4!==r&&6!==r&&8!==r||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}}function ie(e){return e.__=void 0,delete e.__,e}t("decorate",g),t("metadata",m),t("defineMetadata",y),t("hasMetadata",b),t("hasOwnMetadata",v),t("getMetadata",w),t("getOwnMetadata",S),t("getMetadataKeys",_),t("getOwnMetadataKeys",T),t("deleteMetadata",O)}(i)}()}(n||(n={}))}).call(this,n(123),n(69))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),i=n(141),o=n(11);let a=class extends i.EventEmitter{constructor(){super(...arguments),this.eventNamesUsed=new Set}async initialize(){}shutDown(){for(const e of this.eventNamesUsed)try{this.off(e)}catch(e){}}on(e,t){super.on(e,t),this.eventNamesUsed.add(e)}off(e,t){try{super.off(e,t)}catch(e){}}};a=Object(r.c)([Object(o.a)()],a)},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Undefined="Undefined",e.Host="Host",e.Authentication="Authentication",e.ExceptionHandling="ExceptionHandling",e.Navigation="Navigation",e.UiRendering="UiRendering",e.FeatureSuppression="FeatureSuppression",e.Acronyms="Acronyms",e.AtAGlance="AtAGlance",e.BxPromo="BxPromo",e.ContentCreation="ContentCreation",e.CritiqueUpsell="CritiqueUpsell",e.WritingAnalytics="WritingAnalytics",e.TableStyles="TableStyles",e.Similarity="Similarity",e.Goals="Goals",e.Feedback="Feedback",e.PremiumSquigglesPreview="PremiumSquigglesPreview",e.Proofing="Proofing",e.EditorScore="EditorScore",e.PremiumPreview="PremiumPreview",e.TonalRewriteFre="TonalRewriteFre",e.WritersUnblock="WritersUnblock",e.AIFeedback="AIFeedback"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2),i=n(11);function o(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,n=[{key:"getUILanguage",value:function(){return chrome.i18n.getUILanguage()}},{key:"getBrowserLanguages",value:function(){return(e=function(){return s(this,(function(e){return[2,chrome.i18n.getAcceptLanguages()]}))},function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function s(e){o(a,r,i,s,u,"next",e)}function u(e){o(a,r,i,s,u,"throw",e)}s(void 0)}))})();var e}}],n&&a(t.prototype,n),r&&a(t,r),e}();u=Object(r.c)([Object(i.a)()],u)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),i=n(437),o=n(11);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"getMessage",value:function(e,t){var n,r=chrome.i18n.getMessage(e);if(!r)return"";var o=[];return void 0!==t&&(o=Array.isArray(t)?t:[t]),(n=i.a).format.apply(n,[r].concat(u(o)))}}])&&s(t.prototype,n),r&&s(t,r),e}();c=Object(r.c)([Object(o.a)()],c)},function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r=n(2),i=n(8),o=n(55),a=n(52),s=n(139),u=n(248),c=n(102),l=n(192),d=n(85),f=n(13),h=n(11),p=n(7);function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){m(o,r,i,a,s,"next",e)}function s(e){m(o,r,i,a,s,"throw",e)}a(void 0)}))}}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function w(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?g(e):t;var n}function S(e,t){return S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},S(e,t)}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v(e);if(t){var i=v(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return w(this,n)}}function T(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(u,e);var t,n,r,a=_(u);function u(e,t,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),o=a.call(this,e,t),Object.defineProperty(g(o),"storeEntryReader",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(g(o),"storeEntryWriter",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(g(o),"_emitter",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(g(o),"_hostSettings",{enumerable:!0,configurable:!0,writable:!0,value:r}),o.write(i.a.AppId,o._hostSettings.appId),o}return t=u,(n=[{key:"populateStoreEntryMap",value:function(){var e=new Map;return e.set(i.a.AppId,{storeEntry:Object(f.d)(i.a.AppId,"EditorBX_Online")}),e.set(i.a.EnableCopilotInsert,{storeEntry:Object(f.d)(i.a.EnableCopilotInsert,!0),isSynced:!0}),e.set(i.a.EnableCopilotRewrite,{storeEntry:Object(f.d)(i.a.EnableCopilotRewrite,!0),isSynced:!0}),e.set(i.a.EnableSpelling,{storeEntry:Object(f.d)(i.a.EnableSpelling,!0),isSynced:!0}),e.set(i.a.EnableGrammar,{storeEntry:Object(f.d)(i.a.EnableGrammar,!0),isSynced:!0}),e.set(i.a.EnableRefinements,{storeEntry:Object(f.d)(i.a.EnableRefinements,!0),isSynced:!0}),e.set(i.a.EnableSynonymsToggle,{storeEntry:Object(f.d)(i.a.EnableSynonymsToggle,!0),isSynced:!0}),e.set(i.a.Descriptors,{storeEntry:Object(f.d)(i.a.Descriptors,JSON.stringify([{name:"FlightIds",value:"Wac-WordEditorServiceSuggestionDescriptionsNoReferenceInformation-Treatment;Wac-WordEditorServiceMultipleGrammarCritiquesPerSentence-Treatment"}]))}),e.set(i.a.ProofingLanguages,{storeEntry:Object(f.d)(i.a.ProofingLanguages,["en-US"])}),e.set(i.a.CritiqueValuePerLanguage,{storeEntry:Object(f.d)(i.a.CritiqueValuePerLanguage,JSON.stringify([]))}),e.set(i.a.DefaultProofingLanguageInitialized,{storeEntry:Object(f.d)(i.a.DefaultProofingLanguageInitialized,!1)}),e.set(i.a.ProofingLanguageListInitialized,{storeEntry:Object(f.d)(i.a.ProofingLanguageListInitialized,!1)}),e.set(i.a.IsLanguageAutoDetectEnabled,{storeEntry:Object(f.d)(i.a.IsLanguageAutoDetectEnabled,!0)}),e.set(i.a.TonalFREAccepted,{storeEntry:Object(f.d)(i.a.TonalFREAccepted,!1)}),e.set(i.a.EnableEditor,{storeEntry:Object(f.d)(i.a.EnableEditor,!0)}),e.set(i.a.EnableTextPrediction,{storeEntry:Object(f.d)(i.a.EnableTextPrediction,!0)}),e.set(i.a.EnableCIQFlags,{storeEntry:Object(f.d)(i.a.EnableCIQFlags,!0)}),e.set(i.a.EnableCIQMenu,{storeEntry:Object(f.d)(i.a.EnableCIQMenu,!0)}),e.set(i.a.OverriddenCritiqueTypeOptions,{storeEntry:Object(f.d)(i.a.OverriddenCritiqueTypeOptions,[])}),e.set(i.a.OverriddenInlineEditingSettings,{storeEntry:Object(f.d)(i.a.OverriddenInlineEditingSettings,[])}),e.set(i.a.PaneOverriddenCritiqueTypeOptions,{storeEntry:Object(f.d)(i.a.PaneOverriddenCritiqueTypeOptions,[])}),e.set(i.a.StealthOverriddenCritiqueTypeOptions,{storeEntry:Object(f.d)(i.a.StealthOverriddenCritiqueTypeOptions,[])}),e.set(i.a.HashedUserDictionary,{storeEntry:Object(f.d)(i.a.HashedUserDictionary,[])}),e.set(i.a.ShowSynonyms,{storeEntry:Object(f.d)(i.a.ShowSynonyms,!1)}),e.set(i.a.DefaultLoggingLevel,{storeEntry:Object(f.c)(i.a.DefaultLoggingLevel,o.a.Info)}),e.set(i.a.EnableTelemetry,{storeEntry:Object(f.d)(i.a.EnableTelemetry,!0),isSynced:!0}),e.set(i.a.DebugMode,{storeEntry:Object(f.c)(i.a.DebugMode,!1)}),e.set(i.a.CritiqueValuePerLanguage,{storeEntry:Object(f.d)(i.a.CritiqueValuePerLanguage,JSON.stringify([]))}),e.set(s.a.AllowedUrls,{storeEntry:Object(f.b)(s.a.AllowedUrls,[".*"])}),e.set(s.a.UserExcludedUrls,{storeEntry:Object(f.d)(s.a.UserExcludedUrls,["https://www.example.com"])}),e.set(i.a.ConfigurationId,{storeEntry:Object(f.b)(i.a.ConfigurationId,"")}),e.set(i.a.ClientId,{storeEntry:Object(f.d)(i.a.ClientId,""),isSynced:!1}),e}},{key:"initialize",value:function(){var e=this;return y((function(){return T(this,(function(t){switch(t.label){case 0:return[4,e.read(i.a.EnableCopilotInsert)];case 1:return t.sent(),[4,e.read(i.a.EnableCopilotRewrite)];case 2:return t.sent(),[4,e.read(i.a.EnableSpelling)];case 3:return t.sent(),[4,e.read(i.a.EnableGrammar)];case 4:return t.sent(),[4,e.read(i.a.EnableRefinements)];case 5:return t.sent(),[4,e.read(i.a.EnableSynonymsToggle)];case 6:return t.sent(),[4,e.read(i.a.EnableTelemetry)];case 7:return t.sent(),[4,e.read(i.a.ConfigurationId)];case 8:return t.sent(),e._emitter.on(i.a.EnableCopilotInsert,y((function(){return T(this,(function(t){switch(t.label){case 0:return[4,e.read(i.a.EnableCopilotInsert)];case 1:return t.sent(),[2]}}))}))),e._emitter.on(i.a.EnableCopilotRewrite,y((function(){return T(this,(function(t){switch(t.label){case 0:return[4,e.read(i.a.EnableCopilotRewrite)];case 1:return t.sent(),[2]}}))}))),e._emitter.on(i.a.EnableSpelling,y((function(){return T(this,(function(t){switch(t.label){case 0:return[4,e.read(i.a.EnableSpelling)];case 1:return t.sent(),[2]}}))}))),e._emitter.on(i.a.EnableGrammar,y((function(){return T(this,(function(t){switch(t.label){case 0:return[4,e.read(i.a.EnableGrammar)];case 1:return t.sent(),[2]}}))}))),e._emitter.on(i.a.EnableRefinements,y((function(){return T(this,(function(t){switch(t.label){case 0:return[4,e.read(i.a.EnableRefinements)];case 1:return t.sent(),[2]}}))}))),e._emitter.on(i.a.EnableTelemetry,y((function(){return T(this,(function(t){switch(t.label){case 0:return[4,e.read(i.a.EnableTelemetry)];case 1:return t.sent(),[2]}}))}))),e._emitter.on(i.a.ConfigurationId,y((function(){return T(this,(function(t){switch(t.label){case 0:return[4,e.read(i.a.ConfigurationId)];case 1:return t.sent(),[2]}}))}))),e._emitter.on(i.a.OverriddenCritiqueTypeOptions,y((function(){return T(this,(function(t){switch(t.label){case 0:return[4,e.read(i.a.OverriddenCritiqueTypeOptions)];case 1:return t.sent(),[2]}}))}))),e._emitter.on(i.a.OverriddenInlineEditingSettings,y((function(){return T(this,(function(t){switch(t.label){case 0:return[4,e.read(i.a.OverriddenInlineEditingSettings)];case 1:return t.sent(),[2]}}))}))),e._emitter.on(i.a.CritiqueValuePerLanguage,y((function(){return T(this,(function(t){switch(t.label){case 0:return[4,e.read(i.a.CritiqueValuePerLanguage)];case 1:return t.sent(),[2]}}))}))),e._emitter.on(i.a.EnableSynonymsToggle,y((function(){return T(this,(function(t){switch(t.label){case 0:return[4,e.read(i.a.EnableSynonymsToggle)];case 1:return t.sent(),[2]}}))}))),e._emitter.on(i.a.ProofingLanguages,y((function(){return T(this,(function(t){switch(t.label){case 0:return[4,e.read(i.a.ProofingLanguages)];case 1:return t.sent(),[2]}}))}))),[2]}}))}))()}},{key:"shutDown",value:function(){}}])&&b(t.prototype,n),r&&b(t,r),u}(u.a);O=Object(r.c)([Object(h.a)(),Object(r.f)(0,Object(p.a)(c.a)),Object(r.f)(1,Object(p.a)(l.a)),Object(r.f)(2,Object(p.a)(d.a)),Object(r.f)(3,Object(p.a)(a.a)),Object(r.e)("design:paramtypes",[Object,Object,Object,Object])],O)},function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var r=n(2),i=n(200),o=n(83),a=n(248),s=n(102),u=n(192),c=n(85),l=n(13),d=n(11),f=n(7),h=n(16);function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){g(o,r,i,a,s,"next",e)}function s(e){g(o,r,i,a,s,"throw",e)}a(void 0)}))}}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}function v(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?p(e):t;var n}function w(e,t){return w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},w(e,t)}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b(e);if(t){var i=b(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v(this,n)}}function _(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(s,e);var t,n,r,a=S(s);function s(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),r=a.call(this,e,t),Object.defineProperty(p(r),"storeEntryReader",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(p(r),"storeEntryWriter",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(p(r),"_emitter",{enumerable:!0,configurable:!0,writable:!0,value:n}),r}return t=s,(n=[{key:"populateStoreEntryMap",value:function(){var e=new Map;return e.set(h.a.CleanupContentScriptOnExtensionDisable,{storeEntry:Object(l.c)(h.a.CleanupContentScriptOnExtensionDisable,!0),isSynced:!1}),e.set(h.a.InjectContentScriptsOnExtensionLoad,{storeEntry:Object(l.d)(h.a.InjectContentScriptsOnExtensionLoad,!0),isSynced:!1}),e.set(h.a.EnableTeachingUiOnPageBoot,{storeEntry:Object(l.b)(h.a.EnableTeachingUiOnPageBoot,!1),isSynced:!1}),e.set(h.a.IsTeachingUiDismissed,{storeEntry:Object(l.d)(h.a.IsTeachingUiDismissed,!1),isSynced:!1}),e.set(h.a.EditorClientState,{storeEntry:Object(l.b)(h.a.EditorClientState,i.a.Undefined),isSynced:!1}),e.set(h.a.EditorClientInitState,{storeEntry:Object(l.d)(h.a.EditorClientInitState,i.a.Undefined),isSynced:!1}),e.set(h.a.EditorPriorityShutdown,{storeEntry:Object(l.d)(h.a.EditorPriorityShutdown,!1),isSynced:!1}),e.set(h.a.WebsitesWithNativeIntegration,{storeEntry:Object(l.b)(h.a.WebsitesWithNativeIntegration,["https://outlook-sdf.live.com/*","https://outlook-sdf.office.com/*","https://outlook-sdf.office365.com/*","https://outlook.live.com/*","https://outlook.office.com/*","https://outlook.office365.com/*","https://www.office.com/*","https://onedrive.live.com/*","https://*.onedrive.live.com/*","https://*.sharepoint.com/:w:/*","https://*.sharepoint-df.com/:w:/*","https://*.sharepoint.com/:p:/*","https://*.sharepoint.com/:x:/*","https://*.sharepoint.com/:o:/*","https://*.loop.microsoft.com/*","https://loop.microsoft.com/*"]),isSynced:!1}),e.set(h.a.ConflictDetected,{storeEntry:Object(l.d)(h.a.ConflictDetected,!1),isSynced:!1}),e.set(h.a.ConflictDetectionAnnouncementDismissed,{storeEntry:Object(l.d)(h.a.ConflictDetectionAnnouncementDismissed,!1),isSynced:!1}),e.set(h.a.FirstInstallVersion,{storeEntry:Object(l.d)(h.a.FirstInstallVersion,""),isSynced:!1}),e.set(h.a.DisabledWebSites,{storeEntry:Object(l.b)(h.a.DisabledWebSites,[]),isSynced:!1}),e.set(h.a.DisabledGrammars,{storeEntry:Object(l.b)(h.a.DisabledGrammars,[]),isSynced:!1}),e.set(h.a.ConflictingElements,{storeEntry:Object(l.b)(h.a.ConflictingElements,[]),isSynced:!1}),e.set(h.a.EvaluationData,{storeEntry:Object(l.b)(h.a.EvaluationData,""),isSynced:!1}),e.set(o.a.CourtesyAttributes,{storeEntry:Object(l.b)(o.a.CourtesyAttributes,["data-gramm"]),isSynced:!1}),e.set(o.a.RootContentMaxLengthInChars,{storeEntry:Object(l.b)(o.a.RootContentMaxLengthInChars,2e3),isSynced:!1}),e.set(h.a.EnableUninstallSurvey,{storeEntry:Object(l.d)(h.a.EnableUninstallSurvey,!1),isSynced:!1}),e}},{key:"initialize",value:function(){var e=this;return m((function(){var t;return _(this,(function(n){switch(n.label){case 0:return[4,e.read(h.a.ConflictingElements)];case 1:return n.sent(),[4,e.read(o.a.CourtesyAttributes)];case 2:return n.sent(),[4,e.read(o.a.RootContentMaxLengthInChars)];case 3:return n.sent(),e._emitter.on(h.a.ConflictingElements,m((function(){return _(this,(function(t){switch(t.label){case 0:return[4,e.read(h.a.ConflictingElements)];case 1:return t.sent(),[2]}}))}))),e._emitter.on(o.a.CourtesyAttributes,m((function(){return _(this,(function(t){switch(t.label){case 0:return[4,e.read(o.a.CourtesyAttributes)];case 1:return t.sent(),[2]}}))}))),e._emitter.on(o.a.RootContentMaxLengthInChars,m((function(){return _(this,(function(t){switch(t.label){case 0:return[4,e.read(o.a.RootContentMaxLengthInChars)];case 1:return t.sent(),[2]}}))}))),t=e.getDefaultValue(h.a.WebsitesWithNativeIntegration),[4,e.write(h.a.WebsitesWithNativeIntegration,t)];case 4:return n.sent(),[2]}}))}))()}},{key:"shutDown",value:function(){}}])&&y(t.prototype,n),r&&y(t,r),s}(a.a);T=Object(r.c)([Object(d.a)(),Object(r.f)(0,Object(f.a)(s.a)),Object(r.f)(1,Object(f.a)(u.a)),Object(r.f)(2,Object(f.a)(c.a)),Object(r.e)("design:paramtypes",[Object,Object,Object])],T)},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),i=n(382),o=n(11),a=n(7),s=n(60),u=n(52);let c=class extends s.a{constructor(e){super(),this.hostSettings=e,this.disablers=[],this.enablers=[!0]}check(){return!this.hostSettings.enableRoamingDictionary&&!this.hostSettings.enableV2RoamingDictionary}getRoamingDictionary(){return this._roamingDictionary}setRoamingDictionary(e){this._roamingDictionary=e}isReady(){return!this.check()&&void 0!==this._roamingDictionary&&this._roamingDictionary.getLoadState()===i.a.LOADED}processCallBackResult(e,t,n){return this._roamingDictionary=n.roamingDictionary,super.processCallBackResult(e,t,n)}};c=Object(r.c)([Object(o.a)(),Object(r.f)(0,Object(a.a)(u.a))],c)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),i=n(11);class o{constructor(e){this._customWindow=e,this._timeouts=new Map,this._intervals=new Map}get targetWindow(){var e;return null!==(e=this._customWindow)&&void 0!==e?e:window}clearTimer(e){const t=this._timeouts.get(e);t&&(this.targetWindow.clearTimeout(t),this._timeouts.delete(e));const n=this._intervals.get(e);n&&(this.targetWindow.clearInterval(n),this._intervals.delete(e))}setInterval(e,t,n){this.clearTimer(e);const r=this.targetWindow.setInterval(t,n);return this._intervals.set(e,r),e}setIntervalWithDelay(e,t,n,r){this.clearTimer(e);const i=this.targetWindow.setTimeout((()=>{t();const r=this.targetWindow.setInterval(t,n);this._intervals.set(e,r)}),r);return this._timeouts.set(e,i),e}setTimeout(e,t,n){this.clearTimer(e);const r=this.targetWindow.setTimeout(t,n);return this._timeouts.set(e,r),e}async initialize(){}shutDown(){for(const e of this._timeouts.values())this.targetWindow.clearTimeout(e);for(const e of this._intervals.values())this.targetWindow.clearInterval(e);this._intervals.clear(),this._timeouts.clear()}}let a=class{constructor(){this._timer=new o}clearTimer(e){this._timer.clearTimer(e)}setInterval(e,t,n){return this._timer.setInterval(e,t,n)}setIntervalWithDelay(e,t,n,r){return this._timer.setIntervalWithDelay(e,t,n,r)}setTimeout(e,t,n){return this._timer.setTimeout(e,t,n)}async initialize(){}shutDown(){this._timer.shutDown()}};a=Object(r.c)([Object(i.a)()],a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(2),i=n(8),o=n(11),a=n(55);const s=(e,t,n,r)=>{const i={eventName:e,tagID:`0x${`00000000${t.toString(16)}`.slice(-8)}`,message:n,data:r};return JSON.stringify(i)};let u=class{async initialize(e){}addCorrelationID(e){console.log(`CorrelationID is: ${e}`)}log(e,t,n,r){this.dispatchLog(null,e,t,n,r)}debug(e,t,n){this.dispatchLog(null,e,a.a.Debug,t,n)}error(e,t,n){this.dispatchLog(null,e,a.a.Error,t,n)}warn(e,t,n){this.dispatchLog(null,e,a.a.Warn,t,n)}info(e,t,n){this.dispatchLog(null,e,a.a.Info,t,n)}logEvent(e,t,n,r,i,o){this.dispatchLog(t,e,n,r,o)}dispatchLog(e,t,n,r,i){switch(n){case a.a.Debug:console.log(s(e,t,r,i));break;case a.a.Error:console.error(s(e,t,r,i));break;case a.a.Info:console.info(s(e,t,r,i));break;case a.a.Warn:console.warn(s(e,t,r,i));break;default:throw new Error("Invalid logging level")}}};u=Object(r.c)([Object(o.a)()],u);var c=n(27),l=n(170),d=n(169),f=n(61),h=n(271),p=n(7);let g=class{constructor(e,t){this._transports=e,this._activityTransport=t,this._debugMode=!1,this._initialized=!1,this._initializing=!1,this._diagosticEventName="GeneralDiagnostics",this.logDiagnostics=(e,t,n,r)=>{this.logActivityBase(this._diagosticEventName,e,t,n,r)},this.logActivity=(e,t,n,r)=>{this.logActivityBase(e,void 0,t,n,r)},this.logActivityBase=(e,t,n,r,i)=>{const o=this.getNewActivity(e,c.a.SamplingPolicy.CriticalExperimentation);t&&(null==o||o.dataFields.push(Object(f.a)("message",t))),n&&(null==o||o.dataFields.push(Object(f.a)("data",JSON.stringify(n)))),r&&(null==o||o.dataFields.push(...r)),o&&(o.success=!0,o.endNow())}}async initialize(e,t,n,r,o){var a;if(!this._initialized){if(!this._initializing)try{this._debugMode=null!==(a=await(null==e?void 0:e.read(i.a.DebugMode)))&&void 0!==a&&a,this._debugMode&&this._transports.push(new u);for(const i of this._transports)await i.initialize(e,n,r,t,o);this._activityTransport&&await this._activityTransport.initialize(e,n,r,t,o)}finally{this._initializing=!1}this._initialized=!0}}addCorrelationID(e){for(const t of this._transports)t.addCorrelationID(e);this._activityTransport&&this._activityTransport.addCorrelationID(e)}log(e,t,n,r){this.logEvent(e,null,t,n,c.a.SamplingPolicy.Measure,r)}info(e,t,n){this.logEvent(e,null,a.a.Info,t,c.a.SamplingPolicy.Measure,n)}warn(e,t,n){this.logEvent(e,null,a.a.Warn,t,c.a.SamplingPolicy.Measure,n)}error(e,t,n){this.logEvent(e,null,a.a.Error,t,c.a.SamplingPolicy.CriticalBusinessImpact,n)}debug(e,t,n){this.logEvent(e,null,a.a.Debug,t,c.a.SamplingPolicy.Diagnostics,n)}logServiceRequest(e,t,n,r,i){for(const o of this._transports)t&&(o.serviceRequestID=t),this.logEvent(e,null,n,r,c.a.SamplingPolicy.Measure,i)}logEvent(e,t,n,r,i,o,s){if(this._initialized&&(this._debugMode||n!==a.a.Debug))for(const a of this._transports)a.logEvent(e,t,n,r,i,o,s)}getNewActivity(e,t,n){return this._initialized&&this._activityTransport?this._activityTransport.getNewActivity(e,t,n):void 0}dispose(){}};g=Object(r.c)([Object(o.a)(),Object(r.f)(0,Object(h.a)(d.a)),Object(r.f)(1,Object(p.a)(l.a))],g)},function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return b}));var r=n(2),i=n(76),o={};function a(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?o[e]?(t.ariaTenantToken&&(o[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(o[e].dnmToken=t.dnmToken)):o[e]=t:Object(i.b)(0,0,(function(){return"Namespace: ".concat(e)}))}function s(e,t){for(var n=e.length;n>0;){var r=e.substr(0,n);if(o[r]){var i=o[r];return t.ariaTenantToken=i.ariaTenantToken,t.dnmToken=i.dnmToken,!0}n=e.lastIndexOf(".",n-1)}return!1}var u=9007199254740991,c=-u,l=98,d=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,f=/^[a-zA-Z0-9_\.]{1,95}$/;function h(e){if(!function(e){if(!e||e.length>l)return!1;return d.test(e)}(e.eventName))throw new Error("Invalid eventName");var t=e.eventContract;if(t){if(t.name&&!p(t.name))throw new Error("Invalid eventContract");g(t.dataFields)}g(e.dataFields)}function p(e){return f.test(e)}function g(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!p(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<c||e>u)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}var m=n(21);function y(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?Object(r.a)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var b=function(){function e(e,t,n){var i,o,a;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(i=this.persistentDataFields).push.apply(i,e.persistentDataFields),this.config=Object(r.a)(Object(r.a)({},e.getConfig()),this.config),(o=this.partAFields).push.apply(o,e.partAFields)),t&&(a=this.persistentDataFields).push.apply(a,t)}return e.prototype.addEventContentType=function(e,t){e.push(Object(m.b)("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=y(e),n=t.telemetryProperties;n.nexusTenantToken=-1;var r=n.ariaTenantToken;if(!r&&(!s(t.eventName,n)&&!r))return void Object(i.b)(0,0,(function(){return"No tenant token: "+e.eventName}));this.sendTelemetryEventInternal(t,1)},e.prototype.sendNonStandardEvent=function(e,t){var n=y(e);this.sendTelemetryEventInternal(n,t)},e.prototype.sendCustomerContent=function(e){var t=y(e),n=t.telemetryProperties,r=n.customerContentVersion;return(!r||r>2)&&(n.customerContentVersion=2),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,n.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=y(e),n=t.telemetryProperties;if(!n.dnmToken&&(!s(t.eventName,n)&&!n.dnmToken))return void Object(i.b)(0,0,(function(){return"No dnm token: "+t.eventName}));this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):Object(i.b)(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void Object(i.a)(0,"SendTelemetryEvent",e)}this.telemetrySinks.forEach((function(n){try{3===t||2===t?n.sendNonStandardEvent&&n.sendNonStandardEvent(e,t):n.sendTelemetryEvent(e)}catch(e){}}))}else Object(i.b)(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var n,r,i;if(e.dataFields&&(null===(i=e.dataFields)||void 0===i||i.unshift(Object(m.c)("OTelJS.Version","4.20.18")),3!==t&&this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.partAFields.length>0){var o=e.eventContract||{name:"",dataFields:[]};(r=o.dataFields).push.apply(r,this.partAFields),e.eventContract=o}this.config.disableValidation||h(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,n=e;t<n.length;t++){var r=n[t],i=r[0],o=r[1];this.sendTelemetryEventInternal(i,o)}},e.prototype.setTenantToken=function(e,t,n){a(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.setDNMToken=function(e,t){a(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return y(e)},e.prototype.getConfig=function(){return this.config},e}()},,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),i=n(11);let o=class{triggerCallback(e,t){t?(this.userInfo=void 0,this.lastError=t):this.lastError=void 0,this.userInfo=e(this.userInfo)}async executeAsync(e=!0){return new Promise(((t,n)=>{this.execute(e,(e=>(this.lastError?n(this.lastError):t(e),e)))}))}};o=Object(r.c)([Object(i.a)()],o)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IOrchestratorSettings")},,,,function(e,t,n){"use strict";var r,i=new Uint8Array(16);function o(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(i)}var a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var s=function(e){return"string"==typeof e&&a.test(e)},u=[],c=0;c<256;++c)u.push((c+256).toString(16).substr(1));var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]).toLowerCase();if(!s(n))throw TypeError("Stringified UUID is invalid");return n};t.a=function(e,t,n){var r=(e=e||{}).random||(e.rng||o)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return l(r)}},,function(e,t,n){"use strict";n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"f",(function(){return h})),n.d(t,"e",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"b",(function(){return m}));var r=n(48),i=n(299),o=n(336),a=n(154),s=n(138),u=n(104),c=n(204),l=n(101);function d(e,t,n,i){var o,s;const l=null!==(o=e.graphTransaction)&&void 0!==o?o:{addedNodes:[],unreconciledContent:null!==(s=e.cachedTiles)&&void 0!==s?s:[],removedNodes:[],updatedNodes:[]};let d=r.c.Chars;l.unreconciledContent.some((e=>e.textUnit===u.e.Paragraph))?d=r.c.Paragraph:l.unreconciledContent.some((e=>e.textUnit===u.e.Sentence))?d=r.c.Sentence:e.hasWordChanges&&(d=r.c.Word);const h=l.unreconciledContent.map((e=>{var r;return{position:e.header.elementId.offset,length:e.header.elementId.span,unit:Object(c.a)(e.textUnit),languageId:null!==(r=t.specifiedLocale)&&void 0!==r?r:n}}));return f(e.tileNodeId,t.eventSeqId,i,e.cachedTextInfo,e.newTextInfo,e.minDiffBounds,e.cachedWordCount,d,a.a.TileNode,e.mutationChangeType,h)}function f(e,t,n,o,a,s,u,c,l,d,f,h){var p;let g,m,b=0;const v=null!==(p=null==o?void 0:o.content)&&void 0!==p?p:"",w=a.content,S=s.firstDiffLeft,_=v.length-s.firstDiffRight,T=w.length-s.firstDiffRight,O=function(e,t,n,i,o){if(e===t)return r.b.Update;if(n===o)return r.b.Add;if(i===o)return r.b.Delete;return r.b.Update}(v.length,w.length,_,T,S);switch(O){case r.b.Update:b=_-S,g=w.substring(S,T),m=v.substring(S,_);break;case r.b.Add:b=0,g=w.substring(S,T);break;case r.b.Delete:b=_-S,m=v.substring(S,_)}return{tileId:e,tileVersion:t,documentModel:n,delta:new i.a({deltaType:O,unit:c,position:S,length:b,content:g,wordCount:u,invalidationRanges:f,userInfo:{userType:y(d)}}),sourceType:l,changeType:d,deletedOrReplacedCharacters:m,tileText:w,wordBoundaries:h}}function h(e,t,n,r,i){var u,c,l;const d=null!==(u=e.graphTransaction)&&void 0!==u?u:{addedNodes:[],unreconciledContent:[],removedNodes:null!==(c=e.nodesToRetire)&&void 0!==c?c:[],updatedNodes:[]},f=null!==(l=e.mutationChangeType)&&void 0!==l?l:a.b.Code,h=d.removedNodes.map((e=>({messageType:s.a.RemoveData,data:{tileId:e,tileVersion:t.eventSeqId,documentModel:r,changeType:f,isTextNode:!0,tile:void 0}})));return h.push(...d.unreconciledContent.map((a=>{const{prev:u,next:c}=function(e,t){const n=e.getChildById(t);if(!n)return{prev:void 0,next:void 0};const r=e.findPreviousChildNode(n),i=e.findNextChildNode(n);return{prev:"#head#"===r?r:null==r?void 0:r.id,next:"#tail#"===i?i:null==i?void 0:i.id}}(t,a.header.elementId.id);return{messageType:i&&!d.addedNodes.includes(a.header.elementId.id)?s.a.ChangeData:s.a.NewData,data:{tileId:a.header.elementId.id,tileVersion:t.eventSeqId,documentModel:r,changeType:f,isTextNode:!0,tile:new o.a(Object.assign(Object.assign({},e.newTextInfo),{content:a.data,formattedRanges:[{start:0,length:a.data.length,languageId:n}]})),prevId:u,nextId:c}}}))),h}function p(e,t,n,o,a){return{tileId:e,tileVersion:t,documentModel:n,delta:Object(l.f)(a)?new i.a({deltaType:r.b.FormattingUpdate,formattedRanges:a.formattedRanges,attributionRanges:a.attributionRanges}):Array.isArray(a)?new i.a({deltaType:r.b.FormattingUpdate,formattedRanges:a}):new i.a({deltaType:r.b.OtherNonContentUpdate,otherNonContentData:a}),sourceType:o}}function g(e,t){var n;return{tileId:e.id,tileVersion:e.eventSeqId,documentModel:e.documentModel,changeType:e.mutationChangeType,isTextNode:!0,tile:e.content?new o.a(Object.assign(Object.assign({},e.content),{formattedRanges:[...null!==(n=e.content.formattedRanges)&&void 0!==n?n:[],{start:0,length:e.content.content.length,languageId:t}]})):void 0,prevId:e.prevTileId,nextId:e.nextTileId}}function m(e,t,n,r,i,a,s,u,c){var l;return{oldTileId:e,newTileId:t,tileVersion:n,oldDocumentModel:u,newDocumentModel:c,tile:new o.a(Object.assign(Object.assign({},r),{formattedRanges:[...null!==(l=r.formattedRanges)&&void 0!==l?l:[],{start:0,length:r.content.length,languageId:i}]})),prevId:a,nextId:s}}function y(e){switch(e){case a.b.Local:return r.a.SessionUser;case a.b.Remote:return r.a.Collaborator;default:return r.a.Programmatic}}},,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(33);class i{constructor(e){r.a.assign(i,this,e)}static getTypeName(){return"AugLoop_Text_TextTile"}static getBaseTypes(){return[]}static typeGuard(e){return r.a.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class o{constructor(e){r.a.assign(o,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return r.a.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class a{constructor(e){r.a.assign(a,this,e)}static getTypeName(){return"AugLoop_Text_InlineTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return r.a.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class s{constructor(e){r.a.assign(s,this,e)}static getTypeName(){return"AugLoop_Text_DynamicTextContext"}static getBaseTypes(){return["AugLoop_Core_DynamicContext"]}static typeGuard(e){return r.a.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class u{constructor(e){r.a.assign(u,this,e)}static getTypeName(){return"AugLoop_Text_TaskTile"}static getBaseTypes(){return["AugLoop_Text_FormattedTextTile","AugLoop_Text_TextTile"]}static typeGuard(e){return r.a.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class c{constructor(e){r.a.assign(c,this,e)}static getTypeName(){return"AugLoop_Text_PersonTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return r.a.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){r.a.assign(l,this,e)}static getTypeName(){return"AugLoop_Text_DateTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return r.a.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class d{constructor(e){r.a.assign(d,this,e)}static getTypeName(){return"AugLoop_Text_LinkTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return r.a.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),i=n(40),o=n(11),a=n(7),s=n(47);const u=["CN"];let c=class extends s.a{constructor(e){super(e)}checkUserInfo(){return!this.ctry||!u.includes(this.ctry)}};c=Object(r.c)([Object(o.a)(),Object(r.f)(0,Object(a.a)(i.a))],c)},function(e,t,n){"use strict";function r(e,t,n){return o((e=>setTimeout(e,t)),e,n)}function i(e,t,n,r){return o((n=>e.requestAnimationFrame(n,t)),n,r)}function o(e,t,n){let r=!1,i=!1;const a=[];let s=!1;return()=>new Promise((async u=>{if("Immediately"===n){if(!r){r=!0;try{await t()}catch(e){}e((()=>{r=!1,u()}))}}else r?(s&&(i=!0),a.push(u)):(r=!0,e((async()=>{s=!0;try{await t()}catch(e){}s=!1,r=!1,u();for(const e of a)e();i&&(i=!1,o(e,t,n))})))}))}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o}))},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("ITimer")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9),i=Object(r.a)("IBetaStateProcessor")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9),i=Object(r.a)("IManagedStorageApi")},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IPageContextEmitter")},,,,,function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(355),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(69))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,i,o,a,s,u=1,c={},l=!1,d=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){p(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){p(e.data)},r=function(e){o.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(i=d.documentElement,r=function(e){var t=d.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):r=function(e){setTimeout(p,0,e)}:(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&p(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),r=function(t){e.postMessage(a+t,"*")}),f.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return c[u]=i,r(u),u++},f.clearImmediate=h}function h(e){delete c[e]}function p(e){if(l)setTimeout(p,0,e);else{var t=c[e];if(t){l=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}(t)}finally{h(e),l=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(69),n(123))},function(e,t,n){"use strict";function r(e,t){return!(!e||!t)&&(e.start===t.start&&e.length===t.length&&e.priority===t.priority&&e.textInContext===t.textInContext&&e.nodeId===t.nodeId)}function i(e,t){return!(e.start>=t.start+t.length||t.start>=e.start+e.length)}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return a}));const o=(e,t,n)=>{if(e&&void 0!==t&&void 0!==n)return e.substring(t,t+n)};function a(e){const t=new Map;for(const n of e){if(!n.tileId)continue;const e=t.get(n.tileId.nodeId);e?e.push(n):t.set(n.tileId.nodeId,[n])}return t}},function(e,t,n){"use strict";var r=Symbol.for("react.element"),i=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,y={};function b(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||g}function v(){}function w(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||g}b.prototype.isReactComponent={},b.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},b.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=b.prototype;var S=w.prototype=new v;S.constructor=w,m(S,b.prototype),S.isPureReactComponent=!0;var _=Array.isArray,T=Object.prototype.hasOwnProperty,O={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,n){var i,o={},a=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)T.call(t,i)&&!C.hasOwnProperty(i)&&(o[i]=t[i]);var u=arguments.length-2;if(1===u)o.children=n;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];o.children=c}if(e&&e.defaultProps)for(i in u=e.defaultProps)void 0===o[i]&&(o[i]=u[i]);return{$$typeof:r,type:e,key:a,ref:s,props:o,_owner:O.current}}function I(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}var k=/\/+/g;function A(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function P(e,t,n,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case r:case i:u=!0}}if(u)return a=a(u=e),e=""===o?"."+A(u,0):o,_(a)?(n="",null!=e&&(n=e.replace(k,"$&/")+"/"),P(a,t,n,"",(function(e){return e}))):null!=a&&(I(a)&&(a=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,n+(!a.key||u&&u.key===a.key?"":(""+a.key).replace(k,"$&/")+"/")+e)),t.push(a)),1;if(u=0,o=""===o?".":o+":",_(e))for(var c=0;c<e.length;c++){var l=o+A(s=e[c],c);u+=P(s,t,n,l,a)}else if(l=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"==typeof l)for(e=l.call(e),c=0;!(s=e.next()).done;)u+=P(s=s.value,t,n,l=o+A(s,c++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function N(e,t,n){if(null==e)return e;var r=[],i=0;return P(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function j(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},x={transition:null},D={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:x,ReactCurrentOwner:O};t.Children={map:N,forEach:function(e,t,n){N(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return N(e,(function(){t++})),t},toArray:function(e){return N(e,(function(e){return e}))||[]},only:function(e){if(!I(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=b,t.Fragment=o,t.Profiler=s,t.PureComponent=w,t.StrictMode=a,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.cloneElement=function(e,t,n){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),o=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=O.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)T.call(t,c)&&!C.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==u?u[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){u=Array(c);for(var l=0;l<c;l++)u[l]=arguments[l+2];i.children=u}return{$$typeof:r,type:e.type,key:o,ref:a,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:u,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=I,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:j}},t.memo=function(e,t){return{$$typeof:f,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=x.transition;x.transition={};try{e()}finally{x.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.2.0"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IRegistrar")},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),i=n(11),o=n(271),a=n(94);let s=class{constructor(e){this.registrables=e,this.initializeCalled=!1,this.shutDownCalled=!1}async initialize(){var e;if(!this.initializeCalled){this.initializeCalled=!0;for(const e of this.registrables)await e.initialize();for(const t of this.registrables)await(null===(e=t.servicesInitialized)||void 0===e?void 0:e.call(t));this.shutDownCalled=!1}}shutDown(){if(!this.shutDownCalled){this.shutDownCalled=!0;for(const e of this.registrables)e.shutDown()}}async addRegistrable(e){var t;await e.initialize(),await(null===(t=e.servicesInitialized)||void 0===t?void 0:t.call(e)),this.registrables.push(e)}async recheckRegistrables(e){var t;const n=e.getAll(a.a),r=[];for(const e of n)this.registrables.includes(e)||(await e.initialize(),this.registrables.push(e),r.push(e));for(const e of r)await(null===(t=e.servicesInitialized)||void 0===t?void 0:t.call(e))}};s=Object(r.c)([Object(i.a)(),Object(r.f)(0,Object(o.a)(a.a))],s)},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2),i=n(11),o=n(7),a=n(74),s=n(52);let u=class{constructor(e,t){this._hostSettings=e,this._featureFlagsReader=t}check(){return!!this._hostSettings.enableOrchestration&&this._featureFlagsReader.flags.enableParagraphUpdates&&this._featureFlagsReader.flags.enableParagraphDeltas}};u=Object(r.c)([Object(i.a)(),Object(r.f)(0,Object(o.a)(s.a)),Object(r.f)(1,Object(o.a)(a.a))],u)},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(2),i=n(184),o=n(55),a=n(27),s=n(53),u=n(235),c=n(236),l=n(237),d=n(11),f=n(7),h=n(98),p=n(57),g=n(85),m=n(102),y=n(13);const b={enableConflictDetectionAnnouncement:!1,enableUpsellFeature:!1,enableMultiLanguageAnnouncement:!1,enableNotifications:!1,enableOptimizedCallingPattern:!1,enableOptimizedRehydration:!1,enablePostUpsellAnnouncement:!1,enableInternalMailFeedback:!1,enableOrchestration:!1,enableV2RoamingDictionary:!1,enableSignInAnnouncement:!1,enableSignInAnnouncementAlternativeText:!1,enableRateExtensionPrompt:!1,enableRateExtensionPromptEdge:!1,enableRateExtensionPromptFpsSurvey:!1,enableEnhancedUpsell:!1,enablePremiumPreview:!1,enableUnsignedInEditor:!1,enableSuppressUnsignedInEditorForMultiLang:!1,enableCritiqueSettings:!1,enableOcvIntEndpoint:!1,enableOcvFeedbackUi:!1,enableE2eMetric:!1,enableKeptMetric:!1,enableAriaStatusElement:!1,enableCssHighlightApiAnnouncementsOnly:!1,enableCssHighlightApiAnnouncementsOnlyForSpellingAndGrammar:!1,enableLineNavAriaAnnouncement:!1,enableCSSHighlightApiSquiggleRendering:!1,enableVisibilityTracker:!1,enableSquigglesUpdateThrottling:!1,mutationObserverBasedRelativePosition:!1,visibilityTrackerShouldTrackSquiggles:!0,enableCursorIntersectionObserver:!1,isMsitUser:!1,enableDispatchCritiquesOnEmptyDiffs:!0,enableSignInAnnouncementReshownWeekly:!1,enableSignInAnnouncementReshownBiweekly:!1,enableSignInAnnouncementReshownMonthly:!1,enableTargetedUpsell:!1,inferenceCritiqueCloudIconEnabled:!1,enableAutoCorrect:!1,enablePersonalizedAutoCorrect:!1,enableParagraphUpdates:!1,enableForceClearCritiques:!0,enableConditionalSignInMessage:!1,disableCalcLengthForAddDeltasInPresentation:!0,enableAnnotationActivationConfig:!0,enableAutoCorrectInputCache:!1,enableBetaExperience:!1,enableRoamingService:!1,enableWacCrossPromo:!1,enableAriaStatusPostMessage:!1,enableAriaStatusInNonRootIFrames:!1,enablePhraseTextUnitClientSide:!1,enableAadc:!1,enableBetaExperienceTelemetry:!1,enableUserDictionaryAnnouncement:!1,enableParagraphDeltas:!1,enableOrchestratorOverriddenCritiqueTypeOptions:!1,enableOrchestratorCritiqueDeletion:!1,enableRequiredServiceDataOnly:!1,disableBxOptionalPrivacySetting:!1,enableParagraphDeltasVerboseLogging:!1,enableParagraphDeltasEmptyInitialTile:!1,enableGDocsAnnotatedCanvas:!1,disableTileNodeObserver:!1,enableQueryOnlyOnLocalChange:!1,enableSvgSquiggleUnderline:!1,enableEditorServiceRouting:!1,enableCopywriter:!1,disableCalloutOnDoubleClick:!1,disableAutoBrowserVirtualizationOfSquiggles:!1,enableGDocsSuppressNativeSquiggles:!1,enableUserInfoCountry:!1,enableNonProveableElements:!0,enableSynonyms:!1,enableAiInsert:!1,enableAiInsertForInputTexarea:!1,enableSquigglesOnlyOnWholeWords:!1,disableECCMenuRecreationOnALReconnection:!1,enableLoggingModulesAndBindings:!1,enableResignInPrompt:!1,enableMagicWindow:!1,enableAttributionRangeExceptionInFormattedTextDeltas:!1};let v=class{constructor(e,t,n,r,o,a){this._emitter=e,this._storeEntryReader=t,this._logger=n,this._isAdult=r,this._isMinor=o,this._isChild=a,this._defaultAdultOnlyFeature={enableUpsellFeature:!0},this._defaultMinorAndAboveFeature={enableBxTelemetry:!0,enableRateExtensionPrompt:!0,enableRateExtensionPromptEdge:!0,enableRateExtensionPromptFpsSurvey:!0,enableOcvIntEndpoint:!0,enableOcvFeedbackUi:!0,enableUninstallSurvey:!0},this._defaultFeatureFlags=Object.assign(Object.assign(Object.assign({},this._defaultMinorAndAboveFeature),this._defaultAdultOnlyFeature),b),this._rolloutFeatureFlags=Object(y.b)(y.a.FeatureFlags,b),this._localFlags=Object.assign({},this._defaultFeatureFlags),this._flagOverrides={},this.updatedAdultOnlyFeatureFlags=e=>{var t;const n=!this.areAgeGroupPredicatesProvided()||!!(null===(t=this._isAdult)||void 0===t?void 0:t.check()),r=Object.assign({},this._defaultAdultOnlyFeature);for(const t in this._defaultAdultOnlyFeature)r[t]=n&&e[t];return r},this.updateMinorAndAboveFeatureFlags=e=>{var t,n;const r=!this.areAgeGroupPredicatesProvided()||(!!(null===(t=this._isMinor)||void 0===t?void 0:t.check())||!!(null===(n=this._isAdult)||void 0===n?void 0:n.check())),i=Object.assign({},this._defaultMinorAndAboveFeature);for(const t in this._defaultMinorAndAboveFeature)i[t]=r&&e[t];return i},this.areAgeGroupPredicatesProvided=()=>!!(this._isAdult&&this._isChild&&this._isMinor),this._eventPublisher=new i.a}get flags(){return this._localFlags}overrideFlags(e){this._flagOverrides=e,this.applyFlagOverrides()}applyFlagOverrides(){this._localFlags=Object.assign(Object.assign({},this._localFlags),this._flagOverrides)}async refreshFlags(){return await this.updateFlags(),this.flags}async initialize(){this._emitter.on(y.a.FeatureFlags,(()=>{this.updateFlags()})),await this.updateFlags()}shutDown(){}async updateFlags(){try{const e=await this._storeEntryReader.readOrInitialize(this._rolloutFeatureFlags);let t=Object.assign(Object.assign({},this._defaultFeatureFlags),...Object.entries(e).map((([e,t])=>{return{[e]:(n=t,"string"==typeof n?"true"===n.toLowerCase():!0===n)};var n})));if(t.enableAadc){const e=this.updateMinorAndAboveFeatureFlags(t),n=this.updatedAdultOnlyFeatureFlags(t);t=Object.assign(Object.assign(Object.assign({},t),e),n)}this._localFlags=t,this.applyFlagOverrides(),this.publishEvent("flagsChanged",this.flags)}catch(e){this._logger.logEvent(571318787,p.a.FeatureFlagParsingError,o.a.Error,void 0,a.a.SamplingPolicy.Diagnostics)}}subscribe(e,t){this._eventPublisher.subscribe(e,t)}unsubscribe(e,t){this._eventPublisher.unsubscribe(e,t)}publishEvent(e,t){this._eventPublisher.publishEvent(e,t)}};v=Object(r.c)([Object(d.a)(),Object(r.f)(0,Object(f.a)(g.a)),Object(r.f)(1,Object(f.a)(m.a)),Object(r.f)(2,Object(f.a)(s.a)),Object(r.f)(3,Object(h.a)()),Object(r.f)(3,Object(f.a)(u.a)),Object(r.f)(4,Object(h.a)()),Object(r.f)(4,Object(f.a)(c.a)),Object(r.f)(5,Object(h.a)()),Object(r.f)(5,Object(f.a)(l.a))],v)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(26);function i(e,t,n){if(e)for(const t of e)if("LicenseType"===t.name)return t.value;let i=r.c.NoLicense;return t?i=r.c.Subscription:n&&(i=n),null==e||e.push({name:"LicenseType",value:i}),i}},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return Ms}));var r=n(2),i=n(76),o="Data.",a="b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121",s=void 0;function u(e,t,n,r){var a=!0;if(t)for(var s=function(t){var s=t.classification,u=t.dataType,c=t.name;if(s&&!(4===s||1===s||2===r&&32===s||3===r&&2048===s))return a=!1,"break";if(3===r&&n&&3!==u&&1!==u&&2!==u&&"OTelJS.Version"!==c&&"OTelJS.Sink"!==c)return Object(i.b)(0,1,(function(){return"DNM: Invalid field type "+c})),a=!1,"break";var l=void 0;l=n?"zC."===c.substr(0,3)?"zC."+o+c.substr(3):o+c:c;var d=void 0;switch(u){case 3:d=6;break;case 2:d=4;break;case 4:d=8;break;case 0:return e[l]="string"==typeof t.value?t.value.substr(0,25e3):t.value,"continue";default:return e[l]=t.value,"continue"}var f={value:t.value,propertyType:d};e[l]=f},u=0,c=t;u<c.length;u++){if("break"===s(c[u]))break}return a}function c(e,t){try{return e()}catch(e){return Object(i.a)(1,"1DS Sink",e),t}}var l="App.Version",d="User.TenantId",f="Session.Id";function h(e){Object(i.b)(0,1,(function(){return"Invalid "+e}))}var p=n(152),g=n(323),m=n(263),y=n(18),b=n(109),v="initialize",w="name",S="getNotifyMgr",_="identifier",T="push",O="isInitialized",C="config",E="instrumentationKey",I="logger",k="length",A="time",P="processNext",N="getProcessTelContext",j="addNotificationListener",R="removeNotificationListener",x="stopPollingInternalLogs",D="onComplete",M="getPlugin",L="flush",B="_extensions",F="splice",U="teardown",q="messageId",z="message",W="isAsync",V="_doTeardown",G="update",H="getNext",$="diagLog",K="setNextPlugin",J="createNew",Q="cookieCfg",Y="indexOf",X="substring",Z="userAgent",ee="split",te="setEnabled",ne="substr",re="nodeType",ie="apply",oe="replace",ae="enableDebugExceptions",se="logInternalMessage",ue="toLowerCase",ce="call",le="type",de="handler",fe="listeners",he="isChildEvt",pe="getCtx",ge="setCtx",me="complete",ye="traceId",be="spanId",ve="traceFlags",we="constructor",Se="prototype",_e="function",Te="_dynInstFuncs",Oe="_isDynProxy",Ce="_dynClass",Ee="_dynInstChk",Ie=Ee,ke="_dfOpts",Ae="_unknown_",Pe="__proto__",Ne="_dyn"+Pe,je="_dynInstProto",Re="useBaseInst",xe="setInstFuncs",De=Object,Me=De.getPrototypeOf,Le=De.getOwnPropertyNames,Be=0;function Fe(e,t){return e&&De[Se].hasOwnProperty.call(e,t)}function Ue(e){return e&&(e===De[Se]||e===Array[Se])}function qe(e){return Ue(e)||e===Function[Se]}function ze(e){var t;if(e){if(Me)return Me(e);var n=e[Pe]||e[Se]||(e[we]?e[we][Se]:null);t=e[Ne]||n,Fe(e,Ne)||(delete e[je],t=e[Ne]=e[je]||e[Ne],e[je]=n)}return t}function We(e,t){var n=[];if(Le)n=Le(e);else for(var r in e)"string"==typeof r&&Fe(e,r)&&n.push(r);if(n&&n.length>0)for(var i=0;i<n.length;i++)t(n[i])}function Ve(e,t,n){return t!==we&&typeof e[t]===_e&&(n||Fe(e,t))}function Ge(e){throw new TypeError("DynamicProto: "+e)}function He(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function $e(e,t,n,r,i){function o(e,t){var n=function(){var r=function(e,t,n,r){var i=null;if(e&&Fe(n,Ce)){var o=e[Te]||{};if((i=(o[n[Ce]]||{})[t])||Ge("Missing ["+t+"] "+_e),!i[Ee]&&!1!==o[Ie]){for(var a=!Fe(e,t),s=ze(e),u=[];a&&s&&!qe(s)&&!He(u,s);){var c=s[t];if(c){a=c===r;break}u.push(s),s=ze(s)}try{a&&(e[t]=i),i[Ee]=1}catch(e){o[Ie]=!1}}}return i}(this,t,e,n)||function(e,t,n){var r=t[e];return r===n&&(r=ze(t)[e]),typeof r!==_e&&Ge("["+e+"] is not a "+_e),r}(t,e,n);return r.apply(this,arguments)};return n[Oe]=1,n}if(!Ue(e)){var a=n[Te]=n[Te]||{},s=a[t]=a[t]||{};!1!==a[Ie]&&(a[Ie]=!!i),We(n,(function(t){Ve(n,t,!1)&&n[t]!==r[t]&&(s[t]=n[t],delete n[t],(!Fe(e,t)||e[t]&&!e[t][Oe])&&(e[t]=o(e,t)))}))}}function Ke(e,t){return Fe(e,Se)?e.name||t||Ae:((e||{})[we]||{}).name||t||Ae}function Je(e,t,n,r){Fe(e,Se)||Ge("theClass is an invalid class definition.");var i=e[Se];(function(e,t){if(Me){for(var n=[],r=ze(t);r&&!qe(r)&&!He(n,r);){if(r===e)return!0;n.push(r),r=ze(r)}return!1}return!0})(i,t)||Ge("["+Ke(e)+"] is not in class hierarchy of ["+Ke(t)+"]");var o=null;Fe(i,Ce)?o=i[Ce]:(o="_dynCls$"+Ke(e,"_")+"$"+Be,Be++,i[Ce]=o);var a=Je[ke],s=!!a[Re];s&&r&&void 0!==r[Re]&&(s=!!r[Re]);var u=function(e){var t={};return We(e,(function(n){!t[n]&&Ve(e,n,!1)&&(t[n]=e[n])})),t}(t),c=function(e,t,n,r){function i(e,t,n){var i=t[n];if(i[Oe]&&r){var o=e[Te]||{};!1!==o[Ie]&&(i=(o[t[Ce]]||{})[n]||i)}return function(){return i.apply(e,arguments)}}var o={};We(n,(function(e){o[e]=i(t,n,e)}));for(var a=ze(e),s=[];a&&!qe(a)&&!He(s,a);)We(a,(function(e){!o[e]&&Ve(a,e,!Me)&&(o[e]=i(t,a,e))})),s.push(a),a=ze(a);return o}(i,t,u,s);n(t,c);var l=!!Me&&!!a[xe];l&&r&&(l=!!r[xe]),$e(i,o,t,u,!1!==l)}Je[ke]={setInstFuncs:!0,useBaseInst:!0};var Qe="",Ye="channels",Xe="core",Ze="createPerfMgr",et="disabled",tt="extensionConfig",nt="processTelemetry",rt="priority",it="eventsSent",ot="eventsDiscarded",at="eventsSendRequest",st="perfEvent",ut="errorToConsole",ct="warnToConsole",lt="getPerfMgr",dt="toISOString",ft="endsWith",ht="startsWith",pt="indexOf",gt="reduce",mt="trim",yt="toString",bt="__proto__",vt="constructor",wt=y.d,St=y.b.freeze,_t=(y.b.seal,y.b.keys),Tt=String[y.k],Ot=Tt[mt],Ct=Tt[ft],Et=Tt[ht],It=Date[y.k][dt],kt=Array.isArray,At=y.f[yt],Pt=y.e[yt],Nt=Pt[ce](y.b),jt=/-([a-z])/g,Rt=/([^\w\d_$])/g,xt=/^(\d+[\w\d_$])/,Dt=Object.getPrototypeOf;function Mt(e,t){return typeof e===t}function Lt(e){return void 0===e||typeof e===y.l}function Bt(e){return null===e||Lt(e)}function Ft(e){return!Bt(e)}function Ut(e,t){return!(!e||!y.e[ce](e,t))}function qt(e){return!(!e||typeof e!==y.j)}function zt(e){return!(!e||typeof e!==y.h)}function Wt(e){var t=e;return t&&Yt(t)&&(t=(t=(t=t[oe](jt,(function(e,t){return t.toUpperCase()})))[oe](Rt,"_"))[oe](xt,(function(e,t){return"_"+t}))),t}function Vt(e,t){if(e)for(var n in e)y.e[ce](e,n)&&t[ce](e,n,e[n])}function Gt(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=Ct?e[ft](t):function(e,t){var n=!1,r=t?t[k]:0,i=e?e[k]:0;if(r&&i&&i>=r&&!(n=e===t)){for(var o=i-1,a=r-1;a>=0;a--){if(e[o]!=t[a])return!1;o--}n=!0}return n}(e,t)),n}function Ht(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=Et?e[ht](t):function(e,t){var n=!1,r=t?t[k]:0;if(e&&r&&e[k]>=r&&!(n=e===t)){for(var i=0;i<r;i++)if(e[i]!==t[i])return!1;n=!0}return n}(e,t)),n}function $t(e,t){return!(!e||!t)&&-1!==e[Y](t)}function Kt(e){return!(!e||"[object Date]"!==At[ce](e))}var Jt=kt||function(e){return!(!e||"[object Array]"!==At[ce](e))};function Qt(e){return!(!e||"[object Error]"!==At[ce](e))}function Yt(e){return"string"==typeof e}function Xt(e){return"number"==typeof e}function Zt(e){return"boolean"==typeof e}function en(e){var t=!1;if(e&&"object"==typeof e){var n=Dt?Dt(e):function(e){if(e){if(Dt)return Dt(e);var t=e[bt]||e[y.k]||e[vt];if(t)return t}return null}(e);n?(n[vt]&&y.e[ce](n,vt)&&(n=n[vt]),t=typeof n===y.h&&Pt[ce](n)===Nt):t=!0}return t}function tn(e){if(e)return It?e[dt]():function(e){if(e&&e.getUTCFullYear){var t=function(e){var t=String(e);return 1===t[k]&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(e)}function nn(e,t,n){var r=e[k];try{for(var i=0;i<r&&(!(i in e)||-1!==t[ce](n||e,e[i],i,e));i++);}catch(e){}}function rn(e,t,n){if(e){if(e[pt])return e[pt](t,n);var r=e[k],i=n||0;try{for(var o=Math.max(i>=0?i:r-Math.abs(i),0);o<r;o++)if(o in e&&e[o]===t)return o}catch(e){}}return-1}function on(e,t,n){var r;if(e){if(e.map)return e.map(t,n);var i=e[k],o=n||e;r=new Array(i);try{for(var a=0;a<i;a++)a in e&&(r[a]=t[ce](o,e[a],e))}catch(e){}}return r}function an(e,t,n){var r;if(e){if(e[gt])return e[gt](t,n);var i=e[k],o=0;if(arguments[k]>=3)r=arguments[2];else{for(;o<i&&!(o in e);)o++;r=e[o++]}for(;o<i;)o in e&&(r=t(r,e[o],o,e)),o++}return r}function sn(e){return e&&(e=Ot&&e[mt]?e[mt]():e[oe]?e[oe](/^\s+|\s+$/g,Qe):e),e}var un=!{toString:null}.propertyIsEnumerable("toString"),cn=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function ln(e){var t=typeof e;if(t===y.h||t===y.j&&null!==e||Object(b.c)("objKeys called on non-object"),!un&&_t)return _t(e);var n=[];for(var r in e)e&&y.e[ce](e,r)&&n[T](r);if(un)for(var i=cn[k],o=0;o<i;o++)e&&y.e[ce](e,cn[o])&&n[T](cn[o]);return n}function dn(e,t,n,r){if(wt)try{var i={enumerable:!0,configurable:!0};return n&&(i.get=n),r&&(i.set=r),wt(e,t,i),!0}catch(e){}return!1}function fn(e){return e}function hn(e){return St&&Vt(e,(function(e,t){(Jt(t)||qt(t))&&St(t)})),pn(e)}var pn=St||fn;function gn(){var e=Date;return e.now?e.now():(new e).getTime()}function mn(e){return Qt(e)?e[w]:Qe}function yn(e,t,n,r,i){var o=n;return e&&((o=e[t])===n||i&&!i(o)||r&&!r(n)||(o=n,e[t]=o)),o}function bn(e,t,n){var r;return e?!(r=e[t])&&Bt(r)&&(r=Lt(n)?{}:n,e[t]=r):r=Lt(n)?{}:n,r}function vn(e,t){return Bt(e)?t:e}function wn(e){return!!e}function Sn(e){throw new Error(e)}function _n(e,t){var n=null,r=null;return zt(e)?n=e:r=e,function(){var e=arguments;if(n&&(r=n()),r)return r[t][ie](r,e)}}function Tn(e,t,n,r,i){e&&t&&n&&(!1!==i||Lt(e[t]))&&(e[t]=_n(n,r))}function On(e,t,n,r){return e&&t&&qt(e)&&Jt(n)&&nn(n,(function(n){Yt(n)&&Tn(e,n,t,n,r)})),e}function Cn(e){return e&&y.a&&(e=Object(y.b)(Object(y.a)({},e))),e}function En(e,t,n,r,i,o){var a=arguments,s=a[0]||{},u=a[k],c=!1,l=1;for(u>0&&Zt(s)&&(c=s,s=a[l]||{},l++),qt(s)||(s={});l<u;l++){var d=a[l],f=Jt(d),h=qt(d);for(var p in d){if(f&&p in d||h&&y.e[ce](d,p)){var g=d[p],m=void 0;if(c&&g&&((m=Jt(g))||en(g))){var b=s[p];m?Jt(b)||(b=[]):en(b)||(b={}),g=En(c,b,g)}void 0!==g&&(s[p]=g)}}}return s}var In="window",kn="document",An="navigator",Pn="location",Nn="console",jn="performance",Rn="JSON",xn="crypto",Dn="msCrypto",Mn="ReactNative",Ln="msie",Bn="trident/",Fn="XMLHttpRequest",Un=null,qn=null,zn=!1,Wn=null,Vn=null;function Gn(e,t){var n=!1;if(e){try{if(!(n=t in e)){var r=e[y.k];r&&(n=t in r)}}catch(e){}if(!n)try{n=!Lt((new e)[t])}catch(e){}}return n}function Hn(e){var t=Object(b.a)();return t&&t[e]?t[e]:e===In&&$n()?window:null}function $n(){return Boolean(typeof window===y.j&&window)}function Kn(){return $n()?window:Hn(In)}function Jn(){return Boolean(typeof document===y.j&&document)?document:Hn(kn)}function Qn(){return Boolean(typeof navigator===y.j&&navigator)}function Yn(){return Qn()?navigator:Hn(An)}function Xn(e){if(e&&zn){var t=Hn("__mockLocation");if(t)return t}return typeof location===y.j&&location?location:Hn(Pn)}function Zn(){return Hn(jn)}function er(){return Boolean(typeof JSON===y.j&&JSON||null!==Hn(Rn))}function tr(){return er()?JSON||Hn(Rn):null}function nr(){var e=Yn();return!(!e||!e.product)&&e.product===Mn}function rr(){var e=Yn();if(e&&(e[Z]!==qn||null===Un)){var t=((qn=e[Z])||Qe)[ue]();Un=$t(t,Ln)||$t(t,Bn)}return Un}function ir(e){var t=Object[y.k].toString[ce](e),n=Qe;return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e[w]+"'":er()&&(n=tr().stringify(e)),t+n}function or(){return null===Vn&&(Vn=Qn()&&Boolean(Yn().sendBeacon)),Vn}function ar(e){var t=!1;try{t=!!Hn("fetch");var n=Hn("Request");t&&e&&n&&(t=Gn(n,"keepalive"))}catch(e){}return t}function sr(){return null===Wn&&(Wn=typeof XDomainRequest!==y.l)&&ur()&&(Wn=Wn&&!Gn(Hn(Fn),"withCredentials")),Wn}function ur(){var e=!1;try{e=!!Hn(Fn)}catch(e){}return e}var cr,lr=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],dr=null;function fr(e,t){return function(){var n=arguments,r=hr(t);if(r){var i=r.listener;i&&i[e]&&i[e][ie](i,n)}}}function hr(e){var t,n=dr;return n||!0===e.disableDbgExt||(n=dr||((t=Hn("Microsoft"))&&(dr=t.ApplicationInsights),dr)),n?n.ChromeDbgExt:null}function pr(e){return e?'"'+e[oe](/\"/g,Qe)+'"':Qe}function gr(e,t){var n=typeof console!==y.l?console:Hn(Nn);if(n){var r="log";n[e]&&(r=e),zt(n[r])&&n[r](t)}}var mr=function(){function e(e,t,n,r){void 0===n&&(n=!1);var i=this;i[q]=e,i[z]=(n?"AI: ":"AI (Internal): ")+e;var o=Qe;er()&&(o=tr().stringify(r));var a=(t?" message:"+pr(t):Qe)+(r?" props:"+pr(o):Qe);i[z]+=a}return e.dataType="MessageData",e}();var yr=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n,r,i,o,a=0,s={};Je(e,this,(function(e){function u(t,n){if(!(a>=i)){var o=!0,u="AITR_"+n[q];if(s[u]?o=!1:s[u]=!0,o&&(t<=r&&(e.queue[T](n),a++,c(1===t?"error":"warn",n)),a===i)){var l="Internal events throttle limit per PageView reached for this app.",d=new mr(23,l,!1);e.queue[T](d),1===t?e[ut](l):e[ct](l)}}}function c(e,n){var r=hr(t||{});r&&r[$]&&r[$](e,n)}!function(e){n=vn(e.loggingLevelConsole,0),r=vn(e.loggingLevelTelemetry,1),i=vn(e.maxMessageLimit,25),o=vn(e[ae],!1)}(t||{}),e.consoleLoggingLevel=function(){return n},e.telemetryLoggingLevel=function(){return r},e.maxInternalMessageLimit=function(){return i},e[ae]=function(){return o},e.throwInternal=function(t,r,i,a,l){void 0===l&&(l=!1);var d=new mr(r,i,l,a);if(o)throw ir(d);var f=1===t?ut:ct;if(Lt(d[z]))c("throw"+(1===t?"Critical":"Warning"),d);else{if(l){var h=+d[q];!s[h]&&n>=t&&(e[f](d[z]),s[h]=!0)}else n>=t&&e[f](d[z]);u(t,d)}},e[ct]=function(e){gr("warn",e),c("warning",e)},e[ut]=function(e){gr("error",e),c("error",e)},e.resetInternalMessageCount=function(){a=0,s={}},e[se]=u}))}return e.__ieDyn=1,e}();function br(e){return e||new yr}function vr(e,t,n,r,i,o){void 0===o&&(o=!1),br(e).throwInternal(t,n,r,i,o)}function wr(e,t){br(e)[ct](t)}var Sr="toGMTString",_r="toUTCString",Tr="cookie",Or="expires",Cr="enabled",Er="isCookieUseDisabled",Ir="disableCookiesUsage",kr="_ckMgr",Ar=null,Pr=null,Nr=null,jr=Jn(),Rr={},xr={};function Dr(e,t){var n=Lr[kr]||xr[kr];return n||(n=Lr[kr]=Lr(e,t),xr[kr]=n),n}function Mr(e){return!e||e.isEnabled()}function Lr(e,t){var n,r=function(e){var t=e[Q]=e[Q]||{};if(yn(t,"domain",e.cookieDomain,Ft,Bt),yn(t,"path",e.cookiePath||"/",null,Bt),Bt(t[Cr])){var n=void 0;Lt(e[Er])||(n=!e[Er]),Lt(e[Ir])||(n=!e[Ir]),t[Cr]=n}return t}(e||xr),i=r.path||"/",o=r.domain,a=!1!==r[Cr],s=((n={isEnabled:function(){var e=a&&Br(t),n=xr[kr];return e&&n&&s!==n&&(e=Mr(n)),e}})[te]=function(e){a=!1!==e},n.set=function(e,t,n,a,u){var c=!1;if(Mr(s)){var l={},d=sn(t||Qe),f=d[Y](";");if(-1!==f&&(d=sn(t[X](0,f)),l=Fr(t[X](f+1))),yn(l,"domain",a||o,wn,Lt),!Bt(n)){var h=rr();if(Lt(l[Or])){var p=gn()+1e3*n;if(p>0){var g=new Date;g.setTime(p),yn(l,Or,Ur(g,h?Sr:_r)||Ur(g,h?Sr:_r)||Qe,wn)}}h||yn(l,"max-age",Qe+n,null,Lt)}var m=Xn();m&&"https:"===m.protocol&&(yn(l,"secure",null,null,Lt),null===Pr&&(Pr=!Vr((Yn()||{})[Z])),Pr&&yn(l,"SameSite","None",null,Lt)),yn(l,"path",u||i,null,Lt),(r.setCookie||Wr)(e,qr(d,l)),c=!0}return c},n.get=function(e){var t=Qe;return Mr(s)&&(t=(r.getCookie||zr)(e)),t},n.del=function(e,t){var n=!1;return Mr(s)&&(n=s.purge(e,t)),n},n.purge=function(e,n){var i,o=!1;if(Br(t)){var a=((i={}).path=n||"/",i[Or]="Thu, 01 Jan 1970 00:00:01 GMT",i);rr()||(a["max-age"]="0"),(r.delCookie||Wr)(e,qr(Qe,a)),o=!0}return o},n);return s[kr]=s,s}function Br(e){if(null===Ar){Ar=!1;try{Ar=void 0!==(jr||{})[Tr]}catch(t){vr(e,2,68,"Cannot access document.cookie - "+mn(t),{exception:ir(t)})}}return Ar}function Fr(e){var t={};e&&e[k]&&nn(sn(e)[ee](";"),(function(e){if(e=sn(e||Qe)){var n=e[Y]("=");-1===n?t[e]=null:t[sn(e[X](0,n))]=sn(e[X](n+1))}}));return t}function Ur(e,t){return zt(e[t])?e[t]():null}function qr(e,t){var n=e||Qe;return Vt(t,(function(e,t){n+="; "+e+(Bt(t)?Qe:"="+t)})),n}function zr(e){var t=Qe;if(jr){var n=jr[Tr]||Qe;Nr!==n&&(Rr=Fr(n),Nr=n),t=sn(Rr[e]||Qe)}return t}function Wr(e,t){jr&&(jr[Tr]=e+"="+t)}function Vr(e){return!!Yt(e)&&(!(!$t(e,"CPU iPhone OS 12")&&!$t(e,"iPad; CPU OS 12"))||(!!($t(e,"Macintosh; Intel Mac OS X 10_14")&&$t(e,"Version/")&&$t(e,"Safari"))||(!(!$t(e,"Macintosh; Intel Mac OS X 10_14")||!Gt(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))||(!(!$t(e,"Chrome/5")&&!$t(e,"Chrome/6"))||(!(!$t(e,"UnrealEngine")||$t(e,"Chrome"))||!(!$t(e,"UCBrowser/12")&&!$t(e,"UCBrowser/11")))))))}var Gr=4294967296,Hr=4294967295,$r=!1,Kr=123456789,Jr=987654321;function Qr(e){e<0&&(e>>>=0),Kr=123456789+e&Hr,Jr=987654321-e&Hr,$r=!0}function Yr(){try{var e=2147483647&gn();Qr((Math.random()*Gr^e)+e)}catch(e){}}function Xr(e){return e>0?Math.floor(Zr()/Hr*(e+1))>>>0:0}function Zr(e){var t=0,n=Hn(xn)||Hn(Dn);return n&&n.getRandomValues&&(t=n.getRandomValues(new Uint32Array(1))[0]&Hr),0===t&&rr()&&($r||Yr(),t=ti()&Hr),0===t&&(t=Math.floor(Gr*Math.random()|0)),e||(t>>>=0),t}function ei(e){e?Qr(e):Yr()}function ti(e){var t=((Jr=36969*(65535&Jr)+(Jr>>16)&Hr)<<16)+(65535&(Kr=18e3*(65535&Kr)+(Kr>>16)&Hr))>>>0&Hr;return e||(t>>>=0),t}function ni(e){void 0===e&&(e=22);for(var t=Zr()>>>0,n=0,r=Qe;r[k]<e;)n++,r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(Zr()<<2&4294967295|3&t)>>>0,n=0);return r}var ri=y.d,ii="2.8.6",oi="."+ni(6),ai=0;function si(e){return 1===e[re]||9===e[re]||!+e[re]}function ui(e,t){var n=t[e.id];if(!n){n={};try{si(t)&&(function(e,t,n){if(ri)try{return ri(e,t,{value:n,enumerable:!1,configurable:!0}),!0}catch(e){}return!1}(t,e.id,n)||(t[e.id]=n))}catch(e){}}return n}function ci(e,t){return void 0===t&&(t=!1),Wt(e+ai+++(t?"."+ii:Qe)+oi)}function li(e){var t={id:ci("_aiData-"+(e||Qe)+"."+ii),accept:function(e){return si(e)},get:function(e,n,r,i){var o=e[t.id];return o?o[Wt(n)]:(i&&((o=ui(t,e))[Wt(n)]=r),r)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}var di="on",fi="attachEvent",hi="addEventListener",pi="detachEvent",gi="removeEventListener",mi="events",yi="visibilitychange",bi="pagehide",vi="pageshow",wi="unload",Si="beforeunload",_i=ci("aiEvtPageHide"),Ti=ci("aiEvtPageShow"),Oi=/\.[\.]+/g,Ci=/[\.]+$/,Ei=1,Ii=li("events"),ki=/^([^.]*)(?:\.(.+)|)/;function Ai(e){return e&&e[oe]?e.replace(/^\s*\.*|\.*\s*$/g,Qe):e}function Pi(e,t){var n;if(t){var r=Qe;Jt(t)?(r=Qe,nn(t,(function(e){(e=Ai(e))&&("."!==e[0]&&(e="."+e),r+=e)}))):r=Ai(t),r&&("."!==r[0]&&(r="."+r),e=(e||Qe)+r)}var i=ki.exec(e||Qe)||[];return(n={})[le]=i[1],n.ns=(i[2]||Qe).replace(Oi,".").replace(Ci,Qe)[ee](".").sort().join("."),n}function Ni(e,t,n){void 0===n&&(n=!0);var r=Ii.get(e,mi,{},n),i=r[t];return i||(i=r[t]=[]),i}function ji(e,t,n,r){e&&t&&t[le]&&(e[gi]?e[gi](t[le],n,r):e[pi]&&e[pi](di+t[le],n))}function Ri(e,t,n,r){for(var i=t[k];i--;){var o=t[i];o&&(n.ns&&n.ns!==o.evtName.ns||r&&!r(o)||(ji(e,o.evtName,o[de],o.capture),t[F](i,1)))}}function xi(e,t){return t?Pi("xx",Jt(t)?[e].concat(t):[e,t]).ns[ee]("."):e}function Di(e,t,n,r,i){var o;void 0===i&&(i=!1);var a=!1;if(e)try{var s=Pi(t,r);if(a=function(e,t,n,r){var i=!1;return e&&t&&t[le]&&n&&(e[hi]?(e[hi](t[le],n,r),i=!0):e[fi]&&(e[fi](di+t[le],n),i=!0)),i}(e,s,n,i),a&&Ii.accept(e)){var u=((o={guid:Ei++,evtName:s})[de]=n,o.capture=i,o);Ni(e,s.type)[T](u)}}catch(e){}return a}function Mi(e,t,n,r,i){if(void 0===i&&(i=!1),e)try{var o=Pi(t,r),a=!1;!function(e,t,n){if(t[le])Ri(e,Ni(e,t[le]),t,n);else{var r=Ii.get(e,mi,{});Vt(r,(function(r,i){Ri(e,i,t,n)})),0===ln(r)[k]&&Ii.kill(e,mi)}}(e,o,(function(e){return!((!o.ns||n)&&e[de]!==n)&&(a=!0,!0)})),a||ji(e,o,n,i)}catch(e){}}function Li(e,t,n){var r=!1,i=Kn();i&&(r=Di(i,e,t,n),r=Di(i.body,e,t,n)||r);var o=Jn();return o&&(r=Di(o,e,t,n)||r),r}function Bi(e,t,n,r){var i=!1;return t&&e&&e[k]>0&&nn(e,(function(e){e&&(n&&-1!==rn(n,e)||(i=Li(e,t,r)||i))})),i}function Fi(e,t,n){e&&Jt(e)&&nn(e,(function(e){e&&function(e,t,n){var r=Kn();r&&(Mi(r,e,t,n),Mi(r.body,e,t,n));var i=Jn();i&&Mi(i,e,t,n)}(e,t,n)}))}function Ui(e,t,n){return function(e,t,n,r){var i=!1;return t&&e&&Jt(e)&&!(i=Bi(e,t,n,r))&&n&&n[k]>0&&(i=Bi(e,t,null,r)),i}([Si,wi,bi],e,t,n)}function qi(e,t,n){var r=xi(_i,n),i=Bi([bi],e,t,r);return t&&-1!==rn(t,yi)||(i=Bi([yi],(function(t){var n=Jn();e&&n&&"hidden"===n.visibilityState&&e(t)}),t,r)||i),!i&&t&&(i=qi(e,null,n)),i}function zi(e,t,n){var r=xi(Ti,n),i=Bi([vi],e,t,r);return!(i=Bi([yi],(function(t){var n=Jn();e&&n&&"visible"===n.visibilityState&&e(t)}),t,r)||i)&&t&&(i=zi(e,null,n)),i}var Wi,Vi=null;y.l;function Gi(){var e=$i();return e[X](0,8)+"-"+e[X](8,12)+"-"+e[X](12,16)+"-"+e[X](16,20)+"-"+e[X](20)}function Hi(){var e=Zn();return e&&e.now?e.now():gn()}function $i(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=Qe,r=0;r<4;r++)n+=t[15&(e=Zr())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var i=t[8+(3&Zr())|0];return n[ne](0,8)+n[ne](9,4)+"4"+n[ne](13,3)+i+n[ne](16,3)+n[ne](19,12)}var Ki={_canUseCookies:void 0,isTypeof:Mt,isUndefined:Lt,isNullOrUndefined:Bt,hasOwnProperty:Ut,isFunction:zt,isObject:qt,isDate:Kt,isArray:Jt,isError:Qt,isString:Yt,isNumber:Xt,isBoolean:Zt,toISOString:tn,arrForEach:nn,arrIndexOf:rn,arrMap:on,arrReduce:an,strTrim:sn,objCreate:b.b,objKeys:ln,objDefineAccessors:dn,addEventHandler:Li,dateNow:gn,isIE:rr,disableCookies:function(){Ji()[te](!1)},newGuid:Gi,perfNow:Hi,newId:ni,randomValue:Xr,random32:Zr,mwcRandomSeed:ei,mwcRandom32:ti,generateW3CId:$i};function Ji(e,t){var n=Dr(e,t),r=Ki._canUseCookies;return null===Vi&&(Vi=[],Wi=r,dn(Ki,"_canUseCookies",(function(){return Wi}),(function(e){Wi=e,nn(Vi,(function(t){t[te](e)}))}))),-1===rn(Vi,n)&&Vi[T](n),Zt(r)&&n[te](r),Zt(Wi)&&n[te](Wi),n}var Qi,Yi=n(566);function Xi(e){var t={};return Vt(e,(function(e,n){t[e]=n,t[n]=e})),hn(t)}var Zi="Failed",eo=Zi+"MonitorAjax",to="Track",no="Start",ro="Stop",io="Event",oo="AuthContext",ao="Exception",so="Local",uo="Session",co="Storage",lo="Browser",fo="Cannot",ho="Buffer",po="InstrumentationKey",go=(Xi({CRITICAL:1,WARNING:2}),Xi(((Qi={})[lo+"DoesNotSupport"+so+co]=0,Qi[lo+fo+"Read"+so+co]=1,Qi[lo+fo+"Read"+uo+co]=2,Qi[lo+fo+"Write"+so+co]=3,Qi[lo+fo+"Write"+uo+co]=4,Qi[lo+Zi+"RemovalFrom"+so+co]=5,Qi[lo+Zi+"RemovalFrom"+uo+co]=6,Qi[fo+"SendEmptyTelemetry"]=7,Qi.ClientPerformanceMathError=8,Qi["ErrorParsingAI"+uo+"Cookie"]=9,Qi.ErrorPVCalc=10,Qi[ao+"WhileLoggingError"]=11,Qi[Zi+"AddingTelemetryTo"+ho]=12,Qi[eo+"Abort"]=13,Qi[eo+"Dur"]=14,Qi[eo+"Open"]=15,Qi[eo+"RSC"]=16,Qi[eo+"Send"]=17,Qi[eo+"GetCorrelationHeader"]=18,Qi[Zi+"ToAddHandlerForOnBeforeUnload"]=19,Qi[Zi+"ToSendQueuedTelemetry"]=20,Qi[Zi+"ToReportDataLoss"]=21,Qi["Flush"+Zi]=22,Qi.MessageLimitPerPVExceeded=23,Qi.MissingRequiredFieldSpecification=24,Qi.NavigationTimingNotSupported=25,Qi.OnError=26,Qi[uo+"RenewalDateIsZero"]=27,Qi.SenderNotInitialized=28,Qi[no+to+io+Zi]=29,Qi[ro+to+io+Zi]=30,Qi[no+to+Zi]=31,Qi[ro+to+Zi]=32,Qi.TelemetrySampledAndNotSent=33,Qi[to+io+Zi]=34,Qi[to+ao+Zi]=35,Qi[to+"Metric"+Zi]=36,Qi[to+"PV"+Zi]=37,Qi[to+"PV"+Zi+"Calc"]=38,Qi[to+"Trace"+Zi]=39,Qi["Transmission"+Zi]=40,Qi[Zi+"ToSet"+co+ho]=41,Qi[Zi+"ToRestore"+co+ho]=42,Qi.InvalidBackendResponse=43,Qi[Zi+"ToFixDepricatedValues"]=44,Qi.InvalidDurationValue=45,Qi.TelemetryEnvelopeInvalid=46,Qi.CreateEnvelopeError=47,Qi[fo+"SerializeObject"]=48,Qi[fo+"SerializeObjectNonSerializable"]=49,Qi.CircularReferenceDetected=50,Qi["Clear"+oo+Zi]=51,Qi[ao+"Truncated"]=52,Qi.IllegalCharsInName=53,Qi.ItemNotInArray=54,Qi.MaxAjaxPerPVExceeded=55,Qi.MessageTruncated=56,Qi.NameTooLong=57,Qi.SampleRateOutOfRange=58,Qi["Set"+oo+Zi]=59,Qi["Set"+oo+Zi+"AccountName"]=60,Qi.StringValueTooLong=61,Qi.StartCalledMoreThanOnce=62,Qi.StopCalledWithoutStart=63,Qi["TelemetryInitializer"+Zi]=64,Qi.TrackArgumentsNotSpecified=65,Qi.UrlTooLong=66,Qi[uo+co+ho+"Full"]=67,Qi[fo+"AccessCookie"]=68,Qi.IdTooLong=69,Qi.InvalidEvent=70,Qi[eo+"SetRequestHeader"]=71,Qi["Send"+lo+"InfoOnUserInit"]=72,Qi["Plugin"+ao]=73,Qi["Notification"+ao]=74,Qi.SnippetScriptLoadFailure=99,Qi["Invalid"+po]=100,Qi[fo+"ParseAiBlobValue"]=101,Qi.InvalidContentBlob=102,Qi[to+"PageAction"+io+Zi]=103,Qi[Zi+"AddingCustomDefinedRequestContext"]=104,Qi["InMemory"+co+ho+"Full"]=105,Qi[po+"Deprecation"]=106,Qi))),mo=(Xi({NotSet:0,Pii_DistinguishedName:1,Pii_GenericData:2,Pii_IPV4Address:3,Pii_IPv6Address:4,Pii_MailSubject:5,Pii_PhoneNumber:6,Pii_QueryString:7,Pii_SipAddress:8,Pii_SmtpAddress:9,Pii_Identity:10,Pii_Uri:11,Pii_Fqdn:12,Pii_IPV4AddressLegacy:13,CustomerContent_GenericContent:32}),Xi({Normal:1,CostDeferred:2,RealTime:3,Immediate:4}),Xi({Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9})),yo=(Xi({Normal:1,Critical:2}),Xi({NONE:0,ERROR:1,WARNING:2,INFORMATION:3}),pn(Object(Yi.a)(Object(Yi.a)({},go),Xi({AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520}))),function(e,t){var n=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0;var r=[],o=!1,s=!0,c={name:"DiagnosticLevel",processEvent:function(e){var t=e.eventFlags.diagnosticLevel;return o||10===t||110===t||120===t}},p={},y=Gi();this.init=function(){return s=s&&function(e){function t(t){return"string"==typeof e[t]||(h(t),!1)}var n=t("App.Name")&&t(l)&&t("App.Platform")&&t(f),r=e["User.IsAnonymous"];if(!1!==r&&void 0!==r||(n=n&&t("User.PrimaryIdentityHash")&&t("User.PrimaryIdentitySpace")),!n)return n;var i=e[l];/^(\d+\.){3}\d+(-?[a-zA-Z0-9]+)?$/.test(i)||(h(l),n=!1);var o=/^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$/,a=e[d];return!a||t(d)&&o.test(a)||(h(d),n=!1),o.test(e[f])||(h(f),n=!1),n}(p)},this.getOneDSTelemetryEvent=function(e){return b(e,{eventType:1})},this.getOneDSCustomerContent=function(e){if(t.enableCustomerContent&&e.telemetryProperties.customerContentVersion&&Math.floor(e.telemetryProperties.customerContentVersion)<=1&&1===e.telemetryProperties.customerContentType)return b(e,{eventType:2})};var b=function(e,t){var o,s=Object(g.b)(e);if(function(e,t){for(var n=function(n){var r=t[n];if(!r.processEvent(e))return Object(i.b)(2,1,(function(){return"".concat(e.eventName," suppressed by ").concat(r.name)})),{value:!1}},r=0;r<t.length;r++){var o=n(r);if("object"==typeof o)return o.value}return!0}(s,r)){var c=(o=s,o.timestamp?new Date(o.timestamp):new Date).toISOString(),l={"Event.Name":s.eventName,"Event.Source":"OTelJS","Event.Time":{value:c,propertyType:mo.DateTime}};for(var d in n.eventsProcessed++,l["Event.Sequence"]={value:n.eventsProcessed,propertyType:mo.Int64},l["Event.Id"]=y+"."+n.eventsProcessed,p)l[d]=p[d];if(!u(l,s.dataFields,!0,t.eventType))return void Object(i.b)(0,1,(function(){return"Dropping Event: "+s.eventName}));var f="custom";s.eventContract&&(s.eventContract.name&&(l["Event.Contract"]=s.eventContract.name,f+="."+s.eventContract.name.toLowerCase().replace(/\./g,"_")),u(l,s.eventContract.dataFields,!1,t.eventType));var h=function(e,t){return 2===t?a:e.telemetryProperties&&(1!==t||e.telemetryProperties.ariaTenantToken)?1===t?e.telemetryProperties.ariaTenantToken:void 0:void Object(i.b)(0,1,(function(){return"Missing Aria Token"}))}(s,t.eventType);if(!h)return;return{iKey:h,name:s.eventName,data:l,time:c,baseType:f,ext:{sdk:{seq:n.eventsProcessed}}}}};this.addPreprocessor=function(e){r.push(e)},this.getOneDSPersistentDataFields=function(){return p},this.getPreprocessors=function(){return r};var v=function(e){u(p,e,!1,1)};this.addPersistentDataFields=v,this.setOptionalEventsEnabled=function(e){o=e},this.setFullEventsEnabled=this.setOptionalEventsEnabled,t.enableOptionalEvents&&(o=!0),v(e);var w=t.coreFields;if(w){v(m.b.getFields(w.app)),v(m.e.getFields(w.user)),v(m.d.getFields(w.session));var S=w.release;S&&v(m.c.getFields(S))}this.addPreprocessor(c)}),bo="ctx",vo="ParentContextKey",wo="ChildrenContextKey",So=null,_o=function(){function e(t,n,r){var i,o=this,a=!1;(o.start=gn(),o[w]=t,o[W]=r,o[he]=function(){return!1},zt(n))&&(a=dn(o,"payload",(function(){return!i&&zt(n)&&(i=n(),n=null),i})));o[pe]=function(t){return t?t===e[vo]||t===e[wo]?o[t]:(o[bo]||{})[t]:null},o[ge]=function(t,n){if(t)if(t===e[vo])o[t]||(o[he]=function(){return!0}),o[t]=n;else if(t===e[wo])o[t]=n;else{(o[bo]=o[bo]||{})[t]=n}},o[me]=function(){var t=0,r=o[pe](e[wo]);if(Jt(r))for(var i=0;i<r[k];i++){var s=r[i];s&&(t+=s[A])}o[A]=gn()-o.start,o.exTime=o[A]-t,o[me]=function(){},!a&&zt(n)&&(o.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),To=function(){function e(t){this.ctx={},Je(e,this,(function(e){e.create=function(e,t,n){return new _o(e,t,n)},e.fire=function(e){e&&(e[me](),t&&zt(t[st])&&t[st](e))},e[ge]=function(t,n){t&&((e[bo]=e[bo]||{})[t]=n)},e[pe]=function(t){return(e[bo]||{})[t]}}))}return e.__ieDyn=1,e}(),Oo="CoreUtils.doPerf";function Co(e,t,n,r,i){if(e){var o=e;if(o[lt]&&(o=o[lt]()),o){var a=void 0,s=o[pe](Oo);try{if(a=o.create(t(),r,i)){if(s&&a[ge]&&(a[ge](_o[vo],s),s[pe]&&s[ge])){var u=s[pe](_o[wo]);u||(u=[],s[ge](_o[wo],u)),u[T](a)}return o[ge](Oo,a),n(a)}}catch(e){a&&a[ge]&&a[ge]("exception",e)}finally{a&&o.fire(a),o[ge](Oo,s)}}}return n()}var Eo="00000000000000000000000000000000",Io="0000000000000000";function ko(e,t,n){return!(!e||e[k]!==t||e===n)&&!!e.match(/^[\da-f]*$/)}function Ao(e){return ko(e,32,Eo)}function Po(e){return ko(e,16,Io)}var No=li("plugin");function jo(e){return No.get(e,"state",{},!0)}function Ro(e,t){for(var n,r=[],i=null,o=e[H]();o;){var a=o[M]();if(a){i&&zt(i[K])&&zt(a[nt])&&i[K](a);(zt(a[O])?a[O]():(n=jo(a))[O])||r[T](a),i=a,o=o[H]()}}nn(r,(function(r){var i=e[Xe]();r[v](e.getCfg(),i,t,e[H]()),n=jo(r),r[Xe]||n[Xe]||(n[Xe]=i),n[O]=!0,delete n[U]}))}function xo(e){return e.sort((function(e,t){var n=0;if(t){var r=zt(t[nt]);zt(e[nt])?n=r?e[rt]-t[rt]:1:r&&(n=-1)}else n=e?1:-1;return n}))}var Do="TelemetryPluginChain",Mo="_hasRun",Lo="_getTelCtx",Bo=0;function Fo(e,t,n,r){var i=null,o=[];null!==r&&(i=r?function(e,t,n){for(;e;){if(e[M]()===n)return e;e=e[H]()}return Wo([n],t[C]||{},t)}(e,n,r):e);var a={_next:function(){var e=i;if(i=e?e[H]():null,!e){var t=o;t&&t[k]>0&&(nn(t,(function(e){try{e.func[ce](e.self,e.args)}catch(e){vr(n[I],2,73,"Unexpected Exception during onComplete - "+ir(e))}})),o=[])}return e},ctx:{core:function(){return n},diagLog:function(){return function(e,t){return(e||{})[I]||new yr(t)}(n,t)},getCfg:function(){return t},getExtCfg:s,getConfig:function(e,n,r){void 0===r&&(r=!1);var i,o=s(e,null);o&&!Bt(o[n])?i=o[n]:t&&!Bt(t[n])&&(i=t[n]);return Bt(i)?r:i},hasNext:function(){return!!i},getNext:function(){return i},setNext:function(e){i=e},iterate:function(e){var t;for(;t=a._next();){var n=t[M]();n&&e(n)}},onComplete:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];e&&o[T]({func:e,self:Lt(t)?a.ctx:t,args:n})}}};function s(e,n,r){var i;if(void 0===n&&(n={}),void 0===r&&(r=0),t){var o=t[tt];o&&e&&(i=o[e])}if(i){if(qt(n)&&0!==r){var a=En(!0,n,i);t&&2===r&&Vt(n,(function(e){if(Bt(a[e])){var n=t[e];Bt(n)||(a[e]=n)}})),i=a}}else i=n;return i}return a}function Uo(e,t,n,r){var i=Fo(e,t,n,r),o=i.ctx;return o[P]=function(e){var t=i._next();return t&&t[nt](e,o),!t},o[J]=function(e,r){return void 0===e&&(e=null),Jt(e)&&(e=Wo(e,t,n,r)),Uo(e||o[H](),t,n,r)},o}function qo(e,t,n){var r=t[C]||{},i=Fo(e,r,t,n),o=i.ctx;return o[P]=function(e){var t=i._next();return t&&t.unload(o,e),!t},o[J]=function(e,n){return void 0===e&&(e=null),Jt(e)&&(e=Wo(e,r,t,n)),qo(e||o[H](),t,n)},o}function zo(e,t,n){var r=t[C]||{},i=Fo(e,r,t,n).ctx;return i[P]=function(e){return i.iterate((function(t){zt(t[G])&&t[G](i,e)}))},i[J]=function(e,n){return void 0===e&&(e=null),Jt(e)&&(e=Wo(e,r,t,n)),zo(e||i[H](),t,n)},i}function Wo(e,t,n,r){var i=null,o=!r;if(Jt(e)&&e[k]>0){var a=null;nn(e,(function(e){if(o||r!==e||(o=!0),o&&e&&zt(e[nt])){var s=function(e,t,n){var r,i=null,o=zt(e[nt]),a=zt(e[K]);r=e?e[_]+"-"+e[rt]+"-"+Bo++:"Unknown-0-"+Bo++;var s={getPlugin:function(){return e},getNext:function(){return i},processTelemetry:l,unload:d,update:f,_id:r,_setNext:function(e){i=e}};function u(){var r;return e&&zt(e[Lo])&&(r=e[Lo]()),r||(r=Uo(s,t,n)),r}function c(t,n,o,a,s){var u=!1,c=e?e[_]:Do,l=t[Mo];return l||(l=t[Mo]={}),t.setNext(i),e&&Co(t[Xe](),(function(){return c+":"+o}),(function(){l[r]=!0;try{var e=i?i._id:Qe;e&&(l[e]=!1),u=n(t)}catch(e){var a=!i||l[i._id];a&&(u=!0),i&&a||vr(t[$](),1,73,"Plugin ["+c+"] failed during "+o+" - "+ir(e)+", run flags: "+ir(l))}}),a,s),u}function l(t,n){function r(n){if(!e||!o)return!1;var r=jo(e);return!r[U]&&!r[et]&&(a&&e[K](i),e[nt](t,n),!0)}c(n=n||u(),r,"processTelemetry",(function(){return{item:t}}),!t.sync)||n[P](t)}function d(t,n){function r(){var r=!1;if(e){var i=jo(e),o=e[Xe]||i[Xe];!e||o&&o!==t.core()||i[U]||(i[Xe]=null,i[U]=!0,i[O]=!1,e[U]&&!0===e[U](t,n)&&(r=!0))}return r}c(t,r,"unload",(function(){}),n[W])||t[P](n)}function f(t,n){function r(){var r=!1;if(e){var i=jo(e),o=e[Xe]||i[Xe];!e||o&&o!==t.core()||i[U]||e[G]&&!0===e[G](t,n)&&(r=!0)}return r}c(t,r,"update",(function(){}),!1)||t[P](n)}return pn(s)}(e,t,n);i||(i=s),a&&a._setNext(s),a=s}}))}return r&&!i?Wo([r],t,n):i}var Vo=500,Go="Channel has invalid priority - ";function Ho(e,t,n){t&&Jt(t)&&t[k]>0&&(nn(t=t.sort((function(e,t){return e[rt]-t[rt]})),(function(e){e[rt]<Vo&&Sn(Go+e[_])})),e[T]({queue:pn(t),chain:Wo(t,n[C],n)}))}function $o(){var e=[];return{add:function(t){t&&e[T](t)},run:function(t,n){nn(e,(function(e){try{e(t,n)}catch(e){vr(t[$](),2,73,"Unexpected error calling unload handler - "+ir(e))}})),e=[]}}}var Ko="getPlugin",Jo=function(){function e(){var t,n,r,i,o,a=this;function s(e){void 0===e&&(e=null);var t=e;if(!t){var i=n||Uo(null,{},a[Xe]);t=r&&r[Ko]?i[J](null,r[Ko]):i[J](null,r)}return t}function u(e,t,i){e&&yn(e,tt,[],null,Bt),!i&&t&&(i=t[N]()[H]());var o=r;r&&r[Ko]&&(o=r[Ko]()),a[Xe]=t,n=Uo(i,e,t,o)}function c(){t=!1,a[Xe]=null,n=null,r=null,o=[],i=$o()}c(),Je(e,a,(function(e){e[v]=function(e,n,r,i){u(e,n,i),t=!0},e[U]=function(t,n){var a,s=e[Xe];if(s&&(!t||s===t[Xe]())){var u,l=!1,d=t||qo(null,s,r&&r[Ko]?r[Ko]():r),f=n||((a={reason:0})[W]=!1,a);return e[V]&&!0===e[V](d,f,h)?u=!0:h(),u}function h(){if(!l){l=!0,i.run(d,n);var e=o;o=[],nn(e,(function(e){e.rm()})),!0===u&&d[P](f),c()}}},e[G]=function(t,n){var i=e[Xe];if(i&&(!t||i===t[Xe]())){var o,a=!1,s=t||zo(null,i,r&&r[Ko]?r[Ko]():r),c=n||{reason:0};return e._doUpdate&&!0===e._doUpdate(s,c,l)?o=!0:l(),o}function l(){a||(a=!0,u(s.getCfg(),s.core(),s[H]()))}},e._addHook=function(e){e&&(Jt(e)?o=o.concat(e):o[T](e))},Tn(e,"_addUnloadCb",(function(){return i}),"add")})),a[$]=function(e){return s(e)[$]()},a[O]=function(){return t},a.setInitialized=function(e){t=e},a[K]=function(e){r=e},a[P]=function(e,t){t?t[P](e):r&&zt(r[nt])&&r[nt](e,null)},a._getTelCtx=s}return e.__ieDyn=1,e}(),Qo=function(e){function t(){var n,r,i=e.call(this)||this;function o(){n=0,r=[]}return i.identifier="TelemetryInitializerPlugin",i.priority=199,o(),Je(t,i,(function(e,t){e.addTelemetryInitializer=function(e){var t={id:n++,fn:e};return r[T](t),{remove:function(){nn(r,(function(e,n){if(e.id===t.id)return r[F](n,1),-1}))}}},e[nt]=function(t,n){for(var i=!1,o=r[k],a=0;a<o;++a){var s=r[a];if(s)try{if(!1===s.fn[ie](null,[t])){i=!0;break}}catch(e){vr(n[$](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+mn(e),{exception:ir(e)},!0)}}i||e[P](t,n)},e[V]=function(){o()}})),i}return Object(Yi.b)(t,e),t.__ieDyn=1,t}(Jo),Yo="Plugins must provide initialize method",Xo="_notificationManager",Zo="SDK is still unloading...",ea={loggingLevelConsole:1};function ta(e,t){return new To(t)}function na(e,t){var n=!1;return nn(t,(function(t){if(t===e)return n=!0,-1})),n}var ra=function(){function e(){var t,n,r,i,o,a,s,u,c,l,d,f,h,p,g,m,y,V,G,H,$=0;Je(e,this,(function(e){function K(){n=!1,t=En(!0,{},ea),e[C]=t,e[I]=new yr(t),e[B]=[],g=new Qo,r=[],i=null,o=null,a=null,s=null,u=null,l=null,c=[],d=null,f=null,h=null,p=!1,m=null,y=ci("AIBaseCore",!0),V=$o(),H=null}function Q(){return Uo(Z(),t,e)}function Y(n){var r=function(e,t,n){var r,i=[],o={};return nn(n,(function(n){(Bt(n)||Bt(n[v]))&&Sn(Yo);var r=n[rt],a=n[_];n&&r&&(Bt(o[r])?o[r]=a:wr(e,"Two extensions have same priority #"+r+" - "+o[r]+", "+a)),(!r||r<t)&&i[T](n)})),(r={all:n})[Xe]=i,r}(e[I],Vo,c);l=r[Xe],u=null;var i=r.all;if(h=pn(function(e,t,n){var r=[];if(e&&nn(e,(function(e){return Ho(r,e,n)})),t){var i=[];nn(t,(function(e){e[rt]>Vo&&i[T](e)})),Ho(r,i,n)}return r}(f,i,e)),d){var o=rn(i,d);-1!==o&&i[F](o,1),-1!==(o=rn(l,d))&&l[F](o,1),d._setQueue(h)}else d=function(e,t){function n(){return Uo(null,t[C],t,null)}function r(e,t,n,r){var i=e?e[k]+1:1;function o(){0==--i&&(r&&r(),r=null)}i>0&&nn(e,(function(e){if(e&&e.queue[k]>0){var r=e.chain,a=t[J](r);a[D](o),n(a)}else i--})),o()}var i=!1,o={identifier:"ChannelControllerPlugin",priority:Vo,initialize:function(t,n,r,o){i=!0,nn(e,(function(e){e&&e.queue[k]>0&&Ro(Uo(e.chain,t,n),r)}))},isInitialized:function(){return i},processTelemetry:function(t,i){r(e,i||n(),(function(e){e[P](t)}),(function(){i[P](t)}))},update:function(t,n){var i=n||{reason:0};return r(e,t,(function(e){e[P](i)}),(function(){t[P](i)})),!0},pause:function(){r(e,n(),(function(e){e.iterate((function(e){e.pause&&e.pause()}))}),null)},resume:function(){r(e,n(),(function(e){e.iterate((function(e){e.resume&&e.resume()}))}),null)},teardown:function(t,n){var o=n||{reason:0,isAsync:!1};return r(e,t,(function(e){e[P](o)}),(function(){t[P](o),i=!1})),!0},getChannel:function(t){var n=null;return e&&e[k]>0&&nn(e,(function(e){if(e&&e.queue[k]>0&&(nn(e.queue,(function(e){if(e[_]===t)return n=e,-1})),n))return-1})),n},flush:function(t,i,o,a){var s=1,u=!1,c=null;function l(){s--,u&&0===s&&(c&&(clearTimeout(c),c=null),i&&i(u),i=null)}return a=a||5e3,r(e,n(),(function(e){e.iterate((function(e){if(e[L]){s++;var n=!1;e[L](t,(function(){n=!0,l()}),o)||n||(t&&null==c?c=setTimeout((function(){c=null,l()}),a):l())}}))}),(function(){u=!0,l()})),!0},_setQueue:function(t){e=t}};return o}(h,e);i[T](d),l[T](d),e[B]=xo(i),d[v](t,e,i),Ro(Q(),i),e[B]=pn(xo(l||[])).slice(),n&&function(t){var n=zo(Z(),e);e._updateHook&&!0===e._updateHook(n,t)||n[P](t)}(n)}function X(t){var n,r=null,i=null;return nn(e[B],(function(e){if(e[_]===t&&e!==d&&e!==g)return i=e,-1})),!i&&d&&(i=d.getChannel(t)),i&&((n={plugin:i})[te]=function(e){jo(i)[et]=!e},n.isEnabled=function(){var e=jo(i);return!e[U]&&!e[et]},n.remove=function(e,t){var n;void 0===e&&(e=!0);var r=[i],o=((n={reason:1})[W]=e,n);ee(r,o,(function(e){e&&Y({reason:32,removed:r}),t&&t(e)}))},r=n),r}function Z(){if(!u){var n=(l||[]).slice();-1===rn(n,g)&&n[T](g),u=Wo(xo(n),t,e)}return u}function ee(n,r,i){if(n&&n[k]>0){var o=qo(Wo(n,t,e),e);o[D]((function(){var e=!1,t=[];nn(c,(function(r,i){na(r,n)?e=!0:t[T](r)})),c=t;var r=[];f&&(nn(f,(function(t,i){var o=[];nn(t,(function(t){na(t,n)?e=!0:o[T](t)})),r[T](o)})),f=r),i&&i(e)})),o[P](r)}else i(!1)}function ne(){var n=e[I]?e[I].queue:[];n&&(nn(n,(function(n){var r,i=((r={})[w]=m||"InternalMessageId: "+n[q],r.iKey=vn(t[E]),r.time=tn(new Date),r.baseType=mr.dataType,r.baseData={message:n[z]},r);e.track(i)})),n[k]=0)}function re(e,t,n,r){return d?d[L](e,t,n||6,r):(t&&t(!1),!0)}function ie(t){var n=e[I];n?vr(n,2,73,t):Sn(t)}K(),e[O]=function(){return n},e[v]=function(r,o,s,u){p&&Sn(Zo),e[O]()&&Sn("Core should not be initialized more than once"),t=r||{},e[C]=t,Bt(r[E])&&Sn("Please provide instrumentation key"),i=u,e[Xo]=u,function(){var e=vn(t.disableDbgExt);!0===e&&G&&(i[R](G),G=null);i&&!G&&!0!==e&&(G=function(e){if(!cr){cr={};for(var t=0;t<lr[k];t++)cr[lr[t]]=fr(lr[t],e)}return cr}(t),i[j](G))}(),function(){var e=vn(t.enablePerfMgr);!e&&a&&(a=null);e&&bn(t,Ze,ta)}(),bn(t,tt,{}).NotificationManager=i,s&&(e[I]=s);var l=bn(t,"extensions",[]);(c=[])[T].apply(c,Object(Yi.c)(Object(Yi.c)([],o,!1),l,!1)),f=bn(t,Ye,[]),Y(null),h&&0!==h[k]||Sn("No "+Ye+" available"),n=!0,e.releaseQueue()},e.getTransmissionControls=function(){var e=[];return h&&nn(h,(function(t){e[T](t.queue)})),pn(e)},e.track=function(n){n.iKey=n.iKey||t[E],n[A]=n[A]||tn(new Date),n.ver=n.ver||"4.0",!p&&e[O]()?Q()[P](n):r[T](n)},e[N]=Q,e[S]=function(){var t;return i||(i=Object(b.b)(((t={})[j]=function(e){},t[R]=function(e){},t[it]=function(e){},t[ot]=function(e,t){},t[at]=function(e,t){},t)),e[Xo]=i),i},e[j]=function(e){i&&i[j](e)},e[R]=function(e){i&&i[R](e)},e.getCookieMgr=function(){return s||(s=Lr(t,e[I])),s},e.setCookieMgr=function(e){s=e},e[lt]=function(){if(!o&&!a&&vn(t.enablePerfMgr)){var n=vn(t[Ze]);zt(n)&&(a=n(e,e[S]()))}return o||a||So},e.setPerfMgr=function(e){o=e},e.eventCnt=function(){return r[k]},e.releaseQueue=function(){if(n&&r[k]>0){var e=r;r=[],nn(e,(function(e){Q()[P](e)}))}},e.pollInternalLogs=function(e){m=e||null;var n=vn(t.diagnosticLogInterval);return n&&n>0||(n=1e4),$&&clearInterval($),$=setInterval((function(){ne()}),n)},e[x]=function(){$&&(clearInterval($),$=0,ne())},On(e,(function(){return g}),["addTelemetryInitializer"]),e.unload=function(t,r,i){var o;void 0===t&&(t=!0),n||Sn("SDK is not initialized"),p&&Sn(Zo);var a=((o={reason:50})[W]=t,o.flushComplete=!1,o),s=qo(Z(),e);function u(t){a.flushComplete=t,p=!0,V.run(s,a),e[x](),s[P](a)}s[D]((function(){K(),r&&r(a)}),e),re(t,u,6,i)||u(!1)},e[M]=X,e.addPlugin=function(e,t,n,r){if(!e)return r&&r(!1),void ie(Yo);var i=X(e[_]);if(i&&!t)return r&&r(!1),void ie("Plugin ["+e[_]+"] is already loaded!");var o={reason:16};function a(t){c[T](e),o.added=[e],Y(o),r&&r(!0)}if(i){var s=[i.plugin];ee(s,{reason:2,isAsync:!!n},(function(e){e?(o.removed=s,o.reason|=32,a()):r&&r(!1)}))}else a()},e.evtNamespace=function(){return y},e[L]=re,e.getTraceCtx=function(e){var t,n;return H||(n={},H={getName:function(){return n[w]},setName:function(e){t&&t.setName(e),n[w]=e},getTraceId:function(){return n[ye]},setTraceId:function(e){t&&t.setTraceId(e),Ao(e)&&(n[ye]=e)},getSpanId:function(){return n[be]},setSpanId:function(e){t&&t.setSpanId(e),Po(e)&&(n[be]=e)},getTraceFlags:function(){return n[ve]},setTraceFlags:function(e){t&&t.setTraceFlags(e),n[ve]=e}}),H},e.setTraceCtx=function(e){H=e||null},Tn(e,"addUnloadCb",(function(){return V}),"add")}))}return e.__ieDyn=1,e}();function ia(e,t,n,r){nn(e,(function(e){if(e&&e[t])if(n)setTimeout((function(){return r(e)}),0);else try{r(e)}catch(e){}}))}var oa,aa=function(){function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;Je(e,this,(function(e){e[j]=function(t){e.listeners[T](t)},e[R]=function(t){for(var n=rn(e[fe],t);n>-1;)e.listeners[F](n,1),n=rn(e[fe],t)},e[it]=function(t){ia(e[fe],it,!0,(function(e){e[it](t)}))},e[ot]=function(t,n){ia(e[fe],ot,!0,(function(e){e[ot](t,n)}))},e[at]=function(t,n){ia(e[fe],at,n,(function(e){e[at](t,n)}))},e[st]=function(t){t&&(!n&&t[he]()||ia(e[fe],st,!1,(function(e){t[W]?setTimeout((function(){return e[st](t)}),0):e[st](t)})))}}))}return e.__ieDyn=1,e}(),sa=function(e){function t(){var n=e.call(this)||this;return Je(t,n,(function(e,t){function n(t){var n=e[S]();n&&n[ot]([t],2)}e[v]=function(e,n,r,i){t[v](e,n,r||new yr(e),i||new aa(e))},e.track=function(r){Co(e[lt](),(function(){return"AppInsightsCore:track"}),(function(){null===r&&(n(r),Sn("Invalid telemetry item")),function(e){Bt(e[w])&&(n(e),Sn("telemetry name required"))}(r),t.track(r)}),(function(){return{item:r}}),!r.sync)}})),n}return Object(Yi.b)(t,e),t.__ieDyn=1,t}(ra),ua="",ca="version",la="properties",da="3.2.6",fa="1DS-Web-JS-"+da,ha="withCredentials",pa=((oa={})[0]=0,oa[2]=6,oa[1]=1,oa[3]=7,oa[4098]=6,oa[4097]=1,oa[4099]=7,oa);Boolean(Jn()),Boolean(Kn());function ga(e){return!(e===ua||Bt(e))}function ma(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return ua}function ya(e){return!!(e&&Xt(e)&&e>=1&&e<=4)}function ba(e,t,n){if(!t&&!ga(t)||"string"!=typeof e)return null;var r=typeof t;if("string"===r||"number"===r||"boolean"===r||Jt(t))t={value:t};else if("object"!==r||y.e.call(t,"value")){if(Bt(t.value)||t.value===ua||!Yt(t.value)&&!Xt(t.value)&&!Zt(t.value)&&!Jt(t.value))return null}else t={value:n?JSON.stringify(t):t};if(Jt(t.value)&&!Ta(t.value))return null;if(!Bt(t.kind)){if(Jt(t.value)||!_a(t.kind))return null;t.value=t.value.toString()}return t}function va(e,t,n){var r=-1;if(!Lt(e))if(t>0&&(32===t?r=8192:t<=13&&(r=t<<5)),function(e){if(e>=0&&e<=9)return!0;return!1}(n))-1===r&&(r=0),r|=n;else{var i=pa[Ca(e)]||-1;-1!==r&&-1!==i?r|=i:6===i&&(r=i)}return r}function wa(e,t,n,r,i){var o={},a=!1,s=0,u=arguments.length,c=arguments;for("[object Boolean]"===Object[y.k].toString.call(c[0])&&(a=c[0],s++);s<u;s++){Vt(c[s],(function(e,t){a&&t&&qt(t)?Jt(t)?(o[e]=o[e]||[],nn(t,(function(t,n){t&&qt(t)?o[e][n]=wa(!0,o[e][n],t):o[e][n]=t}))):o[e]=wa(!0,o[e],t):o[e]=t}))}return o}var Sa=Hi;function _a(e){return 0===e||e>0&&e<=13||32===e}function Ta(e){return e.length>0}function Oa(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=Sa()}function Ca(e){var t=0;if(null!=e){var n=typeof e;"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===y.j&&(t=4,Jt(e)?(t=4096,e.length>0&&(t|=Ca(e[0]))):y.e.call(e,"value")&&(t=8192|Ca(e.value)))}return t}y.l,y.j,y.l,b.b;var Ea=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],Je(t,n,(function(e,t){e.logger&&e.logger.queue||(e.logger=new yr({loggingLevelConsole:1})),e.initialize=function(n,r,i,o){Co(e,(function(){return"AppInsightsCore.initialize"}),(function(){var a=e.pluginVersionStringArr;if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var s=n.propertyStorageOverride;!s||s.getProperty&&s.setProperty||Sn("Invalid property storage override passed."),n.channels&&nn(n.channels,(function(e){e&&nn(e,(function(e){if(e.identifier&&e.version){var t=e.identifier+"="+e.version;a.push(t)}}))}))}e.getWParam=function(){return"undefined"!=typeof document||n.enableWParam?0:-1},r&&nn(r,(function(e){if(e&&e.identifier&&e.version){var t=e.identifier+"="+e.version;a.push(t)}})),e.pluginVersionString=a.join(";"),e.pluginVersionStringArr=a;try{t.initialize(n,r,i,o),e.pollInternalLogs("InternalLog")}catch(t){var u=e.logger,c=ir(t);-1!==c.indexOf("channels")&&(c+="\n - Channels must be provided through config.channels only!"),vr(u,1,514,"SDK Initialization Failed - no telemetry will be sent: "+c)}}),(function(){return{config:n,extensions:r,logger:i,notificationManager:o}}))},e.track=function(n){Co(e,(function(){return"AppInsightsCore.track"}),(function(){var r=n;if(r){r.timings=r.timings||{},r.timings.trackStart=Sa(),ya(r.latency)||(r.latency=1);var i=r.ext=r.ext||{};i.sdk=i.sdk||{},i.sdk.ver=fa;var o=r.baseData=r.baseData||{};o[la]=o[la]||{};var a=o[la];a[ca]=a[ca]||e.pluginVersionString||ua}t.track(r)}),(function(){return{item:n}}),!n.sync)}})),n}return Object(Yi.b)(t,e),t.__ieDyn=1,t}(sa),Ia=Xi({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5}),ka="REAL_TIME",Aa="POST",Pa="drop",Na="send",ja="requeue",Ra="rspFail",xa="application/x-json-stream",Da="cache-control",Ma="content-type",La="kill-tokens",Ba="kill-duration",Fa="time-delta-millis",Ua="client-version",qa="client-id",za="time-delta-to-apply-millis",Wa="upload-time",Va="apikey",Ga="AuthMsaDeviceTicket",Ha="AuthXToken",$a="msfpc",Ka="trace",Ja="user";function Qa(e){var t=(e.ext||{}).intweb;return t&&ga(t[$a])?t[$a]:null}function Ya(e){for(var t=null,n=0;null===t&&n<e.length;n++)t=Qa(e[n]);return t}var Xa=function(){function e(t,n){var r=n?[].concat(n):[],i=this,o=Ya(r);i.iKey=function(){return t},i.Msfpc=function(){return o||""},i.count=function(){return r.length},i.events=function(){return r},i.addEvent=function(e){return!!e&&(r.push(e),o||(o=Qa(e)),!0)},i.split=function(n,i){var a;if(n<r.length){var s=r.length-n;Bt(i)||(s=i<s?i:s),a=r.splice(n,s),o=Ya(r)}return new e(t,a)}}return e.create=function(t,n){return new e(t,n)},e}(),Za=function(){function e(){var t=!0,n=!0,r=!0,i="use-collector-delta",o=!1;Je(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){r&&(r=!1,o||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return i},e.setClockSkew=function(e){o||(e?(i=e,n=!0,o=!0):n=!1,t=!0)}}))}return e.__ieDyn=1,e}(),es=function(){function e(){var t={};Je(e,this,(function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var r=(a=e.split(","),s=[],a&&nn(a,(function(e){s.push(sn(e))})),s);if("this-request-only"===n)return r;for(var i=1e3*parseInt(n,10),o=0;o<r.length;++o)t[r[o]]=gn()+i}catch(e){return[]}var a,s;return[]},e.isTenantKilled=function(e){var n=t,r=sn(e);return void 0!==n[r]&&n[r]>gn()||(delete n[r],!1)}}))}return e.__ieDyn=1,e}();function ts(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)}var ns,rs=2e6,is=Math.min(rs,65e3),os="metadata",as="f",ss=/\./,us=function(){function e(t,n,r,i){var o="data",a="baseData",s=!!i,u=!0,c=n,l={};Je(e,this,(function(e){function n(e,t,i,o,a,u,d){Vt(e,(function(e,f){var h=null;if(f||ga(f)){var p=i,g=e,m=a,y=t;if(s&&!o&&ss.test(e)){var b=e.split("."),v=b.length;if(v>1){m&&(m=m.slice());for(var w=0;w<v-1;w++){var S=b[w];y=y[S]=y[S]||{},p+="."+S,m&&m.push(S)}g=b[v-1]}}var _=o&&function(e){var t=l[e];return void 0===t&&(e.length>=7&&(t=Ht(e,"ext.metadata")||Ht(e,"ext.web")),l[e]=t),t}(p);if(h=!_&&c&&c.handleField(p,g)?c.value(p,g,f,r):ba(g,f,r)){var T=h.value;if(y[g]=T,u&&u(m,g,h),d&&"object"==typeof T&&!Jt(T)){var O=m;O&&(O=O.slice()).push(g),n(f,T,p+"."+g,o,O,u,d)}}}}))}e.createPayload=function(e,t,n,r,i,o){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:r,sendType:o,sendReason:i}},e.appendPayload=function(n,r,i){var o=n&&r&&!n.overflow;return o&&Co(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=r.events(),o=n.payloadBlob,a=n.numEvents,s=!1,u=[],c=[],l=n.isBeacon,d=l?65e3:3984588,f=l?is:rs,h=0,p=0;h<t.length;){var g=t[h];if(g){if(a>=i){n.overflow=r.split(h);break}var m=e.getEventBlob(g);if(m&&m.length<=f){var y=m.length;if(o.length+y>d){n.overflow=r.split(h);break}o&&(o+="\n"),o+=m,++p>20&&(o.substr(0,1),p=0),s=!0,a++}else m?u.push(g):c.push(g),t.splice(h,1),h--}h++}if(u&&u.length>0&&n.sizeExceed.push(Xa.create(r.iKey(),u)),c&&c.length>0&&n.failedEvts.push(Xa.create(r.iKey(),c)),s){n.batches.push(r),n.payloadBlob=o,n.numEvents=a;var b=r.iKey();-1===rn(n.apiKeys,b)&&n.apiKeys.push(b)}}),(function(){return{payload:n,theBatch:{iKey:r.iKey(),evts:r.events()},max:i}})),o},e.getEventBlob=function(e){try{return Co(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+ma(e.iKey);var r={},i=e.ext;i&&(t.ext=r,Vt(i,(function(e,t){n(t,r[e]={},"ext."+e,!0,null,null,!0)})));var s=t[o]={};s.baseType=e.baseType;var c=s[a]={};return n(e.baseData,c,a,!1,[a],(function(e,t,n){cs(r,e,t,n)}),u),n(e.data,s,o,!1,[],(function(e,t,n){cs(r,e,t,n)}),u),JSON.stringify(t)}),(function(){return{item:e}}))}catch(e){return null}}}))}return e.__ieDyn=1,e}();function cs(e,t,n,r){if(r&&e){var i=va(r.value,r.kind,r.propertyType);if(i>-1){var o=e[os];o||(o=e[os]={f:{}});var a=o[as];if(a||(a=o[as]={}),t)for(var s=0;s<t.length;s++){var u=t[s];a[u]||(a[u]={f:{}});var c=a[u][as];c||(c=a[u][as]={}),a=c}a=a[n]={},Jt(r.value)?a.a={t:i}:a.t=i}}}var ls="sendAttempt",ds="&NoResponseBody=true",fs=((ns={})[1]=ja,ns[100]=ja,ns[200]="sent",ns[8004]=Pa,ns[8003]=Pa,ns),hs={},ps={};function gs(e,t,n){hs[e]=t,!1!==n&&(ps[t]=e)}function ms(e){try{return e.responseText}catch(e){}return""}function ys(e,t){var n=!1;if(e&&t){var r=ln(e);if(r&&r.length>0)for(var i=t.toLowerCase(),o=0;o<r.length;o++){var a=r[o];if(a&&Ut(t,a)&&a.toLowerCase()===i){n=!0;break}}}return n}function bs(e,t,n,r){t&&n&&n.length>0&&(r&&hs[t]?(e.hdrs[hs[t]]=n,e.useHdrs=!0):e.url+="&"+t+"="+n)}gs(Ga,Ga,!1),gs(Ua,Ua),gs(qa,"Client-Id"),gs(Va,Va),gs(za,za),gs(Wa,Wa),gs(Ha,Ha);var vs=function(){function e(t,n,r,i,o){this._responseHandlers=[];var a,s,u,c,l,d,f,h="?cors=true&"+Ma.toLowerCase()+"="+xa,p=new es,g=!1,m=new Za,b=!1,v=0,w=!0,S=[],_={},T=[],O=null,C=!1,E=!1,I=!1;Je(e,this,(function(e){var k=!0;function A(e,t){for(var n=0,r=null,i=0;null==r&&i<e.length;)1===(n=e[i])?sr()?r=P:ur()&&(r=j):2===n&&ar(t)?r=N:b&&3===n&&or()&&(r=x),i++;return r?{_transport:n,_isSync:t,sendPOST:r}:null}function P(e,t,n){var r=new XDomainRequest;r.open(Aa,e.urlString),e.timeout&&(r.timeout=e.timeout),r.onload=function(){var e=ms(r);R(t,200,{},e),H(e)},r.onerror=function(){R(t,400,{})},r.ontimeout=function(){R(t,500,{})},r.onprogress=function(){},n?r.send(e.data):o.set((function(){r.send(e.data)}),0)}function N(e,t,n){var r,i=e.urlString,a=!1,s=!1,u=((r={body:e.data,method:Aa}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,r);n&&(u.keepalive=!0,2===e._sendReason&&(a=!0,i+=ds)),k&&(u.credentials="include"),e.headers&&ln(e.headers).length>0&&(u.headers=e.headers),fetch(i,u).then((function(e){var n={},r="",i=e.headers;i&&i.forEach((function(e,t){n[t]=e})),e.body&&e.text().then((function(e){r=e})),s||(s=!0,R(t,e.status,n,r),H(r))})).catch((function(e){s||(s=!0,R(t,0,{}))})),a&&!s&&(s=!0,R(t,200,{})),!s&&e.timeout>0&&o.set((function(){s||(s=!0,R(t,500,{}))}),e.timeout)}function j(e,t,n){var r=e.urlString;function i(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var r=t.getResponseHeader(n);r&&(e[n]=sn(r))}return e}function o(e){var t={};return e.getAllResponseHeaders?t=function(e){var t={};if(Yt(e)){nn(sn(e).split(/[\r\n]+/),(function(e){if(e){var n=e.indexOf(": ");if(-1!==n){var r=sn(e.substring(0,n)).toLowerCase(),i=sn(e.substring(n+1));t[r]=i}else t[sn(e)]=1}}))}return t}(e.getAllResponseHeaders()):(t=i(t,e,Fa),t=i(t,e,Ba),t=i(t,e,"kill-duration-seconds")),t}function a(e,n){R(t,e.status,o(e),n)}n&&e.disableXhrSync&&(n=!1);var s=function(e,t,n,r,i,o){function a(e,t,n){try{e[t]=n}catch(e){}}void 0===r&&(r=!1),void 0===i&&(i=!1);var s=new XMLHttpRequest;return r&&a(s,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",r),n&&a(s,ha,n),s.open(e,t,!i),n&&a(s,ha,n),!i&&o&&a(s,"timeout",o),s}(Aa,r,k,!0,n,e.timeout);Vt(e.headers,(function(e,t){s.setRequestHeader(e,t)})),s.onload=function(){var e=ms(s);a(s,e),H(e)},s.onerror=function(){a(s)},s.ontimeout=function(){a(s)},s.send(e.data)}function R(e,t,n,r){try{e(t,n,r)}catch(e){vr(s,2,518,ir(e))}}function x(e,t,n){var r=200,i=e._thePayload,o=e.urlString+ds;try{var a=Yn();if(!a.sendBeacon(o,e.data))if(i){var u=[];nn(i.batches,(function(e){if(u&&e&&e.count()>0){for(var t=e.events(),n=0;n<t.length;n++)if(!a.sendBeacon(o,O.getEventBlob(t[n]))){u.push(e.split(n));break}}else u.push(e.split(0))})),$(u,8003,i.sendType,!0)}else r=0}catch(e){wr(s,"Failed to send telemetry using sendBeacon API. Ex:"+ir(e)),r=0}finally{R(t,r,{},"")}}function D(e){return 2===e||3===e}function M(e){return E&&D(e)&&(e=2),e}function L(){return!g&&v<n}function B(){var e=T;return T=[],e}function F(e,t,n){var r=!1;return e&&e.length>0&&!g&&u[t]&&O&&(r=0!==t||L()&&(n>0||m.allowRequestSending())),r}function U(e){var t={};return e&&nn(e,(function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}})),t}function q(e,n,r,i,o){if(e&&0!==e.length)if(g)$(e,1,i);else{i=M(i);try{var a=e,l=0!==i;Co(c,(function(){return"HttpManager:_sendBatches"}),(function(a){a&&(e=e.slice(0));for(var s=[],c=null,d=Sa(),f=u[i]||(l?u[1]:u[0]),h=(E||D(i)||f&&3===f._transport)&&!w&&b&&or();F(e,i,n);){var g=e.shift();g&&g.count()>0&&(p.isTenantKilled(g.iKey())?s.push(g):(c=c||O.createPayload(n,r,l,h,o,i),O.appendPayload(c,g,t)?null!==c.overflow&&(e=[c.overflow].concat(e),c.overflow=null,V(c,d,Sa(),o),d=Sa(),c=null):(V(c,d,Sa(),o),d=Sa(),e=[g].concat(e),c=null)))}c&&V(c,d,Sa(),o),e.length>0&&(T=e.concat(T)),$(s,8004,i)}),(function(){return{batches:U(a),retryCount:n,isTeardown:r,isSynchronous:l,sendReason:o,useSendBeacon:D(i),sendType:i}}),!l)}catch(e){vr(s,2,48,"Unexpected Exception sending batch: "+ir(e))}}}function z(e,t){var n={url:h,hdrs:{},useHdrs:!1};t?(n.hdrs=wa(n.hdrs,_),n.useHdrs=ln(n.hdrs).length>0):Vt(_,(function(e,t){ps[e]?bs(n,ps[e],t,!1):(n.hdrs[e]=t,n.useHdrs=!0)})),bs(n,qa,"NO_AUTH",t),bs(n,Ua,fa,t);var r="";nn(e.apiKeys,(function(e){r.length>0&&(r+=","),r+=e})),bs(n,Va,r,t),bs(n,Wa,gn().toString(),t);var i=function(e){for(var t=0;t<e.batches.length;t++){var n=e.batches[t].Msfpc();if(n)return encodeURIComponent(n)}return""}(e);if(ga(i)&&(n.url+="&ext.intweb.msfpc="+i),m.shouldAddClockSkewHeaders()&&bs(n,za,m.getClockSkewHeaderValue(),t),c.getWParam){var o=c.getWParam();o>=0&&(n.url+="&w="+o)}for(var a=0;a<S.length;a++)n.url+="&"+S[a].name+"="+S[a].value;return n}function W(e,t,n){e[t]=e[t]||{},e[t][a.identifier]=n}function V(t,n,i,o){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var l=!!e.sendHook,h=u[t.sendType];!D(t.sendType)&&t.isBeacon&&2===t.sendReason&&(h=u[2]||u[3]||h);var g=I;(t.isBeacon||3===h._transport)&&(g=!1);var b=z(t,g);g=g||b.useHdrs;var S=Sa();Co(c,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var u=0;u<t.batches.length;u++)for(var _=t.batches[u].events(),T=0;T<_.length;T++){var O=_[T];if(C){var I=O.timings=O.timings||{};W(I,"sendEventStart",S),W(I,"serializationStart",n),W(I,"serializationCompleted",i)}O[ls]>0?O[ls]++:O[ls]=1}$(t.batches,1e3+(o||0),t.sendType,!0);var k={data:t.payloadBlob,urlString:b.url,headers:b.hdrs,_thePayload:t,_sendReason:o,timeout:d};Lt(f)||(k.disableXhrSync=!!f),g&&(ys(k.headers,Da)||(k.headers[Da]="no-cache, no-store"),ys(k.headers,Ma)||(k.headers[Ma]=xa));var A=null;h&&(A=function(n){m.firstRequestSent();var i=function(n,i){!function(t,n,i,o){var s=9e3,u=null,c=!1,l=!1;try{var d=!0;if(typeof t!==y.l){if(n){m.setClockSkew(n[Fa]);var f=n[Ba]||n["kill-duration-seconds"];nn(p.setKillSwitchTenants(n[La],f),(function(e){nn(i.batches,(function(t){if(t.iKey()===e){u=u||[];var n=t.split(0);i.numEvents-=n.count(),u.push(n)}}))}))}if(200==t||204==t)return void(s=200);((g=t)>=300&&g<500&&408!=g&&429!=g||501==g||505==g||i.numEvents<=0)&&(d=!1),s=9e3+t%1e3}if(d){s=100;var h=i.retryCnt;0===i.sendType&&(h<r?(c=!0,G((function(){0===i.sendType&&v--,q(i.batches,h+1,i.isTeardown,E?2:i.sendType,5)}),E,ts(h))):(l=!0,E&&(s=8001)))}}finally{c||(m.setClockSkew(),function(t,n,r,i){try{i&&a._backOffTransmission(),200===n&&(i||t.isSync||a._clearBackOff(),function(e){if(C){var t=Sa();nn(e,(function(e){e&&e.count()>0&&function(e,t){C&&nn(e,(function(e){W(e.timings=e.timings||{},"sendEventCompleted",t)}))}(e.events(),t)}))}}(t.batches)),$(t.batches,n,t.sendType,!0)}finally{0===t.sendType&&(v--,5!==r&&e.sendQueuedRequests(t.sendType,r))}}(i,s,o,l)),$(u,8004,i.sendType)}var g}(n,i,t,o)},u=t.isTeardown||t.isSync;try{h.sendPOST(n,i,u),e.sendListener&&e.sendListener(k,n,u,t.isBeacon)}catch(e){wr(s,"Unexpected exception sending payload. Ex:"+ir(e)),R(i,0,{})}}),Co(c,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(A)if(0===t.sendType&&v++,l&&!t.isBeacon&&3!==h._transport){var n={data:k.data,urlString:k.urlString,headers:wa({},k.headers),timeout:k.timeout,disableXhrSync:k.disableXhrSync},r=!1;Co(c,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(n,(function(e){r=!0,w||e._thePayload||(e._thePayload=e._thePayload||k._thePayload,e._sendReason=e._sendReason||k._sendReason),A(e)}),t.isSync||t.isTeardown)}catch(e){r||A(k)}}))}else A(k)}))}),(function(){return{thePayload:t,serializationStart:n,serializationCompleted:i,sendReason:o}}),t.isSync)}t.sizeExceed&&t.sizeExceed.length>0&&$(t.sizeExceed,8003,t.sendType),t.failedEvts&&t.failedEvts.length>0&&$(t.failedEvts,8002,t.sendType)}function G(e,t,n){t?e():o.set(e,n)}function H(t){var n=e._responseHandlers;try{for(var r=0;r<n.length;r++)try{n[r](t)}catch(e){vr(s,1,519,"Response handler failed: "+e)}if(t){var i=JSON.parse(t);ga(i.webResult)&&ga(i.webResult[$a])&&l.set("MSFPC",i.webResult[$a],31536e3)}}catch(e){}}function $(e,t,n,r){if(e&&e.length>0&&i){var o=i[function(e){var t=fs[e];ga(t)||(t="oth",e>=9e3&&e<=9999?t=Ra:e>=8e3&&e<=8999?t=Pa:e>=1e3&&e<=1999&&(t=Na));return t}(t)];if(o){var a=0!==n;Co(c,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){G((function(){try{o.call(i,e,t,a,n)}catch(e){vr(s,1,74,"send request notification failed: "+e)}}),r||a,0)}),(function(){return{batches:U(e),reason:t,isSync:a,sendSync:r,sendType:n}}),!a)}}}e.initialize=function(e,t,n,r,i){var o;i||(i={}),h=e+h,I=!!Lt(i.avoidOptions)||!i.avoidOptions,c=t,l=t.getCookieMgr(),C=!c.config.disableEventTimings;var p=!!c.config.enableCompoundKey;s=(a=n).diagLog();var g=i.valueSanitizer,m=i.stringifyObjects;Lt(i.enableCompoundKey)||(p=!!i.enableCompoundKey),d=i.xhrTimeout,f=i.disableXhrSync,b=!nr(),O=new us(c,g,m,p);var y=r,v=i.alwaysUseXhrOverride?r:null,S=i.alwaysUseXhrOverride?r:null;if(!r){w=!1;var _=Xn();_&&_.protocol&&"file:"===_.protocol.toLowerCase()&&(k=!1);var T=[];T=nr()?[2,1]:[1,2,3];var E=i.transports;E&&(Xt(E)?T=[E].concat(T):Jt(E)&&(T=E.concat(T))),r=A(T,!1),y=A(T,!0),r||wr(s,"No available transport to send events")}(o={})[0]=r,o[1]=y||A([1,2,3],!0),o[2]=v||A([3,2],!0)||y||A([1],!0),o[3]=S||A([2,3],!0)||y||A([1],!0),u=o},e._getDbgPlgTargets=function(){return[u[0],p,O,u]},e.addQueryStringParameter=function(e,t){for(var n=0;n<S.length;n++)if(S[n].name===e)return void(S[n].value=t);S.push({name:e,value:t})},e.addHeader=function(e,t){_[e]=t},e.canSendRequest=function(){return L()&&m.allowRequestSending()},e.sendQueuedRequests=function(e,t){Lt(e)&&(e=0),E&&(e=M(e),t=2),F(T,e,0)&&q(B(),0,!1,e,t||0)},e.isCompletelyIdle=function(){return!g&&0===v&&0===T.length},e.setUnloading=function(e){E=e},e.addBatch=function(e){if(e&&e.count()>0){if(p.isTenantKilled(e.iKey()))return!1;T.push(e)}return!0},e.teardown=function(){T.length>0&&q(B(),0,!0,2,2)},e.pause=function(){g=!0},e.resume=function(){g=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&(Bt(t)&&(t=1),E&&(t=M(t),n=2),q([e],0,!1,t,n||0))}}))}return e.__ieDyn=1,e}();function ws(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout(e,t,n)}function Ss(e){clearTimeout(e)}function _s(e,t){return{set:e||ws,clear:t||Ss}}var Ts="eventsDiscarded",Os="overrideInstrumentationKey",Cs="maxEventRetryAttempts",Es="maxUnloadEventRetryAttempts",Is=function(e){function t(){var n,r=e.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="3.2.6";var i,o,a,s,u,c,l,d=!1,f=[],h=null,p=!1,g=0,m=500,y=0,b=1e4,v={},w=ka,S=null,_=null,T=0,O=0,C={},E=-1,I=!0,k=!1,A=6,P=2;return Je(t,r,(function(e,t){function r(e){"beforeunload"!==(e||Kn().event).type&&(k=!0,o.setUnloading(k)),F(2,2)}function N(e){k=!1,o.setUnloading(k)}function j(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext[Ka]&&delete e.ext[Ka],e.ext&&e.ext[Ja]&&e.ext[Ja].id&&delete e.ext[Ja].id,I&&(e.ext=Cn(e.ext),e.baseData&&(e.baseData=Cn(e.baseData)),e.data&&(e.data=Cn(e.data))),e.sync)if(T||p)e.latency=3,e.sync=!1;else if(o)return I&&(e=Cn(e)),void o.sendSynchronousBatch(Xa.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var n=e.latency,r=y,i=b;4===n&&(r=g,i=m);var a=!1;if(r<i)a=!z(e,t);else{var s=1,u=20;4===n&&(s=4,u=1),a=!0,function(e,t,n,r){for(;n<=t;){var i=U(e,t,!0);if(i&&i.count()>0){var o=i.split(0,r),a=o.count();if(a>0)return 4===n?g-=a:y-=a,Y(Ts,[o],Ia.QueueFull),!0}n++}return W(),!1}(e.iKey,e.latency,s,u)&&(a=!z(e,t))}a&&Q(Ts,[e],Ia.QueueFull)}function R(e,t,n){var r=V(e,t,n);return o.sendQueuedRequests(t,n),r}function x(){return y>0}function D(){if(E>=0&&V(E,0,u)&&o.sendQueuedRequests(0,u),g>0&&!_&&!p){var e=v[w][2];e>=0&&(_=L((function(){_=null,R(4,0,1),D()}),e))}var t=v[w][1];!S&&!h&&t>=0&&!p&&(x()?S=L((function(){S=null,R(0===O?3:1,0,1),O++,O%=2,D()}),t):O=0)}function M(){n=null,d=!1,f=[],h=null,p=!1,g=0,m=500,y=0,b=1e4,v={},w=ka,S=null,_=null,T=0,O=0,i=null,C={},a=void 0,s=0,E=-1,u=null,I=!0,k=!1,A=6,P=2,c=null,l=_s(),o=new vs(500,2,1,{requeue:K,send:X,sent:Z,drop:ee,rspFail:te,oth:ne},l),$(),C[4]={batches:[],iKeyMap:{}},C[3]={batches:[],iKeyMap:{}},C[2]={batches:[],iKeyMap:{}},C[1]={batches:[],iKeyMap:{}},re()}function L(e,t){0===t&&T&&(t=1);var n=1e3;return T&&(n=ts(T-1)),l.set(e,t*n)}function B(){return null!==S&&(l.clear(S),S=null,O=0,!0)}function F(e,t){B(),h&&(l.clear(h),h=null),p||R(1,e,t)}function U(e,t,n){var r=C[t];r||(r=C[t=1]);var i=r.iKeyMap[e];return!i&&n&&(i=Xa.create(e),r.batches.push(i),r.iKeyMap[e]=i),i}function q(t,n){o.canSendRequest()&&!T&&(a>0&&y>a&&(n=!0),n&&null==h&&e.flush(t,null,20))}function z(e,t){I&&(e=Cn(e));var n=e.latency,r=U(e.iKey,n,!0);return!!r.addEvent(e)&&(4!==n?(y++,t&&0===e.sendAttempt&&q(!e.sync,s>0&&r.count()>=s)):g++,!0)}function W(){for(var e=0,t=0,n=function(n){var r=C[n];r&&r.batches&&nn(r.batches,(function(r){4===n?e+=r.count():t+=r.count()}))},r=1;r<=4;r++)n(r);y=t,g=e}function V(t,n,r){var i=!1,a=0===n;return!a||o.canSendRequest()?Co(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],n=4;n>=t;){var r=C[n];r&&r.batches&&r.batches.length>0&&(nn(r.batches,(function(t){o.addBatch(t)?i=i||t&&t.count()>0:e=e.concat(t.events()),4===n?g-=t.count():y-=t.count()})),r.batches=[],r.iKeyMap={}),n--}e.length>0&&Q(Ts,e,Ia.KillSwitch),i&&E>=t&&(E=-1,u=0)}),(function(){return{latency:t,sendType:n,sendReason:r}}),!a):(E=E>=0?Math.min(E,t):t,u=Math.max(u,r)),i}function G(e,t){R(1,0,t),W(),H((function(){e&&e(),f.length>0?h=L((function(){h=null,G(f.shift(),t)}),0):(h=null,D())}))}function H(e){o.isCompletelyIdle()?e():h=L((function(){h=null,H(e)}),.25)}function $(){(v={})[ka]=[2,1,0],v.NEAR_REAL_TIME=[6,3,0],v.BEST_EFFORT=[18,9,0]}function K(t,n){var r=[],i=A;k&&(i=P),nn(t,(function(t){t&&t.count()>0&&nn(t.events(),(function(t){t&&(t.sync&&(t.latency=4,t.sync=!1),t.sendAttempt<i?(Oa(t,e.identifier),j(t,!1)):r.push(t))}))})),r.length>0&&Q(Ts,r,Ia.NonRetryableStatus),k&&F(2,2)}function J(t,n){var r=e._notificationManager||{},i=r[t];if(i)try{i.apply(r,n)}catch(n){vr(e.diagLog(),1,74,t+" notification failed: "+n)}}function Q(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&J(e,[t].concat(n))}function Y(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&nn(t,(function(t){t&&t.count()>0&&J(e,[t.events()].concat(n))}))}function X(e,t,n){e&&e.length>0&&J("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])}function Z(e,t){Y("eventsSent",e,t),D()}function ee(e,t){Y(Ts,e,t>=8e3&&t<=8999?t-8e3:Ia.Unknown)}function te(e){Y(Ts,e,Ia.NonRetryableStatus),D()}function ne(e,t){Y(Ts,e,Ia.Unknown),D()}function re(){s=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,b/6)}M(),e._getDbgPlgTargets=function(){return[o]},e.initialize=function(s,u,d){Co(u,(function(){return"PostChannel:initialize"}),(function(){var f=u;t.initialize(s,u,d);try{u.addUnloadCb;c=xi(ci(e.identifier),u.evtNamespace&&u.evtNamespace());var h=e._getTelCtx();s.extensionConfig[e.identifier]=s.extensionConfig[e.identifier]||{},n=h.getExtCfg(e.identifier),l=_s(n.setTimeoutOverride,n.clearTimeoutOverride),I=!n.disableOptimizeObj&&!!Hn("chrome"),function(e){var t=e.getWParam;e.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|t()}}(f),n.eventsLimitInMem>0&&(b=n.eventsLimitInMem),n.immediateEventLimit>0&&(m=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(a=n.autoFlushEventsLimit),Xt(n[Cs])&&(A=n[Cs]),Xt(n[Es])&&(P=n[Es]),re(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(i=n.httpXHROverride),ga(s.anonCookieName)&&o.addQueryStringParameter("anoncknm",s.anonCookieName),o.sendHook=n.payloadPreprocessor,o.sendListener=n.payloadListener;var p=n.overrideEndpointUrl?n.overrideEndpointUrl:s.endpointUrl;e._notificationManager=s.extensionConfig.NotificationManager,o.initialize(p,e.core,e,i,n);var g=s.disablePageUnloadEvents||[];Ui(r,g,c),qi(r,g,c),zi(N,s.disablePageShowEvents,c)}catch(t){throw e.setInitialized(!1),t}}),(function(){return{coreConfig:s,core:u,extensions:d}}))},e.processTelemetry=function(t,r){Oa(t,e.identifier);var i=(r=e._getTelCtx(r)).getExtCfg(e.identifier),o=!!n.disableTelemetry;i&&(o=o||!!i.disableTelemetry);var a=t;o||d||(n[Os]&&(a.iKey=n[Os]),i&&i[Os]&&(a.iKey=i[Os]),j(a,!0),k?F(2,2):D()),e.processNext(a,r)},e._doTeardown=function(e,t){F(2,2),d=!0,o.teardown(),Fi([Si,wi,bi],null,c),function(e,t){var n=xi(_i,t);Fi([bi],e,n),Fi([yi],null,n)}(null,c),function(e,t){var n=xi(Ti,t);Fi([vi],e,n),Fi([yi],null,n)}(null,c),M()},e.setEventQueueLimits=function(e,t){b=e>0?e:1e4,a=t>0?t:0,re();var n=y>e;if(!n&&s>0)for(var r=1;!n&&r<=3;r++){var i=C[r];i&&i.batches&&nn(i.batches,(function(e){e&&e.count()>=s&&(n=!0)}))}q(!0,n)},e.pause=function(){B(),p=!0,o.pause()},e.resume=function(){p=!1,o.resume(),D()},e.addResponseHandler=function(e){o._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){B(),$(),w=ka,D(),Vt(e,(function(e,t){var n=t.length;if(n>=2){var r=n>2?t[2]:0;if(t.splice(0,n-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var i=t[0]/t[1];t[0]=Math.ceil(i)*t[1]}r>=0&&t[1]>=0&&r>t[1]&&(r=t[1]),t.push(r),v[e]=t}}))},e.flush=function(e,t,n){if(void 0===e&&(e=!0),!p)if(n=n||1,e)null==h?(B(),V(1,0,n),h=L((function(){h=null,G(t,n)}),0)):f.push(t);else{var r=B();R(1,1,n),null!=t&&t(),r&&D()}},e.setMsaAuthTicket=function(e){o.addHeader(Ga,e)},e.hasEvents=x,e._setTransmitProfile=function(e){w!==e&&void 0!==v[e]&&(B(),w=e,D())},e._backOffTransmission=function(){T<4&&(T++,B(),D())},e._clearBackOff=function(){T&&(T=0,B(),D())},dn(e,"_setTimeoutOverride",(function(){return l.set}),(function(e){l=_s(e,l.clear)})),dn(e,"_clearTimeoutOverride",(function(){return l.clear}),(function(e){l=_s(l.set,e)}))})),r}return Object(Yi.b)(t,e),t.__ieDyn=1,t}(Jo),ks=Is,As="HttpManager:_sendBatches",Ps="HttpManager:_sendBatchesNotification",Ns=function(){function e(e,t,n){this.start=Date.now(),this.name=e,this.isAsync=!0===n,this.payload=t}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),js=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,t,n){return e===As||e===Ps?new Ns(e,t,n):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case As:this.handleSendBatches(e);break;case Ps:this.handleSendBatchesNotification(e)}},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){this._callbacks.requestProcessingStats&&this._callbacks.requestProcessingStats(e.time||0,0)},e.prototype.handleSendBatchesNotification=function(e){if(this._callbacks.requestProcessingStats&&e.payload){var t=e.payload();if(t.batches&&t.reason&&t.reason>=1e3&&t.reason<=1999){var n=0;for(var r in t.batches)n+=t.batches[r].evts.length;this._callbacks.requestProcessingStats(0,n)}}},e}();function Rs(e,t,n,i){var o={instrumentationKey:t,endpointUrl:n,channelConfiguration:{eventsLimitInMem:e.eventsLimitInMem,httpXHROverride:e.httpXHROverride,setTimeoutOverride:e.setTimeoutOverride,clearTimeoutOverride:e.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0,disableOptimizeObj:!0},disableCookiesUsage:!0,extensionConfig:Object(r.a)({},e.extensionConfig)};e.stats&&e.stats.networkStats&&o.channelConfiguration&&(o.channelConfiguration.payloadListener=function(t,n){var r,i=n||t;i.data&&(null===(r=e.stats)||void 0===r||r.networkStats(i.data.length))});var a=new Ds;return a.initialize(o,i),a.setUploadFrequency(e.uploadFrequency),e.notificationListener&&a.addNotificationListener(e.notificationListener),e.stats&&a.setPerfMgr(new js(e.stats)),a}var xs=function(e,t){t&&t.addNotificationListener({eventsSent:function(t){Object(i.b)(2,2,(function(){return"Successfully sent ".concat(t.length," event(s)")})),Object(i.b)(3,2,(function(){return"Sent event(s) details : ".concat(JSON.stringify(t,null,2))})),e.eventsSent+=t.length},eventsDiscarded:function(t,n){Object(i.b)(0,2,(function(){return"Discarded ".concat(t.length," event(s) because ").concat(n)})),Object(i.b)(3,2,(function(){return"Discarded event(s) details : ".concat(JSON.stringify(t,null,2))})),e.eventsDiscarded+=t.length}})},Ds=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.d)(t,e),t.prototype.initialize=function(t,n){this._postChannel=new ks;var i=[];n&&(i=i.concat(n)),t.channels=[[this._postChannel]],t.extensionConfig=t.extensionConfig||[],t.extensionConfig[this._postChannel.identifier]=Object(r.a)(Object(r.a)({},t.channelConfiguration),t.extensionConfig[this._postChannel.identifier]);try{e.prototype.initialize.call(this,t,i)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},t.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var t=e/1e3,n=t/2,r={};r.OTelCustomTransmissionProfile=[t,n],this._postChannel._loadTransmitProfiles(r),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},t.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},t.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},t}(Ea),Ms=function(e){function t(t,n){var r,o,u=e.call(this,t,n)||this;u.sendTelemetryEvent=function(e){return c((function(){var t=u.getOneDSTelemetryEvent(e);t&&r&&r.track(t)}),s)},u.sendCustomerContent=function(e){return c((function(){var t=u.getOneDSCustomerContent(e);t&&o&&o.track(t)}),s)},u.sendNonStandardEvent=function(e,t){var n=!1;d.forEach((function(r){if(r.canHandle(t))return r.processEvent(e),void(n=!0)})),n||Object(i.b)(0,1,(function(){return"Missing Handler for "+t+"to process"+e.eventName}))},u.flush=function(e){null==r||r.flush(e),null==o||o.flush(e),d.forEach((function(t){t.flush(e)}))},u.shutdown=function(){try{null==r||r.shutdown(),null==o||o.shutdown(),d.forEach((function(e){e.shutdown()}))}catch(e){Object(i.b)(0,2,(function(){return"An error occurred on shutdown"}))}};var l=n.plugins||[],d=n.specialEventHandlers||[];if(d.forEach((function(e){e.initialize(u,n)})),!n.endpointUrl)throw new Error("Missing Endpoint Url");return r=Rs(n,"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",n.endpointUrl,l),n.enableCustomerContent&&n.endpointUrl===p.a.PUBLIC&&(o=Rs(n,a,p.a.CUSTOMER_CONTENT,l)),n.disableStatsTracking||(xs(u,r),xs(u,o)),u}return Object(r.d)(t,e),t}(yo)},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}));const r=1065;function i(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())}const o=65279;function a(e){if(!e)return[];let t="";try{(function(e){const t=atob(e),n=Uint8Array.from(t,(e=>e.charCodeAt(0))),r=new Uint16Array(n.length/2);if((n[1]<<8|n[0])!==o)throw new Error("Unexpected string encoding");for(let e=0;e<n.length;e+=2){const t=n[e+1]<<8|n[e];r[e/2]=t}return r.slice(1)})(e).forEach((e=>{t+=String.fromCharCode(e)}))}catch(n){t=function(e){try{if(!/^[a-z0-9+/]+={0,2}$/i.test(e)||e.length%4!=0)throw Error("Not base64 string");const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n,r,i,o,a,s,u,c;const l=[];for(let d=0;d<e.length;d+=4)o=t.indexOf(e.charAt(d)),a=t.indexOf(e.charAt(d+1)),s=t.indexOf(e.charAt(d+2)),u=t.indexOf(e.charAt(d+3)),c=o<<18|a<<12|s<<6|u,n=c>>>16&255,r=c>>>8&255,i=255&c,l[d/4]=String.fromCharCode(n,r,i),64===u&&(l[d/4]=String.fromCharCode(n,r)),64===s&&(l[d/4]=String.fromCharCode(n));return l.join("")}catch(e){throw new Error(`failed to decode unicode, reason: ${e}`)}}(e)}return t.split("\r\n").filter((e=>e))}function s(e){return function(e){let t="";e.forEach((e=>{t+=String.fromCharCode(e)}));return btoa(t)}(function(e){const t=new Uint16Array(e.length+1),n=new Uint8Array(2*t.length);t[0]=o;for(let n=0;n<e.length;n++)t[n+1]=e.charCodeAt(n);for(let e=0;e<n.length;e+=2){const r=t[e/2],i=r>>8,o=255&r;n[e]=o,n[e+1]=i}return n}(e.join("\r\n")+"\r\n"))}var u=n(256),c=n(330);let l;const d=36e5;async function f(e){if(e){if((await e.saveWordListToRoamingService(Object(c.a)())).success)return!0}return!1}function h(e){clearInterval(l),l=window.setInterval((async()=>{e&&await f(e)}),d)}let p;async function g(){return!(!p||!await f(p))&&(e=p,clearInterval(l),h(e),!0);var e}var m,y=n(257);!function(e){e[e.NOT_LOADED=0]="NOT_LOADED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.LOAD_ERROR=3]="LOAD_ERROR"}(m||(m={}));class b{constructor(e,t,n,r,i,o,a,s){this.authTokenCallback=e,this.environment=t,this.hostApplication=n,this.hostVersion=r,this.hostPlatform=i,this.hostCulture=o,this.logger=a,this.roamingClient=s,this.wordSet=new Set,this.lowerCaseWordSet=new Set,this.loadState=m.NOT_LOADED}async loadWordListFromRoamingService(e){let t;this.loadState=m.LOADING;try{t=(await Object(u.a)(this.authTokenCallback,this.environment,this.hostApplication,this.hostVersion,this.hostPlatform,this.hostCulture,e||Object(c.a)(),[r],this.logger,this.roamingClient)).get(r)}catch(e){return this.loadState=m.LOAD_ERROR,{success:!1,errorMessage:e.message}}return this.setDictionaryValue(t)}setDictionaryValue(e){if(!(e&&e.length>0))return this.loadState=m.LOADED,this.wordSet=new Set,this.lowerCaseWordSet=new Set,{success:!0};try{const t=a(e);return this.wordSet=new Set(t),this.lowerCaseWordSet=new Set(t.map((e=>e.toLocaleLowerCase()))),this.loadState=m.LOADED,{success:!0}}catch(e){return this.loadState=m.LOAD_ERROR,{success:!1,errorMessage:e.message}}}async saveWordListToRoamingService(e){if(this.loadState!==m.LOADED)return{success:!1,errorMessage:"No dictionary previously loaded"};const t=Array.from(this.wordSet).sort(i);let n="";try{n=s(t)}catch(e){return{success:!1,errorMessage:e.message}}if(n)try{return await Object(y.b)(this.authTokenCallback,this.environment,n,this.hostApplication,this.hostVersion,this.hostPlatform,this.hostCulture,e||Object(c.a)(),r,this.logger,this.roamingClient),{success:!0}}catch(e){return{success:!1,errorMessage:e.message}}return{success:!1,errorMessage:"Nothing to save"}}testWord(e,t){return t?this.wordSet.has(e):this.lowerCaseWordSet.has(e.toLocaleLowerCase())}setWordSet(e){return this.wordSet=new Set(e),this.lowerCaseWordSet=new Set(Array.from(e).map((e=>e.toLocaleLowerCase()))),{success:!0}}getWordList(){return Array.from(this.wordSet)}addWord(e){if(e&&!this.wordSet.has(e)){this.wordSet.add(e);const t=e.toLocaleLowerCase();return this.lowerCaseWordSet.has(t)||this.lowerCaseWordSet.add(t),g(),!0}return!1}removeWord(e){if(e&&this.wordSet.has(e)){this.wordSet.delete(e);const t=e.toLocaleLowerCase();return this.lowerCaseWordSet.has(t)&&this.lowerCaseWordSet.delete(t),!0}return!1}removeMultipleWords(e){let t=!0;for(const n of e)t=t||this.removeWord(n);return t}getLoadState(){return this.loadState}}},,,function(e,t){var n="undefined"!=typeof self?self:this,r=function(){function e(){this.fetch=!1,this.DOMException=n.DOMException}return e.prototype=n,new e}();!function(e){!function(t){var n="URLSearchParams"in e,r="Symbol"in e&&"iterator"in Symbol,i="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),o="FormData"in e,a="ArrayBuffer"in e;if(a)var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(e){return e&&s.indexOf(Object.prototype.toString.call(e))>-1};function c(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function l(e){return"string"!=typeof e&&(e=String(e)),e}function d(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function h(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function g(e){var t=new FileReader,n=p(t);return t.readAsArrayBuffer(e),n}function m(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:i&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():a&&i&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=m(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a&&(ArrayBuffer.prototype.isPrototypeOf(e)||u(e))?this._bodyArrayBuffer=m(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}),this.text=function(){var e,t,n,r=h(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=p(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(e,t){e=c(e),t=l(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},f.prototype.delete=function(e){delete this.map[c(e)]},f.prototype.get=function(e){return e=c(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(c(e))},f.prototype.set=function(e,t){this.map[c(e)]=l(t)},f.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},f.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),d(e)},f.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),d(e)},f.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),d(e)},r&&(f.prototype[Symbol.iterator]=f.prototype.entries);var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function v(e,t){var n,r,i=(t=t||{}).body;if(e instanceof v){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),b.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function w(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function S(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},y.call(v.prototype),y.call(S.prototype),S.prototype.clone=function(){return new S(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},S.error=function(){var e=new S(null,{status:0,statusText:""});return e.type="error",e};var _=[301,302,303,307,308];S.redirect=function(e,t){if(-1===_.indexOf(t))throw new RangeError("Invalid status code");return new S(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function T(e,n){return new Promise((function(r,o){var a=new v(e,n);if(a.signal&&a.signal.aborted)return o(new t.DOMException("Aborted","AbortError"));var s=new XMLHttpRequest;function u(){s.abort()}s.onload=function(){var e,t,n={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new f,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t)};n.url="responseURL"in s?s.responseURL:n.headers.get("X-Request-URL");var i="response"in s?s.response:s.responseText;r(new S(i,n))},s.onerror=function(){o(new TypeError("Network request failed"))},s.ontimeout=function(){o(new TypeError("Network request failed"))},s.onabort=function(){o(new t.DOMException("Aborted","AbortError"))},s.open(a.method,a.url,!0),"include"===a.credentials?s.withCredentials=!0:"omit"===a.credentials&&(s.withCredentials=!1),"responseType"in s&&i&&(s.responseType="blob"),a.headers.forEach((function(e,t){s.setRequestHeader(t,e)})),a.signal&&(a.signal.addEventListener("abort",u),s.onreadystatechange=function(){4===s.readyState&&a.signal.removeEventListener("abort",u)}),s.send(void 0===a._bodyInit?null:a._bodyInit)}))}T.polyfill=!0,e.fetch||(e.fetch=T,e.Headers=f,e.Request=v,e.Response=S),t.Headers=f,t.Request=v,t.Response=S,t.fetch=T,Object.defineProperty(t,"__esModule",{value:!0})}({})}(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var i=r;(t=i.fetch).default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,e.exports=t},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),i=n(244),o=n(11);const a=["af-ZA","ar-AE","ar-BH","ar-DZ","ar-EG","ar-IQ","ar-JO","ar-KW","ar-LB","ar-LY","ar-MA","ar-OM","ar-QA","ar-SA","ar-SY","ar-TN","ar-YE","as-IN","az-Latn-AZ","bg-BG","bn-BD","bn-IN","bs-Latn-BA","ca-ES","ca-ES-valencia","cs-CZ","cy-GB","da-DK","de-AT","de-CH","de-DE","de-LI","de-LU","el-GR","en-029","en-AU","en-BZ","en-CA","en-CB","en-GB","en-HK","en-ID","en-IE","en-IN","en-JM","en-MY","en-NZ","en-PH","en-SG","en-TT","en-US","en-ZA","en-ZW","es-419","es-AR","es-BO","es-CL","es-CO","es-CR","es-DO","es-EC","es-ES","es-ES_tradnl","es-GT","es-HN","es-MX","es-NI","es-PA","es-PE","es-PR","es-PY","es-SV","es-US","es-UY","es-VE","et-EE","eu-ES","fa-IR","fi-FI","fr-BE","fr-CA","fr-CD","fr-CH","fr-CI","fr-CM","fr-FR","fr-HT","fr-LU","fr-MA","fr-MC","fr-ML","fr-RE","fr-SN","ga-IE","gd-GB","gl-ES","gu-IN","ha-Latn-NG","he-IL","hi-IN","hr-BA","hr-HR","hu-HU","hy-AM","id-ID","ig-NG","is-IS","it-CH","it-IT","ja-JP","ka-GE","kk-KZ","kn-IN","kok-IN","ko-KR","ky-KG","lb-LU","lt-LT","lv-LV","mi-NZ","mk-MK","ml-IN","mr-IN","ms-BN","ms-MY","mt-MT","nb-NO","ne-IN","ne-NP","nl-BE","nl-NL","nn-NO","nso-ZA","or-IN","pa-IN","pl-PL","ps-AF","pt-BR","pt-PT","rm-CH","ro-MD","ro-RO","ru-MD","ru-RU","rw-RW","si-LK","sk-SK","sl-SI","sq-AL","sr-Cyrl-BA","sr-Cyrl-CS","sr-Cyrl-ME","sr-Cyrl-RS","sr-Latn-BA","sr-Latn-CS","sr-Latn-ME","sr-Latn-RS","sv-FI","sv-SE","sw-KE","ta-IN","te-IN","th-TH","tn-BW","tn-ZA","tr-TR","tt-RU","uk-UA","ur-IN","ur-PK","uz-Latn-UZ","vi-VN","wo-SN","xh-ZA","yo-NG","zu-ZA"];let s=class{constructor(){this.bxSupportedLanguages=a.map((e=>({languageId:e})))}getLanguageInfo(e){return Object(i.a)(e,!0,a)}mapToLanguageInfo(e){return Object(i.b)(e)}bxDefaultSupportedLanguages(){return Object(i.b)(this.bxSupportedLanguages)}};s=Object(r.c)([Object(o.a)()],s)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),i=n(11),o=n(330);let a=class{generate(){return Object(o.a)()}};a=Object(r.c)([Object(i.a)()],a)},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return w}));var r,i=n(2),o=n(9),a=n(11),s=n(7),u=n(27),c=n(52),l=n(53),d=n(8),f=n(89),h=n(285),p=n(132),g=n(55);let m=r=class{constructor(e,t,n,r,i,o){this._logger=e,this._safeWindow=t,this._eventName=n,this._performanceApiGarbageCollectorIntervalInMs=r,this._logToTelemetry=i,this._onTimeout=o,this._performanceMarksInGarbageCollection=[],this._measuresNames=new Map,this._performanceMarksInGCCorrelationKeysHistory=new Map}startEntry(e,t,n){const[r]=this._getPerformanceEntryNames(e);let i=window.performance.mark(r);if(void 0===i){const e=window.performance.getEntriesByName(r);if(1!==e.length)return void this._logger.logEvent(541099735,p.a.TelemetryError,g.a.Error,`Unable to find performance entry by name: ${r}`,u.a.SamplingPolicy.CriticalExperimentation);i=e[0]}this._performanceMarksInGarbageCollection.push(i),t&&this._performanceMarksInGCCorrelationKeysHistory.set(i.name,{correlationKeys:t,customData:n}),this._scheduleGarbageCollection(!1)}_getPerformanceEntryNames(e,t=this._eventName){const n=`${t}-${e}`;return[e,`${n}--${r.END_SUFFIX}`,n]}addMeasure(e,t,n){const[r,i,o]=this._getPerformanceEntryNames(e,t);if(0!==window.performance.getEntriesByName(r).length)try{if(window.performance.mark(i),window.performance.measure(o,r,i),this._measuresNames.set(e,[...this._measuresNames.get(e)||[],{name:t,duration:window.performance.getEntriesByName(o)[0].duration}]),window.performance.clearMarks(i),window.performance.clearMeasures(o),n){const e=this._performanceMarksInGCCorrelationKeysHistory.get(r);if(null==e?void 0:e.correlationKeys){const t=e.correlationKeys,i=e.customData;this._performanceMarksInGCCorrelationKeysHistory.set(r,{correlationKeys:t,customData:Object.assign(Object.assign({},i),n)})}}}catch(e){this._logger.logEvent(523646680,p.a.TelemetryError,g.a.Error,`Error while adding a checkpoint measure to a telemetry entry, error: ${e}`,u.a.SamplingPolicy.CriticalExperimentation)}}commitEntry(e,t=this._eventName,n){const[r,i,o]=this._getPerformanceEntryNames(e,t),a=window.performance.getEntriesByName(r);if(0!==a.length)try{window.performance.mark(i),window.performance.measure(o,r,i),this._measuresNames.set(e,[...this._measuresNames.get(e)||[],{name:t,duration:window.performance.getEntriesByName(o)[0].duration}]);const s=this._performanceMarksInGCCorrelationKeysHistory.get(r);this._logToTelemetry(this._measuresNames.get(e)||[],null==s?void 0:s.correlationKeys,null==s?void 0:s.customData,n),window.performance.clearMarks(r),window.performance.clearMarks(i),window.performance.clearMeasures(o),this._measuresNames.delete(e),this._removeGCTracedPerformanceMark(a[0])}catch(e){this._logger.logEvent(521417349,p.a.TelemetryError,g.a.Error,`Error while commiting a telemetry entry, error: ${e}`,u.a.SamplingPolicy.CriticalExperimentation)}}setOnTimeout(e){this._onTimeout=e}_clearAndReschedule(e){const t=Date.now(),n=[],r=this._performanceMarksInGarbageCollection.filter((r=>{const i=window.performance.timeOrigin+r.startTime;if(e&&!e.didTimeout&&0===e.timeRemaining()||t-i<this._performanceApiGarbageCollectorIntervalInMs)return!0;if(this._onTimeout){const e=this._performanceMarksInGCCorrelationKeysHistory.get(r.name)||{};e.isTimeout=!0,this._onTimeout(e.logicalId,e)}return n.push(r),window.performance.clearMarks(r.name),window.performance.clearMeasures(r.name),this._measuresNames.delete(r.name),!1}));for(const e of n)this._removeGCTracedPerformanceMark(e);this._garbageCollectionScheduler=void 0,r.length>0&&this._scheduleGarbageCollection(!0)}_removeGCTracedPerformanceMark(e){const t=this._performanceMarksInGarbageCollection.indexOf(e);t>=0&&this._performanceMarksInGarbageCollection.splice(t,1),this._performanceMarksInGCCorrelationKeysHistory.has(e.name)&&this._performanceMarksInGCCorrelationKeysHistory.delete(e.name)}_scheduleGarbageCollection(e){this._garbageCollectionScheduler||(!e&&"requestIdleCallback"in window?this._garbageCollectionScheduler=this._safeWindow.requestIdleCallback((e=>this._clearAndReschedule(e)),this._performanceApiGarbageCollectorIntervalInMs):this._garbageCollectionScheduler=window.setTimeout((()=>{this._clearAndReschedule()}),this._performanceApiGarbageCollectorIntervalInMs))}};m.END_SUFFIX="end",m=r=Object(i.c)([Object(a.a)()],m);var y=n(413),b=n(61);const v=Object(o.a)("IE2eMetric");let w=class{constructor(e,t,n,r){var i;this._logger=e,this._hostSettings=t,this._proofingStore=n,this._eventName="End2EndTelemetry",this._alEventName="IsAL",this._performanceApiGarbageCollectorIntervalInMs=1e4,this._logToTelemetry=e=>{const t=this._logger.getNewActivity(this._eventName,u.a.SamplingPolicy.CriticalExperimentation);if(!t)return;const n=this._proofingStore.getCachedEntry(d.a.ProofingLanguages).storeEntryValue;t.dataFields.push(...e.map((e=>Object(b.a)(e.name,e.duration,void 0,u.a.DataFieldType.Double.valueOf())))),t.dataFields.push(...Object(b.b)([this._alEventName,this._isAlEnabled],[y.a.NumProofingLanguages,n.length])),t.success=!0,t.endNow()},this._isAlEnabled=!0===this._hostSettings.enableOrchestration&&!0===(null===(i=this._hostSettings.orchestratorSettings)||void 0===i?void 0:i.enableAugLoop),this.metric=new m(e,r,this._eventName,this._performanceApiGarbageCollectorIntervalInMs,this._logToTelemetry)}startEntry(e){this._hostSettings.enableE2eMetric&&this.metric.startEntry(e)}addMeasure(e,t,n){this._hostSettings.enableE2eMetric&&this.metric.addMeasure(e,t,n)}commitEntry(e,t=this._eventName){this._hostSettings.enableE2eMetric&&this.metric.commitEntry(e,t)}setOnTimeout(e){this.metric.setOnTimeout(e)}};w=Object(i.c)([Object(a.a)(),Object(i.f)(0,Object(s.a)(l.a)),Object(i.f)(1,Object(s.a)(c.a)),Object(i.f)(2,Object(s.a)(f.a)),Object(i.f)(3,Object(s.a)(h.a))],w)},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(2),i=n(323),o=n(263),a=n(76),s=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(s=function(){return 1e3*Math.floor(window.performance.now())});var u=function(e){var t,n=s(),c=Object(i.b)(e.telemetryEvent);return Object(r.a)(Object(r.a)({cv:e.parentCv.getNext()},c),{createChildActivity:function(t){return u({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,n){this.result={code:e,type:t,tag:n}},endNow:function(){var r,i,u=this;if(!t){void 0===this.success&&void 0===this.result&&Object(a.b)(1,0,(function(){return"Activity does not have success or result set"}));var c=s();t=!0;var l={duration:c-n,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},d=null!==(i=null===(r=this.eventContract)||void 0===r?void 0:r.dataFields)&&void 0!==i?i:[];return d.push.apply(d,o.a.getFields(l)),this.eventContract={name:o.a.contractName,dataFields:d},e.sendTelemetryEvent(this)}Object(a.b)(0,0,(function(){return"'".concat(u.eventName,"' already ended")}))}})},c=n(21),l=function(e){var t="Error",n=[];return n.push(Object(c.c)("".concat(t,".ErrorGroup"),e.errorGroup)),n.push(Object(c.b)("".concat(t,".Tag"),e.tag)),void 0!==e.code&&n.push(Object(c.b)("".concat(t,".Code"),e.code)),void 0!==e.id&&n.push(Object(c.b)("".concat(t,".Id"),e.id)),void 0!==e.count&&n.push(Object(c.b)("".concat(t,".Count"),e.count)),n},d=n(460),f=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i.baseCv=Object(d.b)(),i}return Object(r.d)(t,e),t.prototype.createActivity=function(e){return u({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,n,r){return this.sendTelemetryEvent({eventName:e,eventContract:{name:o.a.contractName,dataFields:o.a.getFields(t)},dataFields:n,eventFlags:r})},t.prototype.sendError=function(e){var t=l(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return u({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(i.a),h=n(27),p=n(415),g=n(306),m=n(55),y=n(275);class b{constructor(e,t,n=!1,r=new f){this.kpisEnabled=n,this._oTelTelemetryLogger=r;const{logGroupName:i,tenant:o}=e,{tenantName:a,ariaTenantToken:s,nexusTenantToken:u}=o;this._logGroupName=i,this._oTelTelemetryLogger.addSink(t),this._oTelTelemetryLogger.setTenantToken(`Office.${a}`,s,u),this._namespace=`Office.${a}.${i}`}logEvent(e,t,n,r,i,o,a,s,u){const l=n===g.a.Undefined?t:`${n}.${t}`;if(r===m.a.Debug)return;const d=[Object(c.b)("Tag",e),Object(c.b)("Level",r)];i&&d.push(Object(c.c)(null!=u?u:"Data",Object(y.a)(i))),d.forEach((e=>e.classification=h.a.DataClassification.SystemMetadata)),this.uploadEvent(l,d,null!=o?o:b.DEFAULT_SAMPLING_POLICY,null!=a?a:b.DEFAULT_DIAGNOSTIC_LEVEL,null!=s?s:b.DEFAULT_DATA_CATEGORIES)}logKpi(e,t,n,r,i){if(!this.kpisEnabled)return;const o=`KPIs.${e}`,a=[Object(c.c)("Entity_Id",t),Object(c.a)("IsPremium",r)];i&&a.push(Object(c.c)("Data",JSON.stringify(i))),a.forEach((e=>e.classification=h.a.DataClassification.SystemMetadata));const s=p.a.Office.System.Funnel.getFields("Funnel",{name:this._logGroupName,state:n});a.push(...s),this.uploadEvent(o,a,h.a.SamplingPolicy.CriticalUsage,h.a.DiagnosticLevel.RequiredServiceData,h.a.DataCategories.ProductServiceUsage)}logStandaloneMetric(e,t,n,r,i=[]){const o=null!=t?t:b.DEFAULT_SAMPLING_POLICY,a=null!=n?n:b.DEFAULT_DIAGNOSTIC_LEVEL,s=null!=r?r:b.DEFAULT_DATA_CATEGORIES;this.uploadEvent(e,i,o,a,s)}createActivity(e,t,n){const r=t?`${t}.${e}`:e;return this._oTelTelemetryLogger.createActivity({eventName:this.getFullEventName(r),eventFlags:null!=n?n:{dataCategories:h.a.DataCategories.ProductServiceUsage}})}uploadEvent(e,t,n,r,i){const o=this.getFullEventName(e);this._oTelTelemetryLogger.sendTelemetryEvent({eventName:o,dataFields:t,eventFlags:{dataCategories:i,diagnosticLevel:r,costPriority:h.a.CostPriority.Normal,persistencePriority:h.a.PersistencePriority.Normal,samplingPolicy:n}})}getFullEventName(e){return this.capitalize(`${this._namespace}.${e}`)}capitalize(e){return e.split(".").map(this.capitalizeWord).join(".")}capitalizeWord(e){return e.charAt(0).toUpperCase()+e.slice(1)}}b.DEFAULT_SAMPLING_POLICY=h.a.SamplingPolicy.Measure,b.DEFAULT_DIAGNOSTIC_LEVEL=h.a.DiagnosticLevel.RequiredServiceData,b.DEFAULT_DATA_CATEGORIES=h.a.DataCategories.ProductServiceUsage},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(2),i=n(8),o=n(74),a=n(89),s=n(349),u=n(85),c=n(11),l=n(7),d=n(98),f=n(241);let h=class{constructor(e,t,n,r){this._featureFlagsReader=e,this._proofingPersistedStore=t,this._settingsEmitter=n,this._pageContextReceiver=r,this._supportedWebsites=["www.linkedin.com","medium.com","www.notion.so"],this._supportedWebsitesSpecialHandling=["www.facebook.com","twitter.com"],this._supportedWebsitesPartial=[".substack.com"],this._isCopywriterToggleEnabled=!0,this._isCopywriterPopupToggleEnabled=!0,this._isURLUserDisabled=!1,this._isInitialized=!1,this._updateCopywriterToggleEnabledValue=e=>{var t;this._isCopywriterToggleEnabled=null!==(t=f.a.parseToggleValueFromSettingsEvent(e))&&void 0!==t?t:this._isCopywriterToggleEnabled},this.onContextChanged=e=>{if(!e.runtimeOnOffState)return;const t=`${window.location.protocol}//${window.location.hostname}`;this._isURLUserDisabled=e.runtimeOnOffState.userExcludedUrls.includes(t)}}async initialize(){var e,t;this._isInitialized||(this._isCopywriterToggleEnabled=null!==(e=f.a.parseToggleValue(await this._proofingPersistedStore.read(i.a.OverriddenInlineEditingSettings)))&&void 0!==e?e:this._isCopywriterToggleEnabled,this._isCopywriterPopupToggleEnabled=await this._proofingPersistedStore.read(i.a.EnableCopilotRewrite),this._settingsEmitter.on(i.a.OverriddenInlineEditingSettings,this._updateCopywriterToggleEnabledValue),this._settingsEmitter.on(i.a.EnableCopilotRewrite,(e=>{this._isCopywriterPopupToggleEnabled="true"===JSON.parse(e).value})),null===(t=this._pageContextReceiver)||void 0===t||t.on("contextChangedEvent",this.onContextChanged)),this._isInitialized=!0}shutDown(){}check(){return this._featureFlagsReader.flags.enableCopywriter&&this._isCopywriterToggleEnabled&&this._isCopywriterPopupToggleEnabled&&!this._isURLUserDisabled}isUrlSupported(){return this._supportedWebsites.concat(this._supportedWebsitesSpecialHandling).includes(window.location.hostname)||this._supportedWebsitesPartial.some((e=>window.location.hostname.endsWith(e)))}shouldUseDispachEvent(){return this._supportedWebsitesSpecialHandling.includes(window.location.hostname)}};h=Object(r.c)([Object(c.a)(),Object(r.f)(0,Object(l.a)(o.a)),Object(r.f)(1,Object(l.a)(a.a)),Object(r.f)(2,Object(l.a)(u.a)),Object(r.f)(3,Object(l.a)(s.a)),Object(r.f)(3,Object(d.a)())],h)},,function(e,t,n){"use strict";function r(e,t){var n,r;const i=function(e){const t=new Set,n=[];for(const r of e){const e=o(r);t.has(e)||(t.add(e),n.push(r))}return n}(e),a=[],s=new Map;for(const e of t){const t=e.split("-")[0],r=null!==(n=s.get(t))&&void 0!==n?n:[];r.push(e),s.set(t,r)}for(const e of i)if(e.languageId){const t=e.languageId.split("-")[0],n=null!==(r=s.get(t))&&void 0!==r?r:[];for(const t of n)a.push(Object.assign(Object.assign({},e),{languageId:t}))}else a.push(e);return a}function i(e,t){const n=[],r=new Map;for(const e of t){const t=o(e);r.has(t)||r.set(t,e.value)}for(const t of e)t.value!==r.get(o(t))&&n.push(t);return n}function o(e){var t,n;const r=null!==(n=null===(t=e.languageId)||void 0===t?void 0:t.split("-")[0])&&void 0!==n?n:"";return e.id+r}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(141),i=n(137),o=n(133),a=n(11);class s{constructor(){this.imports=[]}get uniqueId(){return Object(i.a)(507918419)}configureRootServices(e){!function(e,t,n){try{Object(o.b)(e,t,n)}catch(e){}}(Object(a.a)(),r.EventEmitter)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r={NumProofingLanguages:"NumProofingLanguages"}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Offered="Offered",e.Seen="Seen",e.Tried="Tried",e.Kept="Kept",e.Rejected="Rejected"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r,i,o,a,s,u,c,l,d=n(21);(r||(r={})).getFields=function(e,t){var n=[];return n.push(Object(d.b)("".concat(e,".Code"),t.code)),void 0!==t.type&&n.push(Object(d.c)("".concat(e,".Type"),t.type)),void 0!==t.tag&&n.push(Object(d.b)("".concat(e,".Tag"),t.tag)),void 0!==t.isExpected&&n.push(Object(d.a)("".concat(e,".IsExpected"),t.isExpected)),n.push(Object(d.c)("zC.Activity.Result","Office.System.Result")),n},(o=i||(i={})).contractName="Office.System.Activity",o.getFields=function(e){var t="Activity",n=[];return void 0!==e.cV&&n.push(Object(d.c)("".concat(t,".CV"),e.cV)),n.push(Object(d.b)("".concat(t,".Duration"),e.duration)),n.push(Object(d.b)("".concat(t,".Count"),e.count)),n.push(Object(d.b)("".concat(t,".AggMode"),e.aggMode)),void 0!==e.success&&n.push(Object(d.a)("".concat(t,".Success"),e.success)),void 0!==e.result&&n.push.apply(n,r.getFields("".concat(t,".Result"),e.result)),n.push(Object(d.c)("zC.Activity",o.contractName)),n},(a||(a={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(Object(d.c)("".concat(e,".Id"),t.id)),void 0!==t.version&&n.push(Object(d.c)("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&n.push(Object(d.c)("".concat(e,".SessionId"),t.sessionId)),n},(s||(s={})).getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push(Object(d.c)("".concat(e,".Alias"),t.alias)),void 0!==t.primaryIdentityHash&&n.push(Object(d.c)("".concat(e,".PrimaryIdentityHash"),t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push(Object(d.c)("".concat(e,".PrimaryIdentitySpace"),t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push(Object(d.c)("".concat(e,".TenantId"),t.tenantId)),void 0!==t.tenantGroup&&n.push(Object(d.c)("".concat(e,".TenantGroup"),t.tenantGroup)),void 0!==t.isAnonymous&&n.push(Object(d.a)("".concat(e,".IsAnonymous"),t.isAnonymous)),n},(u||(u={})).getFields=function(e,t){var n=[];return void 0!==t.name&&n.push(Object(d.c)("".concat(e,".Name"),t.name)),void 0!==t.state&&n.push(Object(d.c)("".concat(e,".State"),t.state)),n},(c||(c={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(Object(d.b)("".concat(e,".Id"),t.id)),void 0!==t.name&&n.push(Object(d.c)("".concat(e,".Name"),t.name)),void 0!==t.commandSurface&&n.push(Object(d.c)("".concat(e,".CommandSurface"),t.commandSurface)),void 0!==t.parentName&&n.push(Object(d.c)("".concat(e,".ParentName"),t.parentName)),void 0!==t.triggerMethod&&n.push(Object(d.c)("".concat(e,".TriggerMethod"),t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push(Object(d.b)("".concat(e,".TimeOffsetMs"),t.timeOffsetMs)),n},function(e){e.getFields=function(e,t){var n=[];return n.push(Object(d.c)("".concat(e,".ErrorGroup"),t.errorGroup)),n.push(Object(d.b)("".concat(e,".Tag"),t.tag)),void 0!==t.code&&n.push(Object(d.b)("".concat(e,".Code"),t.code)),void 0!==t.id&&n.push(Object(d.b)("".concat(e,".Id"),t.id)),void 0!==t.count&&n.push(Object(d.b)("".concat(e,".Count"),t.count)),n}}(l||(l={}));var f,h=i,p=r,g=l,m=u,y=a,b=c,v=s;!function(e){!function(e){!function(e){e.Activity=h,e.Result=p,e.Error=g,e.Funnel=m,e.Host=y,e.User=v,e.UserAction=b}(e.System||(e.System={}))}(e.Office||(e.Office={}))}(f||(f={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("ISessionContextProvider")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IPresentationDomSettings")},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2),i=n(93),o=n(11),a=n(7),s=n(64);let u=class{constructor(e){this._browserStorage=e,this.registrations={},this.eventNamesUsed=new Set,this._storageChangeDispatcherCallback=async(e,t)=>this._storageChangeDispatcher(e,t)}safelyGetRegistration(e){return this.registrations[e]||(this.registrations[e]=Object(i.a)()),this.registrations[e]}on(e,t){this.safelyGetRegistration(e).listeners.push(t),this.eventNamesUsed.add(e)}async initialize(){this._browserStorage.addChangeListener(this._storageChangeDispatcherCallback)}shutDown(){this._browserStorage.removeEventListener(this._storageChangeDispatcherCallback);for(const e of this.eventNamesUsed)try{this.off(e)}catch(e){}}_storageChangeDispatcher(e,t){for(const t of Object.keys(e)){const n=JSON.parse(e[t].oldValue),r=JSON.parse(e[t].newValue);(null==n?void 0:n.value)!==(null==r?void 0:r.value)&&this.callListeners(t,e[t].newValue)}}callListeners(e,t){const n=e,r=this.safelyGetRegistration(n);for(const e of r.listeners)e(t)}onFirst(e,t){throw Error("onFirst is not implemented for SettingsEmitter")}onAny(e){throw Error("onAny is not implemented for SettingsEmitter")}async waitFor(e){throw Error("waitForFirst is not implemented for SettingsEmitter")}async waitForFirst(e){throw Error("waitForFirst is not implemented for SettingsEmitter")}off(e,t){if(void 0===e)return void(this.registrations={});if(void 0===t)return void(this.registrations[e]=Object(i.a)());const n=this.safelyGetRegistration(e);if(!Object(i.b)(n.listeners,t))throw new Error(`Tried to remove a non-existent listener for event name '${e}'.`)}emit(e,...t){const n=this.safelyGetRegistration(e);for(const e of n.listeners)e(...t)}};u=Object(r.c)([Object(o.a)(),Object(r.f)(0,Object(a.a)(s.a))],u)},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r,i=n(2),o=n(397),a=n(27),s=n(55),u=n(414),c=n(415),l=n(140),d=n(11),f=n(7),h=n(8),p=n(40),g=n(163);let m=r=class{constructor(e,t,n){this._userInfoStrategy=e,this._telemetrySink=t,this._loggerSettings=n,this._appId="",this._clientId="",this._initialized=!1,this._initializing=!1,this._configurationId=""}async initialize(e,t,n,r,i){if(!this._initialized){if(!this._initializing){this._initializing=!0;try{this._hostSettings=i,this._sessionContext=t,this._configurationId=await e.read(h.a.ConfigurationId),this._appId=await e.read(h.a.AppId),this._clientId=await e.read(h.a.ClientId),this._internalLogger=new o.a(this._loggerSettings,this._telemetrySink)}finally{this._initializing=!1}}this._initialized=!0}}logEvent(e,t,n,r,i,o,a){if(this._initialized&&this._loggerSettings.defaultEventName){const s=t||this._loggerSettings.defaultEventName;this.sendLog(s,e,n,r,i,o,a)}}getNewActivity(e,t,n){var i,o,s;if(!this._initialized)return;const u=this._internalLogger.createActivity(e,void 0,{dataCategories:a.a.DataCategories.ProductServiceUsage,diagnosticLevel:a.a.DiagnosticLevel.RequiredServiceData});if(this._userInfoStrategy.execute(!1,(e=>(e&&u.dataFields.push(...Object(g.b)([["User_Id",e.userId],["Tenant_Id",e.tenantId],["Identity_Provider",JSON.stringify(e.identityProvider)],["License_Type",e.licenseType]])),e))),u.dataFields.push(...this.getSessionContextDataFields()),u.dataFields.push(...Object(g.b)([["App_Id",this._appId],["Client_Id",this._clientId],["CorrelationID",null!==(i=this._sessionCorrelationId)&&void 0!==i?i:""],["ConfigurationId",this._configurationId],["FlightsToTrack",null===(s=null===(o=this._hostSettings)||void 0===o?void 0:o.flightsToTrack)||void 0===s?void 0:s.join(";")]])),n){const t=r.createFunnelContract(e,n);u.dataFields.push(...t)}return u}getSessionContextDataFields(){var e,t;return this._sessionContext?Object(g.b)([["Browser_Type",this._sessionContext.browserType],["Browser_Version",null!==(e=this._sessionContext.browserVersion)&&void 0!==e?e:""],["Store_Runtime_Id",null!==(t=this._sessionContext.extensionStoreId)&&void 0!==t?t:""],["Extension_Version",this._sessionContext.extensionVersion],["Extension_Version_Name",this._sessionContext.extensionVersionName]]):[]}addCorrelationID(e){this._sessionCorrelationId=e}sendLog(e,t,n,i,o,u,c){var l,d;if(!this._initialized||n===s.a.Debug)return;const f=[];this.serviceRequestId&&f.push(Object(g.a)("Service_Request_Id",this.serviceRequestId,a.a.DataFieldType.Guid.valueOf())),this._sessionContext&&f.push(...this.getSessionContextDataFields());let h="",p="",m="";if(this._userInfoStrategy.execute(!1,(e=>{var t;return e&&(h=e.userId,p=null!==(t=e.tenantId)&&void 0!==t?t:"",m=e.identityProvider.toString()),e})),f.push(...Object(g.b)([["Tag",t.toString()],["Tag_Hex",t.toString(16)],["Level",s.a[n]],["App_Id",this._appId],["Client_Id",this._clientId],["User_Id",h],["Tenant_Id",p],["Identity_Provider",m],["Text_Message",i],["Correlation_Id",this._sessionCorrelationId],["Data",u instanceof Error?JSON.stringify(Object(g.c)(u)):u?JSON.stringify(u):void 0],["FlightsToTrack",null===(d=null===(l=this._hostSettings)||void 0===l?void 0:l.flightsToTrack)||void 0===d?void 0:d.join(";")]])),c){r.createFunnelContract(e,c).forEach((e=>f.push(e)))}this._internalLogger.logStandaloneMetric(e,o,a.a.DiagnosticLevel.RequiredServiceData,a.a.DataCategories.NotSet,f)}static createFunnelContract(e,t){const n=u.a[t];return c.a.Office.System.Funnel.getFields(e,{name:e,state:n})}};m=r=Object(i.c)([Object(d.a)(),Object(i.f)(0,Object(f.a)(p.a)),Object(i.f)(1,Object(f.a)(l.c)),Object(i.f)(2,Object(f.a)(l.b))],m)},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2),i=n(55),o=n(27),a=n(53),s=n(11),u=n(7),c=n(57),l=n(64),d=n(142);let f=class extends d.a{constructor(e,t){super(e),this._logger=t}async readOrInitialize(e){try{const t=await this.readStoredSetting(e);if(t){if(t.value){const n=JSON.parse(t.value);return t.manualOverride&&void 0!==n?n:(e.lastValueFromStorage=n,void 0!==n?n:e.defaultValue)}}else try{return e.shouldNotWriteDefaultValue||await this.writeSetting(e.name,e.defaultValue),e.defaultValue}catch(e){this._logger.logEvent(521479644,c.a.SettingInitializeError,i.a.Error,void 0,o.a.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}catch(e){this._logger.logEvent(521479643,c.a.SettingReadError,i.a.Error,void 0,o.a.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}return void 0!==e.lastValueFromStorage?e.lastValueFromStorage:e.defaultValue}async readLastUpdatedTimestamp(e){try{const t=await this.readStoredSetting(e);if(t)return t.lastUpdated}catch(e){this._logger.logEvent(521479642,c.a.SettingReadError,i.a.Error,void 0,o.a.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}async readStoredSetting(e){const t=await this._extensionStorage.get(e.name);if(t[e.name]){return JSON.parse(t[e.name])}}};f=Object(r.c)([Object(s.a)(),Object(r.f)(0,Object(u.a)(l.a)),Object(r.f)(1,Object(u.a)(a.a))],f)},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2),i=n(55),o=n(27),a=n(53),s=n(11),u=n(7),c=n(57),l=n(64),d=n(142);let f=class extends d.a{constructor(e,t){super(e),this._logger=t}async write(e,t){try{let n=!1;const r=await this._extensionStorage.get(e.name);if(r[e.name]){n=JSON.parse(r[e.name]).manualOverride}n?this._logger.logEvent(521479641,c.a.SettingManualOverrideWarning,i.a.Warn,`manual override for store entry ${e.name} - writing skipped`,o.a.SamplingPolicy.Measure):await this.writeSetting(e.name,t)}catch(e){this._logger.logEvent(521479640,c.a.SettingWriteError,i.a.Error,void 0,o.a.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}async remove(e){await this._extensionStorage.remove(e)}};f=Object(r.c)([Object(s.a)(),Object(r.f)(0,Object(u.a)(l.a)),Object(r.f)(1,Object(u.a)(a.a))],f)},,function(e,t,n){"use strict";var r,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e.InstrumentationCall="InstrumentationCall"}(r||(r={})),function(e){e.TileIdParseException="RunTimeErrors.TileIdParseException",e.InvalidTileFormat="RunTimeErrors.InvalidTileFormat"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return p}));var r=n(2),i=n(184),o=n(321),a=n(154),s=n(343),u=n(126),c=n(9),l=n(11),d=n(7),f=n(98);const h=Object(c.a)("ITextEventPublisher");let p=class extends i.a{constructor(e,t){super(),this._settings=e,this._timer=null!=t?t:new o.a}dispose(){return this._timer.shutDown(),Promise.resolve()}publishTextChangeEvent(e,t){this.publishEvent("textChange",{data:e,messageType:t}),this.scheduleSendIdleTextEvent(e,t)}publishTextStyleEvent(){this.publishEvent("styleChange",{})}scheduleSendIdleTextEvent(e,t){if(this._settings.enableTileNodeAutoReconciliation&&0!==e.length)for(const n of e)n.mutationChangeType!==a.b.Code&&(this._timer.clearTimer(n.tileNodeId),this._timer.setTimeout(n.tileNodeId,(()=>{this.publishEvent("textChange",{data:[{tileNodeId:n.tileNodeId,text:n.text,mutationChangeType:a.b.Code,rehydrateCritiques:!0,idleReconcileTrigger:!0,optimizedRehydrationEnabled:n.optimizedRehydrationEnabled}],messageType:t}),this._timer.clearTimer(n.tileNodeId)}),this._settings.reconcileTileNodeTime))}};p=Object(r.c)([Object(l.a)(),Object(r.f)(0,Object(d.a)(u.a)),Object(r.f)(1,Object(f.a)()),Object(r.f)(1,Object(d.a)(s.a))],p)},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{static hash(e){let t=0,n=0;for(;n<e.length;)t=(t<<5)-t+e.charCodeAt(n++)|0;return t>0?t:-1*t}static format(e,...t){const n=t.length;return e.replace(/\{(\d+)\}/g,((e,r)=>r<n?t[r]:e))}static trimLeft(e){return e.replace(/^\s+/,"")}static trimRight(e){return e.replace(/\s+$/,"")}}},,,,,function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(9);const i=Object(r.a)("ISentenceTextUnitSeparator"),o=Object(r.a)("IParagraphTextUnitSeparator"),a=Object(r.a)("IDefaultTextUnitSeparator"),s=Object(r.a)("IDocumentTextUnitSeparator")},,function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l}));var r=n(35),i=n(242),o=n(234);function a(){return"x-ms-command-name"}var s=n(88);var u=a;function c(){var e,t,n,r=[{key:"ms-rest-js",value:o.a.msRestVersion}],i=function(){var e=self.navigator;return[{key:"OS",value:(e.oscpu||e.platform).replace(" ","")}]}();return e=r.concat(i),void 0===t&&(t=" "),void 0===n&&(n="/"),e.map((function(e){var t=e.value?""+n+e.value:"";return""+e.key+t})).join(t)}function l(e){var t=e&&null!=e.key?e.key:"x-ms-command-name",n=e&&null!=e.value?e.value:c();return{create:function(e,r){return new d(e,r,t,n)}}}var d=function(e){function t(t,n,r,i){var o=e.call(this,t,n)||this;return o._nextPolicy=t,o._options=n,o.headerKey=r,o.headerValue=i,o}return Object(r.c)(t,e),t.prototype.sendRequest=function(e){return this.addUserAgentHeader(e),this._nextPolicy.sendRequest(e)},t.prototype.addUserAgentHeader=function(e){e.headers||(e.headers=new i.a),!e.headers.get(this.headerKey)&&this.headerValue&&e.headers.set(this.headerKey,this.headerValue)},t}(s.a)},,,,,,,,,,function(e,t,n){"use strict";function r(){return 1e3*(new Date).getTime()}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r,i=n(2),o=n(26),a=n(174),s=n(325),u=n(64),c=n(11),l=n(7);function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function p(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?d(e):t;var n}function g(e,t){return g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},g(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h(e);if(t){var i=h(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}var y=r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(u,e);var t,n,i,s=m(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),t=s.call(this),Object.defineProperty(d(t),"_browserStorage",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(d(t),"notFoundHandler",{enumerable:!0,configurable:!0,writable:!0,value:function(e){t.triggerCallback(e,"Identity not found.")}}),Object.defineProperty(d(t),"userInfoUndefinedHandler",{enumerable:!0,configurable:!0,writable:!0,value:function(e){t.userInfo=void 0,t.triggerCallback(e)}}),t}return t=u,n=[{key:"execute",value:function(){var e=arguments.length>1?arguments[1]:void 0,t=this;arguments.length>0&&void 0!==arguments[0]&&!arguments[0]?e(this.userInfo):this._browserStorage.get("userType").then((function(n){var i=n.userType;i&&i!==o.e.NONE?t._browserStorage.get("identity").then((function(n){var a,s,u;n.identity||t.notFoundHandler(e);var c=n.identity[i];if(null==c?void 0:c.userInfo){var l=null!==(a=c.userInfo.ageGroup)&&void 0!==a?a:o.a.Unknown;t.userInfo={userId:null!==(s=c.userInfo.id)&&void 0!==s?s:"",tenantId:c.tenant,email:null!==(u=c.userInfo.email)&&void 0!==u?u:"",licenseType:r.getLicenseType(i,c.userInfo),identityProvider:i===o.e.MSA?o.b.MSA:o.b.AAD,roamingToken:r.getRoamingToken(i,c),augLoopToken:r.getAugLoopToken(i,c),ageGroup:l,ctry:c.userInfo.ctry,regionScope:c.userInfo.regionScope,displayName:c.userInfo.displayName,photo:c.userInfo.photo},t.triggerCallback(e)}else t.userInfo=void 0,t.triggerCallback(e)})).catch((function(){t.notFoundHandler(e)})):t.userInfoUndefinedHandler(e)})).catch((function(){t.userInfoUndefinedHandler(e)}))}}],i=[{key:"getLicenseType",value:function(e,t){switch(e){case o.e.AAD:return t.activeExperiences&&Array.isArray(t.activeExperiences)?t.activeExperiences.some((function(e){return"OfficeProPlus"===e}))?o.c.Subscription:o.c.NoLicense:o.c.Subscription;case o.e.MSA:if(!t.activeSubscriptionProduct)return;return"none"===t.activeSubscriptionProduct?o.c.NoLicense:o.c.Subscription;case o.e.NONE:default:return}}},{key:"getTokenForResource",value:function(e,t,n){if(e!==o.e.NONE&&t.resources&&t.resources[n]){var r=e===o.e.MSA?"t=":"";return{accessToken:"".concat(r).concat(t.resources[n].access_token),expiresOn:new Date(1e3*t.resources[n].expires_on)}}}},{key:"getRoamingToken",value:function(e,t){var n=e===o.e.AAD?"https://api.office.net":"https://officeapps.live.com";return r.getTokenForResource(e,t,n)}},{key:"getAugLoopToken",value:function(e,t){return r.getTokenForResource(e,t,a.a.Prod)}}],n&&f(t.prototype,n),i&&f(t,i),u}(s.a);y=r=Object(i.c)([Object(c.a)(),Object(i.f)(0,Object(l.a)(u.a)),Object(i.e)("design:paramtypes",[Object])],y)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2),i=n(11);function o(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,n=[{key:"get",value:function(e){return(t=function(){return s(this,(function(t){return[2,chrome.storage.managed.get(e)]}))},function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function s(e){o(a,r,i,s,u,"next",e)}function u(e){o(a,r,i,s,u,"throw",e)}s(void 0)}))})();var t}},{key:"addChangeListener",value:function(e){chrome.storage.onChanged.addListener(e)}},{key:"removeChangeListener",value:function(e){chrome.storage.onChanged.removeListener(e)}}],n&&a(t.prototype,n),r&&a(t,r),e}();u=Object(r.c)([Object(i.a)()],u)},function(e,t,n){"use strict";function r(...e){if(e.length>0){const t=String(e[0]);t.includes(":error")?console.error(...e):t.includes(":warning")?console.warn(...e):t.includes(":info")?console.info(...e):(t.includes(":verbose"),console.debug(...e))}}n.d(t,"a",(function(){return r}))},,,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var i=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}();function o(){if(!r){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(64*Math.random())));r=new i(t.join(""))}return r}},,,,,,function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(i=r;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(o=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=r;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;0!=i--;){var a=o[i];if(!e(t[a],n[a]))return!1}return!0}return t!=t&&n!=n}},,,,,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.error=0]="error",e[e.warn=1]="warn",e[e.info=3]="info",e[e.metric=4]="metric",e[e.verbose=5]="verbose",e[e.debug=6]="debug",e[e.disabled=7]="disabled"}(r||(r={}))},,,,,,,,,,,,function(e,t,n){"use strict";var r=n(628),i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=d;var o=Object.create(n(567));o.inherits=n(531);var a=n(772),s=n(702);o.inherits(d,a);for(var u=i(s.prototype),c=0;c<u.length;c++){var l=u[c];d.prototype[l]||(d.prototype[l]=s.prototype[l])}function d(e){if(!(this instanceof d))return new d(e);a.call(this,e),s.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||r.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),d.prototype._destroy=function(e,t){this.push(null),this.end(),r.nextTick(t,e)}},,,,function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"BrowserInfo",(function(){return r})),n.d(t,"NodeInfo",(function(){return i})),n.d(t,"BotInfo",(function(){return o})),n.d(t,"detectBrowser",(function(){return u})),n.d(t,"parseUserAgent",(function(){return c})),n.d(t,"getNodeVersion",(function(){return l}));class r{constructor(e,t){this.name=e,this.version=t}}class i{constructor(e){this.version=e,this.name="node"}}class o{constructor(){this.bot=!0,this.name="bot",this.version=null}}const a=3,s=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/Edg\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]];function u(e){return e?c(e):navigator?c(navigator.userAgent):l()}function c(e){const t=""!==e&&s.reduce(((t,[n,r])=>{if(t)return t;const i=r.exec(e);return!!i&&[n,i]}),!1);if(!t)return null;const[n,i]=t;if("searchbot"===n)return new o;let u=i[1].split(/[._]/).slice(0,3);return u?u.length<a&&(u=[...u,...d(a-u.length)]):u=[],new r(n,u.join("."))}function l(){return e.version?new i(e.version.slice(1)):null}function d(e){const t=[];for(let n=0;n<e;n+=1)t.push("0");return t}}.call(this,n(123))},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2),i=n(11),o=n(7),a=n(74),s=n(363);let u=class{constructor(e,t){this._featureFlagsReader=e,this._paragraphDeltasEnabled=t}check(){return this._paragraphDeltasEnabled.check()&&this._featureFlagsReader.flags.enableOptimizedRehydration}};u=Object(r.c)([Object(i.a)(),Object(r.f)(0,Object(o.a)(a.a)),Object(r.f)(1,Object(o.a)(s.a))],u)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IQueryDetection")},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r={aa:["aa-ET","Qafar"],af:"af-ZA",agq:["agq-CM","Aghem"],ak:["ak-GH","Akan"],am:"am-ET",ar:"ar-SA",arn:"arn-CL",as:"as-IN",asa:["asa-TZ","Kipare"],ast:["ast-ES","asturianu"],az:["az-Latn-AZ","azrbaycan"],"az-cyrl":["az-Cyrl-AZ"," ()"],"az-latn":["az-Latn-AZ","Azrbaycanl (Latn)"],ba:"ba-RU",bas:["bas-CM","sa"],be:"be-BY",bem:["bem-ZM","Ichibemba"],bez:["bez-TZ","Hibena"],bg:"bg-BG",bin:"bin-NG",bm:["bm-Latn-ML","bamanakan"],"bm-latn":["bm-Latn-ML","bamanakan (Latin)"],bn:"bn-BD",bo:"bo-CN",br:"br-FR",brx:["brx-IN",""],bs:["bs-Latn-BA","bosanski"],"bs-cyrl":["bs-Cyrl-BA"," ()"],"bs-latn":["bs-Latn-BA","bosanski (Latinica)"],byn:["byn-ER",""],ca:"ca-ES",ccp:["ccp-Cakm-BD",""],"ccp-cakm":["ccp-Cakm-BD"," ()"],ce:["ce-RU",""],ceb:["ceb-Latn-PH","Cebuano"],"ceb-latn":["ceb-Latn-PH","Cebuano (Latin)"],cgg:["cgg-UG","Rukiga"],chr:"chr-Cher-US","chr-cher":"chr-Cher-US",co:"co-FR",cs:"cs-CZ",cu:["cu-RU",""],cy:"cy-GB",da:"da-DK",dav:["dav-KE","Kitaita"],de:"de-DE",dje:["dje-NE","Zarmaciine"],dsb:"dsb-DE",dua:["dua-CM","dul"],dv:"dv-MV",dyo:["dyo-SN","joola"],dz:["dz-BT",""],ebu:["ebu-KE","Kembu"],ee:["ee-GH","Eegbe"],el:"el-GR",en:"en-US",eo:["eo-001","esperanto"],es:"es-ES",et:"et-EE",eu:"eu-ES",ewo:["ewo-CM","ewondo"],fa:"fa-IR",ff:"ff-Latn-SN","ff-latn":"ff-Latn-SN",fi:"fi-FI",fil:"fil-PH",fo:"fo-FO",fr:"fr-FR",fur:["fur-IT","furlan"],fy:"fy-NL",ga:"ga-IE",gd:"gd-GB",gl:"gl-ES",gn:"gn-PY",gsw:"gsw-CH",gu:"gu-IN",guz:["guz-KE","Ekegusii"],gv:["gv-IM","Gaelg"],ha:["ha-Latn-NG","Hausa"],"ha-latn":["ha-Latn-NG","Hausa (Latin)"],haw:"haw-US",he:"he-IL",hi:"hi-IN",hr:"hr-HR",hsb:"hsb-DE",hu:"hu-HU",hy:"hy-AM",ia:["ia-001","interlingua"],ibb:"ibb-NG",id:"id-ID",ig:"ig-NG",ii:"ii-CN",is:"is-IS",it:"it-IT",iu:["iu-Latn-CA","Inuktitut"],"iu-cans":["iu-Cans-CA"," ()"],"iu-latn":["iu-Latn-CA","Inuktitut (Qaliujaaqpait)"],ja:"ja-JP",jgo:["jgo-CM","Ndaa"],jmc:["jmc-TZ","Kimachame"],jv:"jv-Latn-ID","jv-java":"jv-Java-ID","jv-latn":"jv-Latn-ID",ka:"ka-GE",kab:["kab-DZ","Taqbaylit"],kam:["kam-KE","Kikamba"],kde:["kde-TZ","Chimakonde"],kea:["kea-CV","kabuverdianu"],khq:["khq-ML","Koyra ciini"],ki:["ki-KE","Gikuyu"],kk:"kk-KZ",kkj:["kkj-CM","kak"],kl:"kl-GL",kln:["kln-KE","Kalenjin"],km:"km-KH",kn:"kn-IN",ko:"ko-KR",kok:"kok-IN",kr:"kr-Latn-NG","kr-latn":"kr-Latn-NG",ks:["ks-Arab-IN",""],"ks-arab":["ks-Arab-IN"," ()"],"ks-deva":"ks-Deva-IN",ksb:["ksb-TZ","Kishambaa"],ksf:["ksf-CM","rikpa"],ksh:["ksh-DE","Klsch"],ku:"ku-Arab-IQ","ku-arab":"ku-Arab-IQ",kw:["kw-GB","kernewek"],ky:"ky-KG",la:"la-001",lag:["lag-TZ","Klaangi"],lb:"lb-LU",lg:["lg-UG","Luganda"],lkt:["lkt-US","Lakliyapi"],ln:["ln-CD","lingla"],lo:"lo-LA",lrc:["lrc-IR"," "],lt:"lt-LT",lu:["lu-CD","Tshiluba"],luo:["luo-KE","Dholuo"],luy:["luy-KE","Luluhia"],lv:"lv-LV",mas:["mas-KE","Maa"],mer:["mer-KE","Kmr"],mfe:["mfe-MU","kreol morisien"],mg:["mg-MG","Malagasy"],mgh:["mgh-MZ","Makua"],mgo:["mgo-CM","meta"],mi:"mi-NZ",mk:"mk-MK",ml:["ml-IN",""],mn:["mn-MN",""],"mn-cyrl":["mn-MN"," ( )"],"mn-mong":["mn-Mong-CN","  ( )"],mni:"mni-IN",moh:"moh-CA",mr:"mr-IN",ms:"ms-MY",mt:"mt-MT",mua:["mua-CM","MUNDA"],my:["my-MM",""],mzn:["mzn-IR",""],naq:["naq-NA","Khoekhoegowab"],nb:"nb-NO",nd:["nd-ZW","isiNdebele"],nds:["nds-DE","Neddersasssch"],ne:"ne-NP",nl:"nl-NL",nmg:["nmg-CM","Kwasio"],nn:"nn-NO",nnh:["nnh-CM","Shw ngiembn"],no:["nb-NO","norsk"],nqo:"nqo-GN",nr:["nr-ZA","isiNdebele"],nso:"nso-ZA",nus:["nus-SS","Thok Nath"],nyn:["nyn-UG","Runyankore"],oc:"oc-FR",om:["om-ET","Oromoo"],or:"or-IN",os:["os-GE",""],pa:"pa-IN","pa-arab":"pa-Arab-PK","pa-guru":"pa-IN",pap:"pap-029",pl:"pl-PL",prg:["prg-001","prsiskan"],prs:"prs-AF",ps:"ps-AF",pt:"pt-BR",quc:"quc-Latn-GT","quc-latn":"quc-Latn-GT",quz:"quz-BO",rm:"rm-CH",rn:["rn-BI","Ikirundi"],ro:"ro-RO",rof:["rof-TZ","Kihorombo"],ru:"ru-RU",rw:"rw-RW",rwk:["rwk-TZ","Kiruwa"],sa:"sa-IN",sah:"sah-RU",saq:["saq-KE","Kisampur"],sbp:["sbp-TZ","Ishisangu"],sd:"sd-Arab-PK","sd-arab":"sd-Arab-PK","sd-deva":"sd-Deva-IN",se:"se-NO",seh:["seh-MZ","sena"],ses:["ses-ML","Koyraboro senni"],sg:["sg-CF","Sng"],shi:["shi-Tfng-MA",""],"shi-latn":["shi-Latn-MA","Tasheliyt (Latin)"],"shi-tfng":["shi-Tfng-MA"," (Tifinagh)"],si:"si-LK",sk:"sk-SK",sl:"sl-SI",sma:"sma-SE",smj:"smj-SE",smn:"smn-FI",sms:"sms-FI",sn:["sn-Latn-ZW","chiShona"],"sn-latn":["sn-Latn-ZW","chiShona (Latin)"],so:["so-SO","Soomaali"],sq:"sq-AL",sr:["sr-Latn-RS","srpski"],"sr-cyrl":["sr-Cyrl-RS"," ()"],"sr-latn":["sr-Latn-RS","srpski (latinica)"],ss:["ss-ZA","Siswati"],ssy:["ssy-ER","Saho"],st:"st-ZA",sv:"sv-SE",sw:"sw-KE",syr:"syr-SY",ta:"ta-IN",te:"te-IN",teo:["teo-UG","Kiteso"],tg:["tg-Cyrl-TJ",""],"tg-cyrl":["tg-Cyrl-TJ"," ()"],th:"th-TH",ti:"ti-ER",tig:["tig-ER",""],tk:"tk-TM",tn:"tn-ZA",to:["to-TO","lea fakatonga"],tr:"tr-TR",ts:["ts-ZA","Xitsonga"],tt:"tt-RU",twq:["twq-NE","Tasawaq senni"],tzm:["tzm-Latn-DZ","Tamazit n lala"],"tzm-arab":"tzm-Arab-MA","tzm-latn":["tzm-Latn-DZ","Tamazit n lala (Latin)"],"tzm-tfng":["tzm-Tfng-MA","Tamazight (Tifinagh)"],ug:"ug-CN",uk:"uk-UA",ur:"ur-PK",uz:"uz-Latn-UZ","uz-arab":["uz-Arab-AF"," ()"],"uz-cyrl":["uz-Cyrl-UZ"," ()"],"uz-latn":"uz-Latn-UZ",vai:["vai-Vaii-LR",""],"vai-latn":["vai-Latn-LR","Vai (Latin)"],"vai-vaii":["vai-Vaii-LR"," (Vai)"],ve:["ve-ZA","Tshivena"],vi:"vi-VN",vo:["vo-001","Volapk"],vun:["vun-TZ","Kyivunjo"],wae:["wae-CH","Walser"],wal:["wal-ET",""],wo:"wo-SN",xh:"xh-ZA",xog:["xog-UG","Olusoga"],yav:["yav-CM","nuasue"],yi:["yi-001",""],yo:"yo-NG",zgh:["zgh-Tfng-MA",""],"zgh-tfng":["zgh-Tfng-MA"," (Tifinagh)"],zh:["zh-CN",""],"zh-hans":"zh-CN","zh-hant":["zh-HK","()"],zu:"zu-ZA"}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>{var n,r;if(t.length>e.length)return!0;for(const i of t){const t=e.find((e=>e.id===i.id)),o=null===(n=i.critiqueTypeInfoList)||void 0===n?void 0:n.length,a=null===(r=null==t?void 0:t.critiqueTypeInfoList)||void 0===r?void 0:r.length;if(o&&a&&o>a)return!0}return!1}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var r=n(2),i=n(74),o=n(226),a=n(115),s=n(207),u=n(11),c=n(7),l=n(28),d=n(31),f=n(213),h=n(214),p=n(58),g=n(16);function m(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){m(o,r,i,a,s,"next",e)}function s(e){m(o,r,i,a,s,"throw",e)}a(void 0)}))}}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var w=function(){function e(t,n,r,i,o,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_featureFlagsReader",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_betaEnrollmentPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_isSignedInUser",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"_systemPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"_announcementsPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_contentScriptEmitter",{enumerable:!0,configurable:!0,writable:!0,value:s});var u=this;Object.defineProperty(this,"_onEnableBetaExperience",{enumerable:!0,configurable:!0,writable:!0,value:y((function(){var e,t;return v(this,(function(n){switch(n.label){case 0:return(e=window.location.href)&&"about:blank"!==e?[4,u._betaEnrollmentPersistedStore.getBetaExperienceState(e)]:[2];case 1:return void 0!==(t=n.sent())&&t!==a.a.Enabled&&u.enrollBeta(e),[2]}}))}))}),this._contentScriptEmitter.on(l.a.enableBetaExperience,this._onEnableBetaExperience)}var t,n,r;return t=e,(n=[{key:"betaFinished",value:function(e){var t=this;return y((function(){var n,r;return v(this,(function(i){switch(i.label){case 0:return[4,t._betaEnrollmentPersistedStore.getBetaExperienceState(e)];case 1:return(n=i.sent())!==a.a.ShowSupportEndedTUI?[3,3]:[4,t._betaEnrollmentPersistedStore.setBetaExperienceState(e,a.a.SupportEnded)];case 2:i.sent(),i.label=3;case 3:return t._featureFlagsReader.flags.enableBetaExperience||n!==a.a.Enabled?[3,6]:[4,t._systemPersistedStore.read(g.a.DisabledWebSites)];case 4:return i.sent().some((function(t){return Object(s.a)(e,t)}))?(r=a.a.SupportEnded,[4,t._betaEnrollmentPersistedStore.setBetaExperienceState(e,r)]):[3,6];case 5:return i.sent(),[2,!0];case 6:return[2,!1]}}))}))()}},{key:"evaluateToShowNativeSquigglesTUI",value:function(e){var t=this;return y((function(){var n,r,i,o;return v(this,(function(u){switch(u.label){case 0:return[4,t._betaEnrollmentPersistedStore.getBetaExperienceState(e)];case 1:return n=u.sent(),r=!1,void 0===n?[2,!1]:t._featureFlagsReader.flags.enableBetaExperience?(r=n===a.a.Enabled,[3,4]):[3,2];case 2:return[4,t._systemPersistedStore.read(g.a.DisabledWebSites)];case 3:i=u.sent(),o=i.some((function(t){return Object(s.a)(e,t)})),r=!o,u.label=4;case 4:return r?[4,t._announcementsPersistedStore.write(d.a.GDocsNativeSquigglesAnnouncementVisible,!0)]:[3,6];case 5:u.sent(),u.label=6;case 6:return[2,r]}}))}))()}},{key:"evaluateToShowTUI",value:function(e){var t=this;return y((function(){var n;return v(this,(function(r){switch(r.label){case 0:return t._featureFlagsReader.flags.enableBetaExperience&&t._isSignedInUser.check()?[4,t._betaEnrollmentPersistedStore.getBetaExperienceState(e)]:[3,4];case 1:return void 0===(n=r.sent())?[2,!1]:n!==a.a.Default?[3,3]:[4,t._betaEnrollmentPersistedStore.setBetaExperienceState(e,a.a.ShowTUI)];case 2:return r.sent(),[2,!0];case 3:if(n===a.a.ShowTUI)return[2,!0];r.label=4;case 4:return[2,!1]}}))}))()}},{key:"enrollBeta",value:function(e){var t=this;return y((function(){return v(this,(function(n){switch(n.label){case 0:return[4,t._betaEnrollmentPersistedStore.setBetaExperienceState(e,a.a.Enabled)];case 1:return n.sent(),t._featureFlagsReader.flags.enableGDocsAnnotatedCanvas?[4,t._announcementsPersistedStore.write(d.a.GDocsNativeSquigglesAnnouncementDismissed,!1)]:[3,4];case 2:return n.sent(),[4,t._announcementsPersistedStore.write(d.a.GDocsNativeSquigglesAnnouncementVisible,!0)];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))()}},{key:"dismissBeta",value:function(e){var t=this;return y((function(){return v(this,(function(n){switch(n.label){case 0:return[4,t._betaEnrollmentPersistedStore.setBetaExperienceState(e,a.a.Disabled)];case 1:return n.sent(),[2]}}))}))()}},{key:"dismissSupportEndedAnnouncement",value:function(e){var t=this;return y((function(){return v(this,(function(n){switch(n.label){case 0:return[4,t._betaEnrollmentPersistedStore.setBetaExperienceState(e,a.a.SupportEnded)];case 1:return n.sent(),[2]}}))}))()}},{key:"isEnabled",value:function(){var e=this;return y((function(){var t;return v(this,(function(n){switch(n.label){case 0:return e._featureFlagsReader.flags.enableBetaExperience&&e._isSignedInUser.check()?[4,e._betaEnrollmentPersistedStore.getBetaExperienceState(window.location.href)]:[2,!1];case 1:return[2,!!(t=n.sent())&&t===a.a.Enabled]}}))}))()}}])&&b(t.prototype,n),r&&b(t,r),e}();w=Object(r.c)([Object(u.a)(),Object(r.f)(0,Object(c.a)(i.a)),Object(r.f)(1,Object(c.a)(h.a)),Object(r.f)(2,Object(c.a)(o.a)),Object(r.f)(3,Object(c.a)(p.a)),Object(r.f)(4,Object(c.a)(f.a)),Object(r.f)(5,Object(c.a)(l.b)),Object(r.e)("design:paramtypes",[Object,Object,o.a,Object,Object,Object])],w)},function(e,t,n){"use strict";function r(e,t){const n={header:e,proofingLanguage:t};return JSON.stringify(n)}function i(e){if(e){const t=JSON.parse(e);if(t)return{tileId:t.header,languageCode:t.proofingLanguage}}return{tileId:e,languageCode:void 0}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("ITileNodeReader")},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"i",(function(){return c})),n.d(t,"j",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"g",(function(){return h})),n.d(t,"h",(function(){return p})),n.d(t,"f",(function(){return g})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return b})),n.d(t,"c",(function(){return v}));var r=n(2),i=n(80),o=n(274),a=n(188),s=n(9),u=n(11);Object(s.a)("ICritiqueInterpreter");function c(e){const t=[i.b.ContextualSpelling,i.b.WrongSpelling];return!!e&&e.typeId!==i.b.Synonyms&&(e.priority===i.c.High||!!e.typeId&&t.includes(e.typeId))}function l(e){return!!e&&e.typeId===i.b.TopicSuggestion}function d(e){return!0===("number"==typeof e.supportedActions?Object(o.a)(e.supportedActions):e.supportedActions).delete}function f(e){const t="number"==typeof e.action?Object(a.a)(e.action):e.action;return!0===t.changeAll||!0===t.changeOnce||!0===t.autoCorrect||!0===t.personalizedAutoCorrect}function h(e){return!!e&&(d(e)&&!e.suggestions.some((e=>f(e))))}function p(e){return(null==e?void 0:e.typeId)===i.b.TonalRewrite}function g(e){return!0===("number"==typeof e.action?Object(a.a)(e.action):e.action).personalizedAutoCorrect}function m(e){return e.suggestions.some((e=>function(e){const t=/\[(.*)\]/g;return!!e.description&&!e.description.match(t)}(e)))}function y(e){for(const t of e.suggestions)if(4===t.action)return t}function b(e){for(const t of e.suggestions)if(!0===t.action.autoCorrect)return t}function v(e){return!!y(e)}let w=class{isSpellingCritique(e){return!!e&&c({priority:e.priority,typeId:Object(i.d)(e.typeId)})}isTopicSuggestionCritique(e){return!!e&&l({typeId:Object(i.d)(e.typeId)})}isDeleteActionAvailable(e){return d(e)}isChangeActionAvailable(e){return f(e)}isRepeatedWord(e){return h(e)}isRewrite(e){return p({typeId:Object(i.d)(e.typeId)})}isPersonalized(e){return g(e)}hasAtLeastOneSynonym(e){return m(e)}getAutoCorrectionSuggestion(e){return y(e)}};w=Object(r.c)([Object(u.a)()],w)},,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";(function(e){var r=n(853),i=n(854),o=n(771);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return c(this,e,t,n)}function c(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=f(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n);e=s(e,r);var i=e.write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(u.isBuffer(t)){var n=0|h(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?s(e,0):f(e,t);if("Buffer"===t.type&&o(t.data))return f(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(l(t),e=s(e,t<0?0:0|h(t)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function f(e,t){var n=t.length<0?0:0|h(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function h(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return z(e).length;default:if(r)return q(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,n);case"utf8":case"utf-8":return E(this,t,n);case"ascii":return k(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return C(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function y(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,r,i){var o,a=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=n;o<s;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(n+u>s&&(n=s-u),o=n;o>=0;o--){for(var d=!0,f=0;f<u;f++)if(c(e,o+f)!==c(t,f)){d=!1;break}if(d)return o}return-1}function v(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function w(e,t,n,r){return W(q(t,e.length-n),e,n,r)}function S(e,t,n,r){return W(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function _(e,t,n,r){return S(e,t,n,r)}function T(e,t,n,r){return W(z(t),e,n,r)}function O(e,t,n,r){return W(function(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function C(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function E(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,s,u,c=e[i],l=null,d=c>239?4:c>223?3:c>191?2:1;if(i+d<=n)switch(d){case 1:c<128&&(l=c);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,d=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=d}return function(e){var t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=I));return n}(r)}t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,n){return c(null,e,t,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},u.allocUnsafe=function(e){return d(null,e)},u.allocUnsafeSlow=function(e){return d(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=u.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?E(this,0,e):g.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,n,r,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(o,a),c=this.slice(r,i),l=e.slice(t,n),d=0;d<s;++d)if(c[d]!==l[d]){o=c[d],a=l[d];break}return o<a?-1:a<o?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":return S(this,e,t,n);case"latin1":case"binary":return _(this,e,t,n);case"base64":return T(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function k(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function A(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function P(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=U(e[o]);return i}function N(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function j(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,n,r,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function x(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function D(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function M(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(e,t,n,r,o){return o||M(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function B(e,t,n,r,o){return o||M(e,0,n,8),i.write(e,t,n,r,52,8),n+8}u.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},u.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||j(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},u.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||j(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},u.prototype.readUInt8=function(e,t){return t||j(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||j(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||j(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||j(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||j(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||j(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||j(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return t||j(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||j(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){t||j(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return t||j(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||j(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||j(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||j(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||j(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||j(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||R(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},u.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||R(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},u.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);R(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a|0)-s&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);R(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a|0)-s&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,n){return L(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return L(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return B(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return B(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},u.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=u.isBuffer(e)?e:q(new u(e,r).toString()),s=a.length;for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function U(e){return e<16?"0"+e.toString(16):e.toString(16)}function q(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function z(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function W(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(69))},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IDynamicSettingsReader")},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IPageParserPersistedStore")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IRoamingDictionaryEmitter")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IAugLoopAuthenticationEmitter")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IHostModelPersistedStore")},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IHostTilingEmitter")},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,i="~";function o(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,n,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new a(n,r||e,o),u=i?i+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function u(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function c(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),c.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},c.prototype.listeners=function(e){var t=i?i+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,a=new Array(o);r<o;r++)a[r]=n[r].fn;return a},c.prototype.listenerCount=function(e){var t=i?i+e:e,n=this._events[t];return n?n.fn?1:n.length:0},c.prototype.emit=function(e,t,n,r,o,a){var s=i?i+e:e;if(!this._events[s])return!1;var u,c,l=this._events[s],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,r),!0;case 5:return l.fn.call(l.context,t,n,r,o),!0;case 6:return l.fn.call(l.context,t,n,r,o,a),!0}for(c=1,u=new Array(d-1);c<d;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var f,h=l.length;for(c=0;c<h;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),d){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,n);break;case 4:l[c].fn.call(l[c].context,t,n,r);break;default:if(!u)for(f=1,u=new Array(d-1);f<d;f++)u[f-1]=arguments[f];l[c].fn.apply(l[c].context,u)}}return!0},c.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},c.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},c.prototype.removeListener=function(e,t,n,r){var o=i?i+e:e;if(!this._events[o])return this;if(!t)return u(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||r&&!a.once||n&&a.context!==n||u(this,o);else{for(var s=0,c=[],l=a.length;s<l;s++)(a[s].fn!==t||r&&!a[s].once||n&&a[s].context!==n)&&c.push(a[s]);c.length?this._events[o]=1===c.length?c[0]:c:u(this,o)}return this},c.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&u(this,t)):(this._events=new o,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=i,c.EventEmitter=c,e.exports=c},,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));const r=void 0!==e&&e.hrtime?()=>{const t=e.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof performance&&performance.now?()=>performance.now():()=>Date.now()}).call(this,n(123))},,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u}));var r=n(18),i=n(109),o=((Object(i.a)()||{}).Symbol,(Object(i.a)()||{}).Reflect,r.a||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])r.f[r.i].call(t,o)&&(e[o]=t[o]);return e}),a=function(e,t){return a=r.b.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[r.i](n)&&(e[n]=t[n])},a(e,t)};function s(e,t){function n(){this.constructor=e}typeof t!==r.h&&null!==t&&Object(i.c)("Class extends value "+String(t)+" is not a constructor or null"),a(e,t),e[r.k]=null===t?Object(i.b)(t):(n[r.k]=t[r.k],new n)}function u(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}},function(e,t,n){function r(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===r(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===r(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===r(e)},t.isError=function(e){return"[object Error]"===r(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(530).Buffer.isBuffer},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2),i=n(11),o=n(656),a=n(646),s=n(26);let u=class extends o.a{constructor(e,t){super(t),this.userInfoStrategy=e,this.options=t}async sendOperationRequest(e,t,n){return this.updateBaseUri(),super.sendOperationRequest(e,t,n)}updateBaseUri(){this.userInfoStrategy.execute(!1,(e=>(e&&e.regionScope!==this.regionScope&&(this.regionScope=e.regionScope,this.baseUri=this.regionScope===s.d.GCC?`https://${a.b.GCCHigh}`:this.options.baseUri),e)))}};u=Object(r.c)([Object(i.a)()],u)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IRoamingDictionaryBroker")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IInstrumentationMessageProcessor")},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r={IsPaneOpen:"IsPaneOpen",IsPaneOpenedInSession:"IsPaneOpenedInSession"}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IPaneOpenState")},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return Ce}));var r=n(12),i=0;function o(){return i++}var a=function(){function e(e,t){this.id=o(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=r.b.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=t.scope===r.a.Singleton&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.onDeactivation=this.onDeactivation,t.cache=this.cache,t},e}(),s=n(15),u=n(14),c=n(198),l={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};function d(e){return e instanceof RangeError||e.message===s.B}var f=n(41),h=function(){function e(e){this.id=o(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}(),p=n(45),g=function(e,t){this.parentContext=e,this.rootRequest=t},m=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}(),y=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}(),b=function(){function e(e,t,n,r){this.id=o(),this.type=e,this.serviceIdentifier=n;var i="symbol"==typeof t?Object(f.d)(t):t;this.name=new y(i||""),this.identifier=t,this.metadata=new Array;var a=null;"string"==typeof r?a=new p.a(u.d,r):r instanceof p.a&&(a=r),null!==a&&this.metadata.push(a)}return e.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){if(n[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(u.c)},e.prototype.matchesArray=function(e){return this.matchesTag(u.c)(e)},e.prototype.isNamed=function(){return this.hasTag(u.d)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return u.f.every((function(t){return e.key!==t}))}))},e.prototype.isOptional=function(){return this.matchesTag(u.g)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===u.d}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return u.f.every((function(t){return e.key!==t}))})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(u.d)(e)},e.prototype.matchesTag=function(e){var t=this;return function(n){for(var r=0,i=t.metadata;r<i.length;r++){var o=i[r];if(o.key===e&&o.value===n)return!0}return!1}},e}(),v=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};function w(e,t,n,r){var i=e.getConstructorMetadata(n),o=i.compilerGeneratedMetadata;if(void 0===o){var a=s.t+" "+t+".";throw new Error(a)}var u=i.userGeneratedMetadata,c=Object.keys(u),l=0===n.length&&c.length>0,d=c.length>n.length,f=function(e,t,n,r,i){for(var o=[],a=0;a<i;a++){var s=S(a,e,t,n,r);null!==s&&o.push(s)}return o}(r,t,o,u,l||d?c.length:n.length),h=T(e,n,t);return v(v([],f,!0),h,!0)}function S(e,t,n,i,o){var a=o[e.toString()]||[],u=C(a),c=!0!==u.unmanaged,l=i[e],d=u.inject||u.multiInject;if((l=d||l)instanceof m&&(l=l.unwrap()),c){if(!t&&(l===Object||l===Function||void 0===l)){var f=s.u+" argument "+e+" in class "+n+".";throw new Error(f)}var h=new b(r.c.ConstructorArgument,u.targetName,l);return h.metadata=a,h}return null}function _(e,t,n,r){var i=e||t;if(void 0===i){var o=s.t+" for property "+String(n)+" in class "+r+".";throw new Error(o)}return i}function T(e,t,n){for(var i=e.getPropertiesMetadata(t),o=[],a=Object.getOwnPropertySymbols(i),s=0,u=Object.keys(i).concat(a);s<u.length;s++){var c=u[s],l=i[c],d=C(l),f=d.targetName||c,h=_(d.inject,d.multiInject,c,n),p=new b(r.c.ClassProperty,f,h);p.metadata=l,o.push(p)}var g=Object.getPrototypeOf(t.prototype).constructor;if(g!==Object){var m=T(e,g,n);o=v(v([],o,!0),m,!0)}return o}function O(e,t){var n=Object.getPrototypeOf(t.prototype).constructor;if(n!==Object){var r=w(e,Object(f.b)(n),n,!0),i=r.map((function(e){return e.metadata.filter((function(e){return e.key===u.m}))})),o=[].concat.apply([],i).length,a=r.length-o;return a>0?a:O(e,n)}return 0}function C(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[u.b],multiInject:t[u.c],targetName:t[u.e],unmanaged:t[u.m]}}var E=function(){function e(e,t,n,r,i){this.id=o(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=i,this.childRequests=[],this.bindings=Array.isArray(r)?r:[r],this.requestScope=null===n?new Map:null}return e.prototype.addChildRequest=function(t,n,r){var i=new e(t,this.parentContext,this,n,r);return this.childRequests.push(i),i},e}();function I(e){return e._bindingDictionary}function k(e,t,n,r,i){var o=P(n.container,i.serviceIdentifier),a=[];return o.length===l.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"==typeof i.serviceIdentifier&&e.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(i.serviceIdentifier).toSelf(),o=P(n.container,i.serviceIdentifier)),a=t?o:o.filter((function(e){var t=new E(e.serviceIdentifier,n,r,e,i);return e.constraint(t)})),function(e,t,n,r){switch(t.length){case l.NoBindingsAvailable:if(n.isOptional())return t;var i=Object(f.c)(e),o=s.v;throw o+=Object(f.e)(i,n),o+=Object(f.f)(r,i,P),new Error(o);case l.OnlyOneBindingAvailable:return t;case l.MultipleBindingsAvailable:default:if(n.isArray())return t;i=Object(f.c)(e),o=s.a+" "+i;throw o+=Object(f.f)(r,i,P),new Error(o)}}(i.serviceIdentifier,a,i,n.container),a}function A(e,t,n,i,o,a){var u,c;if(null===o){u=k(e,t,i,null,a),c=new E(n,i,null,u,a);var l=new g(i,c);i.addPlan(l)}else u=k(e,t,i,o,a),c=o.addChildRequest(a.serviceIdentifier,u,a);u.forEach((function(t){var n=null;if(a.isArray())n=c.addChildRequest(t.serviceIdentifier,t,a);else{if(t.cache)return;n=c}if(t.type===r.b.Instance&&null!==t.implementationType){var o=function(e,t){return w(e,Object(f.b)(t),t,!1)}(e,t.implementationType);if(!i.container.options.skipBaseClassChecks){var u=O(e,t.implementationType);if(o.length<u){var l=s.b(Object(f.b)(t.implementationType));throw new Error(l)}}o.forEach((function(t){A(e,!1,t.serviceIdentifier,i,n,t)}))}}))}function P(e,t){var n=[],r=I(e);return r.hasKey(t)?n=r.get(t):null!==e.parent&&(n=P(e.parent,t)),n}function N(e,t,n,r,i,o,a,s){void 0===s&&(s=!1);var c=new h(t),l=function(e,t,n,r,i,o){var a=e?u.c:u.b,s=new p.a(a,n),c=new b(t,r,n,s);if(void 0!==i){var l=new p.a(i,o);c.metadata.push(l)}return c}(n,r,i,"",o,a);try{return A(e,s,i,c,null,l),c}catch(e){throw d(e)&&Object(f.a)(c.plan.rootRequest),e}}function j(e){return("object"==typeof e&&null!==e||"function"==typeof e)&&"function"==typeof e.then}function R(e){return!!j(e)||Array.isArray(e)&&e.some(j)}var x=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},D=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},M=function(e,t,n){e.has(t.id)||e.set(t.id,n)},L=function(e,t){e.cache=t,e.activated=!0,j(t)&&B(e,t)},B=function(e,t){return x(void 0,void 0,void 0,(function(){var n,r;return D(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,t];case 1:return n=i.sent(),e.cache=n,[3,3];case 2:throw r=i.sent(),e.cache=null,e.activated=!1,r;case 3:return[2]}}))}))},F=n(190),U=function(){return U=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},U.apply(this,arguments)},q=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},z=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},W=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};function V(e,t,n){var i;if(t.length>0){var o=function(e,t){return e.reduce((function(e,n){var i=t(n);return n.target.type===r.c.ConstructorArgument?e.constructorInjections.push(i):(e.propertyRequests.push(n),e.propertyInjections.push(i)),e.isAsync||(e.isAsync=R(i)),e}),{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}(t,n),a=U(U({},o),{constr:e});i=o.isAsync?function(e){return q(this,void 0,void 0,(function(){var t,n;return z(this,(function(r){switch(r.label){case 0:return[4,H(e.constructorInjections)];case 1:return t=r.sent(),[4,H(e.propertyInjections)];case 2:return n=r.sent(),[2,G(U(U({},e),{constructorInjections:t,propertyInjections:n}))]}}))}))}(a):G(a)}else i=new e;return i}function G(e){var t,n=new((t=e.constr).bind.apply(t,W([void 0],e.constructorInjections,!1)));return e.propertyRequests.forEach((function(t,r){var i=t.target.identifier,o=e.propertyInjections[r];n[i]=o})),n}function H(e){return q(this,void 0,void 0,(function(){var t,n,r,i;return z(this,(function(o){for(t=[],n=0,r=e;n<r.length;n++)i=r[n],Array.isArray(i)?t.push(Promise.all(i)):t.push(i);return[2,Promise.all(t)]}))}))}function $(e,t){var n=function(e,t){var n,r;if(Reflect.hasMetadata(u.i,e)){var i=Reflect.getMetadata(u.i,e);try{return null===(r=(n=t)[i.value])||void 0===r?void 0:r.call(n)}catch(t){throw new Error(Object(s.z)(e.name,t.message))}}}(e,t);return j(n)?n.then((function(){return t})):t}function K(e,t){e.scope!==r.a.Singleton&&function(e,t){var n="Class cannot be instantiated in "+(e.scope===r.a.Request?"request":"transient")+" scope.";if("function"==typeof e.onDeactivation)throw new Error(Object(s.y)(t.name,n));if(Reflect.hasMetadata(u.j,t))throw new Error(Object(s.A)(t.name,n))}(e,t)}var J=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},Q=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Y=function(e){return function(t){t.parentContext.setCurrentRequest(t);var n=t.bindings,r=t.childRequests,i=t.target&&t.target.isArray(),o=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(i&&o)return r.map((function(t){return Y(e)(t)}));if(!t.target.isOptional()||0!==n.length){var a=n[0];return te(e,t,a)}}},X=function(e,t){var n=Object(F.b)(e);return function(e,t){try{return e()}catch(e){throw d(e)&&(e=t()),e}}((function(){return n.factory.bind(e)(t)}),(function(){return new Error(s.f(n.factoryType,t.currentRequest.serviceIdentifier.toString()))}))},Z=function(e,t,n){var i,o=t.childRequests;switch(Object(F.a)(n),n.type){case r.b.ConstantValue:case r.b.Function:i=n.cache;break;case r.b.Constructor:i=n.implementationType;break;case r.b.Instance:i=function(e,t,n,r){K(e,t);var i=V(t,n,r);return j(i)?i.then((function(e){return $(t,e)})):$(t,i)}(n,n.implementationType,o,Y(e));break;default:i=X(n,t.parentContext)}return i},ee=function(e,t,n){var i=function(e,t){return t.scope===r.a.Singleton&&t.activated?t.cache:t.scope===r.a.Request&&e.has(t.id)?e.get(t.id):null}(e,t);return null!==i||function(e,t,n){t.scope===r.a.Singleton&&L(t,n),t.scope===r.a.Request&&M(e,t,n)}(e,t,i=n()),i},te=function(e,t,n){return ee(e,n,(function(){var r=Z(e,t,n);return r=j(r)?r.then((function(e){return ne(t,n,e)})):ne(t,n,r)}))};function ne(e,t,n){var r,i=re(e.parentContext,t,n),o=se(e.parentContext.container),a=o.next();do{r=a.value;var s=e.parentContext,u=e.serviceIdentifier,c=ae(r,u);i=j(i)?oe(c,s,i):ie(c,s,i),a=o.next()}while(!0!==a.done&&!I(r).hasKey(e.serviceIdentifier));return i}var re=function(e,t,n){return"function"==typeof t.onActivation?t.onActivation(e,n):n},ie=function(e,t,n){for(var r=e.next();!r.done;){if(j(n=r.value(t,n)))return oe(e,t,n);r=e.next()}return n},oe=function(e,t,n){return J(void 0,void 0,void 0,(function(){var r,i;return Q(this,(function(o){switch(o.label){case 0:return[4,n];case 1:r=o.sent(),i=e.next(),o.label=2;case 2:return i.done?[3,4]:[4,i.value(t,r)];case 3:return r=o.sent(),i=e.next(),[3,2];case 4:return[2,r]}}))}))},ae=function(e,t){var n=e._activations;return n.hasKey(t)?n.get(t).values():[].values()},se=function(e){for(var t=[e],n=e.parent;null!==n;)t.push(n),n=n.parent;return{next:function(){var e=t.pop();return void 0!==e?{done:!1,value:e}:{done:!0,value:void 0}}}};var ue=function(e,t){var n=e.parentRequest;return null!==n&&(!!t(n)||ue(n,t))},ce=function(e){return function(t){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(e)(t)};return n.metaData=new p.a(e,t),n}},le=ce(u.d),de=function(e){return function(t){var n=null;if(null!==t){if(n=t.bindings[0],"string"==typeof e)return n.serviceIdentifier===e;var r=t.bindings[0].implementationType;return e===r}return!1}},fe=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new he(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=le(e),new he(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e&&(null!==e.target&&!e.target.isNamed()&&!e.target.isTagged())},new he(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=ce(e)(t),new he(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return null!==t&&de(e)(t.parentRequest)},new he(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return null!==t&&le(e)(t.parentRequest)},new he(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&ce(e)(t)(n.parentRequest)},new he(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return null!==t&&ue(t,de(e))},new he(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return null!==t&&!ue(t,de(e))},new he(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return null!==t&&ue(t,le(e))},new he(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return null!==t&&!ue(t,le(e))},new he(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&ue(n,ce(e)(t))},new he(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&!ue(n,ce(e)(t))},new he(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return null!==t&&ue(t,e)},new he(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return null!==t&&!ue(t,e)},new he(this._binding)},e}(),he=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new fe(this._binding)},e.prototype.onDeactivation=function(e){return this._binding.onDeactivation=e,new fe(this._binding)},e}(),pe=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new fe(this._binding),this._bindingOnSyntax=new he(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},e}(),ge=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=r.a.Request,new pe(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=r.a.Singleton,new pe(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=r.a.Transient,new pe(this._binding)},e}(),me=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new fe(this._binding),this._bindingOnSyntax=new he(this._binding),this._bindingInSyntax=new ge(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},e}(),ye=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=r.b.Instance,this._binding.implementationType=e,new me(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+s.q);var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=r.b.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=r.a.Singleton,new pe(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=r.b.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new me(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=r.b.Constructor,this._binding.implementationType=e,this._binding.scope=r.a.Singleton,new pe(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=r.b.Factory,this._binding.factory=e,this._binding.scope=r.a.Singleton,new pe(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error(s.o);var t=this.toConstantValue(e);return this._binding.type=r.b.Function,this._binding.scope=r.a.Singleton,t},e.prototype.toAutoFactory=function(e){return this._binding.type=r.b.Factory,this._binding.factory=function(t){return function(){return t.container.get(e)}},this._binding.scope=r.a.Singleton,new pe(this._binding)},e.prototype.toAutoNamedFactory=function(e){return this._binding.type=r.b.Factory,this._binding.factory=function(t){return function(n){return t.container.getNamed(e,n)}},new pe(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=r.b.Provider,this._binding.provider=e,this._binding.scope=r.a.Singleton,new pe(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}(),be=function(){function e(){}return e.of=function(t,n,r,i,o){var a=new e;return a.bindings=t,a.middleware=n,a.deactivations=i,a.activations=r,a.moduleActivationStore=o,a},e}();var ve=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(s.x);if(null==t)throw new Error(s.x);var n=this._map.get(e);void 0!==n?n.push(t):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(s.x);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(s.r)},e.prototype.remove=function(e){if(null==e)throw new Error(s.x);if(!this._map.delete(e))throw new Error(s.r)},e.prototype.removeIntersection=function(e){var t=this;this.traverse((function(n,r){var i=e.hasKey(n)?e.get(n):void 0;if(void 0!==i){var o=r.filter((function(e){return!i.some((function(t){return e===t}))}));t._setValue(n,o)}}))},e.prototype.removeByCondition=function(e){var t=this,n=[];return this._map.forEach((function(r,i){for(var o=[],a=0,s=r;a<s.length;a++){var u=s[a];e(u)?n.push(u):o.push(u)}t._setValue(i,o)})),n},e.prototype.hasKey=function(e){if(null==e)throw new Error(s.x);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){e.forEach((function(e){return t.add(n,"object"==typeof(r=e)&&null!==r&&"clone"in r&&"function"==typeof r.clone?e.clone():e);var r}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,n){e(n,t)}))},e.prototype._setValue=function(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)},e}(),we=function(){function e(){this._map=new Map}return e.prototype.remove=function(e){if(this._map.has(e)){var t=this._map.get(e);return this._map.delete(e),t}return this._getEmptyHandlersStore()},e.prototype.addDeactivation=function(e,t,n){this._getModuleActivationHandlers(e).onDeactivations.add(t,n)},e.prototype.addActivation=function(e,t,n){this._getModuleActivationHandlers(e).onActivations.add(t,n)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){t._map.set(n,{onActivations:e.onActivations.clone(),onDeactivations:e.onDeactivations.clone()})})),t},e.prototype._getModuleActivationHandlers=function(e){var t=this._map.get(e);return void 0===t&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t},e.prototype._getEmptyHandlersStore=function(){return{onActivations:new ve,onDeactivations:new ve}},e}(),Se=function(){return Se=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Se.apply(this,arguments)},_e=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},Te=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Oe=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},Ce=function(){function e(e){var t=e||{};if("object"!=typeof t)throw new Error(""+s.j);if(void 0===t.defaultScope)t.defaultScope=r.a.Transient;else if(t.defaultScope!==r.a.Singleton&&t.defaultScope!==r.a.Transient&&t.defaultScope!==r.a.Request)throw new Error(""+s.h);if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error(""+s.g);if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error(""+s.i);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=o(),this._bindingDictionary=new ve,this._snapshots=[],this._middleware=null,this._activations=new ve,this._deactivations=new ve,this.parent=null,this._metadataReader=new c.a,this._moduleActivationStore=new we}return e.merge=function(t,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var o=new e,a=Oe([t,n],r,!0).map((function(e){return I(e)})),s=I(o);return a.forEach((function(e){var t;t=s,e.traverse((function(e,n){n.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))})),o},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),r=0,i=e;r<i.length;r++){var o=i[r],a=n(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return _e(this,void 0,void 0,(function(){var t,n,r,i,o;return Te(this,(function(a){switch(a.label){case 0:t=this._getContainerModuleHelpersFactory(),n=0,r=e,a.label=1;case 1:return n<r.length?(i=r[n],o=t(i.id),[4,i.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction,o.unbindAsyncFunction,o.onActivationFunction,o.onDeactivationFunction)]):[3,4];case 2:a.sent(),a.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach((function(t){var n=e._removeModuleBindings(t.id);e._deactivateSingletons(n),e._removeModuleHandlers(t.id)}))},e.prototype.unloadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return _e(this,void 0,void 0,(function(){var t,n,r,i;return Te(this,(function(o){switch(o.label){case 0:t=0,n=e,o.label=1;case 1:return t<n.length?(r=n[t],i=this._removeModuleBindings(r.id),[4,this._deactivateSingletonsAsync(i)]):[3,4];case 2:o.sent(),this._removeModuleHandlers(r.id),o.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},e.prototype.bind=function(e){var t=this.options.defaultScope||r.a.Transient,n=new a(e,t);return this._bindingDictionary.add(e,n),new ye(n)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.rebindAsync=function(e){return _e(this,void 0,void 0,(function(){return Te(this,(function(t){switch(t.label){case 0:return[4,this.unbindAsync(e)];case 1:return t.sent(),[2,this.bind(e)]}}))}))},e.prototype.unbind=function(e){if(this._bindingDictionary.hasKey(e)){var t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)},e.prototype.unbindAsync=function(e){return _e(this,void 0,void 0,(function(){var t;return Te(this,(function(n){switch(n.label){case 0:return this._bindingDictionary.hasKey(e)?(t=this._bindingDictionary.get(e),[4,this._deactivateSingletonsAsync(t)]):[3,2];case 1:n.sent(),n.label=2;case 2:return this._removeServiceFromDictionary(e),[2]}}))}))},e.prototype.unbindAll=function(){var e=this;this._bindingDictionary.traverse((function(t,n){e._deactivateSingletons(n)})),this._bindingDictionary=new ve},e.prototype.unbindAllAsync=function(){return _e(this,void 0,void 0,(function(){var e,t=this;return Te(this,(function(n){switch(n.label){case 0:return e=[],this._bindingDictionary.traverse((function(n,r){e.push(t._deactivateSingletonsAsync(r))})),[4,Promise.all(e)];case 1:return n.sent(),this._bindingDictionary=new ve,[2]}}))}))},e.prototype.onActivation=function(e,t){this._activations.add(e,t)},e.prototype.onDeactivation=function(e,t){this._deactivations.add(e,t)},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isCurrentBound=function(e){return this._bindingDictionary.hasKey(e)},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,u.d,t)},e.prototype.isBoundTagged=function(e,t,n){var i=!1;if(this._bindingDictionary.hasKey(e)){var o=this._bindingDictionary.get(e),a=function(e,t,n,i){var o=new b(r.c.Variable,"",t,new p.a(n,i)),a=new h(e);return new E(t,a,null,[],o)}(this,e,t,n);i=o.some((function(e){return e.constraint(a)}))}return!i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i},e.prototype.snapshot=function(){this._snapshots.push(be.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error(s.w);this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore},e.prototype.createChild=function(t){var n=new e(t||this.options);return n.parent=this,n},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),n)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){var t=this._getNotAllArgs(e,!1);return this._getButThrowIfAsync(t)},e.prototype.getAsync=function(e){return _e(this,void 0,void 0,(function(){var t;return Te(this,(function(n){return t=this._getNotAllArgs(e,!1),[2,this._get(t)]}))}))},e.prototype.getTagged=function(e,t,n){var r=this._getNotAllArgs(e,!1,t,n);return this._getButThrowIfAsync(r)},e.prototype.getTaggedAsync=function(e,t,n){return _e(this,void 0,void 0,(function(){var r;return Te(this,(function(i){return r=this._getNotAllArgs(e,!1,t,n),[2,this._get(r)]}))}))},e.prototype.getNamed=function(e,t){return this.getTagged(e,u.d,t)},e.prototype.getNamedAsync=function(e,t){return this.getTaggedAsync(e,u.d,t)},e.prototype.getAll=function(e){var t=this._getAllArgs(e);return this._getButThrowIfAsync(t)},e.prototype.getAllAsync=function(e){var t=this._getAllArgs(e);return this._getAll(t)},e.prototype.getAllTagged=function(e,t,n){var r=this._getNotAllArgs(e,!0,t,n);return this._getButThrowIfAsync(r)},e.prototype.getAllTaggedAsync=function(e,t,n){var r=this._getNotAllArgs(e,!0,t,n);return this._getAll(r)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,u.d,t)},e.prototype.getAllNamedAsync=function(e,t){return this.getAllTaggedAsync(e,u.d,t)},e.prototype.resolve=function(e){var t=this.isBound(e);t||this.bind(e).toSelf();var n=this.get(e);return t||this.unbind(e),n},e.prototype._preDestroy=function(e,t){if(Reflect.hasMetadata(u.j,e))return t[Reflect.getMetadata(u.j,e).value]()},e.prototype._removeModuleHandlers=function(e){var t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)},e.prototype._removeModuleBindings=function(e){return this._bindingDictionary.removeByCondition((function(t){return t.moduleId===e}))},e.prototype._deactivate=function(e,t){var n=this,r=Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){var i=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if(j(i))return this._handleDeactivationError(i.then((function(){return n._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,r)})),r)}var o=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,r);if(j(o))return this._handleDeactivationError(o,r)}catch(e){throw new Error(s.y(r.name,e.message))}},e.prototype._handleDeactivationError=function(e,t){return _e(this,void 0,void 0,(function(){var n;return Te(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e];case 1:return r.sent(),[3,3];case 2:throw n=r.sent(),new Error(s.y(t.name,n.message));case 3:return[2]}}))}))},e.prototype._deactivateContainer=function(e,t){for(var n=this,r=t.next();r.value;){var i=r.value(e);if(j(i))return i.then((function(){return n._deactivateContainerAsync(e,t)}));r=t.next()}},e.prototype._deactivateContainerAsync=function(e,t){return _e(this,void 0,void 0,(function(){var n;return Te(this,(function(r){switch(r.label){case 0:n=t.next(),r.label=1;case 1:return n.value?[4,n.value(e)]:[3,3];case 2:return r.sent(),n=t.next(),[3,1];case 3:return[2]}}))}))},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},n=function(n){return function(r){var i=e.rebind(r);return t(i,n),i}},r=function(t){return function(n,r){e._moduleActivationStore.addActivation(t,n,r),e.onActivation(n,r)}},i=function(t){return function(n,r){e._moduleActivationStore.addDeactivation(t,n,r),e.onDeactivation(n,r)}};return function(o){return{bindFunction:(a=o,function(n){var r=e.bind(n);return t(r,a),r}),isboundFunction:function(t){return e.isBound(t)},onActivationFunction:r(o),onDeactivationFunction:i(o),rebindFunction:n(o),unbindFunction:function(t){return e.unbind(t)},unbindAsyncFunction:function(t){return e.unbindAsync(t)}};var a}},e.prototype._getAll=function(e){return Promise.all(this._get(e))},e.prototype._get=function(e){var t=Se(Se({},e),{contextInterceptor:function(e){return e},targetType:r.c.Variable});if(this._middleware){var n=this._middleware(t);if(null==n)throw new Error(s.p);return n}return this._planAndResolve()(t)},e.prototype._getButThrowIfAsync=function(e){var t=this._get(e);if(R(t))throw new Error(s.s(e.serviceIdentifier));return t},e.prototype._getAllArgs=function(e){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e}},e.prototype._getNotAllArgs=function(e,t,n,r){return{avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:n,value:r}},e.prototype._planAndResolve=function(){var e=this;return function(t){var n=N(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);return function(e){return Y(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}(n=t.contextInterceptor(n))}},e.prototype._deactivateIfSingleton=function(e){var t=this;if(e.activated)return j(e.cache)?e.cache.then((function(n){return t._deactivate(e,n)})):this._deactivate(e,e.cache)},e.prototype._deactivateSingletons=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if(j(this._deactivateIfSingleton(r)))throw new Error(s.c)}},e.prototype._deactivateSingletonsAsync=function(e){return _e(this,void 0,void 0,(function(){var t=this;return Te(this,(function(n){switch(n.label){case 0:return[4,Promise.all(e.map((function(e){return t._deactivateIfSingleton(e)})))];case 1:return n.sent(),[2]}}))}))},e.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(e,t,n){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,n)},e.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(e,t,n){return _e(this,void 0,void 0,(function(){return Te(this,(function(r){switch(r.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(e,t)]:[3,2];case 1:return r.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(e,t,n)];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))},e.prototype._removeServiceFromDictionary=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(s.d+" "+Object(f.c)(e))}},e.prototype._bindingDeactivationAndPreDestroy=function(e,t,n){var r=this;if("function"==typeof e.onDeactivation){var i=e.onDeactivation(t);if(j(i))return i.then((function(){return r._preDestroy(n,t)}))}return this._preDestroy(n,t)},e.prototype._bindingDeactivationAndPreDestroyAsync=function(e,t,n){return _e(this,void 0,void 0,(function(){return Te(this,(function(r){switch(r.label){case 0:return"function"!=typeof e.onDeactivation?[3,2]:[4,e.onDeactivation(t)];case 1:r.sent(),r.label=2;case 2:return[4,this._preDestroy(n,t)];case 3:return r.sent(),[2]}}))}))},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var r=n(2),i=n(217),o=n(8),a=n(138),s=n(195),u=n(139),c=n(349),l=n(11),d=n(7),f=n(85),h=n(176),p=n(214),g=n(211),m=n(16),y=n(58);function b(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){b(o,r,i,a,s,"next",e)}function s(e){b(o,r,i,a,s,"throw",e)}a(void 0)}))}}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var _=function(){function e(t,n,r,a,s,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_proofingEmitter",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_pageContextEmitter",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_emitter",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"_persistedStore",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"_systemPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"_betaPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:u}),Object.defineProperty(this,"_runtimeOnOffState",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_proofingLanguages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._proofingLanguages=new i.a(this._persistedStore.getDefaultValue(o.a.ProofingLanguages))}var t,n,r;return t=e,(n=[{key:"initialize",value:function(){var e=this;return v((function(){var t,n;return S(this,(function(r){switch(r.label){case 0:return[4,e._persistedStore.read(o.a.ProofingLanguages)];case 1:return r.sent(),t={},[4,e._persistedStore.read(u.a.UserExcludedUrls)];case 2:return t.userExcludedUrls=r.sent(),[4,e._systemPersistedStore.read(m.a.DisabledWebSites)];case 3:return t.excludedUrls=r.sent(),[4,e._persistedStore.read(o.a.EnableEditor)];case 4:return t.enableEditor=r.sent(),[4,e._systemPersistedStore.read(m.a.DisabledGrammars)];case 5:return t.disabledGrammars=r.sent(),n=JSON.parse,[4,e._betaPersistedStore.read(h.a.BetaEnrollment)];case 6:return e._runtimeOnOffState=(t.betaEnrollment=n.apply(JSON,[r.sent()]),t),e._pageContextEmitter.emit("runtimeOnOffStateCheck",e._runtimeOnOffState),e._emitter.on(u.a.UserExcludedUrls,v((function(){var t;return S(this,(function(n){switch(n.label){case 0:return[4,e._persistedStore.read(u.a.UserExcludedUrls)];case 1:return t=n.sent(),e._runtimeOnOffState&&e._runtimeOnOffState.userExcludedUrls!==t&&(e._runtimeOnOffState.userExcludedUrls=t,e._pageContextEmitter.emit("runtimeOnOffStateCheck",e._runtimeOnOffState)),[2]}}))}))),e._emitter.on(o.a.EnableEditor,v((function(){var t;return S(this,(function(n){switch(n.label){case 0:return[4,e._persistedStore.read(o.a.EnableEditor)];case 1:return t=n.sent(),e._runtimeOnOffState&&e._runtimeOnOffState.enableEditor!==t&&(e._runtimeOnOffState.enableEditor=t,e._pageContextEmitter.emit("runtimeOnOffStateCheck",e._runtimeOnOffState)),[2]}}))}))),e._emitter.on(m.a.DisabledWebSites,v((function(){var t;return S(this,(function(n){switch(n.label){case 0:return[4,e._systemPersistedStore.read(m.a.DisabledWebSites)];case 1:return t=n.sent(),e._runtimeOnOffState&&e._runtimeOnOffState.excludedUrls!==t&&(e._runtimeOnOffState.excludedUrls=t,e._pageContextEmitter.emit("runtimeOnOffStateCheck",e._runtimeOnOffState)),[2]}}))}))),e._emitter.on(m.a.DisabledGrammars,v((function(){var t;return S(this,(function(n){switch(n.label){case 0:return[4,e._systemPersistedStore.read(m.a.DisabledGrammars)];case 1:return t=n.sent(),e._runtimeOnOffState&&e._runtimeOnOffState.disabledGrammars!==t&&(e._runtimeOnOffState.disabledGrammars=t,e._pageContextEmitter.emit("runtimeOnOffStateCheck",e._runtimeOnOffState)),[2]}}))}))),e._emitter.on(h.a.BetaEnrollment,v((function(){var t,n;return S(this,(function(r){switch(r.label){case 0:return n=JSON.parse,[4,e._betaPersistedStore.read(h.a.BetaEnrollment)];case 1:return t=n.apply(JSON,[r.sent()]),e._runtimeOnOffState&&e._runtimeOnOffState.betaEnrollment!==t&&(e._runtimeOnOffState.betaEnrollment=t,e._pageContextEmitter.emit("runtimeOnOffStateCheck",e._runtimeOnOffState)),[2]}}))}))),e._emitter.on(o.a.ProofingLanguages,v((function(){var t,n;return S(this,(function(r){switch(r.label){case 0:return n=i.a.bind,[4,e._persistedStore.read(o.a.ProofingLanguages)];case 1:return t=new(n.apply(i.a,[void 0,r.sent()])),e._proofingLanguages&&t.equalsTo(e._proofingLanguages.codesList)||(e._proofingLanguages=t,e._proofingEmitter.emit("proofingLanguageChanged",{data:t,messageType:a.a.ChangeData,proofingLanguagesChanged:!0})),[2]}}))}))),[2]}}))}))()}},{key:"shutDown",value:function(){}}])&&w(t.prototype,n),r&&w(t,r),e}();_=Object(r.c)([Object(l.a)(),Object(r.f)(0,Object(d.a)(s.a)),Object(r.f)(1,Object(d.a)(c.a)),Object(r.f)(2,Object(d.a)(f.a)),Object(r.f)(3,Object(d.a)(g.a)),Object(r.f)(4,Object(d.a)(y.a)),Object(r.f)(5,Object(d.a)(p.a)),Object(r.e)("design:paramtypes",[Object,Object,Object,Object,Object,Object])],_)},function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r=n(2),i=n(13),o=n(248),a=n(102),s=n(192),u=n(85),c=n(11),l=n(7),d=n(31);function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){h(o,r,i,a,s,"next",e)}function s(e){h(o,r,i,a,s,"throw",e)}a(void 0)}))}}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function y(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?f(e):t;var n}function b(e,t){return b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},b(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m(e);if(t){var i=m(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y(this,n)}}function w(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(a,e);var t,n,r,o=v(a);function a(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),r=o.call(this,e,t),Object.defineProperty(f(r),"storeEntryReader",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(f(r),"storeEntryWriter",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(f(r),"_settingsEmitter",{enumerable:!0,configurable:!0,writable:!0,value:n}),r}return t=a,n=[{key:"populateStoreEntryMap",value:function(){var e=new Map;return e.set(d.a.PostUpsellAnnouncementVisible,{storeEntry:Object(i.d)(d.a.PostUpsellAnnouncementVisible,!1),isSynced:!0}),e.set(d.a.PostUpsellAnnouncementDismissed,{storeEntry:Object(i.d)(d.a.PostUpsellAnnouncementDismissed,!1),isSynced:!0}),e.set(d.a.PostUpsellAnnouncementHadSubscription,{storeEntry:Object(i.d)(d.a.PostUpsellAnnouncementHadSubscription,!0),isSynced:!0}),e.set(d.a.MultiLanguageAnnouncementVisible,{storeEntry:Object(i.d)(d.a.MultiLanguageAnnouncementVisible,!0),isSynced:!0}),e.set(d.a.MultiLanguageAnnouncementDismissed,{storeEntry:Object(i.d)(d.a.MultiLanguageAnnouncementDismissed,!1),isSynced:!0}),e.set(d.a.SignInAnnouncementVisible,{storeEntry:Object(i.d)(d.a.SignInAnnouncementVisible,!1),isSynced:!0}),e.set(d.a.SignInAnnouncementDismissed,{storeEntry:Object(i.d)(d.a.SignInAnnouncementDismissed,!1),isSynced:!0}),e.set(d.a.RoamingDictionaryLoggedInAnnouncementVisible,{storeEntry:Object(i.d)(d.a.RoamingDictionaryLoggedInAnnouncementVisible,!1),isSynced:!0}),e.set(d.a.RoamingDictionaryLoggedOutAnnouncementVisible,{storeEntry:Object(i.d)(d.a.RoamingDictionaryLoggedOutAnnouncementVisible,!1),isSynced:!0}),e.set(d.a.RoamingDictionaryLoggedInAnnouncementDismissed,{storeEntry:Object(i.d)(d.a.RoamingDictionaryLoggedInAnnouncementDismissed,!1),isSynced:!0}),e.set(d.a.RoamingDictionaryLoggedOutAnnouncementDismissed,{storeEntry:Object(i.d)(d.a.RoamingDictionaryLoggedOutAnnouncementDismissed,!1),isSynced:!0}),e.set(d.a.EligibleForRoamingDictionaryAnnouncement,{storeEntry:Object(i.d)(d.a.EligibleForRoamingDictionaryAnnouncement,!1),isSynced:!0}),e.set(d.a.GDocsNativeSquigglesAnnouncementVisible,{storeEntry:Object(i.d)(d.a.GDocsNativeSquigglesAnnouncementVisible,!1),isSynced:!0}),e.set(d.a.GDocsNativeSquigglesAnnouncementDismissed,{storeEntry:Object(i.d)(d.a.GDocsNativeSquigglesAnnouncementDismissed,!1),isSynced:!0}),e}},{key:"initialize",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this;return p((function(){var o,a;return w(this,(function(s){switch(s.label){case 0:return[4,i.read(e)];case 1:return o=s.sent(),[4,i.read(t)];case 2:return a=s.sent(),n(o&&!a),a&&!r||(i._settingsEmitter.on(e,p((function(){return w(this,(function(r){return i.onSettingsChange(e,t,n),[2]}))}))),i._settingsEmitter.on(t,p((function(){return w(this,(function(r){return i.onSettingsChange(e,t,n),[2]}))})))),[2]}}))}))()}},{key:"shutDown",value:function(e,t){var n=this;return p((function(){return w(this,(function(r){return n._settingsEmitter.off(e),n._settingsEmitter.off(t),n.write(t,!0),[2]}))}))()}},{key:"onSettingsChange",value:function(e,t,n){var r=this;return p((function(){var i,o;return w(this,(function(a){switch(a.label){case 0:return[4,r.read(e)];case 1:return i=a.sent(),[4,r.read(t)];case 2:return o=a.sent(),n(i&&!o),[2]}}))}))()}}],n&&g(t.prototype,n),r&&g(t,r),a}(o.a);S=Object(r.c)([Object(c.a)(),Object(r.f)(0,Object(l.a)(a.a)),Object(r.f)(1,Object(l.a)(s.a)),Object(r.f)(2,Object(l.a)(u.a)),Object(r.e)("design:paramtypes",[Object,Object,Object])],S)},function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var r=n(2),i=n(115),o=n(13),a=n(248),s=n(102),u=n(192),c=n(85),l=n(207),d=n(11),f=n(7),h=n(176),p=n(58),g=n(16);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){b(o,r,i,a,s,"next",e)}function s(e){b(o,r,i,a,s,"throw",e)}a(void 0)}))}}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}function _(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?y(e):t;var n}function T(e,t){return T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},T(e,t)}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S(e);if(t){var i=S(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _(this,n)}}function E(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(s,e);var t,n,r,a=C(s);function s(e,t,n,r){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),o=a.call(this,e,t),Object.defineProperty(y(o),"storeEntryReader",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(y(o),"storeEntryWriter",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(y(o),"_settingsEmitter",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(y(o),"_systemPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:r});var u,c=y(o);return Object.defineProperty(y(o),"onDisabledWebsitesChange",{enumerable:!0,configurable:!0,writable:!0,value:(u=v((function(e){var t,n;return E(this,(function(r){switch(r.label){case 0:return[4,c._systemPersistedStore.read(g.a.DisabledWebSites)];case 1:return t=r.sent(),n=t.some((function(t){return Object(l.a)(e,t)})),[4,c.getBetaExperienceState(e)];case 2:return r.sent()===i.a.Enabled&&n?[4,c.setBetaExperienceState(e,i.a.ShowSupportEndedTUI)]:[3,4];case 3:r.sent(),r.label=4;case 4:return[2]}}))})),function(e){return u.apply(this,arguments)})}),o}return t=s,(n=[{key:"populateStoreEntryMap",value:function(){var e=new Map;return e.set(h.a.BetaEnrollment,{storeEntry:Object(o.d)(h.a.BetaEnrollment,JSON.stringify([{url:"https://docs.google.com/document/.*",state:i.a.Default}]))}),e}},{key:"initialize",value:function(e,t){var n=this;return v((function(){var r,i,o,a,s,u,c,l,d;return E(this,(function(f){switch(f.label){case 0:return[4,n.getBetaExperienceState(e)];case 1:if(void 0===(r=f.sent()))return[2];i=!0,o=!1,a=void 0;try{for(s=t.entries()[Symbol.iterator]();!(i=(u=s.next()).done);i=!0)c=O(u.value,2),l=c[0],(0,c[1])(l===r)}catch(e){o=!0,a=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}return d=h.a.BetaEnrollment,n._settingsEmitter.on(d,v((function(){return E(this,(function(r){return n.onSettingsChange(e,t),[2]}))}))),n._settingsEmitter.on(g.a.DisabledWebSites,v((function(){return E(this,(function(t){return n.onDisabledWebsitesChange(e),[2]}))}))),[2]}}))}))()}},{key:"shutDown",value:function(){this._settingsEmitter.off(h.a.BetaEnrollment)}},{key:"getBetaExperienceState",value:function(e){var t=this;return v((function(){var n,r,i;return E(this,(function(o){switch(o.label){case 0:return r=JSON.parse,[4,t.read(h.a.BetaEnrollment)];case 1:return n=r.apply(JSON,[o.sent()]),(i=n.find((function(t){return Object(l.a)(e,t.url)})))?[2,i.state]:[2,void 0]}}))}))()}},{key:"setBetaExperienceState",value:function(e,t){var n=this;return v((function(){var r,i,o;return E(this,(function(a){switch(a.label){case 0:return i=JSON.parse,[4,n.read(h.a.BetaEnrollment)];case 1:return r=i.apply(JSON,[a.sent()]),(o=r.find((function(t){return Object(l.a)(e,t.url)})))?o.state=t:r.push({url:e,state:t}),[4,n.write(h.a.BetaEnrollment,JSON.stringify(r))];case 2:return a.sent(),[2]}}))}))()}},{key:"onSettingsChange",value:function(e,t){var n=this;return v((function(){var r,i,o,a,s,u,c,l;return E(this,(function(d){switch(d.label){case 0:return[4,n.getBetaExperienceState(e)];case 1:if(void 0===(r=d.sent()))return[2];i=!0,o=!1,a=void 0;try{for(s=t.entries()[Symbol.iterator]();!(i=(u=s.next()).done);i=!0)c=O(u.value,2),l=c[0],(0,c[1])(l===r)}catch(e){o=!0,a=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}return[2]}}))}))()}}])&&w(t.prototype,n),r&&w(t,r),s}(a.a);I=Object(r.c)([Object(d.a)(),Object(r.f)(0,Object(f.a)(s.a)),Object(r.f)(1,Object(f.a)(u.a)),Object(r.f)(2,Object(f.a)(c.a)),Object(r.f)(3,Object(f.a)(p.a)),Object(r.e)("design:paramtypes",[Object,Object,Object,Object])],I)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("ICritiqueValueStore")},function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var r=n(2),i=n(11),o=n(7),a=n(13),s=n(373),u=n(85),c=n(102),l=n(53),d=n(235),f=n(236),h=n(237),p=n(345);function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){m(o,r,i,a,s,"next",e)}function s(e){m(o,r,i,a,s,"throw",e)}a(void 0)}))}}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){return v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=w(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n||e):i.value}},v(e,t,n||e)}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function S(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?g(e):t;var n}function _(e,t){return _=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_(e,t)}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w(e);if(t){var i=w(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S(this,n)}}function O(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var C={DisableUnsignedInExperience:!0,DisableMsaAuth:!1,DisableWelcomePage:!1},E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(o,e);var t,n,r,i=T(o);function o(e,t,n,r,a,s,u){var c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),c=i.call(this,t,n,r,a,s,u),Object.defineProperty(g(c),"_managedStorage",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(g(c),"managedSettings",{enumerable:!0,configurable:!0,writable:!0,value:C});var l=g(c);return Object.defineProperty(g(c),"updateSettings",{enumerable:!0,configurable:!0,writable:!0,value:y((function(){return O(this,(function(e){switch(e.label){case 0:return[4,l._managedStorage.get()];case 1:return l.managedSettings=e.sent(),[2]}}))}))}),c}return t=o,(n=[{key:"flags",get:function(){var e=v(w(o.prototype),"flags",this);return!0===this.managedSettings.DisableUnsignedInExperience?Object.assign(Object.assign({},e),{enableUnsignedInEditor:!1}):e}},{key:"initialize",value:function(){var e=this;return y((function(){return O(this,(function(t){switch(t.label){case 0:return e._emitter.on(a.a.FeatureFlags,(function(){e.updateSettings()})),e._managedStorage.addChangeListener(e.updateSettings),[4,e.updateSettings()];case 1:return t.sent(),[2]}}))}))()}},{key:"shutDown",value:function(){this._emitter.off(a.a.FeatureFlags),this._managedStorage.removeChangeListener(this.updateSettings)}}])&&b(t.prototype,n),r&&b(t,r),o}(s.a);E=Object(r.c)([Object(i.a)(),Object(r.f)(0,Object(o.a)(p.a)),Object(r.f)(1,Object(o.a)(u.a)),Object(r.f)(2,Object(o.a)(c.a)),Object(r.f)(3,Object(o.a)(l.a)),Object(r.f)(4,Object(o.a)(d.a)),Object(r.f)(5,Object(o.a)(f.a)),Object(r.f)(6,Object(o.a)(h.a)),Object(r.e)("design:paramtypes",[Object,Object,Object,Object,d.a,f.a,h.a])],E)},function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return p}));var r=n(2),i=n(8),o=n(178),a=n(89),s=n(104),u=n(11),c=n(7),l=n(326),d=n(233),f=n(495);let h=class{constructor(e,t,n,r){this._orchestratorSettings=e,this._proofingStore=t,this._descriptorManager=n,this._unSignedInEditorFeature=r}async buildValidRequest(e){const t=await this._proofingStore.read(i.a.OverriddenCritiqueTypeOptions),n=await this._proofingStore.read(i.a.AppId),r=await this.unsignedInEditorFeatureEnabled(),o=await this._descriptorManager.buildDescriptors();return p(e,n,t,this._orchestratorSettings.maxContentLengthInChars,r,o)}async unsignedInEditorFeatureEnabled(){return this._unSignedInEditorFeature.emitAndEvaluateAsync({eventId:o.b.PageContext,sender:o.d.PageContext})}};async function p(e,t,n,r,i,o){let a=0;const u={appId:t,languageUXId:e.data.uxLanguage,content:e.data.tiles.map((e=>{const t=e.data.length<r?function(e,t,n=s.e.Sentence){return 0===e.length?[]:[{text:e,languageId:t,textUnit:n}]}(e.data,e.proofingLanguages[0],e.textUnit):[];return t.length&&(a+=e.data.length),{tileId:(n=e.header,i=e.proofingLanguages[0],Object(f.a)(JSON.stringify(n),i)),revisionId:"1",tileElements:t};var n,i})).filter((e=>e.tileElements&&e.tileElements.length>0)),sessionId:"",descriptors:o,overriddenCritiqueTypeOptions:n.length>0?n:void 0};if(i&&(u.runOnProfileId="50000000-0000-0000-0000-000000000000"),a<r&&u.content&&u.content.length>0)return u}h=Object(r.c)([Object(u.a)(),Object(r.f)(0,Object(c.a)(l.a)),Object(r.f)(1,Object(c.a)(a.a)),Object(r.f)(2,Object(c.a)(d.a)),Object(r.f)(3,Object(c.a)(o.a))],h)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));const r=e=>{const t=[];for(const n of e){const e={tileId:n.header,supportedActions:0,suggestions:[],start:0,length:0,priority:0,languageId:""};t.push(e)}return t},i=e=>!!e.supportedActions&&!!(16&e.supportedActions)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IAutoCorrectionBroker")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IParagraphNodesEventEmitter")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IWordCount")},,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return A})),n.d(t,"a",(function(){return j}));var r=n(2),i=n(55),o=n(53),a=n(139),s=n(534),u=n(85),c=n(11),l=n(7),d=n(27),f=n(34);function h(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function p(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function g(e,t){return m.apply(this,arguments)}function m(){var e;return e=function(e,t){return p(this,(function(n){return[2,chrome.scripting.executeScript({target:{tabId:e},files:[t]})]}))},m=function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){h(o,r,i,a,s,"next",e)}function s(e){h(o,r,i,a,s,"throw",e)}a(void 0)}))},m.apply(this,arguments)}var y,b=n(58),v=n(16),w="*://";function S(e){var t=e,n=!1;e.startsWith(w)&&(t=e.replace(w,"https://"),n=!0);var r=new URL(t),i=n?w:"".concat(r.protocol,"//"),o=decodeURIComponent(r.hostname);if(o.includes("*")&&"*"!==(o=o.replace(/\.\*/gi,"*"))&&(!o.startsWith("*.")||o.indexOf("*",1)>-1))throw new Error("Invalid hostname: a wildcard (*) must specify the entire hostname or a subdomain.");return"".concat(i).concat(o).concat(r.pathname).concat(r.search).concat(r.hash)}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function T(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function O(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){T(o,r,i,a,s,"next",e)}function s(e){T(o,r,i,a,s,"throw",e)}a(void 0)}))}}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e){return function(e){if(Array.isArray(e))return _(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function k(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var A=["https://docs.google.com/*","https://*.officeapps.live.com/*","https://marketingsites-ppe.microsoft.com/en-us/microsoft-365/devtest/*","https://marketingsites-ppe.microsoft.com/en-us/microsoft-365/microsoft-editor/grammar-checker*","https://marketingsites-prod.microsoft.com/en-us/microsoft-365/microsoft-editor/grammar-checker*","https://www.microsoft.com/en-us/microsoft-365/microsoft-editor/grammar-checker","https://res-sdf.cdn.office.net/editorlandingpage/*","https://res.cdn.office.net/editorlandingpage/*","https://contacts.google.com/*","https://clients6.google.com/*"],P=["config.js","content.js"],N=["./editor/config.js","./editor/content.js"],j=y=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_logger",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_systemPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_pageParserStore",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"_emitter",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"contentScriptId",{enumerable:!0,configurable:!0,writable:!0,value:"ContentScript"})}var t,n,r;return t=e,n=[{key:"registerContentScripts",value:function(){var e=this;return O((function(){var t,n,r;return I(this,(function(i){switch(i.label){case 0:return t={id:e.contentScriptId,js:e.getScripts(),persistAcrossSessions:!0,matches:["<all_urls>"],runAt:"document_end",allFrames:!0,excludeMatches:A},[4,chrome.scripting.getRegisteredContentScripts()];case 1:if(1===(n=i.sent()).length&&n[0].id===e.contentScriptId)return[3,5];n.length>0&&chrome.scripting.unregisterContentScripts(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,chrome.scripting.registerContentScripts([t])];case 3:return i.sent(),[3,5];case 4:return r=i.sent(),e._logger.error(508355592,"Content script registration failed: ".concat(r)),[3,5];case 5:return[4,e.updateExcludeMatches()];case 6:return i.sent(),e._emitter.on(a.a.UserExcludedUrls,O((function(){return I(this,(function(t){switch(t.label){case 0:return[4,e.updateExcludeMatches()];case 1:return t.sent(),[2]}}))}))),e._emitter.on(v.a.DisabledWebSites,O((function(){return I(this,(function(t){switch(t.label){case 0:return[4,e.updateExcludeMatches()];case 1:return t.sent(),[2]}}))}))),[2]}}))}))()}},{key:"updateExcludeMatches",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this;return O((function(){var n,r;return I(this,(function(i){switch(i.label){case 0:switch(n=[],e){case 0:return[3,1];case 1:return[3,3]}return[3,5];case 1:return[4,t.addExcludedUrls(n,t._pageParserStore,a.a.UserExcludedUrls,!0)];case 2:i.sent(),i.label=3;case 3:return[4,t.addExcludedUrls(n,t._systemPersistedStore,v.a.DisabledWebSites,!1)];case 4:i.sent(),i.label=5;case 5:return[4,t.addExcludedUrls(n,t._systemPersistedStore,v.a.WebsitesWithNativeIntegration,!1)];case 6:return i.sent(),[3,7];case 7:return i.trys.push([7,9,,12]),[4,chrome.scripting.updateContentScripts([{id:t.contentScriptId,excludeMatches:E(A).concat(E(n))}])];case 8:return i.sent(),[3,12];case 9:return r=i.sent(),t._logger.error(508355591,"Exclude matches update failed: ".concat(r),{safeModeLevel:e}),e<2?[4,t.updateExcludeMatches(e+1)]:[3,11];case 10:i.sent(),i.label=11;case 11:return[3,12];case 12:return[2]}}))}))()}},{key:"addExcludedUrls",value:function(e,t,n,r){var i=this;return O((function(){var o,a,s,u,c,l,d,f,h;return I(this,(function(p){switch(p.label){case 0:return[4,t.read(n)];case 1:o=p.sent(),a=!0,s=!1,u=void 0;try{for(c=(null!=o?o:[])[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){d=l.value;try{(f=S(d))&&e.push(f)}catch(e){h=r?"<user-defined>":d,i._logger.error(508130060,"Error sanitizing url for exclude matches: ".concat(h,"; error: ").concat(e))}}}catch(e){s=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw u}}return[2]}}))}))()}},{key:"getScripts",value:function(){var e=N;try{var t=chrome.runtime.getManifest().background;t&&!t.service_worker.includes("editor/")&&(e=P)}catch(e){}return e}},{key:"injectContentScriptsIntoAllTabs",value:function(){var e=this;return O((function(){var t,n,r,o,a,s,u,c,l,h,p,m;return I(this,(function(b){switch(b.label){case 0:b.trys.push([0,9,,10]),a=chrome.runtime.getManifest(),s=!0,u=!1,c=void 0,b.label=1;case 1:b.trys.push([1,6,7,8]),l=function(){var t,i,a,s,u,c,l;return I(this,(function(d){switch(d.label){case 0:return t=p.value,i=null!==(n=t.js)&&void 0!==n?n:[],[4,Promise.all([y.getBrowserTabIdsMatching(null!==(r=t.matches)&&void 0!==r?r:[]),y.getBrowserTabIdsMatching(null!==(o=t.exclude_matches)&&void 0!==o?o:[])])];case 1:return a=d.sent(),s=a[0],u=a[1],c=new Set(s),u.forEach((function(e){return c.delete(e)})),l=function(){var t=chrome.runtime.lastError;t&&e._logger.debug(509646618,"Init Injection Error: ".concat(JSON.stringify(t)))},c.forEach((function(e){return i.forEach((t=O((function(t){return I(this,(function(n){return[2,g(e,t).catch(l)]}))})),function(e){return t.apply(this,arguments)}));var t})),[2]}}))},h=(null!==(t=a.content_scripts)&&void 0!==t?t:[])[Symbol.iterator](),b.label=2;case 2:return(s=(p=h.next()).done)?[3,5]:[5,k(l())];case 3:b.sent(),b.label=4;case 4:return s=!0,[3,2];case 5:return[3,8];case 6:return m=b.sent(),u=!0,c=m,[3,8];case 7:try{s||null==h.return||h.return()}finally{if(u)throw c}return[7];case 8:return[3,10];case 9:return b.sent(),e._logger.logEvent(509646617,f.a.ContentScriptInjectionError,i.a.Error,"Error in the content script injection process on extension install.",d.a.SamplingPolicy.CriticalBusinessImpact),[3,10];case 10:return[2]}}))}))()}}],r=[{key:"getBrowserTabIdsMatching",value:function(e){return O((function(){return I(this,(function(t){switch(t.label){case 0:return 0===e.length?[3,2]:[4,chrome.tabs.query({url:e})];case 1:return[2,t.sent().map((function(e){return e.id})).filter((function(e){return void 0!==e}))];case 2:return[2,[]]}}))}))()}}],n&&C(t.prototype,n),r&&C(t,r),e}();j=y=Object(r.c)([Object(c.a)(),Object(r.f)(0,Object(l.a)(o.a)),Object(r.f)(1,Object(l.a)(b.a)),Object(r.f)(2,Object(l.a)(s.a)),Object(r.f)(3,Object(l.a)(u.a)),Object(r.e)("design:paramtypes",[Object,Object,Object,Object])],j)},function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var r=n(2),i=n(8),o=n(89),a=n(52),s=n(11),u=n(7);let c=class{constructor(e,t){this._proofingStore=e,this._hostSettings=t}async buildDescriptors(){var e;const t="FlightIds";let n;try{n=JSON.parse(await this._proofingStore.read(i.a.Descriptors))}catch(e){n=JSON.parse(this._proofingStore.getDefaultValue(i.a.Descriptors))}let r="";if(this._hostSettings.flightsToTrack&&this._hostSettings.flightsToTrack.length>0&&(r=`${r}${this._hostSettings.flightsToTrack.join(";")}`),""!==r){const e=n.find((e=>e.name===t));e?e.value=`${e.value};${r}`:n.push({name:t,value:r})}return(null===(e=this._hostSettings.hostMetadata)||void 0===e?void 0:e.releaseAudienceGroup)&&n.push({name:"Audience",value:l(this._hostSettings.hostMetadata.releaseAudienceGroup)}),n}};function l(e){switch(e){case"Local":case"Staging":case"Dogfood":case"DogFood":return"DogFood";case"Microsoft":return"Microsoft";default:return"Production"}}c=Object(r.c)([Object(s.a)(),Object(r.f)(0,Object(u.a)(o.a)),Object(r.f)(1,Object(u.a)(a.a))],c);var d=n(233),f=n(137),h=n(570),p=n(217),g=n(571),m=n(413),y=n(80),b=n(274),v=n(30),w=n(61),S=n(53),_=n(572),T=n(27),O=n(104),C=n(98),E=n(423);let I=class{constructor(e,t,n,r,i){this._hostEmitter=e,this._proofingStore=t,this._descriptorManager=n,this._logger=r,this._paneOpenState=i}async process(e){const t=await this.getRequest(e);return!!t&&(this.emitInstrumentationRequest(t,e),this.logActivity(t),!0)}async getRequest(e){if(e.critique.traceId&&e.critique.typeId&&e.critique.textInContext)return{appId:await this._proofingStore.read(i.a.AppId),descriptors:await this._descriptorManager.buildDescriptors(),languageId:p.a.getDefaultLanguageCode(await this._proofingStore.read(i.a.ProofingLanguages)),traceId:e.critique.traceId,critiquePriority:e.critique.priority,critiqueTypeId:e.critique.typeId,eventId:e.eventId,flaggedText:e.critique.textInContext,suggestions:e.critique.suggestions.map((e=>e.text)),suggestionText:this.getSuggestionText(e),metadata:this.getMetadata(e),substrateEventCustomFields:e.customProperties}}getSuggestionText(e){const t=e.critique.suggestions.map((e=>e.text));let n=t[e.eventId-4];return e.eventId!==O.b.Autoreplace&&e.eventId!==O.b.AutoreplaceUndo||(n=t[0]),e.eventId>=O.b.ChangeAllSugg0&&e.eventId<=O.b.ChangeAllSugg2&&(n=t[e.eventId-8]),n}getMetadata(e){var t,n;const r=null!==(n=null===(t=e.critique.metadata)||void 0===t?void 0:t.slice())&&void 0!==n?n:[];this._paneOpenState&&r.push({name:g.a.IsPaneOpen,value:String(this._paneOpenState.isPaneOpen)},{name:g.a.IsPaneOpenedInSession,value:String(this._paneOpenState.isPaneOpenedInSession)});const o=this._proofingStore.getCachedEntry(i.a.ProofingLanguages).storeEntryValue;return r.push({name:m.a.NumProofingLanguages,value:String(o.length)}),r}emitInstrumentationRequest(e,t){e.critiqueTypeId===y.b.TopicSuggestion||Object(b.b)(t.critique)||this._hostEmitter.emit(v.a.instrumentationRequestV1,{address:void 0,message:e})}logActivity(e){const t=this._logger.getNewActivity(E.b.InstrumentationCall,T.a.SamplingPolicy.Measure),n=e.substrateEventCustomFields&&"true"===e.substrateEventCustomFields.isPersonalized||!1;t&&(t.dataFields.push(...Object(w.b)(["EventID",e.eventId],["CritiquePriority",e.critiquePriority],["CritiqueTypeId",e.critiqueTypeId],["IsPersonalizedEvent",n])),t.success=!0,t.endNow())}};I=Object(r.c)([Object(s.a)(),Object(r.f)(0,Object(u.a)(v.b)),Object(r.f)(1,Object(u.a)(o.a)),Object(r.f)(2,Object(u.a)(d.a)),Object(r.f)(3,Object(u.a)(S.a)),Object(r.f)(4,Object(C.a)()),Object(r.f)(4,Object(u.a)(_.a))],I);class k{constructor(){this.imports=[]}get uniqueId(){return Object(f.a)(507918406)}configureRootServices(e){e.bind(h.a).to(I),e.bind(d.a).to(c)}}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2),i=n(8),o=n(74),a=n(89),s=n(349),u=n(85),c=n(11),l=n(7),d=n(98);let f=class{constructor(e,t,n,r){this._featureFlagsReader=e,this._proofingPersistedStore=t,this._settingsEmitter=n,this._pageContextReceiver=r,this._isURLUserDisabled=!1,this._isInitialized=!1,this._isAiInsertToggleEnabled=!0,this._updateAiInsertToggleEnabledValue=e=>{this._isAiInsertToggleEnabled=h(e)},this.onContextChanged=e=>{if(!e.runtimeOnOffState)return;const t=`${window.location.protocol}//${window.location.hostname}`;this._isURLUserDisabled=e.runtimeOnOffState.userExcludedUrls.includes(t)}}async initialize(){var e;this._isInitialized||(null===(e=this._pageContextReceiver)||void 0===e||e.on("contextChangedEvent",this.onContextChanged),this._settingsEmitter.on(i.a.EnableCopilotInsert,this._updateAiInsertToggleEnabledValue),this._isAiInsertToggleEnabled=h(await this._proofingPersistedStore.read(i.a.EnableCopilotInsert))),this._isInitialized=!0}shutDown(){var e;this._isInitialized&&(null===(e=this._pageContextReceiver)||void 0===e||e.off("contextChangedEvent",this.onContextChanged),this._settingsEmitter.off(i.a.EnableCopilotInsert)),this._isInitialized=!1}check(){return this._featureFlagsReader.flags.enableAiInsert&&!this._isURLUserDisabled&&this._isAiInsertToggleEnabled}};f=Object(r.c)([Object(c.a)(),Object(r.f)(0,Object(l.a)(o.a)),Object(r.f)(1,Object(l.a)(a.a)),Object(r.f)(2,Object(l.a)(u.a)),Object(r.f)(3,Object(l.a)(s.a)),Object(r.f)(3,Object(d.a)())],f);const h=e=>"boolean"==typeof e&&e||"true"===JSON.parse(e).value},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(35),i=n(794),o=n.n(i),a=n(795),s=n.n(a),u=n(242),c=n(114),l=n(736);function d(e){return e&&"function"==typeof e.pipe}function f(e){return new Promise((function(t){e.on("close",t),e.on("end",t),e.on("error",t)}))}var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.c)(t,e),t.prototype.prepareRequest=function(e){return Promise.resolve({})},t.prototype.processRequest=function(e){return Promise.resolve()},t.prototype.fetch=function(e,t){return fetch(e,t)},t}(function(){function e(){}return e.prototype.sendRequest=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,a,h,p,g,m,y,b,v,w,S,_,T,O,C,E,I,k,A,P,N,j,R,x,D,M,L,B;return Object(r.d)(this,(function(F){switch(F.label){case 0:if(!e&&"object"!=typeof e)throw new Error("'httpRequest' (WebResource) cannot be null or undefined and must be of type object.");if(t=new o.a,e.abortSignal){if(e.abortSignal.aborted)throw new c.a("The request was aborted",c.a.REQUEST_ABORTED_ERROR,void 0,e);n=function(e){"abort"===e.type&&t.abort()},e.abortSignal.addEventListener("abort",n)}if(e.timeout&&setTimeout((function(){t.abort()}),e.timeout),e.formData){for(i=e.formData,a=new s.a,h=function(e,t){"function"==typeof t&&(t=t()),t&&t.hasOwnProperty("value")&&t.hasOwnProperty("options")?a.append(e,t.value,t.options):a.append(e,t)},p=0,g=Object.keys(i);p<g.length;p++)if(m=g[p],y=i[m],Array.isArray(y))for(b=0;b<y.length;b++)h(m,y[b]);else h(m,y);e.body=a,e.formData=void 0,(v=e.headers.get("Content-Type"))&&-1!==v.indexOf("multipart/form-data")&&("function"==typeof a.getBoundary?e.headers.set("Content-Type","multipart/form-data; boundary="+a.getBoundary()):e.headers.remove("Content-Type"))}return w=e.body?"function"==typeof e.body?e.body():e.body:void 0,e.onUploadProgress&&e.body&&(S=0,_=new l.Transform({transform:function(t,n,r){S+=t.length,e.onUploadProgress({loadedBytes:S}),r(void 0,t)}}),d(w)?w.pipe(_):_.end(w),w=_),[4,this.prepareRequest(e)];case 1:T=F.sent(),O=Object(r.a)({body:w,headers:e.headers.rawHeaders(),method:e.method,signal:t.signal,redirect:"manual"},T),F.label=2;case 2:return F.trys.push([2,8,9,10]),[4,this.fetch(e.url,O)];case 3:return E=F.sent(),I=function(e){var t=new u.a;return e.forEach((function(e,n){t.set(n,e)})),t}(E.headers),k={headers:I,request:e,status:E.status,readableStreamBody:e.streamResponseBody?E.body:void 0},e.streamResponseBody?[3,5]:[4,E.text()];case 4:return A=F.sent(),[3,6];case 5:A=void 0,F.label=6;case 6:return k.bodyAsText=A,k.redirected=E.redirected,k.url=E.url,C=k,(P=e.onDownloadProgress)&&(d(N=E.body||void 0)?(j=0,R=new l.Transform({transform:function(e,t,n){j+=e.length,P({loadedBytes:j}),n(void 0,e)}}),N.pipe(R),C.readableStreamBody=R):(x=parseInt(I.get("Content-Length"))||void 0)&&P({loadedBytes:x})),[4,this.processRequest(C)];case 7:return F.sent(),[2,C];case 8:if(D=F.sent(),"ENOTFOUND"===(M=D).code)throw new c.a(M.message,c.a.REQUEST_SEND_ERROR,void 0,e);if("aborted"===M.type)throw new c.a("The request was aborted",c.a.REQUEST_ABORTED_ERROR,void 0,e);throw M;case 9:return e.abortSignal&&n&&(L=Promise.resolve(),d(w)&&(L=f(w)),B=Promise.resolve(),d(null==C?void 0:C.readableStreamBody)&&(B=f(C.readableStreamBody)),Promise.all([L,B]).then((function(){var t;null===(t=e.abortSignal)||void 0===t||t.removeEventListener("abort",n)})).catch((function(e){}))),[7];case 10:return[2]}}))}))},e}())},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(){this.mutex=Promise.resolve()}lock(){let e=e=>{};return this.mutex=this.mutex.then((()=>new Promise(e))),new Promise((t=>{e=t}))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IAggregateLogger")},function(e,t,n){"use strict";(function(t){void 0===t||!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports={nextTick:function(e,n,r,i){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var o,a,s=arguments.length;switch(s){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick((function(){e.call(null,n)}));case 3:return t.nextTick((function(){e.call(null,n,r)}));case 4:return t.nextTick((function(){e.call(null,n,r,i)}));default:for(o=new Array(s-1),a=0;a<o.length;)o[a++]=arguments[a];return t.nextTick((function(){e.apply(null,o)}))}}}:e.exports=t}).call(this,n(123))},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2),i=n(656),o=n(11),a=n(7),s=n(8),u=n(74),c=n(30),l=n(53),d=n(89);let f=class{constructor(e,t,n,r,i){this._hostEmitter=e,this._featureFlagsReader=t,this._logger=n,this._proofingStore=r,this._synonymService=i,this.requestSynonymsListener=async e=>{if(!this._featureFlagsReader.flags.enableSynonyms)return;if(!e.message)return void this._logger.error(509620564,"Corrupted message while requesting synonyms");const t=e.message.lookupWords,n=e.message.target,r=e.address,i=await this.getSynonyms(t);this._hostEmitter.emit(c.a.receivedSynonyms,{address:r,message:{word:t.word.trim(),target:n,synonyms:i||[]}})},this.getSynonyms=async e=>{const t=e.word.trim(),n=this._proofingStore.getCachedEntry(s.a.ProofingLanguages).storeEntryValue.some((e=>e.startsWith("en-")));if(t&&(1===t.split(" ").length||!n))try{const n={appId:await this._proofingStore.read(s.a.AppId),languageId:"en-US",lookupWords:[{word:t,postContextText:e.postContextText,preContextText:e.preContextText}],mode:2},r=await this._synonymService.postCheck(n);if(!r.lookupResults||0===r.lookupResults.length)return this._logger.error(509364057,"Corrupted response for synonyms"),[];return r.lookupResults[0].shortlist||[]}catch(e){return void this._logger.error(509364056,"Synonym service call failed.")}}}async initialize(){this._hostEmitter.on(c.a.requestSynonyms,this.requestSynonymsListener)}shutDown(){this._hostEmitter.off(c.a.requestSynonyms)}};f=Object(r.c)([Object(o.a)(),Object(r.f)(0,Object(a.a)(c.b)),Object(r.f)(1,Object(a.a)(u.a)),Object(r.f)(2,Object(a.a)(l.a)),Object(r.f)(3,Object(a.a)(d.a)),Object(r.f)(4,Object(a.a)(i.a))],f)},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2),i=n(11),o=n(7),a=n(454),s=n(30),u=n(132),c=n(55),l=n(27),d=n(53);let f=class{constructor(e,t){this._hostEmitter=e,this._logger=t,this._remoteObjects={},this.onTelemetryEvent=async e=>{try{if(e.message){const t=e.message;t.tagID&&t.level&&t.message&&this._logger.logEvent(t.tagID,t.eventName,t.level,t.message,t.sampling,t.data,t.experimentation)}}catch(e){this._logger.logEvent(571269910,u.a.AriaError,c.a.Error,"The call to Aria failed",l.a.SamplingPolicy.CriticalBusinessImpact)}return!1},this.onNewActivityTelemetryEvent=e=>{try{if(e.address&&e.message){const t=e.message;this._remoteObjects[e.address]={activity:this._logger.getNewActivity(t.eventName,t.sampling,t.experimentation),startTime:Date.now()}}}catch(e){this._logger.logEvent(571269911,u.a.GetNewActivityError,c.a.Error,"The call to getNewActivity failed",l.a.SamplingPolicy.CriticalBusinessImpact)}return!1},this.onAddDataFieldTelemetryEvent=async e=>this.processEnvelope(e,((e,t)=>{e.dataFields.push(t)})),this.onSetResultTelemetryEvent=async e=>this.processEnvelope(e,((e,t)=>{e.setResult(t.resultCode,t.resultType,t.resultTag)})),this.onSetSuccessTelemetryEvent=e=>this.processEnvelope(e,((e,t)=>{e.success=t})),this.onEndNowTelemetryEvent=e=>this.processEnvelope(e,((t,n)=>new Promise((e=>{t.endNow(),e()})).then((()=>{delete this._remoteObjects[e.address]})).catch((()=>{delete this._remoteObjects[e.address]})))),this.processEnvelope=(e,t)=>{var n;try{if(e.address){const r=e.message,i=null===(n=this._remoteObjects[e.address])||void 0===n?void 0:n.activity;i&&t(i,r)}}catch(e){this._logger.logEvent(571269912,u.a.EnvelopeFormatError,c.a.Error,"The call to processEnvelope failed",l.a.SamplingPolicy.CriticalBusinessImpact)}return!1},this.cleanupIntervalId=setInterval((()=>{this.cleanupActivities()}),6e5)}async initialize(){this._hostEmitter.on(s.a.telemetryEvent,this.onTelemetryEvent),this._hostEmitter.on(s.a.newActivityTelemetryEvent,this.onNewActivityTelemetryEvent),this._hostEmitter.on(s.a.activityAddDataFieldTelemetryEvent,this.onAddDataFieldTelemetryEvent),this._hostEmitter.on(s.a.activitySetResultTelemetryEvent,this.onSetResultTelemetryEvent),this._hostEmitter.on(s.a.activitySetSuccessTelemetryEvent,this.onSetSuccessTelemetryEvent),this._hostEmitter.on(s.a.activityEndNowTelemetryEvent,this.onEndNowTelemetryEvent)}shutDown(){this.cleanupIntervalId&&(clearInterval(this.cleanupIntervalId),this.cleanupIntervalId=null)}cleanupActivities(){Object.keys(this._remoteObjects).forEach((e=>{const t=this._remoteObjects[e];t&&a.a()-t.startTime>36e8&&delete this._remoteObjects[e]}))}};f=Object(r.c)([Object(i.a)(),Object(r.f)(0,Object(o.a)(s.b)),Object(r.f)(1,Object(o.a)(d.a))],f)},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(2),i=n(30),o=n(52),a=n(53),s=n(195),u=n(535),c=n(196),l=n(11),d=n(7),f=n(98);let h=class{constructor(e,t,n,r,o,a){this._hostSettings=e,this._roamingDictionaryFeature=t,this._roamingDictionaryBrokerCommunicator=n,this._logger=r,this._proofingEmitter=o,this._roamingDictionaryEmitter=a,this._enableRoamingDictionary=()=>{if(!this._hostSettings.enableV2RoamingDictionary||!this._hostSettings.enableRoamingService)return;if(this._roamingDictionaryFeature.isReady())return void this._sendRoamingDictionaryState(!0);const e=this._sendDictionaryEnableEvent();this._sendRoamingDictionaryState(e)},this._sendDictionaryEnableEvent=()=>this._roamingDictionaryFeature.emitAndEvaluate({eventId:c.b.ClientInitialized,sender:c.c.WordDictionaryInit}),this._setRoamingDictionaryState=e=>{this._sendRoamingDictionaryState(!!e.data)},this._sendRoamingDictionaryState=e=>{this._roamingDictionaryBrokerCommunicator.emit(i.a.setRoamingDictionaryState,{address:void 0,message:e})},this._initCurrentSessionDictionary=()=>{const e=this._roamingDictionaryFeature.getRoamingDictionary();this._roamingDictionaryFeature.isReady()&&e?this._updateCurrentSessionDictionary(e.getWordList()):this._logger.error(555865416,"Dictionary is not ready to be initialized")},this._addWordToRoamingDictionary=e=>{if(!this._hostSettings.enableV2RoamingDictionary||!this._hostSettings.enableRoamingService||!e.message)return;if(this._logger.info(555865417,"Add word to dictionary is clicked"),!this._roamingDictionaryFeature.isReady())return void this._logger.error(555865418,"Dictionary is not ready to add words");const t=this._roamingDictionaryFeature.getRoamingDictionary(),n=null==t?void 0:t.addWord(e.message);this._updateCurrentSessionDictionary([e.message]),n&&this._roamingDictionaryEmitter?this._roamingDictionaryEmitter.emit("writeCurrentDictionaryToService"):n||this._logger.error(555865419,"Word was not added to dictionary")},this._updateCurrentSessionDictionary=e=>{this._roamingDictionaryBrokerCommunicator.emit(i.a.updateCurrentSessionDictionary,{address:void 0,message:e})}}async initialize(){this._roamingDictionaryBrokerCommunicator.on(i.a.addWordToDictionaryLocally,this._addWordToRoamingDictionary),this._roamingDictionaryBrokerCommunicator.on(i.a.enableRoamingDictionary,this._enableRoamingDictionary),this._proofingEmitter.on("proofingLanguageChanged",this._sendDictionaryEnableEvent),this._roamingDictionaryEmitter&&(this._roamingDictionaryEmitter.on("initCurrentSessionDictionary",this._initCurrentSessionDictionary),this._roamingDictionaryEmitter.on("setRoamingDictionaryState",this._setRoamingDictionaryState)),this._enableRoamingDictionary()}shutDown(){}};h=Object(r.c)([Object(l.a)(),Object(r.f)(0,Object(d.a)(o.a)),Object(r.f)(1,Object(d.a)(c.a)),Object(r.f)(2,Object(d.a)(i.b)),Object(r.f)(3,Object(d.a)(a.a)),Object(r.f)(4,Object(d.a)(s.a)),Object(r.f)(5,Object(f.a)()),Object(r.f)(5,Object(d.a)(u.a))],h)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2),i=n(536),o=n(30),a=n(11),s=n(7);let u=class{constructor(e,t){this._hostEmitter=e,this._augLoopAuthenticationEmitter=t,this._augLoopIsReady=!1,this._setAugLoopIsReady=e=>{this._augLoopIsReady=!0===e.data,this._sendAugLoopState()},this._sendAugLoopState=()=>{this._hostEmitter.emit(o.a.setAugLoopState,{address:void 0,message:this._augLoopIsReady})}}async initialize(){this._augLoopAuthenticationEmitter.on(o.a.setAugLoopState,this._setAugLoopIsReady),this._hostEmitter.on(o.a.getAugLoopState,this._sendAugLoopState)}shutDown(){}};u=Object(r.c)([Object(a.a)(),Object(r.f)(0,Object(s.a)(o.b)),Object(r.f)(1,Object(s.a)(i.a))],u)},,,,,,,,,,,,,,function(e,t,n){"use strict";var r,i;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e.Int="nleditor.osi.office-int.net",e.Staging="nleditor.osi.officeppe.net",e.Lab="wus-001.nleditor.osi.officeppe.net",e.Prod="nleditor.osi.office.net",e.GCC="nleditor.gcc.osi.office365.us",e.GCCHigh="nleditor.osi.office365.us",e.USDoD="nleditor.osi.apps.mil",e.USNat="nleditor.osi.eaglex.ic.gov",e.USSec="nleditor.osi.microsoft.scloud"}(r||(r={})),function(e){e.Int="editor-thesaurus.northeurope.cloudapp.azure.com:9443",e.Staging="editor-edog-thesaurus.trafficmanager.net:9443",e.Lab="editor-edog-thesaurus.trafficmanager.net:9443",e.Prod="editor-prod-thesaurus.trafficmanager.net:9443",e.GCCModerate="editor-gccm-thesaurus.usgovtrafficmanager.net:9443",e.GCCHigh="editor-trailblazer-thesaurus.usgovtrafficmanager.net:9443",e.USDoD="editor-pathfinder-thesaurus.usgovtrafficmanager.net:9443",e.USNat="editor-usnat-thesaurus.trafficmanager.eaglex.ic.gov:9443",e.USSec="editor-ussec-thesaurus.trafficmanager.microsoft.scloud:9443"}(i||(i={}))},function(e,t,n){"use strict";function r(e){if(this._capacity=o(e),this._length=0,this._front=0,i(e)){for(var t=e.length,n=0;n<t;++n)this[n]=e[n];this._length=t}}r.prototype.toArray=function(){for(var e=this._length,t=new Array(e),n=this._front,r=this._capacity,i=0;i<e;++i)t[i]=this[n+i&r-1];return t},r.prototype.push=function(e){var t=arguments.length,n=this._length;if(t>1){var r=this._capacity;if(n+t>r){for(var i=0;i<t;++i){this._checkCapacity(n+1),this[o=this._front+n&this._capacity-1]=arguments[i],n++,this._length=n}return n}for(var o=this._front,i=0;i<t;++i)this[o+n&r-1]=arguments[i],o++;return this._length=n+t,n+t}return 0===t?n:(this._checkCapacity(n+1),this[i=this._front+n&this._capacity-1]=e,this._length=n+1,n+1)},r.prototype.pop=function(){var e=this._length;if(0!==e){var t=this._front+e-1&this._capacity-1,n=this[t];return this[t]=void 0,this._length=e-1,n}},r.prototype.shift=function(){var e=this._length;if(0!==e){var t=this._front,n=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length=e-1,n}},r.prototype.unshift=function(e){var t=this._length,n=arguments.length;if(n>1){if(t+n>(i=this._capacity)){for(var r=n-1;r>=0;r--){this._checkCapacity(t+1);var i=this._capacity;this[a=(this._front-1&i-1^i)-i]=arguments[r],t++,this._length=t,this._front=a}return t}var o=this._front;for(r=n-1;r>=0;r--){var a;this[a=(o-1&i-1^i)-i]=arguments[r],o=a}return this._front=o,this._length=t+n,t+n}if(0===n)return t;this._checkCapacity(t+1);i=this._capacity;return this[r=(this._front-1&i-1^i)-i]=e,this._length=t+1,this._front=r,t+1},r.prototype.peekBack=function(){var e=this._length;if(0!==e)return this[this._front+e-1&this._capacity-1]},r.prototype.peekFront=function(){if(0!==this._length)return this[this._front]},r.prototype.get=function(e){var t=e;if(t===(0|t)){var n=this._length;if(t<0&&(t+=n),!(t<0||t>=n))return this[this._front+t&this._capacity-1]}},r.prototype.isEmpty=function(){return 0===this._length},r.prototype.clear=function(){for(var e=this._length,t=this._front,n=this._capacity,r=0;r<e;++r)this[t+r&n-1]=void 0;this._length=0,this._front=0},r.prototype.toString=function(){return this.toArray().toString()},r.prototype.valueOf=r.prototype.toString,r.prototype.removeFront=r.prototype.shift,r.prototype.removeBack=r.prototype.pop,r.prototype.insertFront=r.prototype.unshift,r.prototype.insertBack=r.prototype.push,r.prototype.enqueue=r.prototype.push,r.prototype.dequeue=r.prototype.shift,r.prototype.toJSON=r.prototype.toArray,Object.defineProperty(r.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),r.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(o(1.5*this._capacity+16))},r.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var n=this._front,r=this._length;n+r>t&&function(e,t,n,r,i){for(var o=0;o<i;++o)n[o+r]=e[o+t],e[o+t]=void 0}(this,0,this,t,n+r&t-1)};var i=Array.isArray;function o(e){if("number"!=typeof e){if(!i(e))return 16;e=e.length}return t=Math.min(Math.max(16,e),1073741824),t>>>=0,t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,1+(t|=t>>16);var t}e.exports=r},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return rn})),n.d(t,"e",(function(){return on})),n.d(t,"b",(function(){return an})),n.d(t,"d",(function(){return sn})),n.d(t,"c",(function(){return un}));var r={};function i(e){return e.toLowerCase()}n.r(r),n.d(r,"CommonAppIdProperty",(function(){return it})),n.d(r,"CommonResponseStatusProperty",(function(){return ot})),n.d(r,"CommonRequestIdProperty",(function(){return at})),n.d(r,"TileContent",(function(){return st})),n.d(r,"CommonLanguageIdProperty",(function(){return ut})),n.d(r,"CommonTextUnitProperty",(function(){return ct})),n.d(r,"TopologyNode",(function(){return lt})),n.d(r,"CommonDescriptorsProperty",(function(){return dt})),n.d(r,"Descriptor",(function(){return ft})),n.d(r,"CommonLanguageUXIdProperty",(function(){return ht})),n.d(r,"CommonRunOnProfileIdProperty",(function(){return pt})),n.d(r,"CommonOverriddenCritiqueTypeOptions",(function(){return gt})),n.d(r,"Suggestion",(function(){return mt})),n.d(r,"CommonCritique",(function(){return yt})),n.d(r,"Metadatum",(function(){return bt})),n.d(r,"CommonTileIdProperty",(function(){return vt})),n.d(r,"CommonRevisionIdProperty",(function(){return wt})),n.d(r,"SupportedActions",(function(){return St})),n.d(r,"CommonAppVersionProperty",(function(){return _t})),n.d(r,"CritiqueCategoryInfo",(function(){return Tt})),n.d(r,"CritiqueTypeInfo",(function(){return Ot})),n.d(r,"UserIdentity",(function(){return Ct})),n.d(r,"BrowserExtensionRequestV1",(function(){return Et})),n.d(r,"TileCheckRequestV1",(function(){return It})),n.d(r,"ConfigRequestV2",(function(){return kt})),n.d(r,"LanguageInfoRequestV1",(function(){return At})),n.d(r,"InstrumentationRequestV1",(function(){return Pt})),n.d(r,"BrowserExtensionResponseV1",(function(){return Nt})),n.d(r,"TileCheckResponseV1",(function(){return jt})),n.d(r,"ConfigResponseV2",(function(){return Rt})),n.d(r,"LanguageInfoResponseV1",(function(){return xt})),n.d(r,"TileCheckSpan",(function(){return Dt})),n.d(r,"TileElement",(function(){return Mt})),n.d(r,"CritiqueTypeOption",(function(){return Lt})),n.d(r,"SupportedLanguage",(function(){return Bt})),n.d(r,"TileCheckCritique",(function(){return Ft})),n.d(r,"EditorServicePostTileCheckHeaders",(function(){return Ut})),n.d(r,"EditorServiceConfigV2Headers",(function(){return qt})),n.d(r,"EditorServiceLanguageinfoHeaders",(function(){return zt})),n.d(r,"EditorServiceInstrumentationHeaders",(function(){return Wt}));class o{constructor(e){if(this._headersMap=new Map,e)for(const t of Object.keys(e))this.set(t,e[t])}set(e,t){this._headersMap.set(i(e),{name:e,value:String(t)})}get(e){var t;return null===(t=this._headersMap.get(i(e)))||void 0===t?void 0:t.value}has(e){return this._headersMap.has(i(e))}delete(e){this._headersMap.delete(i(e))}toJSON(e={}){const t={};if(e.preserveCase)for(const e of this._headersMap.values())t[e.name]=e.value;else for(const[e,n]of this._headersMap)t[e]=n.value;return t}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return function*(e){for(const t of e.values())yield[t.name,t.value]}(this._headersMap)}}function a(e){return new o(e)}var s=n(330);class u{constructor(e){var t,n,r,i,o,u,c;this.url=e.url,this.body=e.body,this.headers=null!==(t=e.headers)&&void 0!==t?t:a(),this.method=null!==(n=e.method)&&void 0!==n?n:"GET",this.timeout=null!==(r=e.timeout)&&void 0!==r?r:0,this.formData=e.formData,this.disableKeepAlive=null!==(i=e.disableKeepAlive)&&void 0!==i&&i,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=null!==(o=e.withCredentials)&&void 0!==o&&o,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||Object(s.a)(),this.allowInsecureConnection=null!==(u=e.allowInsecureConnection)&&void 0!==u&&u,this.enableBrowserStreams=null!==(c=e.enableBrowserStreams)&&void 0!==c&&c}}const c="$",l="_";function d(e){return!("object"!=typeof e||null===e||Array.isArray(e)||e instanceof RegExp||e instanceof Date)}function f(e){if(d(e)){const t="string"==typeof e.name,n="string"==typeof e.message;return t&&n}return!1}function h(e){if(f(e))return e.message;{let t;try{t="object"==typeof e&&e?JSON.stringify(e):String(e)}catch(e){t="[unable to stringify input]"}return`Unknown error ${t}`}}const p={},g="REDACTED",m=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],y=["api-version"];class b{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:t=[]}={}){e=m.concat(e),t=y.concat(t),this.allowedHeaderNames=new Set(e.map((e=>e.toLowerCase()))),this.allowedQueryParameters=new Set(t.map((e=>e.toLowerCase())))}sanitize(e){const t=new Set;return JSON.stringify(e,((e,n)=>{if(n instanceof Error)return Object.assign(Object.assign({},n),{name:n.name,message:n.message});if("headers"===e)return this.sanitizeHeaders(n);if("url"===e)return this.sanitizeUrl(n);if("query"===e)return this.sanitizeQuery(n);if("body"!==e&&"response"!==e&&"operationSpec"!==e){if(Array.isArray(n)||d(n)){if(t.has(n))return"[Circular]";t.add(n)}return n}}),2)}sanitizeHeaders(e){const t={};for(const n of Object.keys(e))this.allowedHeaderNames.has(n.toLowerCase())?t[n]=e[n]:t[n]=g;return t}sanitizeQuery(e){if("object"!=typeof e||null===e)return e;const t={};for(const n of Object.keys(e))this.allowedQueryParameters.has(n.toLowerCase())?t[n]=e[n]:t[n]=g;return t}sanitizeUrl(e){if("string"!=typeof e||null===e)return e;const t=new URL(e);if(!t.search)return e;for(const[e]of t.searchParams)this.allowedQueryParameters.has(e.toLowerCase())||t.searchParams.set(e,g);return t.toString()}}const v=new b;class w extends Error{constructor(e,t={}){super(e),this.name="RestError",this.code=t.code,this.statusCode=t.statusCode,this.request=t.request,this.response=t.response,Object.setPrototypeOf(this,w.prototype)}[p](){return`RestError: ${this.message} \n ${v.sanitize(this)}`}}function S(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}function _(e){const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n}w.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",w.PARSE_ERROR="PARSE_ERROR";const T=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;const O=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function C(e,t){var n,r;const i=e.parsedHeaders;if("HEAD"===e.request.method)return Object.assign(Object.assign({},i),{body:e.parsedBody});const o=t&&t.bodyMapper,a=Boolean(null==o?void 0:o.nullable),s=null==o?void 0:o.type.name;if("Stream"===s)return Object.assign(Object.assign({},i),{blobBody:e.blobBody,readableStreamBody:e.readableStreamBody});const u="Composite"===s&&o.type.modelProperties||{},c=Object.keys(u).some((e=>""===u[e].serializedName));if("Sequence"===s||c){const t=null!==(n=e.parsedBody)&&void 0!==n?n:[];for(const n of Object.keys(u))u[n].serializedName&&(t[n]=null===(r=e.parsedBody)||void 0===r?void 0:r[n]);if(i)for(const e of Object.keys(i))t[e]=i[e];return!a||e.parsedBody||i||0!==Object.getOwnPropertyNames(u).length?t:null}return function(e){const t=Object.assign(Object.assign({},e.headers),e.body);return e.hasNullableType&&0===Object.getOwnPropertyNames(t).length?e.shouldWrapBody?{body:null}:null:e.shouldWrapBody?Object.assign(Object.assign({},e.headers),{body:e.body}):t}({body:e.parsedBody,headers:i,hasNullableType:a,shouldWrapBody:(l=e.parsedBody,d=s,"Composite"!==d&&"Dictionary"!==d&&("string"==typeof l||"number"==typeof l||"boolean"==typeof l||null!==(null==d?void 0:d.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i))||null==l))});var l,d}class E{constructor(e={},t=!1){this.modelMappers=e,this.isXML=t}validateConstraints(e,t,n){const r=(e,r)=>{throw new Error(`"${n}" with value "${t}" should satisfy the constraint "${e}": ${r}.`)};if(e.constraints&&null!=t){const{ExclusiveMaximum:n,ExclusiveMinimum:i,InclusiveMaximum:o,InclusiveMinimum:a,MaxItems:s,MaxLength:u,MinItems:c,MinLength:l,MultipleOf:d,Pattern:f,UniqueItems:h}=e.constraints;if(void 0!==n&&t>=n&&r("ExclusiveMaximum",n),void 0!==i&&t<=i&&r("ExclusiveMinimum",i),void 0!==o&&t>o&&r("InclusiveMaximum",o),void 0!==a&&t<a&&r("InclusiveMinimum",a),void 0!==s&&t.length>s&&r("MaxItems",s),void 0!==u&&t.length>u&&r("MaxLength",u),void 0!==c&&t.length<c&&r("MinItems",c),void 0!==l&&t.length<l&&r("MinLength",l),void 0!==d&&t%d!=0&&r("MultipleOf",d),f){const e="string"==typeof f?new RegExp(f):f;"string"==typeof t&&null!==t.match(e)||r("Pattern",f)}h&&t.some(((e,t,n)=>n.indexOf(e)!==t))&&r("UniqueItems",h)}}serialize(e,t,n,r={xml:{}}){var i,o,a;const s={xml:{rootName:null!==(i=r.xml.rootName)&&void 0!==i?i:"",includeRoot:null!==(o=r.xml.includeRoot)&&void 0!==o&&o,xmlCharKey:null!==(a=r.xml.xmlCharKey)&&void 0!==a?a:l}};let u={};const d=e.type.name;n||(n=e.serializedName),null!==d.match(/^Sequence$/i)&&(u=[]),e.isConstant&&(t=e.defaultValue);const{required:f,nullable:h}=e;if(f&&h&&void 0===t)throw new Error(`${n} cannot be undefined.`);if(f&&!h&&null==t)throw new Error(`${n} cannot be null or undefined.`);if(!f&&!1===h&&null===t)throw new Error(`${n} cannot be null.`);if(null==t)u=t;else if(null!==d.match(/^any$/i))u=t;else if(null!==d.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i))u=function(e,t,n){if(null!=n)if(null!==e.match(/^Number$/i)){if("number"!=typeof n)throw new Error(`${t} with value ${n} must be of type number.`)}else if(null!==e.match(/^String$/i)){if("string"!=typeof n.valueOf())throw new Error(`${t} with value "${n}" must be of type string.`)}else if(null!==e.match(/^Uuid$/i)){if("string"!=typeof n.valueOf()||(r=n,!O.test(r)))throw new Error(`${t} with value "${n}" must be of type string and a valid uuid.`)}else if(null!==e.match(/^Boolean$/i)){if("boolean"!=typeof n)throw new Error(`${t} with value ${n} must be of type boolean.`)}else if(null!==e.match(/^Stream$/i)){if(!("string"===typeof n||"function"==typeof n.pipe||n instanceof ArrayBuffer||ArrayBuffer.isView(n)||("function"==typeof Blob||"object"==typeof Blob)&&n instanceof Blob))throw new Error(`${t} must be a string, Blob, ArrayBuffer, ArrayBufferView, or NodeJS.ReadableStream.`)}var r;return n}(d,n,t);else if(null!==d.match(/^Enum$/i)){u=function(e,t,n){if(!t)throw new Error(`Please provide a set of allowedValues to validate ${e} as an Enum Type.`);if(!t.some((e=>"string"==typeof e.valueOf()?e.toLowerCase()===n.toLowerCase():e===n)))throw new Error(`${n} is not a valid value for ${e}. The valid values are: ${JSON.stringify(t)}.`);return n}(n,e.type.allowedValues,t)}else null!==d.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)?u=function(e,t,n){if(null!=t)if(null!==e.match(/^Date$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${n} must be an instanceof Date or a string in ISO8601 format.`);t=t instanceof Date?t.toISOString().substring(0,10):new Date(t).toISOString().substring(0,10)}else if(null!==e.match(/^DateTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${n} must be an instanceof Date or a string in ISO8601 format.`);t=t instanceof Date?t.toISOString():new Date(t).toISOString()}else if(null!==e.match(/^DateTimeRfc1123$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${n} must be an instanceof Date or a string in RFC-1123 format.`);t=t instanceof Date?t.toUTCString():new Date(t).toUTCString()}else if(null!==e.match(/^UnixTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${n} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);t=function(e){if(!e)return;"string"==typeof e.valueOf()&&(e=new Date(e));return Math.floor(e.getTime()/1e3)}(t)}else if(null!==e.match(/^TimeSpan$/i)&&!function(e){return T.test(e)}(t))throw new Error(`${n} must be a string in ISO 8601 format. Instead was "${t}".`);return t}(d,t,n):null!==d.match(/^ByteArray$/i)?u=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(`${e} must be of type Uint8Array.`);t=S(t)}return t}(n,t):null!==d.match(/^Base64Url$/i)?u=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(`${e} must be of type Uint8Array.`);t=function(e){if(!e)return;if(!(e instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(e,t){let n=e.length;for(;n-1>=0&&e[n-1]===t;)--n;return e.substr(0,n)}(S(e),"=").replace(/\+/g,"-").replace(/\//g,"_")}(t)}return t}(n,t):null!==d.match(/^Sequence$/i)?u=function(e,t,n,r,i,o){var a;if(!Array.isArray(n))throw new Error(`${r} must be of type Array.`);let s=t.type.element;if(!s||"object"!=typeof s)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${r}.`);"Composite"===s.type.name&&s.type.className&&(s=null!==(a=e.modelMappers[s.type.className])&&void 0!==a?a:s);const u=[];for(let t=0;t<n.length;t++){const a=e.serialize(s,n[t],r,o);if(i&&s.xmlNamespace){const e=s.xmlNamespacePrefix?`xmlns:${s.xmlNamespacePrefix}`:"xmlns";"Composite"===s.type.name?(u[t]=Object.assign({},a),u[t][c]={[e]:s.xmlNamespace}):(u[t]={},u[t][o.xml.xmlCharKey]=a,u[t][c]={[e]:s.xmlNamespace})}else u[t]=a}return u}(this,e,t,n,Boolean(this.isXML),s):null!==d.match(/^Dictionary$/i)?u=function(e,t,n,r,i,o){if("object"!=typeof n)throw new Error(`${r} must be of type object.`);const a=t.type.value;if(!a||"object"!=typeof a)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${r}.`);const s={};for(const t of Object.keys(n)){const u=e.serialize(a,n[t],r,o);s[t]=P(a,u,i,o)}if(i&&t.xmlNamespace){const e=t.xmlNamespacePrefix?`xmlns:${t.xmlNamespacePrefix}`:"xmlns",n=s;return n[c]={[e]:t.xmlNamespace},n}return s}(this,e,t,n,Boolean(this.isXML),s):null!==d.match(/^Composite$/i)&&(u=function(e,t,n,r,i,o){R(e,t)&&(t=j(e,t,n,"clientName"));if(null!=n){const a={},s=A(e,t,r);for(const u of Object.keys(s)){const l=s[u];if(l.readOnly)continue;let d,f=a;if(e.isXML)d=l.xmlIsWrapped?l.xmlName:l.xmlElementName||l.xmlName;else{const e=I(l.serializedName);d=e.pop();for(const t of e){const e=f[t];null==e&&(void 0!==n[u]&&null!==n[u]||void 0!==l.defaultValue)&&(f[t]={}),f=f[t]}}if(null!=f){if(i&&t.xmlNamespace){const e=t.xmlNamespacePrefix?`xmlns:${t.xmlNamespacePrefix}`:"xmlns";f[c]=Object.assign(Object.assign({},f[c]),{[e]:t.xmlNamespace})}const a=""!==l.serializedName?r+"."+l.serializedName:r;let s=n[u];const h=R(e,t);h&&h.clientName===u&&null==s&&(s=t.serializedName);const p=e.serialize(l,s,a,o);if(void 0!==p&&null!=d){const e=P(l,p,i,o);i&&l.xmlIsAttribute?(f[c]=f[c]||{},f[c][d]=p):i&&l.xmlIsWrapped?f[d]={[l.xmlElementName]:e}:f[d]=e}}}const u=function(e,t,n){const r=t.type.additionalProperties;if(!r&&t.type.className){const r=k(e,t,n);return null==r?void 0:r.type.additionalProperties}return r}(e,t,r);if(u){const t=Object.keys(s);for(const i in n){t.every((e=>e!==i))&&(a[i]=e.serialize(u,n[i],r+'["'+i+'"]',o))}}return a}return n}(this,e,t,n,Boolean(this.isXML),s));return u}deserialize(e,t,n,r={xml:{}}){var i,o,a;const s={xml:{rootName:null!==(i=r.xml.rootName)&&void 0!==i?i:"",includeRoot:null!==(o=r.xml.includeRoot)&&void 0!==o&&o,xmlCharKey:null!==(a=r.xml.xmlCharKey)&&void 0!==a?a:l}};if(null==t)return this.isXML&&"Sequence"===e.type.name&&!e.xmlIsWrapped&&(t=[]),void 0!==e.defaultValue&&(t=e.defaultValue),t;let u;const d=e.type.name;if(n||(n=e.serializedName),null!==d.match(/^Composite$/i))u=function(e,t,n,r,i){var o;R(e,t)&&(t=j(e,t,n,"serializedName"));const a=A(e,t,r);let s={};const u=[];for(const l of Object.keys(a)){const d=a[l],f=I(a[l].serializedName);u.push(f[0]);const{serializedName:h,xmlName:p,xmlElementName:g}=d;let m=r;""!==h&&void 0!==h&&(m=r+"."+h);const y=d.headerCollectionPrefix;if(y){const t={};for(const r of Object.keys(n))r.startsWith(y)&&(t[r.substring(y.length)]=e.deserialize(d.type.value,n[r],m,i)),u.push(r);s[l]=t}else if(e.isXML)if(d.xmlIsAttribute&&n[c])s[l]=e.deserialize(d,n[c][p],m,i);else{const t=g||p||h;if(d.xmlIsWrapped){const t=n[p],r=null!==(o=null==t?void 0:t[g])&&void 0!==o?o:[];s[l]=e.deserialize(d,r,m,i)}else{const r=n[t];s[l]=e.deserialize(d,r,m,i)}}else{let r,o=n;for(const e of f){if(!o)break;o=o[e]}r=o;const u=t.type.polymorphicDiscriminator;let c;if(u&&l===u.clientName&&null==r&&(r=t.serializedName),Array.isArray(n[l])&&""===a[l].serializedName){r=n[l];const t=e.deserialize(d,r,m,i);for(const[e,n]of Object.entries(s))Object.prototype.hasOwnProperty.call(t,e)||(t[e]=n);s=t}else void 0===r&&void 0===d.defaultValue||(c=e.deserialize(d,r,m,i),s[l]=c)}}const l=t.type.additionalProperties;if(l){const t=e=>{for(const t in a){if(I(a[t].serializedName)[0]===e)return!1}return!0};for(const o in n)t(o)&&(s[o]=e.deserialize(l,n[o],r+'["'+o+'"]',i))}else if(n)for(const e of Object.keys(n))void 0!==s[e]||u.includes(e)||N(e,i)||(s[e]=n[e]);return s}(this,e,t,n,s);else{if(this.isXML){const e=s.xml.xmlCharKey;void 0!==t[c]&&void 0!==t[e]&&(t=t[e])}null!==d.match(/^Number$/i)?(u=parseFloat(t),isNaN(u)&&(u=t)):null!==d.match(/^Boolean$/i)?u="true"===t||"false"!==t&&t:null!==d.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)?u=t:null!==d.match(/^(Date|DateTime|DateTimeRfc1123)$/i)?u=new Date(t):null!==d.match(/^UnixTime$/i)?u=function(e){if(!e)return;return new Date(1e3*e)}(t):null!==d.match(/^ByteArray$/i)?u=_(t):null!==d.match(/^Base64Url$/i)?u=function(e){if(!e)return;if(e&&"string"!=typeof e.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return _(e=e.replace(/-/g,"+").replace(/_/g,"/"))}(t):null!==d.match(/^Sequence$/i)?u=function(e,t,n,r,i){var o;let a=t.type.element;if(!a||"object"!=typeof a)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${r}`);if(n){Array.isArray(n)||(n=[n]),"Composite"===a.type.name&&a.type.className&&(a=null!==(o=e.modelMappers[a.type.className])&&void 0!==o?o:a);const t=[];for(let o=0;o<n.length;o++)t[o]=e.deserialize(a,n[o],`${r}[${o}]`,i);return t}return n}(this,e,t,n,s):null!==d.match(/^Dictionary$/i)&&(u=function(e,t,n,r,i){const o=t.type.value;if(!o||"object"!=typeof o)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${r}`);if(n){const t={};for(const a of Object.keys(n))t[a]=e.deserialize(o,n[a],r,i);return t}return n}(this,e,t,n,s))}return e.isConstant&&(u=e.defaultValue),u}}function I(e){const t=[];let n="";if(e){const r=e.split(".");for(const e of r)"\\"===e.charAt(e.length-1)?n+=e.substr(0,e.length-1)+".":(n+=e,t.push(n),n="")}return t}function k(e,t,n){const r=t.type.className;if(!r)throw new Error(`Class name for model "${n}" is not provided in the mapper "${JSON.stringify(t,void 0,2)}".`);return e.modelMappers[r]}function A(e,t,n){let r=t.type.modelProperties;if(!r){const i=k(e,t,n);if(!i)throw new Error(`mapper() cannot be null or undefined for model "${t.type.className}".`);if(r=null==i?void 0:i.type.modelProperties,!r)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(i)}" of type "${t.type.className}" for object "${n}".`)}return r}function P(e,t,n,r){if(!n||!e.xmlNamespace)return t;const i=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns",o={[i]:e.xmlNamespace};if(["Composite"].includes(e.type.name)){if(t[c])return t;{const e=Object.assign({},t);return e[c]=o,e}}const a={};return a[r.xml.xmlCharKey]=t,a[c]=o,a}function N(e,t){return[c,t.xml.xmlCharKey].includes(e)}function j(e,t,n,r){var i;const o=R(e,t);if(o){let a=o[r];if(a){"serializedName"===r&&(a=a.replace(/\\/gi,""));const o=n[a],s=null!==(i=t.type.uberParent)&&void 0!==i?i:t.type.className;if("string"==typeof o&&s){const n=function(e,t,n){const r=[n];for(;r.length;){const n=r.shift(),i=t===n?t:n+"."+t;if(Object.prototype.hasOwnProperty.call(e,i))return e[i];for(const[t,i]of Object.entries(e))t.startsWith(n+".")&&i.type.uberParent===n&&i.type.className&&r.push(i.type.className)}}(e.modelMappers.discriminators,o,s);n&&(t=n)}}}return t}function R(e,t){return t.type.polymorphicDiscriminator||x(e,t.type.uberParent)||x(e,t.type.className)}function x(e,t){return t&&e.modelMappers[t]&&e.modelMappers[t].type.polymorphicDiscriminator}const D={Base64Url:"Base64Url",Boolean:"Boolean",ByteArray:"ByteArray",Composite:"Composite",Date:"Date",DateTime:"DateTime",DateTimeRfc1123:"DateTimeRfc1123",Dictionary:"Dictionary",Enum:"Enum",Number:"Number",Object:"Object",Sequence:"Sequence",String:"String",Stream:"Stream",TimeSpan:"TimeSpan",UnixTime:"UnixTime"};function M(e,t,n){let r=t.parameterPath;const i=t.mapper;let o;if("string"==typeof r&&(r=[r]),Array.isArray(r)){if(r.length>0)if(i.isConstant)o=i.defaultValue;else{let t=L(e,r);!t.propertyFound&&n&&(t=L(n,r));let a=!1;t.propertyFound||(a=i.required||"options"===r[0]&&2===r.length),o=a?i.defaultValue:t.propertyValue}}else{i.required&&(o={});for(const t in r){const a=i.type.modelProperties[t],s=M(e,{parameterPath:r[t],mapper:a},n);void 0!==s&&(o||(o={}),o[t]=s)}}return o}function L(e,t){const n={propertyFound:!1};let r=0;for(;r<t.length;++r){const n=t[r];if(!e||!(n in e))break;e=e[n]}return r===t.length&&(n.propertyValue=e,n.propertyFound=!0),n}const B=new WeakMap;function F(e){let t=B.get(e);return t||(t={},B.set(e,t)),t}const U=["application/json","text/json"],q=["application/xml","application/atom+xml"],z="deserializationPolicy";function W(e={}){var t,n,r,i,o,a,s;const u=null!==(n=null===(t=e.expectedContentTypes)||void 0===t?void 0:t.json)&&void 0!==n?n:U,c=null!==(i=null===(r=e.expectedContentTypes)||void 0===r?void 0:r.xml)&&void 0!==i?i:q,d=e.parseXML,f=e.serializerOptions,h={xml:{rootName:null!==(o=null==f?void 0:f.xml.rootName)&&void 0!==o?o:"",includeRoot:null!==(a=null==f?void 0:f.xml.includeRoot)&&void 0!==a&&a,xmlCharKey:null!==(s=null==f?void 0:f.xml.xmlCharKey)&&void 0!==s?s:l}};return{name:z,async sendRequest(e,t){const n=await t(e);return async function(e,t,n,r,i){const o=await async function(e,t,n,r,i){var o;if(!(null===(o=n.request.streamResponseStatusCodes)||void 0===o?void 0:o.has(n.status))&&n.bodyAsText){const o=n.bodyAsText,a=n.headers.get("Content-Type")||"",s=a?a.split(";").map((e=>e.toLowerCase())):[];try{if(0===s.length||s.some((t=>-1!==e.indexOf(t))))return n.parsedBody=JSON.parse(o),n;if(s.some((e=>-1!==t.indexOf(e)))){if(!i)throw new Error("Parsing XML not supported.");const e=await i(o,r.xml);return n.parsedBody=e,n}}catch(e){const t=`Error "${e}" occurred while parsing the response body - ${n.bodyAsText}.`,r=e.code||w.PARSE_ERROR;throw new w(t,{code:r,statusCode:n.status,request:n.request,response:n})}}return n}(e,t,n,r,i);if(!function(e){const t=e.request,n=F(t),r=null==n?void 0:n.shouldDeserialize;let i;i=void 0===r||("boolean"==typeof r?r:r(e));return i}(o))return o;const a=F(o.request),s=null==a?void 0:a.operationSpec;if(!s||!s.responses)return o;const u=function(e){let t;const n=e.request,r=F(n),i=null==r?void 0:r.operationSpec;i&&(t=(null==r?void 0:r.operationResponseGetter)?null==r?void 0:r.operationResponseGetter(i,e):i.responses[e.status]);return t}(o),{error:c,shouldReturnResponse:l}=function(e,t,n){var r;const i=200<=e.status&&e.status<300,o=function(e){const t=Object.keys(e.responses);return 0===t.length||1===t.length&&"default"===t[0]}(t)?i:!!n;if(o){if(!n)return{error:null,shouldReturnResponse:!1};if(!n.isError)return{error:null,shouldReturnResponse:!1}}const a=null!=n?n:t.responses.default,s=(null===(r=e.request.streamResponseStatusCodes)||void 0===r?void 0:r.has(e.status))?`Unexpected status code: ${e.status}`:e.bodyAsText,u=new w(s,{statusCode:e.status,request:e.request,response:e});if(!a)throw u;const c=a.bodyMapper,l=a.headersMapper;try{if(e.parsedBody){const n=e.parsedBody;let r;if(c){let e=n;if(t.isXML&&c.type.name===D.Sequence){e=[];const t=c.xmlElementName;"object"==typeof n&&t&&(e=n[t])}r=t.serializer.deserialize(c,e,"error.response.parsedBody")}const i=n.error||r||n;u.code=i.code,i.message&&(u.message=i.message),c&&(u.response.parsedBody=r)}e.headers&&l&&(u.response.parsedHeaders=t.serializer.deserialize(l,e.headers.toJSON(),"operationRes.parsedHeaders"))}catch(t){u.message=`Error "${t.message}" occurred in deserializing the responseBody - "${e.bodyAsText}" for the default response.`}return{error:u,shouldReturnResponse:!1}}(o,s,u);if(c)throw c;if(l)return o;if(u){if(u.bodyMapper){let e=o.parsedBody;s.isXML&&u.bodyMapper.type.name===D.Sequence&&(e="object"==typeof e?e[u.bodyMapper.xmlElementName]:[]);try{o.parsedBody=s.serializer.deserialize(u.bodyMapper,e,"operationRes.parsedBody")}catch(e){throw new w(`Error ${e} occurred in deserializing the responseBody - ${o.bodyAsText}`,{statusCode:o.status,request:o.request,response:o})}}else"HEAD"===s.httpMethod&&(o.parsedBody=n.status>=200&&n.status<300);u.headersMapper&&(o.parsedHeaders=s.serializer.deserialize(u.headersMapper,o.headers.toJSON(),"operationRes.parsedHeaders"))}return o}(u,c,n,h,d)}}}var V=n(215);const G=Object(V.a)("core-rest-pipeline"),H="logPolicy";const $=new Set(["Deserialize","Serialize","Retry","Sign"]);class K{constructor(e){var t;this._policies=[],this._policies=null!==(t=null==e?void 0:e.slice(0))&&void 0!==t?t:[],this._orderedPolicies=void 0}addPolicy(e,t={}){if(t.phase&&t.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(t.phase&&!$.has(t.phase))throw new Error(`Invalid phase name: ${t.phase}`);if(t.afterPhase&&!$.has(t.afterPhase))throw new Error(`Invalid afterPhase name: ${t.afterPhase}`);this._policies.push({policy:e,options:t}),this._orderedPolicies=void 0}removePolicy(e){const t=[];return this._policies=this._policies.filter((n=>!(e.name&&n.policy.name===e.name||e.phase&&n.options.phase===e.phase)||(t.push(n.policy),!1))),this._orderedPolicies=void 0,t}sendRequest(e,t){return this.getOrderedPolicies().reduceRight(((e,t)=>n=>t.sendRequest(n,e)),(t=>e.sendRequest(t)))(t)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new K(this._policies)}static create(){return new K}orderPolicies(){const e=[],t=new Map;function n(e){return{name:e,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}const r=n("Serialize"),i=n("None"),o=n("Deserialize"),a=n("Retry"),s=n("Sign"),u=[r,i,o,a,s];function c(e){return"Retry"===e?a:"Serialize"===e?r:"Deserialize"===e?o:"Sign"===e?s:i}for(const e of this._policies){const n=e.policy,r=e.options,i=n.name;if(t.has(i))throw new Error("Duplicate policy names not allowed in pipeline");const o={policy:n,dependsOn:new Set,dependants:new Set};r.afterPhase&&(o.afterPhase=c(r.afterPhase),o.afterPhase.hasAfterPolicies=!0),t.set(i,o);c(r.phase).policies.add(o)}for(const e of this._policies){const{policy:n,options:r}=e,i=n.name,o=t.get(i);if(!o)throw new Error(`Missing node for policy ${i}`);if(r.afterPolicies)for(const e of r.afterPolicies){const n=t.get(e);n&&(o.dependsOn.add(n),n.dependants.add(o))}if(r.beforePolicies)for(const e of r.beforePolicies){const n=t.get(e);n&&(n.dependsOn.add(o),o.dependants.add(n))}}function l(n){n.hasRun=!0;for(const r of n.policies)if((!r.afterPhase||r.afterPhase.hasRun&&!r.afterPhase.policies.size)&&0===r.dependsOn.size){e.push(r.policy);for(const e of r.dependants)e.dependsOn.delete(r);t.delete(r.policy.name),n.policies.delete(r)}}function d(){for(const e of u){if(l(e),e.policies.size>0&&e!==i)return void(i.hasRun||l(i));e.hasAfterPolicies&&l(i)}}let f=0;for(;t.size>0;){f++;const t=e.length;if(d(),e.length<=t&&f>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}const J="redirectPolicy",Q=["GET","HEAD"];function Y(e={}){const{maxRetries:t=20}=e;return{name:J,async sendRequest(e,n){const r=await n(e);return X(n,r,t)}}}async function X(e,t,n,r=0){const{request:i,status:o,headers:a}=t,s=a.get("location");if(s&&(300===o||301===o&&Q.includes(i.method)||302===o&&Q.includes(i.method)||303===o&&"POST"===i.method||307===o)&&r<n){const t=new URL(s,i.url);i.url=t.toString(),303===o&&(i.method="GET",i.headers.delete("Content-Length"),delete i.body),i.headers.delete("Authorization");const a=await e(i);return X(e,a,n,r+1)}return t}const Z="1.10.0",ee=3;function te(e){const t=new Map;t.set("core-rest-pipeline",Z),function(e){const t=self.navigator;e.set("OS",(t.oscpu||t.platform).replace(" ",""))}(t);const n=function(e){const t=[];for(const[n,r]of e){const e=r?`${n}/${r}`:n;t.push(e)}return t.join(" ")}(t);return e?`${e} ${n}`:n}const ne="x-ms-useragent",re="userAgentPolicy";const ie=new Error("decompressResponsePolicy is not supported in browser environment");new WeakMap,new WeakMap;class oe extends Error{constructor(e){super(e),this.name="AbortError"}}const ae="The operation was aborted.";function se(e,t,n){return new Promise(((r,i)=>{let o,a;const s=()=>i(new oe((null==n?void 0:n.abortErrorMsg)?null==n?void 0:n.abortErrorMsg:ae)),u=()=>{(null==n?void 0:n.abortSignal)&&a&&n.abortSignal.removeEventListener("abort",a)};if(a=()=>(o&&clearTimeout(o),u(),s()),(null==n?void 0:n.abortSignal)&&n.abortSignal.aborted)return s();o=setTimeout((()=>{u(),r(t)}),e),(null==n?void 0:n.abortSignal)&&n.abortSignal.addEventListener("abort",a)}))}function ue(e,t){const n=e.headers.get(t);if(!n)return;const r=Number(n);return Number.isNaN(r)?void 0:r}const ce="Retry-After",le=["retry-after-ms","x-ms-retry-after-ms",ce];function de(e){if(e&&[429,503].includes(e.status))try{for(const t of le){const n=ue(e,t);if(0===n||n){return n*(t===ce?1e3:1)}}const t=e.headers.get(ce);if(!t)return;const n=Date.parse(t)-Date.now();return Number.isFinite(n)?Math.max(0,n):void 0}catch(e){return}}const fe=1e3,he=64e3;function pe(e={}){var t,n;const r=null!==(t=e.retryDelayInMs)&&void 0!==t?t:fe,i=null!==(n=e.maxRetryDelayInMs)&&void 0!==n?n:he;let o=r;return{name:"exponentialRetryStrategy",retry({retryCount:t,response:n,responseError:r}){const a=function(e){if(!e)return!1;return"ETIMEDOUT"===e.code||"ESOCKETTIMEDOUT"===e.code||"ECONNREFUSED"===e.code||"ECONNRESET"===e.code||"ENOENT"===e.code}(r),s=a&&e.ignoreSystemErrors,u=function(e){return Boolean(e&&void 0!==e.status&&(e.status>=500||408===e.status)&&501!==e.status&&505!==e.status)}(n),c=u&&e.ignoreHttpStatusCodes,l=n&&(function(e){return Number.isFinite(de(e))}(n)||!u);if(l||c||s)return{skipStrategy:!0};if(r&&!a&&!u)return{errorToThrow:r};const d=o*Math.pow(2,t),f=Math.min(i,d);var h,p;return o=f/2+(h=0,p=f/2,h=Math.ceil(h),p=Math.floor(p),Math.floor(Math.random()*(p-h+1))+h),{retryAfterInMs:o}}}}const ge=Object(V.a)("core-rest-pipeline retryPolicy"),me="retryPolicy";function ye(e,t={maxRetries:ee}){const n=t.logger||ge;return{name:me,async sendRequest(r,i){var o,a;let s,u,c=-1;e:for(;;){c+=1,s=void 0,u=void 0;try{n.info(`Retry ${c}: Attempting to send request`,r.requestId),s=await i(r),n.info(`Retry ${c}: Received a response from request`,r.requestId)}catch(e){if(n.error(`Retry ${c}: Received an error from request`,r.requestId),u=e,!e||"RestError"!==u.name)throw e;s=u.response}if(null===(o=r.abortSignal)||void 0===o?void 0:o.aborted){n.error(`Retry ${c}: Request aborted.`);throw new oe}if(c>=(null!==(a=t.maxRetries)&&void 0!==a?a:ee)){if(n.info(`Retry ${c}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),u)throw u;if(s)return s;throw new Error("Maximum retries reached with no response or error to throw")}n.info(`Retry ${c}: Processing ${e.length} retry strategies.`);t:for(const t of e){const e=t.logger||ge;e.info(`Retry ${c}: Processing retry strategy ${t.name}.`);const n=t.retry({retryCount:c,response:s,responseError:u});if(n.skipStrategy){e.info(`Retry ${c}: Skipped.`);continue t}const{errorToThrow:i,retryAfterInMs:o,redirectTo:a}=n;if(i)throw e.error(`Retry ${c}: Retry strategy ${t.name} throws error:`,i),i;if(o||0===o){e.info(`Retry ${c}: Retry strategy ${t.name} retries after ${o}`),await se(o,void 0,{abortSignal:r.abortSignal});continue e}if(a){e.info(`Retry ${c}: Retry strategy ${t.name} redirects to ${a}`),r.url=a;continue e}}if(u)throw n.info("None of the retry strategies could work with the received error. Throwing it."),u;if(s)return n.info("None of the retry strategies could work with the received response. Returning it."),s}}}}const be="defaultRetryPolicy";const ve="formDataPolicy";const we=!1,Se=new Error("proxyPolicy is not supported in browser environment");const _e="setClientRequestIdPolicy";const Te="tlsPolicy";const Oe={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function Ce(e={}){let t=new Ee(e.parentContext);return e.span&&(t=t.setValue(Oe.span,e.span)),e.namespace&&(t=t.setValue(Oe.namespace,e.namespace)),t}class Ee{constructor(e){this._contextMap=e instanceof Ee?new Map(e._contextMap):new Map}setValue(e,t){const n=new Ee(this);return n._contextMap.set(e,t),n}getValue(e){return this._contextMap.get(e)}deleteValue(e){const t=new Ee(this);return t._contextMap.delete(e),t}}let Ie;function ke(){return Ie||(Ie={createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(e,t)=>({span:{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}},tracingContext:Ce({parentContext:t.tracingContext})}),withContext:(e,t,...n)=>t(...n)}),Ie}const Ae="tracingPolicy";function Pe(e={}){const t=te(e.userAgentPrefix),n=function(){try{return function(e){const{namespace:t,packageName:n,packageVersion:r}=e;function i(e,i,o){var a;const s=ke().startSpan(e,Object.assign(Object.assign({},o),{packageName:n,packageVersion:r,tracingContext:null===(a=null==i?void 0:i.tracingOptions)||void 0===a?void 0:a.tracingContext}));let u=s.tracingContext;const c=s.span;return u.getValue(Oe.namespace)||(u=u.setValue(Oe.namespace,t)),c.setAttribute("az.namespace",u.getValue(Oe.namespace)),{span:c,updatedOptions:Object.assign({},i,{tracingOptions:Object.assign(Object.assign({},null==i?void 0:i.tracingOptions),{tracingContext:u})})}}function o(e,t,...n){return ke().withContext(e,t,...n)}return{startSpan:i,withSpan:async function(e,t,n,r){const{span:a,updatedOptions:s}=i(e,t,r);try{const e=await o(s.tracingOptions.tracingContext,(()=>Promise.resolve(n(s,a))));return a.setStatus({status:"success"}),e}catch(e){throw a.setStatus({status:"error",error:e}),e}finally{a.end()}},withContext:o,parseTraceparentHeader:function(e){return ke().parseTraceparentHeader(e)},createRequestHeaders:function(e){return ke().createRequestHeaders(e)}}}({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:Z})}catch(e){return void G.warning(`Error when creating the TracingClient: ${h(e)}`)}}();return{name:Ae,async sendRequest(e,r){var i,o;if(!n||!(null===(i=e.tracingOptions)||void 0===i?void 0:i.tracingContext))return r(e);const{span:a,tracingContext:s}=null!==(o=function(e,t,n){try{const{span:r,updatedOptions:i}=e.startSpan(`HTTP ${t.method}`,{tracingOptions:t.tracingOptions},{spanKind:"client",spanAttributes:{"http.method":t.method,"http.url":t.url,requestId:t.requestId}});if(!r.isRecording())return void r.end();n&&r.setAttribute("http.user_agent",n);const o=e.createRequestHeaders(i.tracingOptions.tracingContext);for(const[e,n]of Object.entries(o))t.headers.set(e,n);return{span:r,tracingContext:i.tracingOptions.tracingContext}}catch(e){return void G.warning(`Skipping creating a tracing span due to an error: ${h(e)}`)}}(n,e,t))&&void 0!==o?o:{};if(!a||!s)return r(e);try{const t=await n.withContext(s,r,e);return function(e,t){try{e.setAttribute("http.status_code",t.status);const n=t.headers.get("x-ms-request-id");n&&e.setAttribute("serviceRequestId",n),e.setStatus({status:"success"}),e.end()}catch(e){G.warning(`Skipping tracing span processing due to an error: ${h(e)}`)}}(a,t),t}catch(e){throw function(e,t){try{e.setStatus({status:"error",error:f(t)?t:void 0}),((n=t)instanceof w||f(n)&&"RestError"===n.name)&&t.statusCode&&e.setAttribute("http.status_code",t.statusCode),e.end()}catch(n){G.warning(`Skipping tracing span processing due to an error: ${h(n)}`)}var n}(a,e),e}}}}function Ne(e){const t=K.create();var n;return we&&(e.tlsOptions&&t.addPolicy((n=e.tlsOptions,{name:Te,sendRequest:async(e,t)=>(e.tlsSettings||(e.tlsSettings=n),t(e))})),t.addPolicy(function(){throw Se}(e.proxyOptions)),t.addPolicy(function(){throw ie}())),t.addPolicy({name:ve,async sendRequest(e,t){if(e.formData){const t=e.formData,n=new FormData;for(const e of Object.keys(t)){const r=t[e];if(Array.isArray(r))for(const t of r)n.append(e,t);else n.append(e,r)}e.body=n,e.formData=void 0;const r=e.headers.get("Content-Type");r&&-1!==r.indexOf("application/x-www-form-urlencoded")?e.body=new URLSearchParams(n).toString():r&&-1!==r.indexOf("multipart/form-data")&&e.headers.delete("Content-Type")}return t(e)}}),t.addPolicy(function(e={}){const t=te(e.userAgentPrefix);return{name:re,sendRequest:async(e,n)=>(e.headers.has(ne)||e.headers.set(ne,t),n(e))}}(e.userAgentOptions)),t.addPolicy(function(e="x-ms-client-request-id"){return{name:_e,sendRequest:async(t,n)=>(t.headers.has(e)||t.headers.set(e,t.requestId),n(t))}}()),t.addPolicy(function(e={}){var t;return{name:be,sendRequest:ye([{name:"throttlingRetryStrategy",retry({response:e}){const t=de(e);return Number.isFinite(t)?{retryAfterInMs:t}:{skipStrategy:!0}}},pe(e)],{maxRetries:null!==(t=e.maxRetries)&&void 0!==t?t:ee}).sendRequest}}(e.retryOptions),{phase:"Retry"}),t.addPolicy(Pe(e.userAgentOptions),{afterPhase:"Retry"}),we&&t.addPolicy(Y(e.redirectOptions),{afterPhase:"Retry"}),t.addPolicy(function(e={}){var t;const n=null!==(t=e.logger)&&void 0!==t?t:G.info,r=new b({additionalAllowedHeaderNames:e.additionalAllowedHeaderNames,additionalAllowedQueryParameters:e.additionalAllowedQueryParameters});return{name:H,async sendRequest(e,t){if(!n.enabled)return t(e);n(`Request: ${r.sanitize(e)}`);const i=await t(e);return n(`Response status code: ${i.status}`),n(`Headers: ${r.sanitize(i.headers)}`),i}}}(e.loggingOptions),{afterPhase:"Sign"}),t}const je={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};function Re(e,t){let n,r=null,i=null;const o=Object.assign(Object.assign({},je),t),a={get isRefreshing(){return null!==r},get shouldRefresh(){var e;return!a.isRefreshing&&(null!==(e=null==i?void 0:i.expiresOnTimestamp)&&void 0!==e?e:0)-o.refreshWindowInMs<Date.now()},get mustRefresh(){return null===i||i.expiresOnTimestamp-o.forcedRefreshWindowInMs<Date.now()}};function s(t,s){var u;if(!a.isRefreshing){r=async function(e,t,n){async function r(){if(!(Date.now()<n)){const t=await e();if(null===t)throw new Error("Failed to refresh access token.");return t}try{return await e()}catch(e){return null}}let i=await r();for(;null===i;)await se(t),i=await r();return i}((()=>e.getToken(t,s)),o.retryIntervalInMs,null!==(u=null==i?void 0:i.expiresOnTimestamp)&&void 0!==u?u:Date.now()).then((e=>(r=null,i=e,n=s.tenantId,i))).catch((e=>{throw r=null,i=null,n=void 0,e}))}return r}return async(e,t)=>n!==t.tenantId||Boolean(t.claims)||a.mustRefresh?s(e,t):(a.shouldRefresh&&s(e,t),i)}const xe="bearerTokenAuthenticationPolicy";async function De(e){const{scopes:t,getAccessToken:n,request:r}=e,i={abortSignal:r.abortSignal,tracingOptions:r.tracingOptions},o=await n(t,i);o&&e.request.headers.set("Authorization",`Bearer ${o.token}`)}function Me(e){var t;const{credential:n,scopes:r,challengeCallbacks:i}=e,o=e.logger||G,a=Object.assign({authorizeRequest:null!==(t=null==i?void 0:i.authorizeRequest)&&void 0!==t?t:De,authorizeRequestOnChallenge:null==i?void 0:i.authorizeRequestOnChallenge},i),s=n?Re(n):()=>Promise.resolve(null);return{name:xe,async sendRequest(e,t){if(!e.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");let n,i;await a.authorizeRequest({scopes:Array.isArray(r)?r:[r],request:e,getAccessToken:s,logger:o});try{n=await t(e)}catch(e){i=e,n=e.response}if(a.authorizeRequestOnChallenge&&401===(null==n?void 0:n.status)&&function(e){const t=e.headers.get("WWW-Authenticate");if(401===e.status&&t)return t}(n)){if(await a.authorizeRequestOnChallenge({scopes:Array.isArray(r)?r:[r],request:e,response:n,getAccessToken:s,logger:o}))return t(e)}if(i)throw i;return n}}}function Le(e){const{parameterPath:t,mapper:n}=e;let r;return r="string"==typeof t?t:Array.isArray(t)?t.join("."):n.serializedName,r}const Be="serializationPolicy";function Fe(e={}){const t=e.stringifyXML;return{name:Be,async sendRequest(e,n){const r=F(e),i=null==r?void 0:r.operationSpec,o=null==r?void 0:r.operationArguments;return i&&o&&(function(e,t,n){var r,i;if(n.headerParameters)for(const r of n.headerParameters){let i=M(t,r);if(null!=i||r.mapper.required){i=n.serializer.serialize(r.mapper,i,Le(r));const t=r.mapper.headerCollectionPrefix;if(t)for(const n of Object.keys(i))e.headers.set(t+n,i[n]);else e.headers.set(r.mapper.serializedName||Le(r),i)}}const o=null===(i=null===(r=t.options)||void 0===r?void 0:r.requestOptions)||void 0===i?void 0:i.customHeaders;if(o)for(const t of Object.keys(o))e.headers.set(t,o[t])}(e,o,i),function(e,t,n,r=function(){throw new Error("XML serialization unsupported!")}){var i,o,a,s,u;const d=null===(i=t.options)||void 0===i?void 0:i.serializerOptions,f={xml:{rootName:null!==(o=null==d?void 0:d.xml.rootName)&&void 0!==o?o:"",includeRoot:null!==(a=null==d?void 0:d.xml.includeRoot)&&void 0!==a&&a,xmlCharKey:null!==(s=null==d?void 0:d.xml.xmlCharKey)&&void 0!==s?s:l}},h=f.xml.xmlCharKey;if(n.requestBody&&n.requestBody.mapper){e.body=M(t,n.requestBody);const i=n.requestBody.mapper,{required:o,serializedName:a,xmlName:s,xmlElementName:l,xmlNamespace:d,xmlNamespacePrefix:p,nullable:g}=i,m=i.type.name;try{if(void 0!==e.body&&null!==e.body||g&&null===e.body||o){const t=Le(n.requestBody);e.body=n.serializer.serialize(i,e.body,t,f);const o=m===D.Stream;if(n.isXML){const t=p?`xmlns:${p}`:"xmlns",n=function(e,t,n,r,i){if(e&&!["Composite","Sequence","Dictionary"].includes(n)){const n={};return n[i.xml.xmlCharKey]=r,n[c]={[t]:e},n}return r}(d,t,m,e.body,f);m===D.Sequence?e.body=r(function(e,t,n,r){Array.isArray(e)||(e=[e]);if(!n||!r)return{[t]:e};const i={[t]:e};return i[c]={[n]:r},i}(n,l||s||a,t,d),{rootName:s||a,xmlCharKey:h}):o||(e.body=r(n,{rootName:s||a,xmlCharKey:h}))}else{if(m===D.String&&((null===(u=n.contentType)||void 0===u?void 0:u.match("text/plain"))||"text"===n.mediaType))return;o||(e.body=JSON.stringify(e.body))}}}catch(e){throw new Error(`Error "${e.message}" occurred in serializing the payload - ${JSON.stringify(a,void 0,"  ")}.`)}}else if(n.formDataParameters&&n.formDataParameters.length>0){e.formData={};for(const r of n.formDataParameters){const i=M(t,r);if(null!=i){const t=r.mapper.serializedName||Le(r);e.formData[t]=n.serializer.serialize(r.mapper,i,Le(r),f)}}}}(e,o,i,t)),n(e)}}}function Ue(e){return Boolean(e&&"function"==typeof e.getReader&&"function"==typeof e.tee)}class qe{async sendRequest(e){if("https:"!==new URL(e.url).protocol&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");try{return await async function(e){const{abortController:t,abortControllerCleanup:n}=function(e){const t=new AbortController;let n,r;if(e.abortSignal){if(e.abortSignal.aborted)throw new oe("The operation was aborted.");r=e=>{"abort"===e.type&&t.abort()},e.abortSignal.addEventListener("abort",r),n=()=>{var t;r&&(null===(t=e.abortSignal)||void 0===t||t.removeEventListener("abort",r))}}e.timeout>0&&setTimeout((()=>{t.abort()}),e.timeout);return{abortController:t,abortControllerCleanup:n}}(e);try{const n=function(e){const t=new Headers;for(const[n,r]of e)t.append(n,r);return t}(e.headers),r=function(e){const t="function"==typeof e.body?e.body():e.body;if(function(e){return e&&"function"==typeof e.pipe}(t))throw new Error("Node streams are not supported in browser environment.");return Ue(t)?ze(t,e.onUploadProgress):t}(e);return async function(e,t){var n,r;const i=function(e){const t=a();for(const[n,r]of e.headers)t.set(n,r);return t}(e),o={request:t,headers:i,status:e.status},s=Ue(e.body)?ze(e.body,t.onDownloadProgress):e.body;if((null===(n=t.streamResponseStatusCodes)||void 0===n?void 0:n.has(Number.POSITIVE_INFINITY))||(null===(r=t.streamResponseStatusCodes)||void 0===r?void 0:r.has(o.status)))if(t.enableBrowserStreams)o.browserStreamBody=null!=s?s:void 0;else{const e=new Response(s);o.blobBody=e.blob()}else{const e=new Response(s);o.bodyAsText=await e.text()}return o}(await fetch(e.url,{body:r,method:e.method,headers:n,signal:t.signal,credentials:e.withCredentials?"include":"same-origin",cache:"no-store"}),e)}finally{n&&n()}}(e)}catch(t){throw function(e,t){var n;return e&&"AbortError"===(null==e?void 0:e.name)?e:new w(`Error sending request: ${e.message}`,{code:null!==(n=null==e?void 0:e.code)&&void 0!==n?n:w.REQUEST_SEND_ERROR,request:t})}(t,e)}}}function ze(e,t){let n=0;if(function(e){return void 0!==e.pipeThrough&&void 0!==self.TransformStream}(e))return e.pipeThrough(new TransformStream({transform(e,r){null!==e?(r.enqueue(e),n+=e.length,t&&t({loadedBytes:n})):r.terminate()}}));{const r=e.getReader();return new ReadableStream({async pull(e){var i;const{done:o,value:a}=await r.read();if(o||!a)return e.close(),void r.releaseLock();n+=null!==(i=null==a?void 0:a.length)&&void 0!==i?i:0,e.enqueue(a),t&&t({loadedBytes:n})}})}}function We(){return new qe}let Ve;const Ge={CSV:",",SSV:" ",Multi:"Multi",TSV:"\t",Pipes:"|"};function He(e,t,n,r){const i=function(e,t,n){var r;const i=new Map;if(null===(r=e.urlParameters)||void 0===r?void 0:r.length)for(const r of e.urlParameters){let o=M(t,r,n);const a=Le(r);o=e.serializer.serialize(r.mapper,o,a),r.skipEncoding||(o=encodeURIComponent(o)),i.set(`{${r.mapper.serializedName||a}}`,o)}return i}(t,n,r);let o=!1,a=$e(e,i);if(t.path){let e=$e(t.path,i);"/{nextLink}"===t.path&&e.startsWith("/")&&(e=e.substring(1)),e.includes("://")?(a=e,o=!0):a=function(e,t){if(!t)return e;const n=new URL(e);let r=n.pathname;r.endsWith("/")||(r=`${r}/`);t.startsWith("/")&&(t=t.substring(1));const i=t.indexOf("?");if(-1!==i){const e=t.substring(0,i),o=t.substring(i+1);r+=e,o&&(n.search=n.search?`${n.search}&${o}`:o)}else r+=t;return n.pathname=r,n.toString()}(a,e)}const{queryParams:s,sequenceParams:u}=function(e,t,n){var r;const i=new Map,o=new Set;if(null===(r=e.queryParameters)||void 0===r?void 0:r.length)for(const r of e.queryParameters){"Sequence"===r.mapper.type.name&&r.mapper.serializedName&&o.add(r.mapper.serializedName);let a=M(t,r,n);if(null!=a||r.mapper.required){a=e.serializer.serialize(r.mapper,a,Le(r));const t=r.collectionFormat?Ge[r.collectionFormat]:"";if(Array.isArray(a)&&(a=a.map((e=>null==e?"":e))),"Multi"===r.collectionFormat&&0===a.length)continue;!Array.isArray(a)||"SSV"!==r.collectionFormat&&"TSV"!==r.collectionFormat||(a=a.join(t)),r.skipEncoding||(a=Array.isArray(a)?a.map((e=>encodeURIComponent(e))):encodeURIComponent(a)),!Array.isArray(a)||"CSV"!==r.collectionFormat&&"Pipes"!==r.collectionFormat||(a=a.join(t)),i.set(r.mapper.serializedName||Le(r),a)}}return{queryParams:i,sequenceParams:o}}(t,n,r);return a=function(e,t,n,r=!1){if(0===t.size)return e;const i=new URL(e),o=function(e){const t=new Map;if(!e||"?"!==e[0])return t;const n=(e=e.slice(1)).split("&");for(const e of n){const[n,r]=e.split("=",2),i=t.get(n);i?Array.isArray(i)?i.push(r):t.set(n,[i,r]):t.set(n,r)}return t}(i.search);for(const[e,i]of t){const t=o.get(e);if(Array.isArray(t))if(Array.isArray(i)){t.push(...i);const n=new Set(t);o.set(e,Array.from(n))}else t.push(i);else t?(Array.isArray(i)?i.unshift(t):n.has(e)&&o.set(e,[t,i]),r||o.set(e,i)):o.set(e,i)}const a=[];for(const[e,t]of o)if("string"==typeof t)a.push(`${e}=${t}`);else if(Array.isArray(t))for(const n of t)a.push(`${e}=${n}`);else a.push(`${e}=${t}`);return i.search=a.length?`?${a.join("&")}`:"",i.toString()}(a,s,u,o),a}function $e(e,t){let n=e;for(const[e,r]of t)n=n.split(e).join(r);return n}const Ke=Object(V.a)("core-client");class Je{constructor(e={}){var t,n;if(this._requestContentType=e.requestContentType,this._endpoint=null!==(t=e.endpoint)&&void 0!==t?t:e.baseUri,e.baseUri&&Ke.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=e.allowInsecureConnection,this._httpClient=e.httpClient||(Ve||(Ve=We()),Ve),this.pipeline=e.pipeline||function(e){const t=function(e){if(e.credentialScopes){const t=e.credentialScopes;return Array.isArray(t)?t.map((e=>new URL(e).toString())):new URL(t).toString()}if(e.endpoint)return`${e.endpoint}/.default`;if(e.baseUri)return`${e.baseUri}/.default`;if(e.credential&&!e.credentialScopes)throw new Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy");return}(e),n=e.credential&&t?{credentialScopes:t,credential:e.credential}:void 0;return function(e={}){const t=Ne(null!=e?e:{});return e.credentialOptions&&t.addPolicy(Me({credential:e.credentialOptions.credential,scopes:e.credentialOptions.credentialScopes})),t.addPolicy(Fe(e.serializationOptions),{phase:"Serialize"}),t.addPolicy(W(e.deserializationOptions),{phase:"Deserialize"}),t}(Object.assign(Object.assign({},e),{credentialOptions:n}))}(e),null===(n=e.additionalPolicies)||void 0===n?void 0:n.length)for(const{policy:t,position:n}of e.additionalPolicies){const e="perRetry"===n?"Sign":void 0;this.pipeline.addPolicy(t,{afterPhase:e})}}async sendRequest(e){return this.pipeline.sendRequest(this._httpClient,e)}async sendOperationRequest(e,t){const n=t.baseUrl||this._endpoint;if(!n)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");const r=function(e){return new u(e)}({url:He(n,t,e,this)});r.method=t.httpMethod;const i=F(r);i.operationSpec=t,i.operationArguments=e;const o=t.contentType||this._requestContentType;o&&t.requestBody&&r.headers.set("Content-Type",o);const a=e.options;if(a){const e=a.requestOptions;e&&(e.timeout&&(r.timeout=e.timeout),e.onUploadProgress&&(r.onUploadProgress=e.onUploadProgress),e.onDownloadProgress&&(r.onDownloadProgress=e.onDownloadProgress),void 0!==e.shouldDeserialize&&(i.shouldDeserialize=e.shouldDeserialize),e.allowInsecureConnection&&(r.allowInsecureConnection=!0)),a.abortSignal&&(r.abortSignal=a.abortSignal),a.tracingOptions&&(r.tracingOptions=a.tracingOptions)}this._allowInsecureConnection&&(r.allowInsecureConnection=!0),void 0===r.streamResponseStatusCodes&&(r.streamResponseStatusCodes=function(e){const t=new Set;for(const n in e.responses){const r=e.responses[n];r.bodyMapper&&r.bodyMapper.type.name===D.Stream&&t.add(Number(n))}return t}(t));try{const e=await this.sendRequest(r),n=C(e,t.responses[e.status]);return(null==a?void 0:a.onResponse)&&a.onResponse(e,n),n}catch(e){if("object"==typeof e&&(null==e?void 0:e.response)){const n=e.response,r=C(n,t.responses[e.statusCode]||t.responses.default);e.details=r,(null==a?void 0:a.onResponse)&&a.onResponse(n,r,e)}throw e}}}async function Qe(e){const{scopes:t,response:n}=e,r=e.logger||Ke,i=n.headers.get("WWW-Authenticate");if(!i)return r.info("The WWW-Authenticate header was missing. Failed to perform the Continuous Access Evaluation authentication flow."),!1;const o=function(e){return`, ${e.trim()}`.split(", Bearer ").filter((e=>e)).map((e=>`${e.trim()}, `.split('", ').filter((e=>e)).map((e=>(([e,t])=>({[e]:t}))(e.trim().split('="')))).reduce(((e,t)=>Object.assign(Object.assign({},e),t)),{})))}(i)||[],a=o.find((e=>e.claims));if(!a)return r.info('The WWW-Authenticate header was missing the necessary "claims" to perform the Continuous Access Evaluation authentication flow.'),!1;const s=await e.getAccessToken(a.scope?[a.scope]:t,{claims:(u=a.claims,atob(u))});var u;return!!s&&(e.request.headers.set("Authorization",`Bearer ${s.token}`),!0)}const Ye="Composite",Xe="String",Ze="Number",et="Sequence",tt={xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}};function nt(e){const t={};for(const s of e)t[(a=s[0],a.charAt(0).toLowerCase()+a.slice(1))]=(n=s[0],r=s[1],i=s[2],o=s[3],{serializedName:n,required:i,defaultValue:o,type:{name:r}});var n,r,i,o,a;return t}function rt(e,t){return{type:{name:Ye,className:e,modelProperties:t}}}const it=rt("CommonAppIdProperty",nt([["AppId",Xe]])),ot=rt("CommonResponseStatusProperty",nt([["ResponseStatus",Ze,!1,0]])),at=rt("CommonRequestIdProperty",nt([["RequestId",Xe]])),st=rt("TileContent",Object.assign(Object.assign({},nt([["TileId",Xe,!0],["RevisionId",Xe,!0]])),{analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}},tileElements:{serializedName:"TileElements",type:{name:et,element:{type:{name:Ye,className:"TileElement"}}}}})),ut=rt("CommonLanguageIdProperty",nt([["LanguageId",Xe]])),ct=rt("CommonTextUnitProperty",nt([["TextUnit",Ze]])),lt=rt("TopologyNode",Object.assign(Object.assign({},nt([["Id",Xe,!0],["RevisionId",Xe,!0],["Type",Ze,!0],["NumberOfChildren",Ze],["AreChildsOrdered","Boolean",void 0,!1]])),{analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}},children:{serializedName:"Children",type:{name:et,element:{type:{name:Ye,className:"TopologyNode"}}}}})),dt=rt("CommonDescriptorsProperty",{descriptors:{serializedName:"Descriptors",type:{name:et,element:{type:{name:Ye,className:"Descriptor"}}}}}),ft=rt("Descriptor",nt([["Name",Xe,!0],["Value",Xe,!0]])),ht=rt("CommonLanguageUXIdProperty",nt([["LanguageUXId",Xe]])),pt=rt("CommonRunOnProfileIdProperty",nt([["RunOnProfileId","Uuid"]])),gt=rt("CommonOverriddenCritiqueTypeOptions",{overriddenCritiqueTypeOptions:{serializedName:"OverriddenCritiqueTypeOptions",type:{name:et,element:{type:{name:Ye,className:"CritiqueTypeOption"}}}}}),mt=rt("Suggestion",nt([["Text",Xe,!0],["Description",Xe],["ConfidenceLevel",Ze],["Source",Ze],["Action",Ze,!0],["BucketId",Ze],["NumberOfInstances",Ze]])),yt=rt("CommonCritique",Object.assign(Object.assign({},nt([["TraceId","Uuid"],["TypeId","Uuid"],["CategoryTitle",Xe],["Context",Xe],["Start",Ze,void 0,0],["StartInContext",Ze,void 0,0],["Length",Ze,void 0,0],["LanguageId",Xe],["Priority",Ze]])),{metadata:{serializedName:"Metadata",type:{name:et,element:{type:{name:Ye,className:"Metadatum"}}}}})),bt=rt("Metadatum",nt([["Name",Xe,!0],["Value",Xe,!0]])),vt=rt("CommonTileIdProperty",nt([["TileId",Xe]])),wt=rt("CommonRevisionIdProperty",nt([["RevisionId",Xe]])),St=rt("SupportedActions",nt([["SupportedActions",Ze]])),_t=rt("CommonAppVersionProperty",nt([["AppVersion",Xe]])),Tt=rt("CritiqueCategoryInfo",Object.assign(Object.assign({},nt([["Id","Uuid",!0],["Name",Xe,!0],["Priority",Ze]])),{critiqueTypeInfoList:{serializedName:"CritiqueTypeInfoList",type:{name:et,element:{type:{name:Ye,className:"CritiqueTypeInfo"}}}}})),Ot=rt("CritiqueTypeInfo",Object.assign(Object.assign({},nt([["Id","Uuid",!0],["Name",Xe,!0],["IsBinaryCritiqueType","Boolean"],["DefaultCritiqueValue",Ze,!0],["CritiquePriority",Ze],["CritiqueTag",Xe]])),{critiqueTypeValues:{serializedName:"CritiqueTypeValues",type:{name:et,element:{type:{name:Xe}}}}})),Ct=rt("UserIdentity",nt([["IdentityProvider",Ze,!0],["Puid",Xe,!0],["TenantId",Xe],["Cid",Xe]])),Et=rt("BrowserExtensionRequestV1",Object.assign(Object.assign({},it.type.modelProperties),nt([["Browser",Xe],["BrowserVersion",Xe],["ClientId",Xe],["Email",Xe],["ExtensionId",Xe],["FirstInstallVersion",Xe],["LanguageId",Xe],["LanguageUxId",Xe],["LicenseType",Xe],["StoreId",Xe],["TenantId",Xe]]))),It=rt("TileCheckRequestV1",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},it.type.modelProperties),dt.type.modelProperties),ht.type.modelProperties),pt.type.modelProperties),gt.type.modelProperties),nt([["SessionId",Xe,!0],["RequestOrderInSession",Ze]])),{content:{serializedName:"Content",type:{name:et,element:{type:{name:Ye,className:"TileContent"}}}},topology:{serializedName:"Topology",type:{name:Ye,className:"TopologyNode"}}})),kt=rt("ConfigRequestV2",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},it.type.modelProperties),_t.type.modelProperties),dt.type.modelProperties),ut.type.modelProperties),ht.type.modelProperties),pt.type.modelProperties)),At=rt("LanguageInfoRequestV1",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},it.type.modelProperties),dt.type.modelProperties),ut.type.modelProperties),ht.type.modelProperties),pt.type.modelProperties)),Pt=rt("InstrumentationRequestV1",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},it.type.modelProperties),ut.type.modelProperties),dt.type.modelProperties),nt([["TraceId","Uuid",!0],["CritiqueGenerationTime",Ze],["CritiquePriority",Ze,!0],["CritiqueTypeId","Uuid",!0],["EventId",Ze,!0],["OriginalText",Xe],["PreContextBegin",Ze],["PostContextEnd",Ze],["SubstrateEventName",Xe]])),{flaggedText:{constraints:{MaxLength:2e4,MinLength:1},serializedName:"FlaggedText",required:!0,type:{name:Xe}},metadata:{serializedName:"Metadata",type:{name:et,element:{type:{name:Ye,className:"Metadatum"}}}},substrateEventCustomFields:{serializedName:"SubstrateEventCustomFields",type:{name:"Dictionary",value:{type:{name:"any"}}}},suggestions:{serializedName:"Suggestions",type:{name:et,element:{type:{name:Xe}}}},suggestionText:{constraints:{MaxLength:2e4},serializedName:"SuggestionText",type:{name:Xe}}})),Nt=rt("BrowserExtensionResponseV1",Object.assign(Object.assign(Object.assign(Object.assign({},ot.type.modelProperties),at.type.modelProperties),nt([["UseTileCheck","Boolean",void 0,!1],["Descriptors",Xe],["StyleObserverIntervalTime",Ze,void 0,0],["StyleSampleTime",Ze,void 0,0],["RootContentMaxLengthInChars",Ze,void 0,2e3],["SchedulerDefaultWaitingTime",Ze,void 0,0],["SchedulerDefaultWaitingTimeIncrement",Ze,void 0,0],["SchedulerDefaultMaxTime",Ze,void 0,0],["RefreshCritiqueWaitingTime",Ze,void 0,0],["RequestCritiqueDelay",Ze,void 0,0],["EnableDirtyRangeAutoRehydration","Boolean",void 0,!1],["TelemetryTenant",Xe],["LogGroupName",Xe],["SendToAria","Boolean",void 0,!1],["IntervalForActivityCleanup",Ze,void 0,0],["MaxAllowedTimeForActivities",Ze,void 0,0],["CalloutHoverTimeout",Ze,void 0,0],["MaxSuggestionItemsDisplayNumber",Ze,void 0,0],["EditorClientState",Ze],["ConfigurationId",Xe]])),{disabledWebSites:{serializedName:"DisabledWebSites",type:{name:et,element:{type:{name:Xe}}}},allowedUrls:{serializedName:"AllowedUrls",type:{name:et,element:{type:{name:Xe}}}},disabledGrammars:{serializedName:"DisabledGrammars",type:{name:et,element:{type:{name:Xe}}}},versionEmergencyOverrides:{serializedName:"VersionEmergencyOverrides",type:{name:"Dictionary",value:{type:{name:Xe}}}},featureFlags:{serializedName:"FeatureFlags",type:{name:"Dictionary",value:{type:{name:Xe}}}},dynamicSettings:{serializedName:"DynamicSettings",type:{name:"Dictionary",value:{type:{name:"any"}}}},spellCheckAttributes:{serializedName:"SpellCheckAttributes",type:{name:et,element:{type:{name:Xe}}}},conflictingElements:{serializedName:"ConflictingElements",type:{name:et,element:{type:{name:Xe}}}},editorCanvas:{serializedName:"EditorCanvas",type:{name:"Dictionary",value:{type:{name:"any"}}}}})),jt=rt("TileCheckResponseV1",Object.assign(Object.assign({},ot.type.modelProperties),{critiques:{serializedName:"Critiques",type:{name:et,element:{type:{name:Ye,className:"TileCheckCritique"}}}}})),Rt=rt("ConfigResponseV2",Object.assign(Object.assign({},ot.type.modelProperties),{critiqueCategoryInfoList:{serializedName:"CritiqueCategoryInfoList",required:!0,type:{name:et,element:{type:{name:Ye,className:"CritiqueCategoryInfo"}}}}})),xt=rt("LanguageInfoResponseV1",Object.assign(Object.assign({},ot.type.modelProperties),{supportedLanguages:{serializedName:"SupportedLanguages",required:!0,type:{name:et,element:{type:{name:Ye,className:"SupportedLanguage"}}}}})),Dt=rt("TileCheckSpan",Object.assign(Object.assign(Object.assign({},ut.type.modelProperties),nt([["Start",Ze,void 0,0],["Length",Ze,void 0,"tileElement.Text.Length - span.Start"],["DoNotCheck","Boolean"]])),{analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}}})),Mt=rt("TileElement",Object.assign(Object.assign(Object.assign(Object.assign({},ut.type.modelProperties),ct.type.modelProperties),nt([["Text",Xe,!0],["IsClean","Boolean"]])),{enabledLanguages:{serializedName:"EnabledLanguages",type:{name:et,element:{type:{name:et,element:{type:{name:Ye,className:"CommonLanguageIdProperty"}}}}}},analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}},spans:{serializedName:"Spans",type:{name:et,element:{type:{name:Ye,className:"TileCheckSpan"}}}}})),Lt=rt("CritiqueTypeOption",Object.assign(Object.assign({},ut.type.modelProperties),nt([["Id","Uuid",!0],["Name",Xe],["TypeName",Xe],["Value",Xe,!0]]))),Bt=rt("SupportedLanguage",Object.assign(Object.assign(Object.assign({},ut.type.modelProperties),ct.type.modelProperties),nt([["SupportedCritiqueTag",Xe]]))),Ft=rt("TileCheckCritique",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},yt.type.modelProperties),vt.type.modelProperties),wt.type.modelProperties),St.type.modelProperties),nt([["BucketId",Ze],["ExplanationTitle",Xe],["ExplanationLabel",Xe],["Explanation",Xe],["Status",Ze],["Tag",Ze]])),{suggestions:{serializedName:"Suggestions",type:{name:et,element:{type:{name:Ye,className:"Suggestion"}}}}})),Ut=rt("EditorServicePostTileCheckHeaders",tt),qt=rt("EditorServiceConfigV2Headers",tt),zt=rt("EditorServiceLanguageinfoHeaders",tt),Wt=rt("EditorServiceInstrumentationHeaders",tt),Vt={parameterPath:["options","contentType"],mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},Gt={parameterPath:"body",mapper:Et},Ht={parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},$t={parameterPath:"$host",mapper:{serializedName:"$host",required:!0,type:{name:"String"}},skipEncoding:!0},Kt={parameterPath:"xCorrelationId",mapper:{serializedName:"X-CorrelationId",type:{name:"Uuid"}}},Jt={parameterPath:"xUserSessionId",mapper:{serializedName:"X-UserSessionId",type:{name:"Uuid"}}},Qt={parameterPath:"xUserId",mapper:{serializedName:"X-UserId",type:{name:"String"}}},Yt={parameterPath:"body",mapper:It},Xt={parameterPath:"xUserComposeSessionId",mapper:{serializedName:"X-UserComposeSessionId",type:{name:"Uuid"}}},Zt={parameterPath:"body",mapper:kt},en={parameterPath:"body",mapper:At},tn={parameterPath:"body",mapper:Pt};class nn extends Je{constructor(e){var t,n;e||(e={});const r="@editor/client-rest-api/2.0.0",i=e.userAgentOptions&&e.userAgentOptions.userAgentPrefix?`${e.userAgentOptions.userAgentPrefix} ${r}`:`${r}`,o=Object.assign(Object.assign(Object.assign({},{requestContentType:"application/json; charset=utf-8"}),e),{userAgentOptions:{userAgentPrefix:i},baseUri:null!==(n=null!==(t=e.endpoint)&&void 0!==t?t:e.baseUri)&&void 0!==n?n:"https://nleditor.osi.officeppe.net/NLEditor"});super(o);let a=!1;if((null==e?void 0:e.pipeline)&&e.pipeline.getOrderedPolicies().length>0){a=e.pipeline.getOrderedPolicies().some((e=>e.name===xe))}e&&e.pipeline&&0!=e.pipeline.getOrderedPolicies().length&&a||(this.pipeline.removePolicy({name:xe}),this.pipeline.addPolicy(Me({credential:null==e?void 0:e.credential,scopes:`${o.credentialScopes}`,challengeCallbacks:{authorizeRequestOnChallenge:Qe}}))),this.pipeline.removePolicy({name:_e}),this.pipeline.removePolicy({name:re}),this.$host=e.$host||"https://nleditor.osi.officeppe.net/NLEditor"}}class rn extends nn{browserextension(e,t){return this.sendOperationRequest({body:e,options:t},ln)}}class on extends nn{postTileCheck(e,t){return this.sendOperationRequest({body:e,options:t},dn)}}class an extends nn{configV2(e,t){return this.sendOperationRequest({body:e,options:t},fn)}}class sn extends nn{languageinfo(e,t){return this.sendOperationRequest({body:e,options:t},hn)}}class un extends nn{instrumentation(e,t){return this.sendOperationRequest({body:e,options:t},pn)}}const cn=function(e={},t=!1){return new E(e,t)}(r,!1),ln={path:"/api/V1/BrowserExtension",httpMethod:"POST",responses:{200:{bodyMapper:Nt},400:{},500:{}},requestBody:Gt,urlParameters:[$t],headerParameters:[Vt,Ht,Kt,Jt,Qt],mediaType:"json",serializer:cn},dn={path:"/api/V1/TileCheck",httpMethod:"POST",responses:{200:{bodyMapper:jt,headersMapper:Ut},400:{},500:{}},requestBody:Yt,urlParameters:[$t],headerParameters:[Vt,Ht,Kt,Jt,Qt,Xt],mediaType:"json",serializer:cn},fn={path:"/Config/V2",httpMethod:"POST",responses:{200:{bodyMapper:Rt,headersMapper:qt},400:{},500:{}},requestBody:Zt,urlParameters:[$t],headerParameters:[Vt,Ht,Kt,Jt,Qt,Xt],mediaType:"json",serializer:cn},hn={path:"/api/V1/LanguageInfo",httpMethod:"POST",responses:{200:{bodyMapper:xt,headersMapper:zt},400:{},500:{}},requestBody:en,urlParameters:[$t],headerParameters:[Vt,Ht,Kt,Jt,Qt],mediaType:"json",serializer:cn},pn={path:"/api/V1/Instrumentation",httpMethod:"POST",responses:{200:{headersMapper:Wt},400:{},500:{}},requestBody:tn,urlParameters:[$t],headerParameters:[Vt,Kt,Jt,Xt,{parameterPath:"authorization",mapper:{serializedName:"Authorization",type:{name:"String"}}},{parameterPath:"serverToServerId",mapper:{serializedName:"ServerToServerId",type:{name:"String"}}}],mediaType:"json",serializer:cn}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var r={};n.r(r),n.d(r,"Descriptor",(function(){return o})),n.d(r,"LookupWords",(function(){return a})),n.d(r,"LookupInput",(function(){return s})),n.d(r,"Synonym",(function(){return u})),n.d(r,"Meaning",(function(){return c})),n.d(r,"LookupResult",(function(){return l})),n.d(r,"LookupOutput",(function(){return d})),n.d(r,"CommonAppIdProperty",(function(){return f})),n.d(r,"CommonLanguageIdProperty",(function(){return h})),n.d(r,"CommonAppVersionProperty",(function(){return p})),n.d(r,"CommonDescriptorsProperty",(function(){return g})),n.d(r,"PostCheckHeaders",(function(){return m}));var i=n(203);const o={serializedName:"Descriptor",type:{name:"Composite",className:"Descriptor",modelProperties:{name:{required:!0,serializedName:"Name",type:{name:"String"}},value:{required:!0,serializedName:"Value",type:{name:"String"}}}}},a={serializedName:"LookupWords",type:{name:"Composite",className:"LookupWords",modelProperties:{word:{required:!0,serializedName:"Word",defaultValue:"test",type:{name:"String"}},preContextText:{serializedName:"PreContextText",defaultValue:"",type:{name:"String"}},postContextText:{serializedName:"PostContextText",defaultValue:"",type:{name:"String"}}}}},s={serializedName:"LookupInput",type:{name:"Composite",className:"LookupInput",modelProperties:{appId:{required:!0,serializedName:"AppId",type:{name:"String"}},appVersion:{serializedName:"AppVersion",type:{name:"String"}},descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}},languageId:{required:!0,serializedName:"LanguageId",type:{name:"String"}},lookupWords:{required:!0,serializedName:"LookupWords",type:{name:"Sequence",element:{type:{name:"Composite",className:"LookupWords"}}}},mode:{required:!0,serializedName:"Mode",defaultValue:2,type:{name:"Number"}}}}},u={serializedName:"Synonym",type:{name:"Composite",className:"Synonym",modelProperties:{text:{required:!0,serializedName:"Text",defaultValue:"",type:{name:"String"}},tag:{serializedName:"Tag",defaultValue:"",type:{name:"String"}},tagInt:{serializedName:"TagInt",defaultValue:0,type:{name:"Number"}}}}},c={serializedName:"Meaning",type:{name:"Composite",className:"Meaning",modelProperties:{text:{required:!0,serializedName:"Text",defaultValue:"",type:{name:"String"}},tag:{serializedName:"Tag",defaultValue:"",type:{name:"String"}},tagInt:{serializedName:"TagInt",defaultValue:0,type:{name:"Number"}},synonyms:{required:!0,serializedName:"Synonyms",type:{name:"Sequence",element:{type:{name:"Composite",className:"Synonym"}}}}}}},l={serializedName:"LookupResult",type:{name:"Composite",className:"LookupResult",modelProperties:{word:{required:!0,serializedName:"Word",defaultValue:"",type:{name:"String"}},meanings:{required:!0,serializedName:"Meanings",type:{name:"Sequence",element:{type:{name:"Composite",className:"Meaning"}}}}}}},d={serializedName:"LookupOutput",type:{name:"Composite",className:"LookupOutput",modelProperties:{lookupResults:{required:!0,serializedName:"LookupResults",type:{name:"Sequence",element:{type:{name:"Composite",className:"LookupResult"}}}}}}},f={serializedName:"CommonAppIdProperty",type:{name:"Composite",className:"CommonAppIdProperty",modelProperties:{appId:{serializedName:"AppId",type:{name:"String"}}}}},h={serializedName:"CommonLanguageIdProperty",type:{name:"Composite",className:"CommonLanguageIdProperty",modelProperties:{languageId:{serializedName:"LanguageId",type:{name:"String"}}}}},p={serializedName:"CommonAppVersionProperty",type:{name:"Composite",className:"CommonAppVersionProperty",modelProperties:{appVersion:{serializedName:"AppVersion",type:{name:"String"}}}}},g={serializedName:"CommonDescriptorsProperty",type:{name:"Composite",className:"CommonDescriptorsProperty",modelProperties:{descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}}}}},m={serializedName:"postcheck-headers",type:{name:"Composite",className:"PostCheckHeaders",modelProperties:{xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}}}};var y=n(1040),b=n(444);class v extends y.a{constructor(e){if(e||(e={}),!e.userAgent){const t=b.b();e.userAgent=`@editor/synonym-client-rest-api/1.0.0 ${t}`}super(void 0,e),this.baseUri=e.baseUri||this.baseUri||"https://editor-edog-thesaurus.trafficmanager.net:9443/",this.requestContentType="application/json; charset=utf-8",null!==e.xCorrelationId&&void 0!==e.xCorrelationId&&(this.xCorrelationId=e.xCorrelationId),null!==e.xUserSessionId&&void 0!==e.xUserSessionId&&(this.xUserSessionId=e.xUserSessionId),null!==e.xUserId&&void 0!==e.xUserId&&(this.xUserId=e.xUserId)}}class w extends v{constructor(e){super(e)}postCheck(e,t,n){return this.sendOperationRequest({body:e,options:t},_,n)}}const S=new i.b(r),_={httpMethod:"POST",path:"api/lookup/",headerParameters:[{parameterPath:"xCorrelationId",mapper:{serializedName:"X-CorrelationId",type:{name:"Uuid"}}},{parameterPath:"xUserSessionId",mapper:{serializedName:"X-UserSessionId",type:{name:"Uuid"}}},{parameterPath:"xUserId",mapper:{serializedName:"X-UserId",type:{name:"String"}}}],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},s),{required:!0})},responses:{200:{bodyMapper:d,headersMapper:m},400:{headersMapper:m},500:{headersMapper:m},default:{}},serializer:S}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}y(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&y(e,"error",t,n)}(e,i,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var u=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function d(e,t,n,r){var i,o,a,s;if(c(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=l(e))>0&&a.length>i&&!a.warned){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,s=u,console&&console.warn&&console.warn(s)}return e}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=f.bind(r);return i.listener=n,r.wrapFn=i,i}function p(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):m(i,i.length)}function g(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function y(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var u=i[e];if(void 0===u)return!1;if("function"==typeof u)o(u,this,t);else{var c=u.length,l=m(u,c);for(n=0;n<c;++n)o(l[n],this,t)}return!0},s.prototype.addListener=function(e,t){return d(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return d(this,e,t,!0)},s.prototype.once=function(e,t){return c(t),this.on(e,h(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,h(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,i,o,a;if(c(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},s.prototype.listeners=function(e){return p(this,e,!0)},s.prototype.rawListeners=function(e){return p(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},s.prototype.listenerCount=g,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(e,t,n){(t=e.exports=n(772)).Stream=t,t.Readable=t,t.Writable=n(702),t.Duplex=n(483),t.Transform=n(776),t.PassThrough=n(860)},function(e,t,n){var r=n(530),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function a(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=a),o(i,a),a.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},a.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},function(e,t,n){"use strict";(function(t,r,i){var o=n(628);function a(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=b;var s,u=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?r:o.nextTick;b.WritableState=y;var c=Object.create(n(567));c.inherits=n(531);var l={deprecate:n(858)},d=n(773),f=n(701).Buffer,h=i.Uint8Array||function(){};var p,g=n(774);function m(){}function y(e,t){s=s||n(483),e=e||{};var r=t instanceof s;this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var i=e.highWaterMark,c=e.writableHighWaterMark,l=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(c||0===c)?c:l,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var d=!1===e.decodeStrings;this.decodeStrings=!d,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,i){--t.pendingcb,n?(o.nextTick(i,r),o.nextTick(O,e,t),e._writableState.errorEmitted=!0,e.emit("error",r)):(i(r),e._writableState.errorEmitted=!0,e.emit("error",r),O(e,t))}(e,n,r,t,i);else{var a=_(n);a||n.corked||n.bufferProcessing||!n.bufferedRequest||S(e,n),r?u(w,e,n,a,i):w(e,n,a,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function b(e){if(s=s||n(483),!(p.call(b,this)||this instanceof s))return new b(e);this._writableState=new y(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),d.call(this)}function v(e,t,n,r,i,o,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function w(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),O(e,t)}function S(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),o=t.corkedRequestsFree;o.entry=n;for(var s=0,u=!0;n;)i[s]=n,n.isBuf||(u=!1),n=n.next,s+=1;i.allBuffers=u,v(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new a(t),t.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,l=n.encoding,d=n.callback;if(v(e,t,!1,t.objectMode?1:c.length,c,l,d),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function _(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function T(e,t){e._final((function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),O(e,t)}))}function O(e,t){var n=_(t);return n&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,o.nextTick(T,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}c.inherits(b,d),y.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(y.prototype,"buffer",{get:l.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(b,Symbol.hasInstance,{value:function(e){return!!p.call(this,e)||this===b&&(e&&e._writableState instanceof y)}})):p=function(e){return e instanceof this},b.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},b.prototype.write=function(e,t,n){var r,i=this._writableState,a=!1,s=!i.objectMode&&(r=e,f.isBuffer(r)||r instanceof h);return s&&!f.isBuffer(e)&&(e=function(e){return f.from(e)}(e)),"function"==typeof t&&(n=t,t=null),s?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof n&&(n=m),i.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),o.nextTick(t,n)}(this,n):(s||function(e,t,n,r){var i=!0,a=!1;return null===n?a=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(e.emit("error",a),o.nextTick(r,a),i=!1),i}(this,i,e,n))&&(i.pendingcb++,a=function(e,t,n,r,i,o){if(!n){var a=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=f.from(t,n));return t}(t,r,i);r!==a&&(n=!0,i="buffer",r=a)}var s=t.objectMode?1:r.length;t.length+=s;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else v(e,t,!1,s,r,i,o);return u}(this,i,s,e,t,n)),a},b.prototype.cork=function(){this._writableState.corked++},b.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||S(this,e))},b.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(b.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),b.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},b.prototype._writev=null,b.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(e,t,n){t.ending=!0,O(e,t),n&&(t.finished?o.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,r,n)},Object.defineProperty(b.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),b.prototype.destroy=g.destroy,b.prototype._undestroy=g.undestroy,b.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,n(123),n(354).setImmediate,n(69))},,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(507);function i(e,t){e.isApplying||e.suggestions[0].text&&(null==t||t.addWordToIgnoreList(e.suggestions[0].text,!0))}function o(e){const t=1===e.suggestions.length?e.suggestions[0]:void 0,n=!!t&&!Object(r.d)(t)&&Object(r.e)(e);for(const t of e.suggestions)a(t,n)}function a(e,t){"number"==typeof e.action?(e.action&=-5,t||(e.action|=1)):(e.action.autoCorrect=!1,t||(e.action.changeOnce=!0))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(2),i=n(52),o=n(11),a=n(7),s=n(50);const u=`(${s.a}(${s.g}|${s.d}|${s.h})*${s.e})`,c=`(${s.a}(${s.g})*(${s.h})+)`,l=`(${s.b}(${s.g})*)`,d=`((${s.e})+)`,f=`(${s.a}(${s.g}|${s.d}|${s.h})*(${s.e})+)`,h=[new RegExp(u,"ig"),new RegExp(c,"ig"),new RegExp(l,"ig")],p=[new RegExp(c,"ig"),new RegExp(l,"ig"),new RegExp(d,"ig"),new RegExp(f,"ig")],g=new RegExp(`${u}|${c}|${l}`,"ig"),m=new RegExp(`${c}|${l}\n    |${d}|${f}`,"ig");let y=class{constructor(e){this._hostSettings=e}expandEndRange(e){const t=this._hostSettings.newLineSentenceSeparatorEnabled?p:h;for(const n of t){const t=Object(s.j)(e,n);if(t.length>0&&0===t[0].begin)return t[0].end-1}return this._hostSettings.newLineSentenceSeparatorEnabled?-1:0}isEndPuncSpecialCase(e){const t=Object(s.j)(e,s.i),n=this._hostSettings.newLineSentenceSeparatorEnabled?e.length-1:e.length;return t.some((e=>e.end===n))}findBeginBoundary(e,t,n){const r=this._hostSettings.newLineSentenceSeparatorEnabled?s.f:s.c,i=e.substring(n,t),o=Object(s.j)(i,r);for(let e=o.length-1;e>=0;e-=1){const t=i.substring(0,o[e].end);if(!this.isEndPuncSpecialCase(t)){const t=i.substring(o[e].begin,i.length),r=this.expandEndRange(t);if(this._hostSettings.newLineSentenceSeparatorEnabled?-1===r:!r)continue;return n+o[e].end+r}}return n}findEndBoundary(e,t,n){const r=e.substring(t,n),i=this._hostSettings.newLineSentenceSeparatorEnabled?s.f:s.c,o=Object(s.j)(r,i);for(const e of o){const n=r.substring(0,e.end);if(!this.isEndPuncSpecialCase(n)){const n=r.substring(e.begin,r.length),i=this.expandEndRange(n);if(this._hostSettings.newLineSentenceSeparatorEnabled?-1===i:!i)continue;return t+e.end+i}}return-1}splitInUnits(e){const t=this._hostSettings.newLineSentenceSeparatorEnabled?m:g,n=e.replace(s.i,(e=>"#".repeat(e.length)));return Object(s.j)(n,t).map((e=>e.end))}};y=Object(r.c)([Object(o.a)(),Object(r.f)(0,Object(a.a)(i.a))],y)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),i=n(11);let o=class{findBeginBoundary(e,t,n){const r=e.lastIndexOf("\n",t-1);return-1===r||r<=n?n:r+1}findEndBoundary(e,t,n){const r=e.indexOf("\n",t+1);return-1===r||r>n?-1:r+1}splitInUnits(e){const t=[];let n=-1;do{n=e.indexOf("\n",n+1),-1!==n&&t.push(n+1)}while(-1!==n);return t}};o=Object(r.c)([Object(i.a)()],o)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),i=n(11);let o=class{findBeginBoundary(e,t,n){return Math.min(t,n)}findEndBoundary(e,t,n){return e.length<n?-1:Math.max(t,n)}splitInUnits(e){return[e.length]}};o=Object(r.c)([Object(i.a)()],o)},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(2),i=n(30),o=n(491),a=n(8),s=n(89),u=n(11),c=n(7),l=n(271);let d=class{constructor(e,t){this._proofingPersistedStore=e,this._hostEmitters=t,this._languageValueMap=new Map,this._handleMessage=async e=>{var t;const n=e.message;this._languageValueMap.set(n.language,{languageId:n.language,hasPremiumValue:null===(t=n.hasPremiumValue)||void 0===t||t,hasGrammar:n.hasGrammar}),await this.fireEvents()}}async initialize(){for(const e of this._hostEmitters)e.on(i.a.configV2ResponseEvent,this._handleMessage)}shutDown(){}reset(){this._languageValueMap.clear()}async setLanguageValueFromConfigResponses(e,t,n){const r=Object(o.a)(e,t);this._languageValueMap.set(n,{languageId:n,hasPremiumValue:r,hasGrammar:-1!==e.findIndex((e=>e.priority&&e.priority>0))}),await this.fireEvents()}async fireEvents(){const e=[];for(const[t,n]of this._languageValueMap)e.push({languageId:t,hasPremiumValue:n.hasPremiumValue,hasGrammar:n.hasGrammar});await this._proofingPersistedStore.write(a.a.CritiqueValuePerLanguage,JSON.stringify(e));for(const t of this._hostEmitters)t.emit(i.a.critiqueValuePerLanguageChanged,{address:void 0,message:e})}};d=Object(r.c)([Object(u.a)(),Object(r.f)(0,Object(c.a)(s.a)),Object(r.f)(1,Object(l.a)(i.c))],d)},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(2),i=n(30),o=n(40),a=n(52),s=n(53),u=n(416),c=n(652),l=n(11),d=n(7),f=n(374);let h=class{constructor(e,t,n,r,i,o){this._userInfoStrategy=e,this._hostEmitter=t,this._editorService=n,this._hostSettings=r,this._logger=i,this._sessionContextProvider=o}async initialize(){this._hostEmitter.on(i.a.instrumentationRequestV1,(async e=>this.handleRequest(e)))}shutDown(){}async handleRequest(e){try{const t=await this._userInfoStrategy.executeAsync(!1);t&&(this._editorService.serverToServerId=JSON.stringify({puid:t.userId,identityProvider:t.identityProvider,tenantId:t.tenantId}));const n=await this._sessionContextProvider();return n.sessionId&&(this._editorService.xUserSessionId=n.sessionId),n.composeSessionId&&(this._editorService.xUserComposeSessionId=n.composeSessionId),Object(f.a)(e.message.descriptors,this._hostSettings.enhancedUpsellEnabled,null==t?void 0:t.licenseType),await this._editorService.instrumentation(e.message),!0}catch(e){this._logger.error(560219268,"Error in sending instrumentation request",e)}return!1}};h=Object(r.c)([Object(l.a)(),Object(r.f)(0,Object(d.a)(o.a)),Object(r.f)(1,Object(d.a)(i.b)),Object(r.f)(2,Object(d.a)(c.c)),Object(r.f)(3,Object(d.a)(a.a)),Object(r.f)(4,Object(d.a)(s.a)),Object(r.f)(5,Object(d.a)(u.a))],h)},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(184),i=n(80),o=n(138),a=n(61),s=n(274);class u extends r.a{constructor(e,t,n,r,a,s,u,c){super(),this._paragraphFinder=e,this._tileNodeId=t,this._critiqueFilterer=n,this._upsellStore=r,this._enabledSettings=a,this._enhancedUpsellEnabled=s,this._autoCorrectionBroker=u,this._logger=c,this._textCache="",this._seqIdCache=0,this.critiqueAction=(e,t)=>{var n;switch(e){case i.a.IgnoreOnce:case i.a.DisableCritiqueType:this._removeCritique(t);break;case i.a.ApplySuggestion:break;default:null===(n=this._logger)||void 0===n||n.error(558952865,"Unexpected and unhandled action type for callback",e)}},this._removeCritique=e=>{if(this._critiques.delete(e)){const e=new Map;for(const t of this._critiques.values())this._addToActive(t,e);this._sendCritiqueMessage(e,this._tileNodeId,void 0,o.a.NewData)}},this._critiques=new Map}setEnabledSettings(e){this._enabledSettings=e}reconcileWithCache(e){const t={firstDiffLeft:0,firstDiffRight:this._textCache.length},n={firstDiffLeft:this._textCache.length,firstDiffRight:0};this.reconcile(e,this._textCache,this._textCache,t,n,this._seqIdCache,!1,void 0)}reconcile(e,t,n,r,i,a,s=!1,u){var c,l;let d=s;this._textCache=n,this._seqIdCache=a;const f=this._critiques.size,h=new Set,p=new Map,g=new Map,m=new Map,y=this._mergeCritiques(e,i,a);for(const e of this._critiques.values()){if(null===(c=this._autoCorrectionBroker)||void 0===c?void 0:c.getAutoCorrectionIsBeingApplied(e)){g.set(e.start,e);continue}const i=t.length-e.start,o=n.length-i;m.set(e.start,o),o>n.length-r.firstDiffRight?(e.start=o,this._addToActive(e,p),g.set(e.start,e),d=!0):r.firstDiffRight?e.start+e.length>=r.firstDiffLeft?d=!0:(this._addToActive(e,p,h),g.set(e.start,e)):e.start+e.length>=r.firstDiffLeft&&t.length!==n.length?d=!0:(this._addToActive(e,p,h),g.set(e.start,e))}if(this._critiques.size||f||h.size||(d=!1),d&&(this._sendCritiqueMessage(p,this._tileNodeId,u,o.a.NewData),this._enhancedUpsellEnabled)){const e=!y&&this._critiques.size===f&&p.size===h.size;this._sendAllCritiquesToUpsellStore(g,this._tileNodeId,e?o.a.ChangeData:o.a.NewData)}for(const[e,t]of this._critiques){if(g.has(e)||!(null===(l=this._autoCorrectionBroker)||void 0===l?void 0:l.getHasAutoCorrectionBeenApplied(t)))continue;const r=m.get(e);void 0!==r&&t.textInContext===n.substring(r,r+t.length)||this.publishEvent("userRevertedAutoCorrection",{critique:t})}this._critiques=g}move(e,t){for(const e of this._critiques.values())e.tileId&&(e.tileId.nodeId=t);setTimeout((()=>{this._sendCritiqueMessage(new Map,e,void 0,o.a.RemoveData)}),0)}get critiques(){return Array.from(this._critiques.values())}_addToActive(e,t,n){var r,o;this._critiqueIsVisible(e)&&(e.priority===i.c.High&&this._enabledSettings.enableSpelling||e.priority===i.c.Medium&&((null===(r=this._upsellStore)||void 0===r?void 0:r.isSquiggleBeingPreviewed(e))||this._enabledSettings.enableGrammar)||e.priority===i.c.Low&&((null===(o=this._upsellStore)||void 0===o?void 0:o.previewPremiumSquiggles)||this._enabledSettings.enableRefinements))&&(t.set(e.start,e),null==n||n.add(e.start))}_critiqueIsVisible(e){this._critiqueFilterer.applyFilters([e]);return!!e.isVisible}_mergeCritiques(e,t,n){var r;if(e){const i=new Map,o=e.filter((e=>{var r;if(e.tileId){const o=this._paragraphFinder.findParagraph(e.tileId.elementId.id);e.start=(null!==(r=null==o?void 0:o.range.offset)&&void 0!==r?r:e.tileId.elementId.offset)+e.start;const a=e.start<t.firstDiffLeft&&e.start+e.length<=t.firstDiffLeft,s=parseInt(e.tileId.seqId,10)===n;if(o||a&&s){const t=this._critiques.get(e.start);return t&&t.start===e.start&&t.length===e.length&&t.priority===e.priority&&(e.traceId=t.traceId),i.set(e.tileId.elementId.id,e.tileId.elementId),!0}}return!1}));for(const[e,t]of this._critiques)for(const n of i.values()){if(null===(r=this._autoCorrectionBroker)||void 0===r?void 0:r.getHasAutoCorrectionBeenApplied(t))continue;const i=n.offset,o=n.offset+n.span,a=t.start,s=t.start+t.length,u=()=>a<i&&s>o,c=()=>s>i&&s<=o;((()=>a>=i&&a<o)()||c()||u())&&this._critiques.delete(e)}for(const e of o)e.length&&this._critiques.set(e.start,e);return!!o.length}return!1}_sendCritiqueMessage(e,t,n,r=o.a.NewData){n&&n.dataFields.push(Object(a.a)("Critique_Reflow",!0)),this.publishEvent("squiggleDataEvent",{tileNodeId:t,critiques:Array.from(e.values()),messageType:r})}_sendAllCritiquesToUpsellStore(e,t,n=o.a.NewData){var r;null===(r=this._upsellStore)||void 0===r||r.processCritiques(n,[{elementId:t,critiques:Array.from(e.values()).map(s.d)}])}}class c extends r.a{constructor(e,t,n,r,i,o){super(),this._critiqueFilterer=e,this._paragraphFinder=t,this._upsellStore=n,this._enhancedUpsellEnabled=r,this._enabledSettings=i,this._autoCorrectionBroker=o,this._critiqueBrokers=new Map,this._critiquesBrokerCleanupHandlers=[],this._disposed=!1}get disposed(){return this._disposed}async dispose(){if(!this._disposed){for(const e of this._critiquesBrokerCleanupHandlers)e();this._critiqueBrokers.clear(),this._disposed=!0}}setEnabledSettings(e){this._enabledSettings=e}processBrokerCritiqueAction(e){this.getCritiqueBroker(e.tileNodeId).critiqueAction(e.actionType,e.offset)}processBrokerMove(e){this.getCritiqueBroker(e.oldNodeId).move(e.oldNodeId,e.newNodeId)}reconcileCritiques(e,t){var n;null===(n=this._critiqueBrokers.get(e))||void 0===n||n.reconcileWithCache(t)}processBrokerReconcile(e){this.getCritiqueBroker(e.tileNodeId).reconcile(e.critiques,e.oldText,e.newText,e.minDiffBounds,e.maxDiffBounds,e.seqId,e.forceReflow)}getCritiqueBroker(e){let t=this._critiqueBrokers.get(e);return t?t.setEnabledSettings(this._enabledSettings):t=this.initializeCritiqueBroker(e),t}initializeCritiqueBroker(e){const t=new u(this._paragraphFinder,e,this._critiqueFilterer,this._upsellStore,this._enabledSettings,this._enhancedUpsellEnabled,this._autoCorrectionBroker);this._critiqueBrokers.set(e,t);const n=async e=>this.publishEvent("squiggleDataEvent",e),r=async e=>this.publishEvent("userRevertedAutoCorrection",{critique:e.critique});return t.subscribe("squiggleDataEvent",n),t.subscribe("userRevertedAutoCorrection",r),this._critiquesBrokerCleanupHandlers.push((()=>{t.unsubscribe("squiggleDataEvent",n),t.unsubscribe("userRevertedAutoCorrection",r)})),t}}},,,function(e,t,n){e.exports=i;var r=n(699).EventEmitter;function i(){r.call(this)}n(531)(i,r),i.Readable=n(700),i.Writable=n(861),i.Duplex=n(862),i.Transform=n(863),i.PassThrough=n(864),i.Stream=i,i.prototype.pipe=function(e,t){var n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),e.on("drain",o),e._isStdio||t&&!1===t.end||(n.on("end",s),n.on("close",u));var a=!1;function s(){a||(a=!0,e.end())}function u(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function c(e){if(l(),0===r.listenerCount(this,"error"))throw e}function l(){n.removeListener("data",i),e.removeListener("drain",o),n.removeListener("end",s),n.removeListener("close",u),n.removeListener("error",c),e.removeListener("error",c),n.removeListener("end",l),n.removeListener("close",l),e.removeListener("close",l)}return n.on("error",c),e.on("error",c),n.on("end",l),n.on("close",l),e.on("close",l),e.emit("pipe",n),e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IWordCountDetector")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("ITextUnitChunker")},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));const{AugLoopTextEncoder:r,AugLoopTextDecoder:i}=(()=>{if("undefined"==typeof TextEncoder){n(873);const e={AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder};return TextEncoder=void 0,TextDecoder=void 0,e}return{AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder}})()},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";(function(t,r){var i=n(628);e.exports=v;var o,a=n(771);v.ReadableState=b;n(699).EventEmitter;var s=function(e,t){return e.listeners(t).length},u=n(773),c=n(701).Buffer,l=t.Uint8Array||function(){};var d=Object.create(n(567));d.inherits=n(531);var f=n(855),h=void 0;h=f&&f.debuglog?f.debuglog("stream"):function(){};var p,g=n(856),m=n(774);d.inherits(v,u);var y=["error","close","destroy","pause","resume"];function b(e,t){e=e||{};var r=t instanceof(o=o||n(483));this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,a=e.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(a||0===a)?a:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(p||(p=n(775).StringDecoder),this.decoder=new p(e.encoding),this.encoding=e.encoding)}function v(e){if(o=o||n(483),!(this instanceof v))return new v(e);this._readableState=new b(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),u.call(this)}function w(e,t,n,r,i){var o,a=e._readableState;null===t?(a.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,O(e)}(e,a)):(i||(o=function(e,t){var n;r=t,c.isBuffer(r)||r instanceof l||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));var r;return n}(a,t)),o?e.emit("error",o):a.objectMode||t&&t.length>0?("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===c.prototype||(t=function(e){return c.from(e)}(t)),r?a.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):S(e,a,t,!0):a.ended?e.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!n?(t=a.decoder.write(t),a.objectMode||0!==t.length?S(e,a,t,!1):E(e,a)):S(e,a,t,!1))):r||(a.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(a)}function S(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&O(e)),E(e,t)}Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),v.prototype.destroy=m.destroy,v.prototype._undestroy=m.undestroy,v.prototype._destroy=function(e,t){this.push(null),t(e)},v.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=c.from(e,t),t=""),n=!0),w(this,e,t,!1,n)},v.prototype.unshift=function(e){return w(this,e,null,!0,!1)},v.prototype.isPaused=function(){return!1===this._readableState.flowing},v.prototype.setEncoding=function(e){return p||(p=n(775).StringDecoder),this._readableState.decoder=new p(e),this._readableState.encoding=e,this};var _=8388608;function T(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=_?e=_:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function O(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(h("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?i.nextTick(C,e):C(e))}function C(e){h("emit readable"),e.emit("readable"),P(e)}function E(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(I,e,t))}function I(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(h("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function k(e){h("readable nexttick read 0"),e.read(0)}function A(e,t){t.reading||(h("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),P(e),t.flowing&&!t.reading&&e.read(0)}function P(e){var t=e._readableState;for(h("flow",t.flowing);t.flowing&&null!==e.read(););}function N(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var r;e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,r=1,i=n.data;e-=i.length;for(;n=n.next;){var o=n.data,a=e>o.length?o.length:e;if(a===o.length?i+=o:i+=o.slice(0,e),0===(e-=a)){a===o.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(a));break}++r}return t.length-=r,i}(e,t):function(e,t){var n=c.allocUnsafe(e),r=t.head,i=1;r.data.copy(n),e-=r.data.length;for(;r=r.next;){var o=r.data,a=e>o.length?o.length:e;if(o.copy(n,n.length-e,0,a),0===(e-=a)){a===o.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(a));break}++i}return t.length-=i,n}(e,t);return r}(e,t.buffer,t.decoder),n);var n}function j(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,i.nextTick(R,t,e))}function R(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function x(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}v.prototype.read=function(e){h("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return h("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?j(this):O(this),null;if(0===(e=T(e,t))&&t.ended)return 0===t.length&&j(this),null;var r,i=t.needReadable;return h("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&h("length less than watermark",i=!0),t.ended||t.reading?h("reading or ended",i=!1):i&&(h("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=T(n,t))),null===(r=e>0?N(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&j(this)),null!==r&&this.emit("data",r),r},v.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},v.prototype.pipe=function(e,t){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,h("pipe count=%d opts=%j",o.pipesCount,t);var u=(!t||!1!==t.end)&&e!==r.stdout&&e!==r.stderr?l:v;function c(t,r){h("onunpipe"),t===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,h("cleanup"),e.removeListener("close",y),e.removeListener("finish",b),e.removeListener("drain",d),e.removeListener("error",m),e.removeListener("unpipe",c),n.removeListener("end",l),n.removeListener("end",v),n.removeListener("data",g),f=!0,!o.awaitDrain||e._writableState&&!e._writableState.needDrain||d())}function l(){h("onend"),e.end()}o.endEmitted?i.nextTick(u):n.once("end",u),e.on("unpipe",c);var d=function(e){return function(){var t=e._readableState;h("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,P(e))}}(n);e.on("drain",d);var f=!1;var p=!1;function g(t){h("ondata"),p=!1,!1!==e.write(t)||p||((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==x(o.pipes,e))&&!f&&(h("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,p=!0),n.pause())}function m(t){h("onerror",t),v(),e.removeListener("error",m),0===s(e,"error")&&e.emit("error",t)}function y(){e.removeListener("finish",b),v()}function b(){h("onfinish"),e.removeListener("close",y),v()}function v(){h("unpipe"),n.unpipe(e)}return n.on("data",g),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?a(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",m),e.once("close",y),e.once("finish",b),e.emit("pipe",n),o.flowing||(h("pipe resume"),n.resume()),e},v.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,n);return this}var a=x(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},v.prototype.on=function(e,t){var n=u.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&O(this):i.nextTick(k,this))}return n},v.prototype.addListener=v.prototype.on,v.prototype.resume=function(){var e=this._readableState;return e.flowing||(h("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(A,e,t))}(this,e)),this},v.prototype.pause=function(){return h("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(h("pause"),this._readableState.flowing=!1,this.emit("pause")),this},v.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",(function(){if(h("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(h("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i)||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<y.length;o++)e.on(y[o],this.emit.bind(this,y[o]));return this._read=function(t){h("wrapped _read",t),r&&(r=!1,e.resume())},this},Object.defineProperty(v.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),v._fromList=N}).call(this,n(69),n(123))},function(e,t,n){e.exports=n(699).EventEmitter},function(e,t,n){"use strict";var r=n(628);function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var n=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return o||a?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(r.nextTick(i,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,n){"use strict";var r=n(859).Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=u,this.end=c,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=l,this.end=d,t=3;break;default:return this.write=f,void(this.end=h)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var t=this.lastTotal-this.lastNeed,n=function(e,t){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function u(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function l(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function f(e){return e.toString(this.encoding)}function h(e){return e&&e.length?this.write(e):""}t.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},o.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=a(t[r]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if(i=a(t[r]),i>=0)return i>0&&(e.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if(i=a(t[r]),i>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,n){"use strict";e.exports=a;var r=n(483),i=Object.create(n(567));function o(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function a(e){if(!(this instanceof a))return new a(e);r.call(this,e),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",s)}function s(){var e=this;"function"==typeof this._flush?this._flush((function(t,n){u(e,t,n)})):u(this,null,null)}function u(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=n(531),i.inherits(a,r),a.prototype.push=function(e,t){return this._transformState.needTransform=!1,r.prototype.push.call(this,e,t)},a.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},a.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},a.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},a.prototype._destroy=function(e,t){var n=this;r.prototype._destroy.call(this,e,(function(e){t(e),n.emit("close")}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(2),i=n(57),o=n(55),a=n(27),s=n(74),u=n(53),c=n(85),l=n(102),d=n(13),f=n(11),h=n(7);let p=class{constructor(e,t,n,r){this._emitter=e,this._storeEntryReader=t,this._featureFlagsReader=n,this._logger=r,this._rolloutDynamicSettings=Object(d.b)(d.a.DynamicSettings,{}),this._currentProfile={}}async initialize(){this._emitter.on(d.a.DynamicSettings,(()=>{this._websiteUrl&&this.updateSettings()}))}shutDown(){}get settings(){return this._currentProfile}async refreshSettingsForWebsite(e){return this._websiteUrl!==e&&(this._websiteUrl=e,await this.updateSettings()),this.settings}mergeProfiles(e,t){return Object.assign(Object.assign(Object.assign({},e),t),{flagOverrides:Object.assign(Object.assign({},e.flagOverrides),t.flagOverrides)})}aggregateSettingsProfilesForURL(e={},t,n){var r;for(const n of null!==(r=e.profileNames)&&void 0!==r?r:[])this._currentProfile=this.mergeProfiles(this._currentProfile,t[n]);if(e.subPages&&"/"!==n.pathname){let r=n.hostname;for(const i of n.pathname.split("/").filter((e=>!!e)))if(r+="/"+i,void 0!==e.subPages[r])return this.aggregateSettingsProfilesForURL(e.subPages[r],t,n)}}evaluateAndApplySettings(e){if(!this._websiteUrl)return;this._currentProfile=Object.assign({},e.profiles.default);const t=new URL(this._websiteUrl);this.aggregateSettingsProfilesForURL(e.websites[t.hostname],e.profiles,t),this._currentProfile.flagOverrides&&this._featureFlagsReader.overrideFlags(this._currentProfile.flagOverrides)}async updateSettings(){try{const e=await this._storeEntryReader.readOrInitialize(this._rolloutDynamicSettings);this.evaluateAndApplySettings(e)}catch(e){this._logger.logEvent(508703316,i.a.DynamicSettingsParsingError,o.a.Error,void 0,a.a.SamplingPolicy.Diagnostics)}}};p=Object(r.c)([Object(f.a)(),Object(r.f)(0,Object(h.a)(c.a)),Object(r.f)(1,Object(h.a)(l.a)),Object(r.f)(2,Object(h.a)(s.a)),Object(r.f)(3,Object(h.a)(u.a))],p)},,,,,,,,,,,,,,function(e,t){var n=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},r=-1;n.Diff=function(e,t){return[e,t]},n.prototype.diff_main=function(e,t,r,i){void 0===i&&(i=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var o=i;if(null==e||null==t)throw new Error("Null input. (diff_main)");if(e==t)return e?[new n.Diff(0,e)]:[];void 0===r&&(r=!0);var a=r,s=this.diff_commonPrefix(e,t),u=e.substring(0,s);e=e.substring(s),t=t.substring(s),s=this.diff_commonSuffix(e,t);var c=e.substring(e.length-s);e=e.substring(0,e.length-s),t=t.substring(0,t.length-s);var l=this.diff_compute_(e,t,a,o);return u&&l.unshift(new n.Diff(0,u)),c&&l.push(new n.Diff(0,c)),this.diff_cleanupMerge(l),l},n.prototype.diff_compute_=function(e,t,i,o){var a;if(!e)return[new n.Diff(1,t)];if(!t)return[new n.Diff(r,e)];var s=e.length>t.length?e:t,u=e.length>t.length?t:e,c=s.indexOf(u);if(-1!=c)return a=[new n.Diff(1,s.substring(0,c)),new n.Diff(0,u),new n.Diff(1,s.substring(c+u.length))],e.length>t.length&&(a[0][0]=a[2][0]=r),a;if(1==u.length)return[new n.Diff(r,e),new n.Diff(1,t)];var l=this.diff_halfMatch_(e,t);if(l){var d=l[0],f=l[1],h=l[2],p=l[3],g=l[4],m=this.diff_main(d,h,i,o),y=this.diff_main(f,p,i,o);return m.concat([new n.Diff(0,g)],y)}return i&&e.length>100&&t.length>100?this.diff_lineMode_(e,t,o):this.diff_bisect_(e,t,o)},n.prototype.diff_lineMode_=function(e,t,i){var o=this.diff_linesToChars_(e,t);e=o.chars1,t=o.chars2;var a=o.lineArray,s=this.diff_main(e,t,!1,i);this.diff_charsToLines_(s,a),this.diff_cleanupSemantic(s),s.push(new n.Diff(0,""));for(var u=0,c=0,l=0,d="",f="";u<s.length;){switch(s[u][0]){case 1:l++,f+=s[u][1];break;case r:c++,d+=s[u][1];break;case 0:if(c>=1&&l>=1){s.splice(u-c-l,c+l),u=u-c-l;for(var h=this.diff_main(d,f,!1,i),p=h.length-1;p>=0;p--)s.splice(u,0,h[p]);u+=h.length}l=0,c=0,d="",f=""}u++}return s.pop(),s},n.prototype.diff_bisect_=function(e,t,i){for(var o=e.length,a=t.length,s=Math.ceil((o+a)/2),u=s,c=2*s,l=new Array(c),d=new Array(c),f=0;f<c;f++)l[f]=-1,d[f]=-1;l[u+1]=0,d[u+1]=0;for(var h=o-a,p=h%2!=0,g=0,m=0,y=0,b=0,v=0;v<s&&!((new Date).getTime()>i);v++){for(var w=-v+g;w<=v-m;w+=2){for(var S=u+w,_=(I=w==-v||w!=v&&l[S-1]<l[S+1]?l[S+1]:l[S-1]+1)-w;I<o&&_<a&&e.charAt(I)==t.charAt(_);)I++,_++;if(l[S]=I,I>o)m+=2;else if(_>a)g+=2;else if(p){if((C=u+h-w)>=0&&C<c&&-1!=d[C])if(I>=(O=o-d[C]))return this.diff_bisectSplit_(e,t,I,_,i)}}for(var T=-v+y;T<=v-b;T+=2){for(var O,C=u+T,E=(O=T==-v||T!=v&&d[C-1]<d[C+1]?d[C+1]:d[C-1]+1)-T;O<o&&E<a&&e.charAt(o-O-1)==t.charAt(a-E-1);)O++,E++;if(d[C]=O,O>o)b+=2;else if(E>a)y+=2;else if(!p){if((S=u+h-T)>=0&&S<c&&-1!=l[S]){var I;_=u+(I=l[S])-S;if(I>=(O=o-O))return this.diff_bisectSplit_(e,t,I,_,i)}}}}return[new n.Diff(r,e),new n.Diff(1,t)]},n.prototype.diff_bisectSplit_=function(e,t,n,r,i){var o=e.substring(0,n),a=t.substring(0,r),s=e.substring(n),u=t.substring(r),c=this.diff_main(o,a,!1,i),l=this.diff_main(s,u,!1,i);return c.concat(l)},n.prototype.diff_linesToChars_=function(e,t){var n=[],r={};function i(e){for(var t="",i=0,a=-1,s=n.length;a<e.length-1;){-1==(a=e.indexOf("\n",i))&&(a=e.length-1);var u=e.substring(i,a+1);(r.hasOwnProperty?r.hasOwnProperty(u):void 0!==r[u])?t+=String.fromCharCode(r[u]):(s==o&&(u=e.substring(i),a=e.length),t+=String.fromCharCode(s),r[u]=s,n[s++]=u),i=a+1}return t}n[0]="";var o=4e4,a=i(e);return o=65535,{chars1:a,chars2:i(t),lineArray:n}},n.prototype.diff_charsToLines_=function(e,t){for(var n=0;n<e.length;n++){for(var r=e[n][1],i=[],o=0;o<r.length;o++)i[o]=t[r.charCodeAt(o)];e[n][1]=i.join("")}},n.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(o,i)==t.substring(o,i)?o=n=i:r=i,i=Math.floor((r-n)/2+n);return i},n.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(e.length-i,e.length-o)==t.substring(t.length-i,t.length-o)?o=n=i:r=i,i=Math.floor((r-n)/2+n);return i},n.prototype.diff_commonOverlap_=function(e,t){var n=e.length,r=t.length;if(0==n||0==r)return 0;n>r?e=e.substring(n-r):n<r&&(t=t.substring(0,n));var i=Math.min(n,r);if(e==t)return i;for(var o=0,a=1;;){var s=e.substring(i-a),u=t.indexOf(s);if(-1==u)return o;a+=u,0!=u&&e.substring(i-a)!=t.substring(0,a)||(o=a,a++)}},n.prototype.diff_halfMatch_=function(e,t){if(this.Diff_Timeout<=0)return null;var n=e.length>t.length?e:t,r=e.length>t.length?t:e;if(n.length<4||2*r.length<n.length)return null;var i=this;function o(e,t,n){for(var r,o,a,s,u=e.substring(n,n+Math.floor(e.length/4)),c=-1,l="";-1!=(c=t.indexOf(u,c+1));){var d=i.diff_commonPrefix(e.substring(n),t.substring(c)),f=i.diff_commonSuffix(e.substring(0,n),t.substring(0,c));l.length<f+d&&(l=t.substring(c-f,c)+t.substring(c,c+d),r=e.substring(0,n-f),o=e.substring(n+d),a=t.substring(0,c-f),s=t.substring(c+d))}return 2*l.length>=e.length?[r,o,a,s,l]:null}var a,s,u,c,l,d=o(n,r,Math.ceil(n.length/4)),f=o(n,r,Math.ceil(n.length/2));return d||f?(a=f?d&&d[4].length>f[4].length?d:f:d,e.length>t.length?(s=a[0],u=a[1],c=a[2],l=a[3]):(c=a[0],l=a[1],s=a[2],u=a[3]),[s,u,c,l,a[4]]):null},n.prototype.diff_cleanupSemantic=function(e){for(var t=!1,i=[],o=0,a=null,s=0,u=0,c=0,l=0,d=0;s<e.length;)0==e[s][0]?(i[o++]=s,u=l,c=d,l=0,d=0,a=e[s][1]):(1==e[s][0]?l+=e[s][1].length:d+=e[s][1].length,a&&a.length<=Math.max(u,c)&&a.length<=Math.max(l,d)&&(e.splice(i[o-1],0,new n.Diff(r,a)),e[i[o-1]+1][0]=1,o--,s=--o>0?i[o-1]:-1,u=0,c=0,l=0,d=0,a=null,t=!0)),s++;for(t&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),s=1;s<e.length;){if(e[s-1][0]==r&&1==e[s][0]){var f=e[s-1][1],h=e[s][1],p=this.diff_commonOverlap_(f,h),g=this.diff_commonOverlap_(h,f);p>=g?(p>=f.length/2||p>=h.length/2)&&(e.splice(s,0,new n.Diff(0,h.substring(0,p))),e[s-1][1]=f.substring(0,f.length-p),e[s+1][1]=h.substring(p),s++):(g>=f.length/2||g>=h.length/2)&&(e.splice(s,0,new n.Diff(0,f.substring(0,g))),e[s-1][0]=1,e[s-1][1]=h.substring(0,h.length-g),e[s+1][0]=r,e[s+1][1]=f.substring(g),s++),s++}s++}},n.prototype.diff_cleanupSemanticLossless=function(e){function t(e,t){if(!e||!t)return 6;var r=e.charAt(e.length-1),i=t.charAt(0),o=r.match(n.nonAlphaNumericRegex_),a=i.match(n.nonAlphaNumericRegex_),s=o&&r.match(n.whitespaceRegex_),u=a&&i.match(n.whitespaceRegex_),c=s&&r.match(n.linebreakRegex_),l=u&&i.match(n.linebreakRegex_),d=c&&e.match(n.blanklineEndRegex_),f=l&&t.match(n.blanklineStartRegex_);return d||f?5:c||l?4:o&&!s&&u?3:s||u?2:o||a?1:0}for(var r=1;r<e.length-1;){if(0==e[r-1][0]&&0==e[r+1][0]){var i=e[r-1][1],o=e[r][1],a=e[r+1][1],s=this.diff_commonSuffix(i,o);if(s){var u=o.substring(o.length-s);i=i.substring(0,i.length-s),o=u+o.substring(0,o.length-s),a=u+a}for(var c=i,l=o,d=a,f=t(i,o)+t(o,a);o.charAt(0)===a.charAt(0);){i+=o.charAt(0),o=o.substring(1)+a.charAt(0),a=a.substring(1);var h=t(i,o)+t(o,a);h>=f&&(f=h,c=i,l=o,d=a)}e[r-1][1]!=c&&(c?e[r-1][1]=c:(e.splice(r-1,1),r--),e[r][1]=l,d?e[r+1][1]=d:(e.splice(r+1,1),r--))}r++}},n.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,n.whitespaceRegex_=/\s/,n.linebreakRegex_=/[\r\n]/,n.blanklineEndRegex_=/\n\r?\n$/,n.blanklineStartRegex_=/^\r?\n\r?\n/,n.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,i=[],o=0,a=null,s=0,u=!1,c=!1,l=!1,d=!1;s<e.length;)0==e[s][0]?(e[s][1].length<this.Diff_EditCost&&(l||d)?(i[o++]=s,u=l,c=d,a=e[s][1]):(o=0,a=null),l=d=!1):(e[s][0]==r?d=!0:l=!0,a&&(u&&c&&l&&d||a.length<this.Diff_EditCost/2&&u+c+l+d==3)&&(e.splice(i[o-1],0,new n.Diff(r,a)),e[i[o-1]+1][0]=1,o--,a=null,u&&c?(l=d=!0,o=0):(s=--o>0?i[o-1]:-1,l=d=!1),t=!0)),s++;t&&this.diff_cleanupMerge(e)},n.prototype.diff_cleanupMerge=function(e){e.push(new n.Diff(0,""));for(var t,i=0,o=0,a=0,s="",u="";i<e.length;)switch(e[i][0]){case 1:a++,u+=e[i][1],i++;break;case r:o++,s+=e[i][1],i++;break;case 0:o+a>1?(0!==o&&0!==a&&(0!==(t=this.diff_commonPrefix(u,s))&&(i-o-a>0&&0==e[i-o-a-1][0]?e[i-o-a-1][1]+=u.substring(0,t):(e.splice(0,0,new n.Diff(0,u.substring(0,t))),i++),u=u.substring(t),s=s.substring(t)),0!==(t=this.diff_commonSuffix(u,s))&&(e[i][1]=u.substring(u.length-t)+e[i][1],u=u.substring(0,u.length-t),s=s.substring(0,s.length-t))),i-=o+a,e.splice(i,o+a),s.length&&(e.splice(i,0,new n.Diff(r,s)),i++),u.length&&(e.splice(i,0,new n.Diff(1,u)),i++),i++):0!==i&&0==e[i-1][0]?(e[i-1][1]+=e[i][1],e.splice(i,1)):i++,a=0,o=0,s="",u=""}""===e[e.length-1][1]&&e.pop();var c=!1;for(i=1;i<e.length-1;)0==e[i-1][0]&&0==e[i+1][0]&&(e[i][1].substring(e[i][1].length-e[i-1][1].length)==e[i-1][1]?(e[i][1]=e[i-1][1]+e[i][1].substring(0,e[i][1].length-e[i-1][1].length),e[i+1][1]=e[i-1][1]+e[i+1][1],e.splice(i-1,1),c=!0):e[i][1].substring(0,e[i+1][1].length)==e[i+1][1]&&(e[i-1][1]+=e[i+1][1],e[i][1]=e[i][1].substring(e[i+1][1].length)+e[i+1][1],e.splice(i+1,1),c=!0)),i++;c&&this.diff_cleanupMerge(e)},n.prototype.diff_xIndex=function(e,t){var n,i=0,o=0,a=0,s=0;for(n=0;n<e.length&&(1!==e[n][0]&&(i+=e[n][1].length),e[n][0]!==r&&(o+=e[n][1].length),!(i>t));n++)a=i,s=o;return e.length!=n&&e[n][0]===r?s:s+(t-a)},n.prototype.diff_prettyHtml=function(e){for(var t=[],n=/&/g,i=/</g,o=/>/g,a=/\n/g,s=0;s<e.length;s++){var u=e[s][0],c=e[s][1].replace(n,"&amp;").replace(i,"&lt;").replace(o,"&gt;").replace(a,"&para;<br>");switch(u){case 1:t[s]='<ins style="background:#e6ffe6;">'+c+"</ins>";break;case r:t[s]='<del style="background:#ffe6e6;">'+c+"</del>";break;case 0:t[s]="<span>"+c+"</span>"}}return t.join("")},n.prototype.diff_text1=function(e){for(var t=[],n=0;n<e.length;n++)1!==e[n][0]&&(t[n]=e[n][1]);return t.join("")},n.prototype.diff_text2=function(e){for(var t=[],n=0;n<e.length;n++)e[n][0]!==r&&(t[n]=e[n][1]);return t.join("")},n.prototype.diff_levenshtein=function(e){for(var t=0,n=0,i=0,o=0;o<e.length;o++){var a=e[o][0],s=e[o][1];switch(a){case 1:n+=s.length;break;case r:i+=s.length;break;case 0:t+=Math.max(n,i),n=0,i=0}}return t+=Math.max(n,i)},n.prototype.diff_toDelta=function(e){for(var t=[],n=0;n<e.length;n++)switch(e[n][0]){case 1:t[n]="+"+encodeURI(e[n][1]);break;case r:t[n]="-"+e[n][1].length;break;case 0:t[n]="="+e[n][1].length}return t.join("\t").replace(/%20/g," ")},n.prototype.diff_fromDelta=function(e,t){for(var i=[],o=0,a=0,s=t.split(/\t/g),u=0;u<s.length;u++){var c=s[u].substring(1);switch(s[u].charAt(0)){case"+":try{i[o++]=new n.Diff(1,decodeURI(c))}catch(e){throw new Error("Illegal escape in diff_fromDelta: "+c)}break;case"-":case"=":var l=parseInt(c,10);if(isNaN(l)||l<0)throw new Error("Invalid number in diff_fromDelta: "+c);var d=e.substring(a,a+=l);"="==s[u].charAt(0)?i[o++]=new n.Diff(0,d):i[o++]=new n.Diff(r,d);break;default:if(s[u])throw new Error("Invalid diff operation in diff_fromDelta: "+s[u])}}if(a!=e.length)throw new Error("Delta length ("+a+") does not equal source text length ("+e.length+").");return i},n.prototype.match_main=function(e,t,n){if(null==e||null==t||null==n)throw new Error("Null input. (match_main)");return n=Math.max(0,Math.min(n,e.length)),e==t?0:e.length?e.substring(n,n+t.length)==t?n:this.match_bitap_(e,t,n):-1},n.prototype.match_bitap_=function(e,t,n){if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var r=this.match_alphabet_(t),i=this;function o(e,r){var o=e/t.length,a=Math.abs(n-r);return i.Match_Distance?o+a/i.Match_Distance:a?1:o}var a=this.Match_Threshold,s=e.indexOf(t,n);-1!=s&&(a=Math.min(o(0,s),a),-1!=(s=e.lastIndexOf(t,n+t.length))&&(a=Math.min(o(0,s),a)));var u,c,l=1<<t.length-1;s=-1;for(var d,f=t.length+e.length,h=0;h<t.length;h++){for(u=0,c=f;u<c;)o(h,n+c)<=a?u=c:f=c,c=Math.floor((f-u)/2+u);f=c;var p=Math.max(1,n-c+1),g=Math.min(n+c,e.length)+t.length,m=Array(g+2);m[g+1]=(1<<h)-1;for(var y=g;y>=p;y--){var b=r[e.charAt(y-1)];if(m[y]=0===h?(m[y+1]<<1|1)&b:(m[y+1]<<1|1)&b|(d[y+1]|d[y])<<1|1|d[y+1],m[y]&l){var v=o(h,y-1);if(v<=a){if(a=v,!((s=y-1)>n))break;p=Math.max(1,2*n-s)}}}if(o(h+1,n)>a)break;d=m}return s},n.prototype.match_alphabet_=function(e){for(var t={},n=0;n<e.length;n++)t[e.charAt(n)]=0;for(n=0;n<e.length;n++)t[e.charAt(n)]|=1<<e.length-n-1;return t},n.prototype.patch_addContext_=function(e,t){if(0!=t.length){if(null===e.start2)throw Error("patch not initialized");for(var r=t.substring(e.start2,e.start2+e.length1),i=0;t.indexOf(r)!=t.lastIndexOf(r)&&r.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)i+=this.Patch_Margin,r=t.substring(e.start2-i,e.start2+e.length1+i);i+=this.Patch_Margin;var o=t.substring(e.start2-i,e.start2);o&&e.diffs.unshift(new n.Diff(0,o));var a=t.substring(e.start2+e.length1,e.start2+e.length1+i);a&&e.diffs.push(new n.Diff(0,a)),e.start1-=o.length,e.start2-=o.length,e.length1+=o.length+a.length,e.length2+=o.length+a.length}},n.prototype.patch_make=function(e,t,i){var o,a;if("string"==typeof e&&"string"==typeof t&&void 0===i)o=e,(a=this.diff_main(o,t,!0)).length>2&&(this.diff_cleanupSemantic(a),this.diff_cleanupEfficiency(a));else if(e&&"object"==typeof e&&void 0===t&&void 0===i)a=e,o=this.diff_text1(a);else if("string"==typeof e&&t&&"object"==typeof t&&void 0===i)o=e,a=t;else{if("string"!=typeof e||"string"!=typeof t||!i||"object"!=typeof i)throw new Error("Unknown call format to patch_make.");o=e,a=i}if(0===a.length)return[];for(var s=[],u=new n.patch_obj,c=0,l=0,d=0,f=o,h=o,p=0;p<a.length;p++){var g=a[p][0],m=a[p][1];switch(c||0===g||(u.start1=l,u.start2=d),g){case 1:u.diffs[c++]=a[p],u.length2+=m.length,h=h.substring(0,d)+m+h.substring(d);break;case r:u.length1+=m.length,u.diffs[c++]=a[p],h=h.substring(0,d)+h.substring(d+m.length);break;case 0:m.length<=2*this.Patch_Margin&&c&&a.length!=p+1?(u.diffs[c++]=a[p],u.length1+=m.length,u.length2+=m.length):m.length>=2*this.Patch_Margin&&c&&(this.patch_addContext_(u,f),s.push(u),u=new n.patch_obj,c=0,f=h,l=d)}1!==g&&(l+=m.length),g!==r&&(d+=m.length)}return c&&(this.patch_addContext_(u,f),s.push(u)),s},n.prototype.patch_deepCopy=function(e){for(var t=[],r=0;r<e.length;r++){var i=e[r],o=new n.patch_obj;o.diffs=[];for(var a=0;a<i.diffs.length;a++)o.diffs[a]=new n.Diff(i.diffs[a][0],i.diffs[a][1]);o.start1=i.start1,o.start2=i.start2,o.length1=i.length1,o.length2=i.length2,t[r]=o}return t},n.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);t=n+t+n,this.patch_splitMax(e);for(var i=0,o=[],a=0;a<e.length;a++){var s,u,c=e[a].start2+i,l=this.diff_text1(e[a].diffs),d=-1;if(l.length>this.Match_MaxBits?-1!=(s=this.match_main(t,l.substring(0,this.Match_MaxBits),c))&&(-1==(d=this.match_main(t,l.substring(l.length-this.Match_MaxBits),c+l.length-this.Match_MaxBits))||s>=d)&&(s=-1):s=this.match_main(t,l,c),-1==s)o[a]=!1,i-=e[a].length2-e[a].length1;else if(o[a]=!0,i=s-c,l==(u=-1==d?t.substring(s,s+l.length):t.substring(s,d+this.Match_MaxBits)))t=t.substring(0,s)+this.diff_text2(e[a].diffs)+t.substring(s+l.length);else{var f=this.diff_main(l,u,!1);if(l.length>this.Match_MaxBits&&this.diff_levenshtein(f)/l.length>this.Patch_DeleteThreshold)o[a]=!1;else{this.diff_cleanupSemanticLossless(f);for(var h,p=0,g=0;g<e[a].diffs.length;g++){var m=e[a].diffs[g];0!==m[0]&&(h=this.diff_xIndex(f,p)),1===m[0]?t=t.substring(0,s+h)+m[1]+t.substring(s+h):m[0]===r&&(t=t.substring(0,s+h)+t.substring(s+this.diff_xIndex(f,p+m[1].length))),m[0]!==r&&(p+=m[1].length)}}}}return[t=t.substring(n.length,t.length-n.length),o]},n.prototype.patch_addPadding=function(e){for(var t=this.Patch_Margin,r="",i=1;i<=t;i++)r+=String.fromCharCode(i);for(i=0;i<e.length;i++)e[i].start1+=t,e[i].start2+=t;var o=e[0],a=o.diffs;if(0==a.length||0!=a[0][0])a.unshift(new n.Diff(0,r)),o.start1-=t,o.start2-=t,o.length1+=t,o.length2+=t;else if(t>a[0][1].length){var s=t-a[0][1].length;a[0][1]=r.substring(a[0][1].length)+a[0][1],o.start1-=s,o.start2-=s,o.length1+=s,o.length2+=s}if(0==(a=(o=e[e.length-1]).diffs).length||0!=a[a.length-1][0])a.push(new n.Diff(0,r)),o.length1+=t,o.length2+=t;else if(t>a[a.length-1][1].length){s=t-a[a.length-1][1].length;a[a.length-1][1]+=r.substring(0,s),o.length1+=s,o.length2+=s}return r},n.prototype.patch_splitMax=function(e){for(var t=this.Match_MaxBits,i=0;i<e.length;i++)if(!(e[i].length1<=t)){var o=e[i];e.splice(i--,1);for(var a=o.start1,s=o.start2,u="";0!==o.diffs.length;){var c=new n.patch_obj,l=!0;for(c.start1=a-u.length,c.start2=s-u.length,""!==u&&(c.length1=c.length2=u.length,c.diffs.push(new n.Diff(0,u)));0!==o.diffs.length&&c.length1<t-this.Patch_Margin;){var d=o.diffs[0][0],f=o.diffs[0][1];1===d?(c.length2+=f.length,s+=f.length,c.diffs.push(o.diffs.shift()),l=!1):d===r&&1==c.diffs.length&&0==c.diffs[0][0]&&f.length>2*t?(c.length1+=f.length,a+=f.length,l=!1,c.diffs.push(new n.Diff(d,f)),o.diffs.shift()):(f=f.substring(0,t-c.length1-this.Patch_Margin),c.length1+=f.length,a+=f.length,0===d?(c.length2+=f.length,s+=f.length):l=!1,c.diffs.push(new n.Diff(d,f)),f==o.diffs[0][1]?o.diffs.shift():o.diffs[0][1]=o.diffs[0][1].substring(f.length))}u=(u=this.diff_text2(c.diffs)).substring(u.length-this.Patch_Margin);var h=this.diff_text1(o.diffs).substring(0,this.Patch_Margin);""!==h&&(c.length1+=h.length,c.length2+=h.length,0!==c.diffs.length&&0===c.diffs[c.diffs.length-1][0]?c.diffs[c.diffs.length-1][1]+=h:c.diffs.push(new n.Diff(0,h))),l||e.splice(++i,0,c)}}},n.prototype.patch_toText=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n];return t.join("")},n.prototype.patch_fromText=function(e){var t=[];if(!e)return t;for(var i=e.split("\n"),o=0,a=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;o<i.length;){var s=i[o].match(a);if(!s)throw new Error("Invalid patch string: "+i[o]);var u=new n.patch_obj;for(t.push(u),u.start1=parseInt(s[1],10),""===s[2]?(u.start1--,u.length1=1):"0"==s[2]?u.length1=0:(u.start1--,u.length1=parseInt(s[2],10)),u.start2=parseInt(s[3],10),""===s[4]?(u.start2--,u.length2=1):"0"==s[4]?u.length2=0:(u.start2--,u.length2=parseInt(s[4],10)),o++;o<i.length;){var c=i[o].charAt(0);try{var l=decodeURI(i[o].substring(1))}catch(e){throw new Error("Illegal escape in patch_fromText: "+l)}if("-"==c)u.diffs.push(new n.Diff(r,l));else if("+"==c)u.diffs.push(new n.Diff(1,l));else if(" "==c)u.diffs.push(new n.Diff(0,l));else{if("@"==c)break;if(""!==c)throw new Error('Invalid patch mode "'+c+'" in: '+l)}o++}}return t},(n.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){for(var e,t=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],n=0;n<this.diffs.length;n++){switch(this.diffs[n][0]){case 1:e="+";break;case r:e="-";break;case 0:e=" "}t[n+1]=e+encodeURI(this.diffs[n][1])+"\n"}return t.join("").replace(/%20/g," ")},e.exports=n,e.exports.diff_match_patch=n,e.exports.DIFF_DELETE=r,e.exports.DIFF_INSERT=1,e.exports.DIFF_EQUAL=0},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return C}));var r,i=n(2),o=n(11),a=n(7),s=n(174),u=n(53),c=n(180),l=n(74),d=n(616),f=n(36),h=n(92),p=n(793),g=n(189),m=n(64);function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){b(o,r,i,a,s,"next",e)}function s(e){b(o,r,i,a,s,"throw",e)}a(void 0)}))}}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function O(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}!function(e){e.roaming="roaming",e.augLoop="augLoop"}(r||(r={}));var C=function(){function t(e,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Object.defineProperty(this,"logger",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"guidGenerator",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"storage",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"featureFlagsReader",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"defaultTokenConfig",{enumerable:!0,configurable:!0,writable:!0,value:{numberOfFetchTrials:0,maxFetchTrials:3,refreshIntervalInHours:6,retryIntervalInHours:2}}),Object.defineProperty(this,"tokenConfigs",{enumerable:!0,configurable:!0,writable:!0,value:{roaming:this.defaultTokenConfig,augLoop:this.defaultTokenConfig}}),Object.defineProperty(this,"userInfoUrl",{enumerable:!0,configurable:!0,writable:!0,value:"https://graph.microsoft.com/v1.0/me/"}),Object.defineProperty(this,"offscreenCreatePromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"msidUserService",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.initialize()}var n,o,a;return n=t,o=[{key:"initialize",value:function(){var e=this;return v((function(){var t;return O(this,(function(n){switch(n.label){case 0:return t=e,e.msidUserService=new p.a(e.logger,e),chrome.runtime.onMessage.addListener((r=v((function(e,n,r){var i;return O(this,(function(o){switch(e.activity){case f.b.ACTIVITY.LOGOUT.NAME:return t.logout().then((function(){r()})).catch((function(e){t.logger.error(509646604,"logout failed",e)})),[2,!0];case f.b.ACTIVITY.AUTHENTICATION.NAME:return t.login(e.type).then((function(e){r(e)})).catch((function(e){t.logger.error(509646603,"Authentication failed",e)})),[2,!0];case f.b.ACTIVITY.AUTHORIZATION.NAME:return n.id===chrome.runtime.id&&e.close&&((null===(i=n.tab)||void 0===i?void 0:i.id)&&chrome.tabs.remove(n.tab.id),delete e.close),t.authorize(t.unpackStateParam(e)).then((function(){r()})).catch((function(e){t.logger.error(509646602,"Authorize failed",e)})),[2,!0];case f.b.ACTIVITY.REQUEST_TOKEN.NAME:return t.navigateToAuthEndpoint(e.data.url,e.data.type,e.data.inIFrame).then((function(e){r(e)})).catch((function(e){t.logger.error(509646601,"Request token failed",e)})),[2,!0];default:return[2]}return[2]}))})),function(e,t,n){return r.apply(this,arguments)})),[4,e.setupOffscreenDocument()];case 1:return n.sent(),e.renewTokens(),[2]}var r}))}))()}},{key:"isLoggedIn",value:function(){var e=this;return v((function(){var t;return O(this,(function(n){switch(n.label){case 0:return[4,e.storage.get(["userType","identity"])];case 1:return[2,(null==(t=n.sent())?void 0:t.identity)&&(null==t?void 0:t.userType)&&(null==t?void 0:t.userType)!==f.a.NONE]}}))}))()}},{key:"httpRequest",value:function(e){var t=this;return v((function(){var n,r,i;return O(this,(function(o){switch(o.label){case 0:return e?(n=new d.a,r=(new Error).stack,e.headers&&e.headers["X-UserType"]?[4,t.acquireToken(e.headers["X-UserType"],e.url,void 0,!1)]:[3,2]):[2,Promise.reject("Invalid Request")];case 1:i=o.sent(),h.g(i)?t.logger.error(509646600,"failed to get auth token for url ".concat(e.url)):e.headers.Authorization="Bearer ".concat(i.access_token),o.label=2;case 2:return[4,n.fetch(e.url,{method:e.method,headers:e.headers,body:JSON.stringify(e.data)}).then((function(e){return e}),(a=v((function(t){return O(this,(function(t){return[2,Promise.reject("httpRequest failed for url: ".concat(e.url," stack:\n ").concat(r))]}))})),function(e){return a.apply(this,arguments)}))];case 3:return[2,o.sent()]}var a}))}))()}},{key:"getLicenseType",value:function(){var e=this;return v((function(){var t,n,r,i;return O(this,(function(o){switch(o.label){case 0:return[4,e.storage.get(["userType","identity"])];case 1:if(t=o.sent(),!(n=t.userType)||n===f.a.NONE)return[2,void 0];if(!t.identity)return[2,void 0];if(!(null==(r=t.identity[n])?void 0:r.userInfo))return[2,void 0];switch(i=r.userInfo,n){case f.a.O365:return i.activeExperiences&&Array.isArray(i.activeExperiences)?[2,i.activeExperiences.some((function(e){return"OfficeProPlus"===e}))?f.b.LICENSE_TYPE.SUBSCRIPTION:f.b.LICENSE_TYPE.NO_LICENSE]:[2,f.b.LICENSE_TYPE.UNKNOWN];case f.a.MSA:return i.activeSubscriptionProduct?[2,"none"===i.activeSubscriptionProduct?f.b.LICENSE_TYPE.NO_LICENSE:f.b.LICENSE_TYPE.SUBSCRIPTION]:[2,f.b.LICENSE_TYPE.UNKNOWN];case f.a.NONE:default:return[2,void 0]}return[2]}}))}))()}},{key:"navigateToAuthEndpoint",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;return v((function(){var i,o;return O(this,(function(a){switch(a.label){case 0:return i=r,[4,r.getUserInfo()];case 1:return o=a.sent(),[2,new Promise((function(a,s){for(var u,c,l=(e=new URL(e)).searchParams,d=0,p=["state","nonce"];d<p.length;d++){var g=p[d],m=l.get(g);m||(m=r.guidGenerator.generate()),"state"===g&&t&&(m+="|".concat(t,"|").concat(f.b.APPINFO_NAME)),l.set(g,m)}var y=l.get("state");function b(t,n,r){if(t.activity===f.b.ACTIVITY.AUTHORIZATION.NAME){i.logger.debug(509646599,"auth listener received: ".concat(e));var o=i.unpackStateParam(t);if(!o||o.state!==y)return;o.error?i.logger.error(509646598,"auth response received with error"):o.access_token?i.logger.info(509646597,"auth listener received successfully"):i.logger.error(509646596,"auth response received with unknown error"),c&&clearTimeout(c),delete t.activity,v(),a(o)}}function v(){chrome.runtime.onMessage.removeListener(b),chrome.runtime.sendMessage({activity:"cleanupOffscreenIframe",frameId:u})}if(r.logger.info(509646595,"loading auth url ".concat(n?"in iframe":"")),chrome.runtime.onMessage.addListener(b),(null==o?void 0:o.email)&&!l.has("login_hint")&&l.set("login_hint",o.email),n){l.set("prompt","none");var w=l.get("scope");u="authFrame!".concat(w),chrome.runtime.sendMessage({activity:"offscreenIframe",data:e,frameId:u}),c=setTimeout((function(){v(),s("Timed out waiting for response from iFrame")}),6e4)}else h.j(e.toString())}))]}}))}))()}},{key:"addAgeGroupToUserInfo",value:function(){var e=this;return v((function(){var t,n,r;return O(this,(function(i){switch(i.label){case 0:return e.featureFlagsReader.flags.enableAadc?[4,e.getUserType()]:[2];case 1:return(t=i.sent())===f.a.NONE?[2]:[4,e.getIdToken(t)];case 2:return n=i.sent(),[4,e.getAgeGroup(t,n)];case 3:return r=i.sent(),[4,e.saveUserInfo(t,{ageGroup:r},!1)];case 4:return i.sent(),[2]}}))}))()}},{key:"isBetaActiveForCurrentPage",value:function(){var e=this;return v((function(){var t,n,r,i,o;return O(this,(function(a){switch(a.label){case 0:return t=e.featureFlagsReader.flags.enableBetaExperience,[4,e.isLoggedIn()];case 1:return n=a.sent(),t&&n?[4,h.a()]:[2,!1];case 2:return r=a.sent(),[4,e.storage.get("BetaEnrollment")];case 3:return i=a.sent(),o=h.i(i,"BetaEnrollment"),[2,JSON.parse(o).some((function(t){return e.evaluateRegex(r.url,t.url)&&2===t.state}))]}}))}))()}},{key:"addRegionScopeToUserInfo",value:function(e,t){var n=this;return v((function(){var r,i,o,a;return O(this,(function(s){switch(s.label){case 0:return n.featureFlagsReader.flags.enableEditorServiceRouting?null==e?[3,1]:(r=e,[3,3]):[2];case 1:return[4,n.getUserType()];case 2:r=s.sent(),s.label=3;case 3:return e=r,null==t?[3,4]:(i=t,[3,6]);case 4:return[4,n.getUserInfo(e)];case 5:i=s.sent(),s.label=6;case 6:return(null==(t=i)?void 0:t.regionScope)||e!==f.a.O365?[3,12]:[4,n.getTenant(e)];case 7:if(!(o=s.sent()))return[3,12];s.label=8;case 8:return s.trys.push([8,11,,12]),[4,n.fetchRegionScope(o)];case 9:return a=s.sent(),n.logger.info(509646594,"FetchRegionScope",{tenant:o,regionScope:a}),[4,n.saveUserInfo(e,{regionScope:a},!1)];case 10:return s.sent(),[3,12];case 11:return s.sent(),n.logger.error(509646593,"failed fetching region scope"),[3,12];case 12:return[2]}}))}))()}},{key:"refreshLicense",value:function(e){var t=this;return v((function(){var n,r,i;return O(this,(function(o){switch(o.label){case 0:return t.logger.debug(509646592,"Refreshing license"),[4,t.getUserType()];case 1:return(n=o.sent())===f.a.NONE?[2,{refreshed:!1}]:[4,t.getServiceForUserType(n)];case 2:return r=o.sent(),[4,t.getServiceProvider(r)];case 3:return null===(i=o.sent())?[2,{refreshed:!1}]:[4,t.fetchLicenseInfo(e,n,i,!0)];case 4:return[2,{refreshed:!0,data:o.sent()}]}}))}))()}},{key:"onInstall",value:function(){var e=this;return v((function(){var t,n,r,i,o,a;return O(this,(function(s){switch(s.label){case 0:return s.trys.push([0,9,,10]),[4,e.getFlightInformation("enableSignInExperiment","enableAutomaticSignIn")];case 1:return t=s.sent(),n=t.enableSignInExperiment,r=t.enableAutomaticSignIn,n?[4,e.getOrDefineClientId(!1)]:[3,3];case 2:i=s.sent(),e.logger.info(509646563,"AutoSignInExperiment",{isAutoSignInEnabled:r,clientId:i}),s.label=3;case 3:return(a=r)?[4,e.isLoggedIn()]:[3,5];case 4:a=!s.sent(),s.label=5;case 5:return o=a,[4,e.openFileUrlInTab(o)];case 6:return s.sent(),o?[4,e.login(f.b.USER_SERVICE_TYPE.MSID)]:[3,8];case 7:s.sent(),s.label=8;case 8:return[3,10];case 9:return s.sent(),e.logger.error(509646562,"failed to auto sign in"),[3,10];case 10:return[2]}}))}))()}},{key:"renewTokens",value:function(){var e=!0,t=!1,n=void 0;try{for(var i,o=Object.values(r)[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;this.renewToken(a)}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}},{key:"renewToken",value:function(e){var t=this;return v((function(){var n,i,o,a,s,u,c,l,d;return O(this,(function(h){switch(h.label){case 0:return t.tokenConfigs[e].numberOfFetchTrials=0,[4,t.getUserType()];case 1:return n=h.sent(),[4,t.getServiceForUserType(n)];case 2:return i=h.sent(),[4,t.getServiceProvider(i)];case 3:return o=h.sent(),[4,t.shouldFetchToken(n,e)];case 4:if(!h.sent())return[2];h.label=5;case 5:return h.trys.push([5,10,,11]),e===r.roaming?(u=t.getRoamingRequestAttributes(n),a=u.endpoint,s=u.resource):e===r.augLoop&&(a=f.b.O365CONFIG.AUGLOOP_URL,s=f.b.O365CONFIG.AUGLOOP_URL),[4,t.removeCurrentToken(o,a,s)];case 6:return c=h.sent(),l=(null==c?void 0:c.access_token)&&!Object(g.a)(c.expires_on),[4,t.fetchTokenInfo(e)];case 7:return h.sent()||!l?[3,9]:[4,t.saveTokens(o,a,c)];case 8:h.sent(),h.label=9;case 9:return[3,11];case 10:return d=h.sent(),t.logger.error(509646561,"failed to init ".concat(e," token fetching, reason: ").concat(d)),[3,11];case 11:return[2]}}))}))()}},{key:"removeDuplicateScopes",value:function(){var e=this;return v((function(){var t,n,r,i;return O(this,(function(o){switch(o.label){case 0:return[4,e.getStoredIdentity()];case 1:return t=o.sent(),[4,e.getUserType()];case 2:if(n=o.sent(),!t||!n||n!==f.a.O365)return[2];r=e.getEndpointBase(f.b.O365CONFIG.ROAMING_URL);try{i=t[n].resources[r].scope,t[n].resources[r].scope=i.filter((function(e){return!e.includes(",")})),i.length!==t[n].resources[r].scope.length&&e.logger.info(509646560,"duplicate scopes removed")}catch(e){return[2]}return[4,e.storage.set({identity:t})];case 3:return o.sent(),[2]}}))}))()}},{key:"acquireToken",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this;return v((function(){var o,a,s;return O(this,(function(u){switch(u.label){case 0:return[4,i.getServiceProvider(e)];case 1:if(!(o=u.sent()))return i.logger.error(509646559,"userService.acquireToken - Invalid type"),[2,Promise.reject("Invalid userType")];!n&&o.getResourceForEndpoint&&(n=o.getResourceForEndpoint(t)),a={},u.label=2;case 2:return u.trys.push([2,8,,9]),[4,i.getAccessToken(t,n)];case 3:return(null==(a=u.sent())?void 0:a.access_token)&&!Object(g.a)(a.expires_on)?[2,a]:[4,i.requestAccessToken(o,n,r)];case 4:return(a=u.sent())?[4,i.saveTokens(o,t,a)]:[3,6];case 5:return u.sent(),[3,7];case 6:return[2,Promise.reject("No tokens available")];case 7:return[3,9];case 8:return s=u.sent(),i.logger.error(509646558,"".concat(i.getFunctionName()," failed. reason: ").concat(JSON.stringify(s),", userType: ").concat(e,", endpoint: ").concat(t,", resource: ").concat(n)),[3,9];case 9:return a&&a.access_token&&a.expires_on&&!Object(g.a)(a.expires_on)?[2,a]:[2,null]}}))}))()}},{key:"getFunctionName",value:function(){return Error().stack.split("\n")[2].trim()}},{key:"retry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500,r=this;return v((function(){var i;return O(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,6]),[4,e()];case 1:return[2,o.sent()];case 2:return i=o.sent(),t?[4,new Promise((function(e){return setTimeout(e,n)}))]:[3,4];case 3:return o.sent(),[2,r.retry(e,t-1,2*n)];case 4:throw i;case 5:return[3,6];case 6:return[2]}}))}))()}},{key:"requestAccessToken",value:function(e,t,n){var r=this;return v((function(){var i,o;return O(this,(function(a){switch(a.label){case 0:return e?[4,r.getUserType()]:(r.logger.error(509646557,"userService.requestAccessToken - Invalid type"),[2,Promise.reject("Invalid userType")]);case 1:return i=a.sent(),[4,r.getUserInfo(i)];case 2:return o=a.sent(),e.requestAccessToken?[2,e.requestAccessToken(t,o,n)]:[2,void 0]}}))}))()}},{key:"authorize",value:function(e){var t=this;return v((function(){var n,r,i;return O(this,(function(o){switch(o.label){case 0:return n=e.type,[4,t.getServiceProvider(n)];case 1:return(i=o.sent())?e.id_token?[4,t.setUserType(e.id_token)]:[3,3]:(t.logger.error(509646556,"userService.authenticate - Invalid type"),[2]);case 2:r=o.sent(),o.label=3;case 3:return e.access_token?[4,t.saveTokens(i,i.getConfig().userInfoUrl,e)]:[3,8];case 4:return o.sent(),r?[3,6]:[4,t.getUserType()];case 5:r=o.sent(),o.label=6;case 6:return t.featureFlagsReader.flags.enableRoamingService&&!i.shouldGetUserInfo(e)?[3,8]:[4,t.lookupUserInfo(i,e.id_token)];case 7:o.sent(),o.label=8;case 8:return e.error&&t.logger.error(509646555,"userService.authenticate - authentication returned error"),[2]}}))}))()}},{key:"clearToken",value:function(){var e=this;return v((function(){return O(this,(function(t){return Promise.all([e.storage.remove("accessToken"),e.storage.remove("refreshToken"),e.storage.remove("userInfo"),e.storage.remove("userType"),e.storage.remove("identity"),e.storage.remove("postUpsellAnnouncementVisible"),e.storage.remove("postUpsellAnnouncementDismissed"),e.storage.remove("postUpsellAnnouncementHadSubscription")]),[2]}))}))()}},{key:"clearUserSettings",value:function(){var e=this;return v((function(){return O(this,(function(t){return Promise.all([e.storage.remove("userExcludedUrls"),e.storage.remove("showSynonyms"),e.storage.remove("enableTelemetry"),e.storage.remove("enableEditor"),e.storage.remove("enableCopilotInsert"),e.storage.remove("enableCopilotRewrite"),e.storage.remove("enableSpelling"),e.storage.remove("enableGrammar"),e.storage.remove("enableRefinements"),e.storage.remove("proofingLanguage"),e.storage.remove("proofingLanguages"),e.storage.remove("defaultProofingLanguageInitialized"),e.storage.remove("proofingLanguageListInitialized"),e.storage.remove("critiqueValuePerLanguage"),e.storage.remove("BetaEnrollment")]),[2]}))}))()}},{key:"getUserType",value:function(){var e=this;return v((function(){var t,n;return O(this,(function(r){switch(r.label){case 0:return[4,e.storage.get("userType")];case 1:return n=r.sent(),[2,null!==(t=null==n?void 0:n.userType)&&void 0!==t?t:f.a.NONE]}}))}))()}},{key:"setUserType",value:function(e){var t=this;return v((function(){var n,r,i,o,a;return O(this,(function(s){switch(s.label){case 0:return n=f.a.NONE,Object.values(f.a).includes(e)?(n=e,[3,6]):[3,1];case 1:return r=t.resolveTypeAndTenant(e),n=r.type,delete r.type,i=S({},n,r),[4,t.getStoredIdentity()];case 2:return o=s.sent(),0!==Object.keys(o).length?[3,4]:[4,t.getOrDefineClientId(!1)];case 3:a=s.sent(),t.logger.info(509646554,"IdentityPopulated",{clientId:a}),s.label=4;case 4:return t.mergeProperties(o,i),[4,t.storage.set({identity:o})];case 5:s.sent(),s.label=6;case 6:return n===f.a.NONE?[3,8]:[4,t.storage.set({userType:n})];case 7:s.sent(),s.label=8;case 8:return[2,n]}}))}))()}},{key:"fetchRegionScope",value:function(e){var t=this;return v((function(){var n,r,i,o;return O(this,(function(a){switch(a.label){case 0:n={method:"GET",url:"https://login.microsoftonline.com/".concat(e,"/.well-known/openid-configuration")},a.label=1;case 1:return a.trys.push([1,5,,6]),[4,t.retry(v((function(){return O(this,(function(e){return[2,t.httpRequest(n)]}))})),5)];case 2:return(r=a.sent())?[4,r.json()]:[3,4];case 3:return[2,(i=a.sent()).tenant_region_scope&&"NA"!==i.tenant_region_scope?i.tenant_region_scope:i.tenant_region_sub_scope?i.tenant_region_sub_scope:void 0];case 4:return[2,Promise.reject("fetchUserScope received no response")];case 5:return o=a.sent(),t.logger.error(509646553,"failed while fetching user region scope"),[2,Promise.reject("fetchUserScope failed: ".concat(o))];case 6:return[2]}}))}))()}},{key:"getSessionContext",value:function(){var e=chrome.runtime.getManifest();return{storeId:chrome.runtime.id,languageUxId:chrome.i18n.getUILanguage(),extensionId:e.version}}},{key:"evaluateRegex",value:function(e,t){return null!==new RegExp(t).exec(e)}},{key:"getOrDefineClientId",value:function(e){var t=this;return v((function(){var n,r,i,o,a;return O(this,(function(s){switch(s.label){case 0:return[4,t.storage.get("clientId")];case 1:return n=s.sent(),!(r=h.i(n,"clientId"))&&e?(i=t.guidGenerator.generate(),o={value:JSON.stringify(i),lastUpdated:Date.now(),manualOverride:!1},(a={}).clientId=JSON.stringify(o),t.storage.set(a),[2,i]):[2,r]}}))}))()}},{key:"getFlightInformation",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this;return v((function(){var e,n,i,o,a,s,u,c,l,d,h,p;return O(this,(function(g){switch(g.label){case 0:return[4,r.getOrDefineClientId(!0)];case 1:return e=g.sent(),n=r.getSessionContext(),i=Object.assign({appId:f.b.APP_ID},n),o={method:"POST",url:f.b.LINKS.FLIGHT_INFO_URL,headers:{"Content-Type":"application/json","X-UserId":e},data:i},[4,r.httpRequest(o)];case 2:return[4,g.sent().json()];case 3:a=g.sent(),s={},u=!0,c=!1,l=void 0;try{for(d=t[Symbol.iterator]();!(u=(h=d.next()).done);u=!0)p=h.value,s[p]=!!a&&!!a.FeatureFlags&&!!a.FeatureFlags[p]&&"true"===a.FeatureFlags[p].toLowerCase()}catch(e){c=!0,l=e}finally{try{u||null==d.return||d.return()}finally{if(c)throw l}}return[2,s]}}))}))()}},{key:"getDisplayTabId",value:function(e){return v((function(){var t;return O(this,(function(n){switch(n.label){case 0:return h.g(e)&&(e=f.b.LINKS.PROGRESSPAGE_URL),[4,h.j(e,!0)];case 1:if(!(null==(t=n.sent())?void 0:t.id))throw new Error("Failed to create a new tab");return[2,t.id]}}))}))()}},{key:"getPostInstallURL",value:function(e){return h.d()?e?f.b.LINKS.POST_INSTALL_CHROME_AUTO_URL:f.b.LINKS.POST_INSTALL_CHROME_URL:h.e()?e?f.b.LINKS.POST_INSTALL_EDGE_AUTO_URL:f.b.LINKS.POST_INSTALL_EDGE_URL:f.b.LINKS.POST_INSTALL_URL}},{key:"openFileUrlInTab",value:function(e){var t=this;return v((function(){var n,r,i;return O(this,(function(o){switch(o.label){case 0:return n=t.getPostInstallURL(e),r=t,[4,t.getDisplayTabId(n)];case 1:return i=o.sent(),h.g(i)?(r.logger.warn(509646552,"openFileUrlInTab: tabIdPromise null or undefined"),[2]):[4,chrome.tabs.update(i,{url:n})];case 2:return o.sent(),[2]}}))}))()}},{key:"login",value:function(e){var t=this;return v((function(){var n,r,i;return O(this,(function(o){switch(o.label){case 0:return[4,t.clearToken()];case 1:return o.sent(),[4,t.getServiceProvider(e)];case 2:return(n=o.sent()).handleLogin?[2,n.handleLogin()]:(r=n.getConfig(),(i=r.loginUrl)?[4,t.navigateToAuthEndpoint(i,n.type)]:(t.logger.error(509646551,"userService.login - Invalid type"),[2]));case 3:return o.sent(),[2]}}))}))()}},{key:"logout",value:function(){var e=this;return v((function(){var t,n,r,i,o;return O(this,(function(a){switch(a.label){case 0:return[4,e.getUserType()];case 1:return t=a.sent(),[4,e.getServiceProvider(t)];case 2:return n=a.sent(),[4,e.clearToken()];case 3:return a.sent(),[4,e.clearUserSettings()];case 4:return a.sent(),n.handleLogout?[4,n.handleLogout()]:[3,6];case 5:return a.sent(),[3,8];case 6:return r=n.getConfig(),(i=r.logoutUrl)?(o={method:"GET",url:i},[4,e.httpRequest(o)]):(e.logger.error(509646550,"userService.logout - Invalid type"),[2]);case 7:a.sent(),a.label=8;case 8:return e.logger.debug(509646549,"userService.logout - ".concat(t)),[2]}}))}))()}},{key:"getServiceForUserType",value:function(e){var t=this;return v((function(){var n;return O(this,(function(r){switch(r.label){case 0:return[4,t.getIdentityProperty("service",e)];case 1:return(n=r.sent())?[2,n]:[2,f.b.USER_SERVICE_TYPE.MSID]}}))}))()}},{key:"getServiceProvider",value:function(e){var t=this;return v((function(){var n;return O(this,(function(r){switch(r.label){case 0:return n=null,Object.values(f.b.USER_SERVICE_TYPE).includes(e)?[3,2]:[4,t.getServiceForUserType(e)];case 1:e=r.sent(),r.label=2;case 2:return-1!==e.indexOf(f.b.USER_SERVICE_TYPE.MSID)?n=t.msidUserService:t.logger.error(509646548,"userService.userService - Invalid type - ".concat(e)),[2,n]}}))}))()}},{key:"getStoredIdentity",value:function(){var e=this;return v((function(){var t,n;return O(this,(function(r){switch(r.label){case 0:return[4,e.storage.get("identity")];case 1:return n=r.sent(),[2,null!==(t=null==n?void 0:n.identity)&&void 0!==t?t:{}]}}))}))()}},{key:"mergeProperties",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=this,s=function(){var t=_(o.value,2),n=t[0],r=t[1];return r||0===r?e[n]&&"none"!==e[n]&&"none"!==r?(void 0===r?"undefined":T(r))!==T(e[n])?(a.logger.warn(509646547,"skipping ".concat(n," due to conflicting types")),"continue"):Array.isArray(r)?(r.forEach((function(t){t.split(",").forEach((function(t){e[n].indexOf(t)<0&&e[n].push(t)}))})),"continue"):"object"==typeof r?(a.mergeProperties(e[n],r),"continue"):void(e[n]=r):(e[n]=r,"continue"):"continue"},u=Object.entries(t)[Symbol.iterator]();!(n=(o=u.next()).done);n=!0)s()}catch(e){r=!0,i=e}finally{try{n||null==u.return||u.return()}finally{if(r)throw i}}}},{key:"resolveTypeAndTenant",value:function(e){var t=e.scopes||e.scope;if(null==t?void 0:t.includes("wl."))return{type:f.a.MSA};var n=e.id_token||e;if(!n)return{type:f.a.NONE};var r={"9188040d-6c67-4c5b-b112-36a304b66dad":{type:f.a.MSA,audience:"prod"},"4925308c-f164-4d2d-bc7e-0631132e9375":{type:f.a.MSA,audience:"ppe"},"72f988bf-86f1-41af-91ab-2d7cd011db47":{type:f.a.O365,audience:"prod",domain:"microsoft.com"},"f686d426-8d16-42db-81b7-ab578e110ccd":{type:f.a.O365,audience:"ppe",domain:"microsoft.com"}};try{var i=this.parseJwtToken(n);if(!i)return{type:f.a.MSA};var o=S({},"tenant",i.payload.tid);if(Object.prototype.hasOwnProperty.call(r,o.tenant)){var a=r[o.tenant];o=Object.assign(o,a)}else o.type=f.a.O365;return o}catch(e){return{type:f.a.MSA}}}},{key:"getEndpointBase",value:function(e){return new URL(e).origin}},{key:"saveTokens",value:function(e,t,n){var r=this;return v((function(){var o,a,s,u,c,l,d,p,g,m,y,b;return O(this,(function(v){switch(v.label){case 0:return n.expires_in&&!n.expires_on&&(n.expires_on=h.b()+Number(n.expires_in)),void 0===t?(r.logger.error(509646546,"userService.saveTokens - endpoint not provided"),[2]):[4,r.getUserType()];case 1:return(s=v.sent())!==f.a.NONE?[3,3]:[4,r.setUserType(n)];case 2:s=v.sent(),v.label=3;case 3:if(s===f.a.NONE)return r.logger.error(509646545,"userService.saveTokens - unable to resolve userType"),[2];u=decodeURIComponent(n.scope).toLowerCase().split(/[ +]/),c=e.getScopeEndpointMap(),v.label=4;case 4:v.trys.push([4,9,10,15]),l=Object(i.b)(u),v.label=5;case 5:return[4,l.next()];case 6:if((d=v.sent()).done)return[3,8];if(p=d.value,null==(g=p.match(/(^https:\/\/[.\w]*(?:\S+\/))/i))?void 0:g.index)return t=g[g.index],[3,8];if(c[p])return t=c[p],[3,8];v.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return m=v.sent(),o={error:m},[3,15];case 10:return v.trys.push([10,,13,14]),d&&!d.done&&(a=l.return)?[4,a.call(l)]:[3,12];case 11:v.sent(),v.label=12;case 12:return[3,14];case 13:if(o)throw o.error;return[7];case 14:return[7];case 15:return t=r.getEndpointBase(t),n.resource&&n.resource!==t&&(r.logger.info(509646544,"saveTokens ".concat(t," does not match ").concat(n.resource)),t=n.resource),y=S({},s,{id_token:n.id_token,refresh_token:n.refresh_token,service:e.type,resources:S({},t,{access_token:n.access_token,expires_in:n.expires_in,expires_on:n.expires_on,scope:u})}),[4,r.getStoredIdentity()];case 16:return b=v.sent(),r.mergeProperties(b,y),[4,r.storage.set({identity:b})];case 17:return v.sent(),[2]}}))}))()}},{key:"supportsScopes",value:function(e,t){if(!e)return!0;Array.isArray(e)||(e=e.toLowerCase().split(/[ +]/));var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(!t.includes(s))return!1}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return!0}},{key:"getAccessToken",value:function(e,t){var n=this;return v((function(){var r,i,o,a,s,u,c,l;return O(this,(function(d){switch(d.label){case 0:if(!e)return n.logger.error(509646543,"userService.getAccessToken - endpoint not provided"),[2];e=n.getEndpointBase(e),d.label=1;case 1:return d.trys.push([1,3,,4]),[4,n.getIdentityProperty("resources")];case 2:if((r=d.sent())[e]){if(i=r[e],e===t)return[2,i];if(i&&n.supportsScopes(t,i.scope))return[2,i];delete r[e]}o=!0,a=!1,s=void 0;try{for(u=r[Symbol.iterator]();!(o=(c=u.next()).done);o=!0)if(l=c.value,n.supportsScopes(t,l.scope))return[2,l]}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}return[2,void 0];case 3:return d.sent(),[2,void 0];case 4:return[2]}}))}))()}},{key:"getUserInfo",value:function(e){var t=this;return v((function(){return O(this,(function(n){return[2,t.getIdentityProperty("userInfo",e)]}))}))()}},{key:"getTenant",value:function(e){var t=this;return v((function(){return O(this,(function(n){return[2,t.getIdentityProperty("tenant",e)]}))}))()}},{key:"getIdToken",value:function(e){var t=this;return v((function(){return O(this,(function(n){return[2,t.getIdentityProperty("id_token",e)]}))}))()}},{key:"getIdentityProperty",value:function(e,t){var n=this;return v((function(){var r,i,o;return O(this,(function(a){switch(a.label){case 0:return null==t?[3,1]:(i=t,[3,3]);case 1:return[4,n.getUserType()];case 2:i=a.sent(),a.label=3;case 3:return r=i,[4,n.getStoredIdentity()];case 4:return(o=a.sent())[r]&&o[r][e]?[2,o[r][e]]:[2,null]}}))}))()}},{key:"saveUserInfo",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;return v((function(){var i,o,a;return O(this,(function(s){switch(s.label){case 0:return[4,r.getStoredIdentity()];case 1:return o=s.sent(),a=(null===(i=o[e])||void 0===i?void 0:i.userInfo)&&!n?o[e].userInfo:{},r.mergeProperties(a,t),o[e]?(o[e].userInfo=a,[4,r.storage.set({identity:o})]):[3,3];case 2:s.sent(),s.label=3;case 3:return[2]}}))}))()}},{key:"fetchMsaLicenseInfo",value:function(e,t){var n=this;return v((function(){var r,i,o,a,s;return O(this,(function(u){switch(u.label){case 0:r={method:"GET",url:f.b.MSACONFIG.LICENSE_ENDPOINT,headers:{"X-UserType":t.type}},u.label=1;case 1:return u.trys.push([1,7,,8]),[4,n.httpRequest(r)];case 2:return(i=u.sent())?[4,i.json()]:[3,6];case 3:return o=u.sent(),[4,n.getUserType()];case 4:return a=u.sent(),s={activeSubscriptionProduct:o.ActiveSubscriptionProduct?o.ActiveSubscriptionProduct:"none"},[4,n.saveUserInfo(a,s)];case 5:return u.sent(),[2,s];case 6:return[2,{}];case 7:return u.sent(),n.logger.error(509646542,"Consumer licensing call failed for ".concat(e,".")),[2,{}];case 8:return[2]}}))}))()}},{key:"fetchAadLicenseInfo",value:function(e,t){var n=this;return v((function(){var r,i,o,a;return O(this,(function(s){switch(s.label){case 0:r={method:"GET",url:f.b.O365CONFIG.LICENSE_ENDPOINT,headers:{"X-UserType":t.type}},s.label=1;case 1:return s.trys.push([1,7,,8]),[4,n.httpRequest(r)];case 2:return[4,s.sent().json()];case 3:return(null==(i=s.sent())?void 0:i.ActiveExperiences)?[4,n.getUserType()]:[3,6];case 4:return o=s.sent(),a={activeExperiences:i.ActiveExperiences},[4,n.saveUserInfo(o,a)];case 5:s.sent(),s.label=6;case 6:return[3,8];case 7:return s.sent(),n.logger.error(509646541,"Commercial license call failed for ".concat(e,".")),[3,8];case 8:return[2,{}]}}))}))()}},{key:"shouldFetchToken",value:function(e,t){var n=this;return v((function(){var r;return O(this,(function(i){return r=n.tokenConfigs[t].numberOfFetchTrials>n.tokenConfigs[t].maxFetchTrials,[2,{roaming:n.featureFlagsReader.flags.enableRoamingService,augLoop:n.featureFlagsReader.flags.enableCopywriter}[t]&&e!==f.a.NONE&&!r]}))}))()}},{key:"fetchTokenInfo",value:function(e,t){var n=this;return v((function(){var i,o,a;return O(this,(function(s){switch(s.label){case 0:return[4,n.getUserType()];case 1:return i=s.sent(),n.tokenConfigs[e].fetchTimeout&&(clearTimeout(n.tokenConfigs[e].fetchTimeout),n.tokenConfigs[e].fetchTimeout=void 0),[4,n.shouldFetchToken(i,e)];case 2:if(!s.sent())return t&&n.logger.error(507802147,"failed to fetch ".concat(e," Info, trial number: ").concat(n.tokenConfigs[e].numberOfFetchTrials,", reason: ").concat(t)),[2,!1];s.label=3;case 3:return s.trys.push([3,11,,12]),e!==r.roaming?[3,8]:i!==f.a.MSA?[3,5]:[4,n.fetchMsaRoamingInfo(i)];case 4:return o=s.sent(),[3,7];case 5:return[4,n.fetchAadRoamingInfo(i)];case 6:o=s.sent(),s.label=7;case 7:return[3,10];case 8:return e!==r.augLoop?[3,10]:[4,n.fetchAugLoopInfo(i)];case 9:o=s.sent(),s.label=10;case 10:return[3,12];case 11:return a=s.sent(),n.tokenConfigs[e].numberOfFetchTrials++,[2,n.fetchTokenInfo(e,a)];case 12:return n.logger.info(509646539,"got ".concat(e," token after ").concat(n.tokenConfigs[e].numberOfFetchTrials," attempt(s)")),n.tokenConfigs[e].numberOfFetchTrials=0,o?[4,n.setNextTokenFetch(o,e)]:[3,14];case 13:return s.sent(),[3,15];case 14:n.logger.error(509646538,"".concat(e," token is undefined")),s.label=15;case 15:return[2,!!o]}}))}))()}},{key:"setNextTokenFetch",value:function(e,t){var n=this;return v((function(){var r,i,o;return O(this,(function(a){switch(a.label){case 0:return r=1e3*e.expires_on-Date.now(),i=60*n.tokenConfigs[t].refreshIntervalInHours*60*1e3,o=Math.min(i,r),r>0?(n.tokenConfigs[t].fetchTimeout=setTimeout(v((function(){return O(this,(function(e){switch(e.label){case 0:return[4,n.renewToken(t)];case 1:return e.sent(),[2]}}))})),o),[3,3]):[3,1];case 1:return[4,n.fetchTokenInfo(t)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))()}},{key:"removeCurrentToken",value:function(e,t,n){var r=this;return v((function(){var i;return O(this,(function(o){switch(o.label){case 0:return[4,r.getAccessToken(t,n)];case 1:return(i=o.sent())?[4,r.saveTokens(e,t,Object.assign(Object.assign({},i),{expires_on:1}))]:[2,{}];case 2:return o.sent(),[2,i]}}))}))()}},{key:"fetchAugLoopInfo",value:function(e){var t=this;return v((function(){var n;return O(this,(function(r){switch(r.label){case 0:return[4,t.acquireToken(e,s.a.Prod,void 0,!1)];case 1:if(!(n=r.sent()))throw new Error("AugLoop token not found!");return[2,n]}}))}))()}},{key:"fetchAadRoamingInfo",value:function(e){var t=this;return v((function(){var n,r,i,o;return O(this,(function(a){switch(a.label){case 0:return n=t.getRoamingRequestAttributes(e),r=n.endpoint,i=n.resource,[4,t.acquireToken(e,r,i,!1)];case 1:if(!(o=a.sent()))throw new Error("Roaming token not found!");return[2,o]}}))}))()}},{key:"fetchMsaRoamingInfo",value:function(e){var t=this;return v((function(){var n,r,i,o;return O(this,(function(a){switch(a.label){case 0:return n=t.getRoamingRequestAttributes(e),r=n.endpoint,i=n.resource,[4,t.acquireToken(e,r,i,!0)];case 1:if(!(o=a.sent()))throw new Error("Roaming token not found!");return[2,o]}}))}))()}},{key:"getRoamingRequestAttributes",value:function(e){if(e===f.a.NONE)throw new Error("Unexpected user type, user is not signed in!");return e===f.a.MSA?{endpoint:f.b.MSACONFIG.ROAMING_URL,resource:f.b.MSACONFIG.ROAMING_SCOPE}:{endpoint:f.b.O365CONFIG.ROAMING_URL,resource:f.b.O365CONFIG.ROAMING_URL}}},{key:"fetchLicenseInfo",value:function(e,t,n,r){var i=this;return v((function(){return O(this,(function(o){return i.logger.info(509646537,"FetchLicenseInfo",{isRefresh:r,userType:t,reason:e}),t===f.a.MSA?[2,i.fetchMsaLicenseInfo(e,n)]:[2,i.fetchAadLicenseInfo(e,n)]}))}))()}},{key:"fetchUserInfo",value:function(){var e=this;return v((function(){var t,n,r,i,o;return O(this,(function(a){switch(a.label){case 0:t={method:"GET",url:e.userInfoUrl,headers:{"X-UserType":f.b.USER_SERVICE_TYPE.MSID}},n={},a.label=1;case 1:return a.trys.push([1,4,,5]),[4,e.httpRequest(t)];case 2:return r=a.sent(),i=e.deleteMetaDataTags,[4,r.json()];case 3:return n=i.apply(e,[a.sent()]),[3,5];case 4:return o=a.sent(),[2,Promise.reject("msidUser.fetchUserInfo failed: ".concat(o))];case 5:return[2,n]}}))}))()}},{key:"lookupUserInfo",value:function(e,t){var n=this;return v((function(){var i,o;return O(this,(function(a){switch(a.label){case 0:return[4,n.getUserType()];case 1:i=a.sent(),a.label=2;case 2:return a.trys.push([2,11,,12]),[4,n.fetchUserInfo()];case 3:return o=a.sent(),n.featureFlagsReader.flags.enableAadc?[4,n.getAgeGroup(i,t)]:[3,5];case 4:o.ageGroup=a.sent(),a.label=5;case 5:return chrome.runtime.sendMessage({activity:f.b.ACTIVITY.USERINFO_AVAILABLE.NAME,data:o}),!o.email&&o.userPrincipalName&&(o.email=o.userPrincipalName),[4,n.saveUserInfo(i,o,!0)];case 6:return a.sent(),[4,n.getPhotoFromServer(e)];case 7:return a.sent(),[4,n.fetchLicenseInfo(f.b.TELEMETRY.FETCHLICENSINGINFO_REASON.LOGIN,i,e,!1)];case 8:return a.sent(),n.tokenConfigs.roaming.numberOfFetchTrials=0,[4,n.fetchTokenInfo(r.roaming)];case 9:return a.sent(),[4,n.addRegionScopeToUserInfo(i,o)];case 10:return a.sent(),[3,12];case 11:return a.sent(),n.logger.error(509646536,"failed while looking up user info"),[3,12];case 12:return[2]}}))}))()}},{key:"getAgeGroup",value:function(e,t){var n=this;return v((function(){var r,i,o,a,s;return O(this,(function(u){switch(u.label){case 0:return i=0,[4,n.getUserInfo(e)];case 1:if(null==(o=u.sent())?void 0:o.ageGroup)return[2,o.ageGroup];if(!t)return[2,i];try{if(!(a=n.parseJwtToken(t,!0)))return[2,0];s=a.payload,i=null!==(r=null==s?void 0:s.ageGroup)&&void 0!==r?r:0}catch(e){n.logger.error(509646535,"error setting age group, reason: ".concat(e))}return[2,i]}}))}))()}},{key:"parseJwtToken",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=/^([^.\s]*)\.([^.\s]+)\.([^.\s]*)$/.exec(e);return!n||n.length<4?(this.logger.error(509646534,"The returned id_token is not parseable."),null):{header:this.parseJsonString(this.base64DecodeStringUrlSafe(n[1]),t),payload:this.parseJsonString(this.base64DecodeStringUrlSafe(n[2]),t)}}},{key:"parseJsonString",value:function(e,t){if(!t)return JSON.parse(e);try{return JSON.parse(e)}catch(t){var n=e.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\/]/g,"\\/").replace(/[\b]/g,"\\b").replace(/[\f]/g,"\\f").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\t]/g,"\\t");return JSON.parse(n)}}},{key:"base64DecodeStringUrlSafe",value:function(t){return t=t.replace(/-/g,"+").replace(/_/g,"/"),decodeURIComponent(escape(e.from(t,"base64").toString("ascii")))}},{key:"getPhotoFromServer",value:function(e){var t=this;return v((function(){var n,r,i,o,a,s,u;return O(this,(function(c){switch(c.label){case 0:return n=e.type,[4,t.getUserType()];case 1:if(r=c.sent(),i=e.getConfig(),!(o=i[r===f.a.MSA?"msaPhotoUrl":"aadPhotoUrl"]))return[2];a={method:"GET",url:o,responseType:"blob",headers:{"X-UserType":n}},c.label=2;case 2:return c.trys.push([2,5,,6]),[4,t.httpRequest(a)];case 3:return[4,c.sent().blob()];case 4:return s=c.sent(),t.logger.info(509646533,"UserService_GotServerPhoto",{userType:r}),(u=new FileReader).onload=v((function(){return O(this,(function(e){return t.saveUserInfo(r,{photo:u.result}),[2]}))})),u.readAsDataURL(s),[3,6];case 5:return c.sent(),[2];case 6:return[2]}}))}))()}},{key:"unpackStateParam",value:function(e){e.state&&(e.state=decodeURIComponent(e.state));var t=_(e.state.split("|"),3),n=(t[0],t[1]);return t[2],n&&(e.type=n),e}},{key:"deleteMetaDataTags",value:function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&t.match(/^@odata/i)&&delete e[t];return e}},{key:"setupOffscreenDocument",value:function(){var e=this;return v((function(){var t,n,r,i,o,a,s,u;return O(this,(function(c){switch(c.label){case 0:return c.trys.push([0,6,,7]),t=chrome.runtime.getURL("offscreen.html"),[4,self.clients.matchAll({includeUncontrolled:!0,type:"all"})];case 1:n=c.sent(),r=!0,i=!1,o=void 0;try{for(a=n[Symbol.iterator]();!(r=(s=a.next()).done);r=!0)if(s.value.url===t)return[2]}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return e.offscreenCreatePromise?[4,e.offscreenCreatePromise]:[3,3];case 2:return c.sent(),[3,5];case 3:return e.offscreenCreatePromise=chrome.offscreen.createDocument({url:t,justification:"authentication",reasons:[chrome.offscreen.Reason.IFRAME_SCRIPTING]}),[4,e.offscreenCreatePromise];case 4:c.sent(),e.offscreenCreatePromise=void 0,c.label=5;case 5:return[3,7];case 6:return u=c.sent(),e.logger.error(507802371,"Failed to setup offscreen document: ".concat(u)),[3,7];case 7:return[2]}}))}))()}}],o&&w(n.prototype,o),a&&w(n,a),t}();C=Object(i.c)([Object(o.a)(),Object(i.f)(0,Object(a.a)(u.a)),Object(i.f)(1,Object(a.a)(c.a)),Object(i.f)(2,Object(a.a)(m.a)),Object(i.f)(3,Object(a.a)(l.a)),Object(i.e)("design:paramtypes",[Object,Object,Object,Object])],C)}).call(this,n(530).Buffer)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(36);function i(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){i(a,r,o,s,u,"next",e)}function u(e){i(a,r,o,s,u,"throw",e)}s(void 0)}))}}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var u=function(){function e(t,n){var i,o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"logger",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"userService",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:r.b.USER_SERVICE_TYPE.MSID}),Object.defineProperty(this,"scopes",{enumerable:!0,configurable:!0,writable:!0,value:"email openid profile user.read"}),Object.defineProperty(this,"userInfoUrl",{enumerable:!0,configurable:!0,writable:!0,value:"https://graph.microsoft.com/v1.0/me/"}),Object.defineProperty(this,"aadV2Url",{enumerable:!0,configurable:!0,writable:!0,value:new URL("https://login.microsoftonline.com/common/oauth2/").toString()}),Object.defineProperty(this,"msaOAuthUrl",{enumerable:!0,configurable:!0,writable:!0,value:new URL("https://login.live.com/oauth20_authorize.srf").toString()}),Object.defineProperty(this,"redirectUri",{enumerable:!0,configurable:!0,writable:!0,value:new URL("nativeclient",this.aadV2Url).toString()}),Object.defineProperty(this,"logoutUrl",{enumerable:!0,configurable:!0,writable:!0,value:new URL("v2.0/logoutsession",this.aadV2Url).toString()}),Object.defineProperty(this,"authorizeUrl",{enumerable:!0,configurable:!0,writable:!0,value:new URL("v2.0/authorize",this.aadV2Url).toString()}),Object.defineProperty(this,"aadClientId",{enumerable:!0,configurable:!0,writable:!0,value:"1a20851a-696e-4c7e-96f4-c282dfe48872"}),Object.defineProperty(this,"loginUrl",{enumerable:!0,configurable:!0,writable:!0,value:(i=new URL(o.authorizeUrl),i.search=o.createParams({prompt:"select_account"}),i.toString())}),Object.defineProperty(this,"scopeUrlMap",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this.populateScopeUrlMap()}var t,n,i;return t=e,(n=[{key:"populateScopeUrlMap",value:function(){this.scopeUrlMap[r.b.MSACONFIG.ROAMING_SCOPE.toLowerCase()]=r.b.MSACONFIG.ROAMING_URL}},{key:"getUserService",value:function(){return this.userService}},{key:"createParams",value:function(e){var t={client_id:this.aadClientId,response_type:"id_token token",redirect_uri:this.redirectUri,scope:this.scopes,response_mode:"fragment"};return new URLSearchParams(Object.assign({},t,e)).toString()}},{key:"getConfig",value:function(){return{loginUrl:this.loginUrl,logoutUrl:this.logoutUrl,aadPhotoUrl:r.b.O365CONFIG.PHOTO_URL,msaPhotoUrl:r.b.MSACONFIG.PHOTO_URL,userInfoUrl:this.userInfoUrl,documentsUrl:"https://graph.microsoft.com/v1.0/me/drive/recent"}}},{key:"getScopeEndpointMap",value:function(){return this.scopeUrlMap}},{key:"shouldGetUserInfo",value:function(e){if(!e.scope)return!1;var t=new Set(e.scope.split(" ").map((function(e){return e.toLowerCase().trim()}))),n=!0,r=!1,i=void 0;try{for(var o,a=this.scopes.split(" ")[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(!t.has(s.toLowerCase().trim()))return!1}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return!0}},{key:"handleLogin",value:function(){var e=this;return o((function(){var t,n,r,i,o,a,u,c,l,d,f,h;return s(this,(function(s){switch(s.label){case 0:t={url:e.authorizeUrl,prompt:"select_account"},(n=[]).push(t),i=!0,o=!1,a=void 0,s.label=1;case 1:s.trys.push([1,6,7,8]),u=n[Symbol.iterator](),s.label=2;case 2:return(i=(c=u.next()).done)?[3,5]:(l=c.value).url?(d=new URL(l.url),delete l.url,r&&l.set("login_hint",r),d.search=e.createParams(l),[4,e.getUserService().navigateToAuthEndpoint(d.toString(),e.type,!1)]):[3,4];case 3:if(!(f=s.sent()).error||"aad_auth"===f.error)return[2];f.username&&(r=f.username),s.label=4;case 4:return i=!0,[3,2];case 5:return[3,8];case 6:return h=s.sent(),o=!0,a=h,[3,8];case 7:try{i||null==u.return||u.return()}finally{if(o)throw a}return[7];case 8:return[2]}}))}))()}},{key:"getResourceForEndpoint",value:function(e){if(!e)return this.scopes;var t={"https://graph.microsoft.com":{"/v1.0/me/":this.scopes,"/v1.0/me/drive/recent":"Files.ReadWrite.All"},"https://nleditor.osi.office.net":{"/NlEditor/":"https://nleditor.osi.office.net/NlEditor/instrumentation.write"},"https://consumer.suite.office.com":{"api/licensing/licensingdata":"https://consumer.suite.office.com/entitlements.read"},"https://webshell.suite.office.com":{"/api/shell/NewTab?culture=en-US":"https://webshell.suite.office.com/.default"},"https://augloop.office.com":{"/v2":"https://augloop.office.com/v2/.default"}};try{var n=new URL(e);if(!Object.prototype.hasOwnProperty.call(t,n.origin))return this.scopes;var r=t[n.origin],i=n.pathname;return r[Object.keys(r).reduce((function(e,t){return i.startsWith(t)&&t.length>e.length?t:e}))]}catch(e){return this.logger.warn(509646615,"msidUser.Service threw an exception: ".concat(e)),this.scopes}}},{key:"requestAccessToken",value:function(e,t,n){var r=this;return o((function(){var i,o,a,u,c;return s(this,(function(s){switch(s.label){case 0:return i={scope:e,response_type:"token"},(null==t?void 0:t.email)&&(i.login_hint=t.email),o=r.createParams(i),(a=new URL(n?r.msaOAuthUrl:r.authorizeUrl)).search=o.toString(),[4,r.getUserService().navigateToAuthEndpoint(a.href,r.type,!0)];case 1:return(u=s.sent())&&u.access_token?[2,u]:(c=null==u?void 0:u.error_description,[2,Promise.reject("failed to get token from iframe for resource ".concat(e,", description: ").concat(c))])}}))}))()}}])&&a(t.prototype,n),i&&a(t,i),e}()},function(e,t,n){"use strict";const{AbortController:r,AbortSignal:i}="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0;e.exports=r,e.exports.AbortSignal=i,e.exports.default=r},function(e,t){e.exports="object"==typeof self?self.FormData:window.FormData},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Log="Log"}(r||(r={}))},function(e,t,n){(function(t){var n=null;"undefined"!=typeof WebSocket?n=WebSocket:"undefined"!=typeof MozWebSocket?n=MozWebSocket:void 0!==t?n=t.WebSocket||t.MozWebSocket:"undefined"!=typeof window?n=window.WebSocket||window.MozWebSocket:"undefined"!=typeof self&&(n=self.WebSocket||self.MozWebSocket),e.exports=n}).call(this,n(69))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports=n(1038)},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=u(e),a=r[0],s=r[1],c=new o(function(e,t,n){return 3*(t+n)/4-n}(0,a,s)),l=0,d=s>0?a-4:a;for(n=0;n<d;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;2===s&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,c[l++]=255&t);1===s&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],a=16383,s=0,u=n-i;s<u;s+=a)o.push(c(e,s,s+a>u?u:s+a));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,n){for(var i,o,a=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,d=n?i-1:0,f=n?-1:1,h=e[t+d];for(d+=f,o=h&(1<<-l)-1,h>>=-l,l+=s;l>0;o=256*o+e[t+d],d+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+e[t+d],d+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,r),o-=c}return(h?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,d=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,p=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+d>=1?f/u:f*Math.pow(2,1-d))*u>=2&&(a++,u/=2),a+d>=l?(s=0,a=l):a+d>=1?(s=(t*u-1)*Math.pow(2,i),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),a=0));i>=8;e[n+h]=255&s,h+=p,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[n+h]=255&a,h+=p,a/=256,c-=8);e[n+h-p]|=128*g}},function(e,t){},function(e,t,n){"use strict";var r=n(701).Buffer,i=n(857);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var t,n,i,o=r.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=a.data,n=o,i=s,t.copy(n,i),s+=a.data.length,a=a.next;return o},e}(),i&&i.inspect&&i.inspect.custom&&(e.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t){},function(e,t,n){(function(t){function n(e){try{if(!t.localStorage)return!1}catch(e){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}}).call(this,n(69))},function(e,t,n){var r=n(530),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function a(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=a),a.prototype=Object.create(i.prototype),o(i,a),a.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},a.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},function(e,t,n){"use strict";e.exports=o;var r=n(776),i=Object.create(n(567));function o(e){if(!(this instanceof o))return new o(e);r.call(this,e)}i.inherits=n(531),i.inherits(o,r),o.prototype._transform=function(e,t,n){n(null,e)}},function(e,t,n){e.exports=n(702)},function(e,t,n){e.exports=n(483)},function(e,t,n){e.exports=n(700).Transform},function(e,t,n){e.exports=n(700).PassThrough},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=Object(r.a)("IContainer");Object(r.a)("IResolveNew")},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(2),i=n(126),o=n(737),a=n(738),s=n(104),u=n(10),c=n(48),l=n(204),d=n(11),f=n(7);let h=class{constructor(e,t,n){this._wordCountDetector=e,this._hostModelSettings=t,this._textUnitChunker=n}generateDeltaEventInformation(e,t,n,r,i,o,a,d){var f;const h=null!==(f=null==t?void 0:t.content)&&void 0!==f?f:"",p=n.content,g=u.b.getMinimalDifferenceBounds(h,p);a&&(g.firstDiffLeft-=1);let m=!1;if(!r&&this._hostModelSettings.partialTileTextUnit!==s.e.Phrase&&this._hostModelSettings.partialTileTextUnit!==this._hostModelSettings.completeTileTextUnit){const e=g.firstDiffLeft,t=p.length-g.firstDiffRight;m=-1!==this._textUnitChunker.getUnitSeparator(this._hostModelSettings.partialTileTextUnit).findEndBoundary(p,e-1,t)}const y=null!=d?d:this._wordCountDetector.getWordCount(h),b=this._wordCountDetector.hasWordCountChanged(g,y,p),v=i?Object(l.a)(this._hostModelSettings.completeTileTextUnit):m?Object(l.a)(this._hostModelSettings.partialTileTextUnit):b.isWordCountChanged?r?Object(l.a)(this._hostModelSettings.completeTileTextUnit):c.c.Word:c.c.Chars;let w;if(this._hostModelSettings.completeTileTextUnit===s.e.Paragraph&&this._hostModelSettings.partialTileTextUnit===s.e.Sentence&&v!==c.c.Paragraph){const e=g.firstDiffLeft,t=this._textUnitChunker.getUnitSeparator(this._hostModelSettings.partialTileTextUnit),n=t.findBeginBoundary(p,e,0),r=t.findEndBoundary(p,e-1,p.length);w=[{position:n,length:(-1===r?p.length:r)-n,unit:c.c.Sentence}]}return{paragraphNode:e,oldTextInfo:t,newTextInfo:n,minDiffBounds:g,wordCount:b.wordCount,deltaUnit:v,mutationChangeType:o,invalidationRanges:w}}};h=Object(r.c)([Object(d.a)(),Object(r.f)(0,Object(f.a)(o.a)),Object(r.f)(1,Object(f.a)(i.a)),Object(r.f)(2,Object(f.a)(a.a))],h)},function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var r=n(2),i=n(138),o=n(30),a=n(154),s=n(217),u=n(8),c=n(89),l=n(74),d=n(53),f=n(489),h=n(336),p=n(48),g=n(299),m=n(266),y=n(118),b=n(104),v=n(95),w=n(204),S=n(332),_=n(219),T=n(11),O=n(271),C=n(7),E=n(98),I=n(101);let k=class{constructor(e,t,n,r,i,o,a){this._hostEmitters=e,this._proofingStore=t,this._featureFlagReader=n,this._logger=r,this._proofingDom=i,this._queryDetection=o,this._nodeTraverser=a,this.tileTracked=new Set}emitTileEvent(e,t,n,r,a,s,u,c,l,d){var f,p;a===i.a.NewData?this.tileTracked.add(t):a===i.a.RemoveData&&(this.tileTracked.delete(t),null===(f=this._queryDetection)||void 0===f||f.handleTileRemoved(t));const g=Object(_.a)(e);for(const e of this._hostEmitters)e.emit(o.a.hostModelTextTile,{address:void 0,message:{messageType:a,data:{tileId:t,tileVersion:r,documentModel:null==g?void 0:g.documentModel,changeType:s,isTextNode:u===v.a.ParagraphNode,tile:n?new h.a(Object.assign(Object.assign({},n),{formattedRanges:[...null!==(p=n.formattedRanges)&&void 0!==p?p:[],{start:0,length:n.content.length,languageId:null!=c?c:this.getProofingLanguage()}]})):void 0,prevId:l,nextId:d}}})}emitParagraphDiffEvent(e){this.tileTracked.has(e.paragraphNode.id)||this._featureFlagReader.flags.enableParagraphDeltasVerboseLogging&&this._logger.error(540915291,"Delta event sent when no parent tile node was created."),this.emitDiffEvent(e.paragraphNode,e.oldTextInfo,e.newTextInfo,e.minDiffBounds,e.wordCount,e.deltaUnit,a.a.ParagraphNode,e.mutationChangeType,e.invalidationRanges)}emitTileDiffEvent(e,t,n,r,i,o,s,u,c){const l=s.unreconciledContent.some((e=>e.textUnit===b.e.Paragraph))?p.c.Paragraph:s.unreconciledContent.some((e=>e.textUnit===b.e.Sentence))?p.c.Sentence:i?p.c.Word:p.c.Chars,d=this.getProofingLanguage(),f=s.unreconciledContent.map((e=>({position:e.header.elementId.offset,length:e.header.elementId.span,unit:Object(w.a)(e.textUnit),languageId:null!=c?c:d})));this.emitDiffEvent(e,t,n,r,o,l,a.a.TileNode,u,f)}emitMoveTileEvent(e,t,n,r,i,a,s,u,c){var l;for(const d of this._hostEmitters)d.emit(o.a.hostModelMoveTextTile,{address:void 0,message:{oldTileId:e,newTileId:t,tileVersion:r,oldDocumentModel:u,newDocumentModel:c,tile:new h.a(Object.assign(Object.assign({},n),{formattedRanges:[...null!==(l=n.formattedRanges)&&void 0!==l?l:[],{start:0,length:n.content.length,languageId:null!=i?i:this.getProofingLanguage()}]})),prevId:a,nextId:s}})}emitParagraphNodeTileEvents(e,t,n,r){const a=Object(_.a)(e),s=t.removedNodes.map((t=>{var r;return{messageType:i.a.RemoveData,data:{tileId:t,tileVersion:null!==(r=e.eventSeqId)&&void 0!==r?r:0,documentModel:null==a?void 0:a.documentModel,changeType:n,isTextNode:!0,tile:void 0}}}));s.push(...t.unreconciledContent.map((o=>{var s,u,c;const l=this._proofingDom.findParagraphNode(o.header.elementId.id),d=l?null===(s=this._nodeTraverser)||void 0===s?void 0:s.findPreviousParagraphNode(l):void 0,f=l?null===(u=this._nodeTraverser)||void 0===u?void 0:u.findNextParagraphNode(l):void 0;return{messageType:this._featureFlagReader.flags.enableParagraphUpdates&&!t.addedNodes.includes(o.header.elementId.id)?i.a.ChangeData:i.a.NewData,data:{tileId:o.header.elementId.id,tileVersion:null!==(c=e.eventSeqId)&&void 0!==c?c:0,documentModel:null==a?void 0:a.documentModel,changeType:n,isTextNode:!0,tile:new h.a(Object.assign(Object.assign({},r),{content:o.data,formattedRanges:[{start:0,length:o.data.length,languageId:this.getProofingLanguage(o.proofingLanguages)}]})),prevId:"#head#"===d?d:null==d?void 0:d.id,nextId:"#tail#"===f?f:null==f?void 0:f.id}}})));for(const e of this._hostEmitters)e.emit(o.a.hostModelParagraphTextTiles,{address:void 0,message:s})}getProofingLanguage(e){return s.a.getDefaultLanguageCode(null!=e?e:this._proofingStore.getCachedEntry(u.a.ProofingLanguages).storeEntryValue)}emitDiffEvent(e,t,n,r,i,s,u,c,l){var d,f,h;const m=null!==(d=null==t?void 0:t.content)&&void 0!==d?d:"",y=n.content,b=r.firstDiffLeft,v=m.length-r.firstDiffRight,w=y.length-r.firstDiffRight,S=m.length===y.length?p.b.Update:v===b?p.b.Add:w===b?p.b.Delete:p.b.Update;let T,O,C;switch(S){case p.b.Update:T=v-b,O=y.substring(b,w),C=m.substring(b,v);break;case p.b.Add:T=0,O=y.substring(b,w);break;case p.b.Delete:T=v-b,C=m.substring(b,v)}let E=new g.a({deltaType:S,unit:s,position:b,length:T,content:O,wordCount:i,invalidationRanges:l,userInfo:{userType:c===a.b.Local?p.a.SessionUser:c===a.b.Remote?p.a.Collaborator:p.a.Programmatic}});const I=u===a.a.ParagraphNode?null===(f=this._queryDetection)||void 0===f?void 0:f.handleTileDelta(e.id,E,y,c,C):void 0;E=Object.assign(Object.assign({},E),I);const k=Object(_.a)(e);for(const t of this._hostEmitters)t.emit(o.a.hostModelDelta,{address:void 0,message:{tileId:e.id,tileVersion:null!==(h=e.eventSeqId)&&void 0!==h?h:0,documentModel:null==k?void 0:k.documentModel,delta:E,sourceType:u,changeType:c,deletedOrReplacedCharacters:C}})}emitFormattingDiffEventDeprecated(e,t,n){var r;const i=Object(_.a)(e),a=Array.isArray(n)?new g.a({deltaType:p.b.FormattingUpdate,formattedRanges:n}):new g.a({deltaType:p.b.OtherNonContentUpdate,otherNonContentData:n});for(const n of this._hostEmitters)n.emit(o.a.hostModelFormattingDelta,{address:void 0,message:{tileId:e.id,tileVersion:null!==(r=e.eventSeqId)&&void 0!==r?r:0,documentModel:null==i?void 0:i.documentModel,delta:a,sourceType:t}})}emitFormattingDiffEvent(e,t,n){var r;if(!this._featureFlagReader.flags.enableAttributionRangeExceptionInFormattedTextDeltas)return Object(I.f)(n)?void this._logger.error(506331489,"Unexpected formatted text range props in deprecated formatted text deltas"):this.emitFormattingDiffEventDeprecated(e,t,n);const i=Object(_.a)(e);for(const a of this._hostEmitters)a.emit(o.a.hostModelFormattingDelta,{address:void 0,message:Object(S.e)(e.id,null!==(r=e.eventSeqId)&&void 0!==r?r:0,null==i?void 0:i.documentModel,t,n)})}};k=Object(r.c)([Object(T.a)(),Object(r.f)(0,Object(O.a)(o.c)),Object(r.f)(1,Object(C.a)(c.a)),Object(r.f)(2,Object(C.a)(l.a)),Object(r.f)(3,Object(C.a)(d.a)),Object(r.f)(4,Object(C.a)(y.a)),Object(r.f)(5,Object(E.a)()),Object(r.f)(5,Object(C.a)(f.a)),Object(r.f)(6,Object(E.a)()),Object(r.f)(6,Object(C.a)(m.a))],k)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return h}));var r=n(2),i=n(11),o=n(10);const a=new Set(["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\ufeff","","","","",""]);let s=class{constructor(){this.supportsBrowserWordBreaking=!1}getForwardBreakByWord(e,t){let n=this.getForwardBreak(e,t);return"WhiteSpace"===(null==n?void 0:n.wordBreakType)&&(n=this.getForwardBreak(e,n.cp)),n?n.cp:e.length}getBackwardBreakByWord(e,t){let n=this.getBackwardBreak(e,t);return"WhiteSpace"===(null==n?void 0:n.wordBreakType)&&(n=this.getBackwardBreak(e,n.cp)),n?n.cp:0}getForwardBreak(e,t){return this.getForwardBreakInternal(e,t,e.length)}getBackwardBreak(e,t){if(t<=1)return;let n=t;for(;n>0;){const t=c(e,n-1);switch(t){case"Undetermined":break;case"AlphaNumeric":case"Punctuation":case"WhiteSpace":case"PuncuationWithoutBreak":case"FootnoteEndnotePunctuation":{if(n<=1)return;const r=n-1,i=c(e,r-1);if(t!==i&&u(t,i)&&("Undetermined"!==i||!this.supportsBrowserWordBreaking))return{cp:r,wordBreakType:t};break}}n-=1}}getTextStartWordBreak(e){return this.getTextWordBreak(e,0)}getTextWordBreak(e,t){return{cp:t,wordBreakType:c(e,t)}}getBreaks(e){const t=this.getBreaksForRange(e,0,e.length);return e.length&&t.splice(0,0,this.getTextStartWordBreak(e)),t}getBreaksForRange(e,t,n){const r=[];if(!e)return r;let i,o=t;do{i&&(r.push(i),o=i.cp),i=this.getForwardBreakInternal(e,o,n)}while(i);return r}getWordCount(e,t){return this.getWordCountFromWordBreaks(e,t).wordCount}getWordCountInRange(e,t,n){return this.getWordCountAndBreaksInRange(e,t,n).wordCount}getWordCountAndBreaksInRange(e,t,n){const r=this.getBreaksForRange(e,t,n);return r.splice(0,0,this.getTextWordBreak(e,t)),{wordCount:this.getWordCount(r,e),wordBreaks:r}}getWordCountWithBoundariesAndBreaksInRange(e,t,n){const r=this.getBreaksForRange(e,t,n);r.splice(0,0,this.getTextWordBreak(e,t));const i=this.getWordCountFromWordBreaks(r,e);return{wordCount:i.wordCount,wordBoundaries:i.wordBoundaries,wordBreaks:r}}getWordCountFromWordBreaks(e,t){const n={browserWordBreakCount:0,wordCount:0,wordBoundaries:[]};let r;for(let i=0;i<e.length;i+=1){const o=e[i];"AlphaNumeric"===o.wordBreakType||"Undetermined"===o.wordBreakType?("Undetermined"===o.wordBreakType&&(n.browserWordBreakCount+=1),l(i,e,t)&&(n.wordCount+=1,r=o.cp)):(void 0!==r&&(n.wordBoundaries.push({start:r,end:o.cp-1}),r=void 0),"Punctuation"!==o.wordBreakType&&"PuncuationWithoutBreak"!==o.wordBreakType||!d(i,e,t)||(n.wordCount+=1))}return void 0!==r&&n.wordBoundaries.push({start:r,end:t.length-1}),n}getForwardBreakInternal(e,t,n){if(t>=n-1)return;let r=t;for(;r<n;){const t=c(e,r);switch(t){case"Undetermined":case"Ignore":break;case"AlphaNumeric":case"Punctuation":case"WhiteSpace":case"PuncuationWithoutBreak":case"FootnoteEndnotePunctuation":{if(r>=n-1)return;let i=r+1,o=c(e,i);for(;"Ignore"===o;){if(i+=1,i>=n)return;o=c(e,i)}if(t!==o&&u(t,o)&&("Undetermined"!==o||!this.supportsBrowserWordBreaking))return{cp:i,wordBreakType:o};break}}r+=1}}};function u(e,t){return"PuncuationWithoutBreak"===e&&"AlphaNumeric"!==t||"AlphaNumeric"===e&&"PuncuationWithoutBreak"!==t||("Punctuation"===e||"FootnoteEndnotePunctuation"===e)||"WhiteSpace"===e}function c(e,t){const n=e.charAt(t).toString();return o.b.isAlphaNum(n)?"AlphaNumeric":function(e){const t=e.charCodeAt(0);return t>=0&&t<=31||32===t||t>=127&&t<=159||160===t||t>=8192&&t<=8202||8239===t||8287===t||9248===t||t>=9250&&t<=9252||12288===t||65282===t}(n)?"WhiteSpace":h(n)?"Punctuation":function(e){return"'"===e||""===e||""===e}(n)?"PuncuationWithoutBreak":function(e){return""===e}(n)?"FootnoteEndnotePunctuation":function(e){return""===e||""===e}(n)?"Ignore":"Undetermined"}function l(e,t,n){if(!e)return!0;const r=t[e];if(!r.cp)return!0;const i=t[e-1];let o=!0;if("Punctuation"===i.wordBreakType){let e=!1;for(let t=i.cp;t<r.cp;t+=1){const r=n.charAt(t);if("-"===r){if(e)return!0;e=!0}else e=!1;if(o=f(r),o)return!0}}else if("Undetermined"===i.wordBreakType)return!1;return("Undetermined"!==r.wordBreakType||"WhiteSpace"===i.wordBreakType)&&o}function d(e,t,n){const r=t[e];if(f(n.charAt(r.cp)))return!1;if(!e)return!0;if(!r.cp)return!1;const i=t[e-1];return"WhiteSpace"===i.wordBreakType||"FootnoteEndnotePunctuation"===i.wordBreakType}function f(e){return""===e||""===e}function h(e){return!!a.has(e)||(e>="!"&&e<="$"||e>="("&&e<="/"||e>=":"&&e<="@"||e>="["&&e<="`"||e>="{"&&e<="~"||e>=""&&e<=""||e>=""&&e<=""||e>=""&&e<=""||e>=" "&&e<=""||e>=" "&&e<="")}s=Object(r.c)([Object(i.a)()],s)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2),i=n(52),o=n(11),a=n(7),s=n(585);let u=class{constructor(e,t){this._wordCount=e,this._hostSettings=t}hasWordCountChanged(e,t,n,r=!1){let i,o=0;r?({wordCount:o,wordBoundaries:i}=this.computeValidWordCountAndBoundariesForRange(n,0,n.length)):o=this.computeValidWordCountForRange(n,0,n.length);const a={isWordCountChanged:!1,wordCount:o,wordBoundaries:i};if(o>0&&0===e.firstDiffLeft&&0===e.firstDiffRight)return a.isWordCountChanged=!0,a;if(e.firstDiffLeft+e.firstDiffRight<=n.length){if(this._wordCount.getWordCountInRange(n,e.firstDiffLeft,n.length-e.firstDiffRight)>1)return a.isWordCountChanged=!0,a}if(t>o)return a.isWordCountChanged=!0,a;const s=this.computeValidWordCountForRange(n,0,n.length-e.firstDiffRight);if(0===s)return a.isWordCountChanged=!1,a;const u=this.computeValidWordCountForRange(n,0,e.firstDiffLeft);return a.isWordCountChanged=s>u,a}getWordCount(e){return this.computeValidWordCountForRange(e,0,e.length)}computeValidWordCountForRange(e,t,n){if(t>=n||t<0||n>e.length)return 0;const{wordCount:r,wordBreaks:i}=this._wordCount.getWordCountAndBreaksInRange(e,t,n);return this.correctWordCountForIncompleteWord(i,e.length,r)}computeValidWordCountAndBoundariesForRange(e,t,n){if(t>=n||t<0||n>e.length)return{wordCount:0,wordBoundaries:[]};const{wordCount:r,wordBreaks:i,wordBoundaries:o}=this._wordCount.getWordCountWithBoundariesAndBreaksInRange(e,t,n);return{wordCount:this.correctWordCountForIncompleteWord(i,e.length,r),wordBoundaries:o}}correctWordCountForIncompleteWord(e,t,n){if(n<=0||0===e.length)return 0;const r=e.length-1;return"WhiteSpace"!==e[r].wordBreakType&&(this._hostSettings.newLineSentenceSeparatorEnabled||this._hostSettings.useParagraphAsTileSeparator||"Punctuation"!==e[r].wordBreakType)&&e[r].cp+1<=t?n-1:n}};u=Object(r.c)([Object(o.a)(),Object(r.f)(0,Object(a.a)(s.a)),Object(r.f)(1,Object(a.a)(i.a))],u)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var r=n(2),i=n(11),o=n(7),a=n(442),s=n(104);let u=class{constructor(e,t,n){this._sentenceSeparator=e,this._paragraphSeparator=t,this._unitySeparator=n}splitInUnitsFromExtendedBoundaries(e,t,n,r){return c(e,t,this.getUnitSeparator(n),r)}extendBoundariesFromDiffBounds(e,t,n){return l(e,t,this.getUnitSeparator(n))}getUnitSeparator(e){switch(e){case s.e.Sentence:return this._sentenceSeparator;case s.e.Paragraph:return this._paragraphSeparator;default:return this._unitySeparator}}};function c(e,t,n,r){const i=function(e,t,n,r){if(!n.firstDiffLeft&&!n.firstDiffRight&&!r.offset&&r.span===t.length)return function(e,t){const n=[],r=e.splitInUnits(t);let i=0;for(const e of r)n.push({offset:i,span:e-i,validEndBoundary:-1!==e}),i=e;(!r.length||r.length&&r[r.length-1]!==t.length)&&n.push({offset:i,span:t.length-i,validEndBoundary:!1});return n}(e,t);const i=2,o=t.slice(r.offset,r.offset+r.span),a=n.firstDiffLeft-r.offset,s=n.firstDiffRight-(t.length-r.offset-r.span);let u=0,c=0;const l=[],d=Math.min(o.length,o.length-s+i);do{const t=u;u=e.findEndBoundary(o,Math.max(u,a-i),d),c=-1!==u&&u<d?u:o.length,c-t&&l.push({offset:t+r.offset,span:c-t,validEndBoundary:-1!==u,enforcedCompleteTileTextUnit:r.enforcedCompleteTileTextUnit})}while(c<o.length);return l}(n,e,t,r||l(e,t,n));return!i.length||i[i.length-1].validEndBoundary&&!1!==i[i.length-1].validEndBoundary||(i[i.length-1]=function(e,t,n){if(!1===t.validEndBoundary&&t.span>=2){let r,i=t.span;do{r=e.slice(t.offset+i-2,t.offset+i),i-=1}while(!/\S/.test(r)&&i>=2);t.validEndBoundary=-1!==n.findEndBoundary(r,0,r.length)}return t}(e,i[i.length-1],n)),i}function l(e,t,n){let r,i=0,o=e.length,a=t.firstDiffLeft+1;if(e.length)do{if(a-=1,i=n.findBeginBoundary(e,a,0),o=n.findEndBoundary(e,e.length-t.firstDiffRight,e.length),r=-1!==o,o=-1!==o?o:e.length,a<e.length){if(i===n.findBeginBoundary(e,a+1,0))continue}let s=i,u=0;for(;s&&a===s+u;){u+=1;const t=s;if(s=n.findBeginBoundary(e,s-1,0),s<t-1){i=s;break}}}while(!(o-i));return{offset:i,span:o-i,validEndBoundary:r}}u=Object(r.c)([Object(i.a)(),Object(r.f)(0,Object(o.a)(a.d)),Object(r.f)(1,Object(o.a)(a.c)),Object(r.f)(2,Object(o.a)(a.a))],u)},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r,i=n(2),o=n(8),a=n(30),s=n(27),u=n(61),c=n(89),l=n(53),d=n(292),f=n(400),h=n(11),p=n(7);let g=r=class{constructor(e,t,n){this._hostEmitter=e,this._proofingPersistedStore=t,this._logger=n,this._autoCorrectDisabledLangs=[],this._calculateLanguagesDisabledForAutocorrect=e=>{const t=[];return e.filter((e=>e.id===r._autocorrectID&&"0"===e.value)).forEach((e=>{e.languageId&&t.push(e.languageId)})),t},this._loadAutoCorrectDisabledLanguages=async()=>{const e=await this.getInlineEditingSettings();return this._calculateLanguagesDisabledForAutocorrect(e)},this._saveInlineEditingSettings=async e=>{const t=e.message,n=await this._proofingPersistedStore.read(o.a.ProofingLanguages),r=Object(f.a)(t,n),i=await this._proofingPersistedStore.read(o.a.OverriddenInlineEditingSettings);await this._proofingPersistedStore.write(o.a.OverriddenInlineEditingSettings,r);const s=this._calculateLanguagesDisabledForAutocorrect(r);this._hostEmitter.emit(a.a.autoCorrectLanguagesUpdated,{address:void 0,message:s}),this._autoCorrectDisabledLangs=s;const u=Object(f.b)(r,i);this._sendTelemetry(u)},this.getAutoCorrectDisabledLanguages=()=>this._autoCorrectDisabledLangs}async initialize(){this._autoCorrectDisabledLangs=await this._loadAutoCorrectDisabledLanguages(),this._hostEmitter.on(a.a.saveInlineEditingSettings,this._saveInlineEditingSettings)}shutDown(){}getInlineEditingSettings(){return this._proofingPersistedStore.read(o.a.OverriddenInlineEditingSettings)}_sendTelemetry(e){var t,n;for(const r of e){const e=this._logger.getNewActivity(d.b.ActionInlineSettingChange,s.a.SamplingPolicy.CriticalExperimentation);e&&(e.dataFields.push(...Object(u.b)(["Setting_Id",r.id],["Setting_Name",null!==(t=r.name)&&void 0!==t?t:""],["Setting_Value",r.value],["Setting_Language",null!==(n=r.languageId)&&void 0!==n?n:""])),e.success=!0,e.endNow())}}};g._autocorrectID="0",g=r=Object(i.c)([Object(h.a)(),Object(i.f)(0,Object(p.a)(a.b)),Object(i.f)(1,Object(p.a)(c.a)),Object(i.f)(2,Object(p.a)(l.a))],g)},function(e){e.exports=JSON.parse('{"version":"2.35.1237"}')},function(e,t,n){(function(e,t){!function(e){"use strict";function n(e){for(var t=0,n=Math.min(65536,e.length+1),r=new Uint16Array(n),i=[],o=0;;){var a=t<e.length;if(!a||o>=n-1){var s=r.subarray(0,o);if(i.push(String.fromCharCode.apply(null,s)),!a)return i.join("");e=e.subarray(t),t=0,o=0}var u=e[t++];if(128&u){if(192==(224&u)){var c=63&e[t++];r[o++]=(31&u)<<6|c}else if(224==(240&u)){c=63&e[t++];var l=63&e[t++];r[o++]=(31&u)<<12|c<<6|l}else if(240==(248&u)){var d=(7&u)<<18|(c=63&e[t++])<<12|(l=63&e[t++])<<6|63&e[t++];d>65535&&(d-=65536,r[o++]=d>>>10&1023|55296,d=56320|1023&d),r[o++]=d}}else r[o++]=u}}var r="Failed to ",i=function(e,t,n){if(e)throw new Error("".concat(r).concat(t,": the '").concat(n,"' option is unsupported."))},o="function"==typeof t&&t.from,a=o?function(e){return t.from(e)}:function(e){for(var t=0,n=e.length,r=0,i=Math.max(32,n+(n>>>1)+7),o=new Uint8Array(i>>>3<<3);t<n;){var a=e.charCodeAt(t++);if(a>=55296&&a<=56319){if(t<n){var s=e.charCodeAt(t);56320==(64512&s)&&(++t,a=((1023&a)<<10)+(1023&s)+65536)}if(a>=55296&&a<=56319)continue}if(r+4>o.length){i+=8,i=(i*=1+t/e.length*2)>>>3<<3;var u=new Uint8Array(i);u.set(o),o=u}if(4294967168&a){if(4294965248&a)if(4294901760&a){if(4292870144&a)continue;o[r++]=a>>>18&7|240,o[r++]=a>>>12&63|128,o[r++]=a>>>6&63|128}else o[r++]=a>>>12&15|224,o[r++]=a>>>6&63|128;else o[r++]=a>>>6&31|192;o[r++]=63&a|128}else o[r++]=a}return o.slice?o.slice(0,r):o.subarray(0,r)};function s(){this.encoding="utf-8"}s.prototype.encode=function(e,t){return i(t&&t.stream,"encode","stream"),a(e)};var u=!o&&"function"==typeof Blob&&"function"==typeof URL&&"function"==typeof URL.createObjectURL,c=["utf-8","utf8","unicode-1-1-utf-8"],l=n;o?l=function(e,n){return(e instanceof t?e:t.from(e.buffer,e.byteOffset,e.byteLength)).toString(n)}:u&&(l=function(e){try{return function(e){var t;try{var n=new Blob([e],{type:"text/plain;charset=UTF-8"});t=URL.createObjectURL(n);var r=new XMLHttpRequest;return r.open("GET",t,!1),r.send(),r.responseText}finally{t&&URL.revokeObjectURL(t)}}(e)}catch(t){return n(e)}});var d="construct 'TextDecoder'",f="".concat(r," ").concat(d,": the ");function h(e,n){if(i(n&&n.fatal,d,"fatal"),e=e||"utf-8",!(o?t.isEncoding(e):-1!==c.indexOf(e.toLowerCase())))throw new RangeError("".concat(f," encoding label provided ('").concat(e,"') is invalid."));this.encoding=e,this.fatal=!1,this.ignoreBOM=!1}h.prototype.decode=function(e,t){var n;return i(t&&t.stream,"decode","stream"),n=e instanceof Uint8Array?e:e.buffer instanceof ArrayBuffer?new Uint8Array(e.buffer):new Uint8Array(e),l(n,this.encoding)},e.TextEncoder=e.TextEncoder||s,e.TextDecoder=e.TextDecoder||h}("undefined"!=typeof window?window:void 0!==e?e:this)}).call(this,n(69),n(530).Buffer)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"ResponseStatus",(function(){return gl})),n.d(r,"ConfidenceLevel",(function(){return ml})),n.d(r,"Source",(function(){return yl})),n.d(r,"TilingType",(function(){return bl})),n.d(r,"TextUnit",(function(){return vl})),n.d(r,"EventId",(function(){return wl})),n.d(r,"MetadataType",(function(){return Sl})),n.d(r,"Type",(function(){return _l})),n.d(r,"Status",(function(){return Tl})),n.d(r,"Tag",(function(){return Ol}));var i={};n.r(i),n.d(i,"Email",(function(){return kl})),n.d(i,"File",(function(){return Al})),n.d(i,"Acronym",(function(){return Pl})),n.d(i,"AcronymsResponse",(function(){return Nl})),n.d(i,"CommonAppIdProperty",(function(){return jl})),n.d(i,"BrowserExtensionRequestV1",(function(){return Rl})),n.d(i,"BrowserExtensionResponseV1",(function(){return xl})),n.d(i,"Descriptor",(function(){return Dl})),n.d(i,"CommonLanguageIdProperty",(function(){return Ml})),n.d(i,"CritiqueTypeOption",(function(){return Ll})),n.d(i,"Suggestion",(function(){return Bl})),n.d(i,"CommonAppVersionProperty",(function(){return Fl})),n.d(i,"ClientSuggestion",(function(){return Ul})),n.d(i,"Tiling",(function(){return ql})),n.d(i,"DocumentStructureMetadata",(function(){return zl})),n.d(i,"CheckRequestV1",(function(){return Wl})),n.d(i,"CheckedSpan",(function(){return Vl})),n.d(i,"Metadatum",(function(){return Gl})),n.d(i,"Critique",(function(){return Hl})),n.d(i,"ReadingConcept",(function(){return $l})),n.d(i,"ReadingCritique",(function(){return Kl})),n.d(i,"ReadingResponse",(function(){return Jl})),n.d(i,"CommonResponseStatusProperty",(function(){return Ql})),n.d(i,"CheckResponseV1",(function(){return Yl})),n.d(i,"CommonCritique",(function(){return Xl})),n.d(i,"CommonDescriptorsProperty",(function(){return Zl})),n.d(i,"CommonLanguageUXIdProperty",(function(){return ed})),n.d(i,"CommonOverriddenCritiqueTypeOptions",(function(){return td})),n.d(i,"CommonParagraphIdProperty",(function(){return nd})),n.d(i,"CommonParagraphRevisionIdProperty",(function(){return rd})),n.d(i,"CommonRequestIdProperty",(function(){return id})),n.d(i,"CommonTileIdProperty",(function(){return od})),n.d(i,"CommonRevisionIdProperty",(function(){return ad})),n.d(i,"CommonRunOnProfileIdProperty",(function(){return sd})),n.d(i,"CommonTextUnitProperty",(function(){return ud})),n.d(i,"ConfigRequestV1",(function(){return cd})),n.d(i,"CritiqueTypeInfo",(function(){return ld})),n.d(i,"CritiqueCategoryInfo",(function(){return dd})),n.d(i,"Profile",(function(){return fd})),n.d(i,"ConfigResponseV1",(function(){return hd})),n.d(i,"ConfigRequestV2",(function(){return pd})),n.d(i,"ConfigResponseV2",(function(){return gd})),n.d(i,"InsightsRequestV1",(function(){return md})),n.d(i,"InsightsResponseV1AnalyzerData",(function(){return yd})),n.d(i,"InsightsResponseV1",(function(){return bd})),n.d(i,"InstrumentationRequestV1",(function(){return vd})),n.d(i,"LanguageInfoRequestV1",(function(){return wd})),n.d(i,"SupportedLanguage",(function(){return Sd})),n.d(i,"LanguageInfoResponseV1",(function(){return _d})),n.d(i,"MetadataContent",(function(){return Td})),n.d(i,"Metadata",(function(){return Od})),n.d(i,"TextElement",(function(){return Cd})),n.d(i,"NeuralBatchCheckRequestV1",(function(){return Ed})),n.d(i,"NeuralBatchCheckResponseV1",(function(){return Id})),n.d(i,"NeuralRewriteRequestV1",(function(){return kd})),n.d(i,"NeuralRewriteResponseV1",(function(){return Ad})),n.d(i,"SelectedLanguages",(function(){return Pd})),n.d(i,"SupportedActions",(function(){return Nd})),n.d(i,"TopologyNode",(function(){return jd})),n.d(i,"TileCheckSpan",(function(){return Rd})),n.d(i,"TileElement",(function(){return xd})),n.d(i,"TileContent",(function(){return Dd})),n.d(i,"TileCheckRequestV1",(function(){return Md})),n.d(i,"TileCheckCritique",(function(){return Ld})),n.d(i,"TileCheckResponseV1",(function(){return Bd})),n.d(i,"UserIdentity",(function(){return Fd})),n.d(i,"PostCheckHeaders",(function(){return Ud})),n.d(i,"GetCheckHeaders",(function(){return qd})),n.d(i,"PostTileCheckHeaders",(function(){return zd})),n.d(i,"ConfigV1Headers",(function(){return Wd})),n.d(i,"ConfigV2Headers",(function(){return Vd})),n.d(i,"LanguageinfoHeaders",(function(){return Gd})),n.d(i,"NeuralbatchcheckHeaders",(function(){return Hd})),n.d(i,"InstrumentationHeaders",(function(){return $d}));var o=n(53),a=n(416),s=n(27),u=n(34),c=n(58),l=n(16),d=n(9),f=Object(d.a)("IAnnouncementFlagDetector"),h=n(616),p=n(412),g=n(200),m=n(358),y=n(359),b=n(140),v=n(74),w=n(532),S=n(52),_=n(30),T=n(305),O=n(94),C=n(195),E=n(535),I=n(536),k=n(288),A=n(392),P=n(212),N=n(40),j=n(568),R=n(180),x=n(393),D=n(265),M=n(343),L=n(178),B=n(226),F=n(363),U=n(629),q=n(419),z=n(169),W=n(170),V=n(322),G=n(10),H=n(396),$=n(285),K=n(89),J=n(235),Q=n(236),Y=n(237),X=n(338),Z=n(196),ee=n(320),te=n(630),ne=n(631),re=n(632),ie=n(126),oe=n(584),ae=n(866),se=n(545),ue=n(867),ce=n(537),le=n(2),de=n(8),fe=n(579),he=n(11),pe=n(7),ge=n(271);let me=class{constructor(e,t,n){this._critiqueValueStore=e,this._hostEmitters=t,this._proofingStore=n}async performCall(){const e=await this._proofingStore.read(de.a.AppId),t=await this._proofingStore.read(de.a.ProofingLanguages);if(this._critiqueValueStore.reset(),Array.isArray(t))for(const n of t){const t={appId:e,languageId:n};this._hostEmitters.forEach((e=>{e.emit(_.a.configV2RequestEvent,{message:{request:t,refresh:!0},address:void 0})}))}}};me=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(fe.a)),Object(le.f)(1,Object(ge.a)(_.c)),Object(le.f)(2,Object(pe.a)(K.a))],me);var ye=n(727),be=n(61),ve=n(292),we=n(400);let Se=class{constructor(e,t,n){this._hostEmitter=e,this._logger=t,this._proofingPersistedStore=n,this._saveCritiqueSettings=async e=>{const t=e.message,n=await this._proofingPersistedStore.read(de.a.ProofingLanguages),r=Object(we.a)(t,n),i=await this._proofingPersistedStore.read(de.a.OverriddenCritiqueTypeOptions);await this._proofingPersistedStore.write(de.a.OverriddenCritiqueTypeOptions,r),this._hostEmitter.emit(_.a.critiqueSettingsChange,{address:void 0,message:r});const o=Object(we.b)(r,i);this._sendTelemetry(o)}}async initialize(){this._hostEmitter.on(_.a.saveCritiqueSettings,this._saveCritiqueSettings)}shutDown(){}_sendTelemetry(e){var t;for(const n of e){const e=this._logger.getNewActivity(ve.b.ActionCritiqueSettingsChange,s.a.SamplingPolicy.CriticalExperimentation);e&&(e.dataFields.push(...Object(be.b)(["CritiqueTypeOption_Id",n.id],["CritiqueTypeOption_Name",null!==(t=n.name)&&void 0!==t?t:""],["CritiqueTypeOption_Value",n.value])),e.success=!0,e.endNow())}}};Se=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(_.b)),Object(le.f)(1,Object(pe.a)(o.a)),Object(le.f)(2,Object(pe.a)(K.a))],Se);var _e,Te,Oe=n(871),Ce=n(326),Ee=n(80),Ie=n(233);!function(e){e.NoLicense="NoLicense",e.Perpetual="Perpetual",e.Subscription="Subscription",e.SubscriptionPreview="SubscriptionPreview"}(_e||(_e={})),function(e){e[e.OrthographicSpellChecking=0]="OrthographicSpellChecking",e[e.ContextualSpellChecking=1]="ContextualSpellChecking",e[e.CoreGrammarChecking=2]="CoreGrammarChecking",e[e.NeuralGrammarChecking=3]="NeuralGrammarChecking"}(Te||(Te={}));var ke=n(33);class Ae{constructor(e){ke.a.assign(Ae,this,e)}static getTypeName(){return"AugLoop_Text_ProofingAnnotationActivationConfig"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ae.getTypeName()])}}Ae.H_={T_:Ae.getTypeName(),B_:Ae.getBaseTypes()};var Pe=n(374);const Ne=Object(d.a)("IProofingAnnotationActivationConfigProvider");let je=class{constructor(e,t,n,r,i){this._descriptorManager=e,this._featureFlagsReader=t,this._hostSettings=n,this._proofingStore=r,this._userInfoStrategy=i,this.getProofingAnnotationActivationConfig=async()=>{if(!this._featureFlagsReader.flags.enableAnnotationActivationConfig)return;const e=await this._descriptorManager.buildDescriptors();let t=_e.NoLicense;this._userInfoStrategy.execute(!1,(n=>(t=Object(Pe.a)(e,this._hostSettings.enhancedUpsellEnabled,null==n?void 0:n.licenseType),n)));let n=[];this._featureFlagsReader.flags.enableOrchestratorOverriddenCritiqueTypeOptions&&(n=await this._proofingStore.read(de.a.OverriddenCritiqueTypeOptions)),n=n.filter((e=>!Object(Ee.e)(e.id)));const r=this._hostSettings.isMultilingualProofingEnabled?await this._proofingStore.read(de.a.ProofingLanguages):void 0;if(r&&this._hostSettings.defaultLocale&&this._hostSettings.addUXLanguageToMultilingualProofingList){const e=this._hostSettings.defaultLocale.split("-")[0];r.find((t=>t.split("-")[0].toLowerCase()===e.toLowerCase()))||r.push(this._hostSettings.defaultLocale)}return new Ae({LicenseType:t,OverriddenCritiqueTypeOptions:n,ProofingLanguages:r})}}};je=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(Ie.a)),Object(le.f)(1,Object(pe.a)(v.a)),Object(le.f)(2,Object(pe.a)(S.a)),Object(le.f)(3,Object(pe.a)(K.a)),Object(le.f)(4,Object(pe.a)(N.a))],je);const Re=Object(d.a)("IClientSubscriber");var xe=n(627);class De{constructor(e){ke.a.assign(De,this,e)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[De.getTypeName()])}}De.H_={T_:De.getTypeName(),B_:De.getBaseTypes()};class Me{constructor(e){ke.a.assign(Me,this,e)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Me.getTypeName()])}}Me.H_={T_:Me.getTypeName(),B_:Me.getBaseTypes()};class Le{constructor(e){ke.a.assign(Le,this,e)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Le.getTypeName()])}}Le.H_={T_:Le.getTypeName(),B_:Le.getBaseTypes()};class Be{constructor(e){ke.a.assign(Be,this,e)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Be.getTypeName()])}}Be.H_={T_:Be.getTypeName(),B_:Be.getBaseTypes()};class Fe{constructor(e){ke.a.assign(Fe,this,e)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Fe.getTypeName()])}}Fe.H_={T_:Fe.getTypeName(),B_:Fe.getBaseTypes()};class Ue{constructor(e){ke.a.assign(Ue,this,e)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ue.getTypeName()])}}Ue.H_={T_:Ue.getTypeName(),B_:Ue.getBaseTypes()};class qe{constructor(e){ke.a.assign(qe,this,e)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[qe.getTypeName()])}}qe.H_={T_:qe.getTypeName(),B_:qe.getBaseTypes()};class ze{constructor(e){ke.a.assign(ze,this,e)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[ze.getTypeName()])}}ze.H_={T_:ze.getTypeName(),B_:ze.getBaseTypes()};class We{constructor(e){ke.a.assign(We,this,e)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[We.getTypeName()])}}We.H_={T_:We.getTypeName(),B_:We.getBaseTypes()};class Ve{constructor(e){ke.a.assign(Ve,this,e)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ve.getTypeName()])}}Ve.H_={T_:Ve.getTypeName(),B_:Ve.getBaseTypes()};class Ge{constructor(e){ke.a.assign(Ge,this,e)}static getTypeName(){return"AugLoop_Core_PurgeSubtreeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ge.getTypeName()])}}Ge.H_={T_:Ge.getTypeName(),B_:Ge.getBaseTypes()};class He{constructor(e){ke.a.assign(He,this,e)}static getTypeName(){return"AugLoop_Core_PurgeSubtreeExceptTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[He.getTypeName()])}}He.H_={T_:He.getTypeName(),B_:He.getBaseTypes()};class $e{constructor(e){ke.a.assign($e,this,e)}static getTypeName(){return"AugLoop_Core_PurgeByTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[$e.getTypeName()])}}$e.H_={T_:$e.getTypeName(),B_:$e.getBaseTypes()};class Ke{constructor(e){ke.a.assign(Ke,this,e)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ke.getTypeName()])}}Ke.H_={T_:Ke.getTypeName(),B_:Ke.getBaseTypes()};class Je{constructor(e){ke.a.assign(Je,this,e)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Je.getTypeName()])}}Je.H_={T_:Je.getTypeName(),B_:Je.getBaseTypes()};class Qe{constructor(e){ke.a.assign(Qe,this,e)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Qe.getTypeName()])}}Qe.H_={T_:Qe.getTypeName(),B_:Qe.getBaseTypes()};class Ye{constructor(e){ke.a.assign(Ye,this,e)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ye.getTypeName()])}}Ye.H_={T_:Ye.getTypeName(),B_:Ye.getBaseTypes()};class Xe{constructor(e){ke.a.assign(Xe,this,e)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Xe.getTypeName()])}}Xe.H_={T_:Xe.getTypeName(),B_:Xe.getBaseTypes()};class Ze{constructor(e,t){this._hostEmitter=e,this._logger=t,this._activationTokens=[]}async activateAnnotationsBase(e,t,n){if(e)if(this._activationTokens.length)this._logger.logDiagnostics(`Trying to activate ${this.annotationListenerType} annotation which is already initialized.`);else{this._session=e,this._sessionId=t;try{const e=await Promise.all(n());this._activationTokens=e.map((e=>e.token))}catch(e){this._logger.error(508044171,`Trying to activate ${this.annotationListenerType} failed due to an exception.`,e)}}else this._logger.logDiagnostics(`Trying to activate ${this.annotationListenerType} annotation with no session.`)}async deactivateAnnotations(e){if(!e||!this._activationTokens.length)return!1;try{const t=await Promise.all(this._activationTokens.map((t=>e.releaseAnnotation(t))));return this._activationTokens=[],t.every(Boolean)}catch(e){return this._logger.error(508044170,`Trying to deactivate ${this.annotationListenerType} failed due to an exception.`,e),!1}}async updateAnnotationActivationConfig(e){this._session?this._activationTokens.length?e&&this._activationTokens.map((t=>{var n;return null===(n=this._session)||void 0===n?void 0:n.updateAnnotationConfig(t,e)})):this._logger.logDiagnostics(`${this.annotationListenerType}: Trying to update annotation config without a valid token.`):this._logger.logDiagnostics(`${this.annotationListenerType}: Trying to update annotation config without a valid session object.`)}}class et{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(et,this,e)}static getTypeName(){return"AugLoop_Text_RangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[et.getTypeName()])}}et.H_={T_:et.getTypeName(),B_:et.getBaseTypes()};class tt{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(tt,this,e)}static getTypeName(){return"AugLoop_Text_MultiTileRangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[tt.getTypeName()])}}tt.H_={T_:tt.getTypeName(),B_:tt.getBaseTypes()};class nt{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(nt,this,e)}static getTypeName(){return"AugLoop_Text_LanguageDetectionSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[nt.getTypeName()])}}nt.H_={T_:nt.getTypeName(),B_:nt.getBaseTypes()};class rt{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(rt,this,e)}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[rt.getTypeName()])}}rt.H_={T_:rt.getTypeName(),B_:rt.getBaseTypes()};class it{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(it,this,e)}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotationLocalized"}static getBaseTypes(){return["AugLoop_Text_LanguageCountAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[it.getTypeName()])}}it.H_={T_:it.getTypeName(),B_:it.getBaseTypes()};class ot{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(ot,this,e)}static getTypeName(){return"AugLoop_Text_Definition"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[ot.getTypeName()])}}ot.H_={T_:ot.getTypeName(),B_:ot.getBaseTypes()};class at{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(at,this,e)}static getTypeName(){return"AugLoop_Text_SuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[at.getTypeName()])}}at.H_={T_:at.getTypeName(),B_:at.getBaseTypes()};class st{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(st,this,e)}static getTypeName(){return"AugLoop_Text_Critique"}static getBaseTypes(){return["AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[st.getTypeName()])}}st.H_={T_:st.getTypeName(),B_:st.getBaseTypes()};class ut{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(ut,this,e)}static getTypeName(){return"AugLoop_Text_NeuralRewriteCritique"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[ut.getTypeName()])}}ut.H_={T_:ut.getTypeName(),B_:ut.getBaseTypes()};class ct{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(ct,this,e)}static getTypeName(){return"AugLoop_Text_CritiqueCategoryCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[ct.getTypeName()])}}ct.H_={T_:ct.getTypeName(),B_:ct.getBaseTypes()};class lt{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(lt,this,e)}static getTypeName(){return"AugLoop_Text_UniqueWordsCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[lt.getTypeName()])}}lt.H_={T_:lt.getTypeName(),B_:lt.getBaseTypes()};class dt{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(dt,this,e)}static getTypeName(){return"AugLoop_Text_EmptyDocumentAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[dt.getTypeName()])}}dt.H_={T_:dt.getTypeName(),B_:dt.getBaseTypes()};class ft{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(ft,this,e)}static getTypeName(){return"AugLoop_Text_IdeasPersonalizationSettingsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[ft.getTypeName()])}}ft.H_={T_:ft.getTypeName(),B_:ft.getBaseTypes()};class ht{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(ht,this,e)}static getTypeName(){return"AugLoop_Text_TextToSpeechAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[ht.getTypeName()])}}ht.H_={T_:ht.getTypeName(),B_:ht.getBaseTypes()};class pt{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(pt,this,e)}static getTypeName(){return"AugLoop_Text_AutoreplaceAnnotation"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[pt.getTypeName()])}}pt.H_={T_:pt.getTypeName(),B_:pt.getBaseTypes()};class gt{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(gt,this,e)}static getTypeName(){return"AugLoop_Text_TextStreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_StreamAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[gt.getTypeName()])}}gt.H_={T_:gt.getTypeName(),B_:gt.getBaseTypes()};var mt=n(138),yt=n(339),bt=n(104);const vt=(e,t,n)=>{const r=n?e.length:t;return e.slice(0,r).map((e=>{var t;return{action:null!==(t=e.suggestionActions)&&void 0!==t?t:0,confidenceLevel:bt.c.High,description:e.description,source:bt.d.None,text:e.text,metadataJSON:e.metadataJSON,languages:e.languageIds}}))},wt=(e,t,n,r,i=3,o=!1)=>{var a;if(e)return{annotationId:t,categoryTitle:e.categoryName,explanation:e.explanationBody,explanationTitle:e.explanationTitle,explanationLabel:e.explanationLabel,languageId:e.language,length:e.range.length,metadata:e.critiqueMetadata?Object.entries(e.critiqueMetadata).map((([e,t])=>({name:e,value:t}))):[],nodeId:n,nodeVersion:r,priority:e.priority,start:e.range.start,suggestions:vt(e.suggestions,i,o),supportedActions:null!==(a=e.critiqueActions)&&void 0!==a?a:0,textInContext:e.context,traceId:e.id,typeId:e.typeId}};var St=n(6);class _t extends Ze{constructor(e,t,n,r,i,o,a){super(t,n),this._hostSettings=e,this._hostEmitter=t,this._logger=n,this._proofingAnnotationActivationConfigProvider=r,this._featureFlagsReader=i,this._annotationsFilterer=o,this._aggregateLogger=a,this._annotationOperations=[],this.annotationListenerType=st.getTypeName(),this._onThrottledAnnotationResult=e=>{this._annotationOperations.push(e),this._throttledAnnotationResult()},this._onThrottledAnnotationResultCallback=()=>{const e=this._annotationOperations;this._annotationOperations=[],this._onAnnotationResults(e)},this._onAnnotationResults=e=>{this._activationTokens.length&&Object(St.transaction)((()=>{const t=function(e,t,n,r,i,o,a){var s,u;const c=new Map;for(const l of e){if(!l.items.length)continue;let e;const d=ke.a.getTypeNameFor(l);switch(Tt(a,l,d),d){case Fe.getTypeName():e=mt.a.NewData;break;case We.getTypeName():e=mt.a.RemoveData;break;default:null==o||o.error(544272668,`[CritiqueAnnotationListener]: Unexpected annotation operation: ${d}`);continue}const f=null!==(s=l.parentPath[l.parentPath.length-1])&&void 0!==s?s:"",h=Number.parseInt(null!==(u=l.parentRevId)&&void 0!==u?u:"0",10);let p;p=t?i&&d!==We.getTypeName()?i.filter(l.items):l.items:i?i.filter(l.items):l.items;const g=e===mt.a.NewData?p.map((e=>wt(e.body,e.id,f,h,r,n))).filter((e=>void 0!==e)):[],m=e===mt.a.RemoveData?p.map((e=>e.id)):[];let y=c.get(f);y?(y.tileVersion=h,y.critiquesAdded.push(...g),y.critiqueIdsRemoved.push(...m)):y={tileVersion:h,critiquesAdded:g,critiqueIdsRemoved:m},c.set(f,y)}return c}(e,this._featureFlagsReader.flags.enableOrchestratorCritiqueDeletion,!!this._hostSettings.isMultilingualProofingEnabled,this._hostSettings.maxSuggestionItemsDisplayNumber,this._annotationsFilterer,this._logger,this._aggregateLogger);for(const[e,{tileVersion:n,critiquesAdded:r,critiqueIdsRemoved:i}]of t.entries())this._hostEmitter.emit(_.a.hostModelCritiques,{address:this._sessionId,message:{messageType:mt.a.ChangeData,data:{tileId:e,tileVersion:n,critiquesAdded:r,critiqueIdsRemoved:i,source:"Augloop"}}})}))},this._throttledAnnotationResult=Object(yt.a)(this._onThrottledAnnotationResultCallback,10,"After")}async activateAnnotations(e,t){this._currentProofingAnnotationConfig=await this._proofingAnnotationActivationConfigProvider.getProofingAnnotationActivationConfig();await super.activateAnnotationsBase(e,t,(()=>e?[e.activateAnnotation(this.annotationListenerType,{callback:this._onThrottledAnnotationResult,config:this._currentProofingAnnotationConfig})]:[]))}async updateAnnotationActivationConfig(){const e=await this._proofingAnnotationActivationConfigProvider.getProofingAnnotationActivationConfig();(function(e,t){var n,r;if(!e!=!t)return!1;if(!e||!t)return!0;return(null!==(n=e.LanguageAutoDetectEnabled)&&void 0!==n&&n)===(null!==(r=t.LanguageAutoDetectEnabled)&&void 0!==r&&r)&&e.LicenseType===t.LicenseType&&JSON.stringify(e.OverriddenCritiqueTypeOptions)===JSON.stringify(t.OverriddenCritiqueTypeOptions)&&JSON.stringify(e.ProofingLanguages)===JSON.stringify(t.ProofingLanguages)})(this._currentProofingAnnotationConfig,e)||(this._currentProofingAnnotationConfig=e,await super.updateAnnotationActivationConfig(e))}}function Tt(e,t,n){e&&(e.incrementEventCount(509741091,`Critiques received with operation type: ${n}`,t.items.length),e.incrementEventCount(509741090,`Spelling critiques received with operation type: ${n}`,Ot(t,Ee.c.High)),e.incrementEventCount(509741089,`Grammar critiques received with operation type: ${n}`,Ot(t,Ee.c.Medium)),e.incrementEventCount(509741088,`Refinements critiques received with operation type: ${n}`,Ot(t,Ee.c.Low)),e.incrementEventCount(509741087,`Informational critiques received with operation type: ${n}`,Ot(t,Ee.c.Informational)))}function Ot(e,t){return e.items.filter((e=>{const n=e.body;return(null==n?void 0:n.priority)===t})).length}const Ct=Object(d.a)("IAnnotationsFilterer");var Et=n(98);let It=class{constructor(e,t,n,r,i,o,a,s){this._hostEmitter=e,this._proofingEmitter=t,this._logger=n,this._proofingAnnotationActivationConfigProvider=r,this._featureFlagsReader=i,this._hostSettings=o,this._annotationsFilterer=a,this._aggregateLogger=s,this.sessionsProvider=void 0,this._onEnabledCritiqueTypesChangedEvent=e=>{this._featureFlagsReader.flags.enableOrchestratorOverriddenCritiqueTypeOptions&&this.updateAnnotationActivationConfigs()},this._onProofingLanguagesChangedEvent=e=>{e.proofingLanguagesChanged&&this._hostSettings.isMultilingualProofingEnabled&&this.updateAnnotationActivationConfigs()}}register(e){this.sessionsProvider=e,this._proofingEmitter.on("enabledCritiqueTypesChanged",this._onEnabledCritiqueTypesChangedEvent),this._proofingEmitter.on("proofingLanguageChanged",this._onProofingLanguagesChangedEvent)}unregister(){this._proofingEmitter.off("enabledCritiqueTypesChanged",this._onEnabledCritiqueTypesChangedEvent),this._proofingEmitter.off("proofingLanguageChanged",this._onProofingLanguagesChangedEvent)}createAnnotationListener(){return new _t(this._hostSettings,this._hostEmitter,this._logger,this._proofingAnnotationActivationConfigProvider,this._featureFlagsReader,this._annotationsFilterer,this._aggregateLogger)}onInitialize(e){}onSessionReconnected(e){}onDocumentCreated(e,t){}get isEnabled(){return this._featureFlagsReader.flags.enableOrchestration}async updateAnnotationActivationConfigs(){var e;const t=await(null===(e=this.sessionsProvider)||void 0===e?void 0:e.getSessions());if(t)for(const e of t.values())await(null==e?void 0:e.updateAnnotationActivationConfig())}};It=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(_.b)),Object(le.f)(1,Object(pe.a)(C.a)),Object(le.f)(2,Object(pe.a)(o.a)),Object(le.f)(3,Object(pe.a)(Ne)),Object(le.f)(4,Object(pe.a)(v.a)),Object(le.f)(5,Object(pe.a)(S.a)),Object(le.f)(6,Object(Et.a)()),Object(le.f)(6,Object(pe.a)(Ct)),Object(le.f)(7,Object(Et.a)()),Object(le.f)(7,Object(pe.a)(xe.a))],It);var kt=n(626),At=n(55),Pt=n(154);class Nt{constructor(e,t,n,r,i,o,a,s){this._sessionId=e,this._logger=t,this._annotationListeners=n,this._session=r,this._aggregateLogger=i,this._augloopDocumentSerializer=o,this._hostEmitter=a,this._clientSubscribers=s,this.sessionWasDisconnected=!1,this.initialize=async()=>{try{this._session.setConnectCallback(this.onSessionConnected),this._session.setDisconnectCallback(this.onSessionDisconnected)}catch(e){this._logger.error(561534362,"Failed to initialize AugLoop session callbacks",e)}try{await this.activateAnnotations(this._annotationListeners.map((e=>e.annotationListenerType)))}catch(e){this._logger.error(508614281,"Failed to initialize AugLoop session annotations",e)}},this.close=()=>{this._session.close()},this.submitDelta=(e,t,n)=>{var r;const i=new Qe({parentPath:e,items:[{id:e[e.length-1],revId:`${n}`,body:t,sourceTimestamp:Date.now()}]});this._session.submitOperation(i),null===(r=this._aggregateLogger)||void 0===r||r.incrementEventCount(512337430,`submitDelta. unit: ${t.unit}`)},this.getSessionId=()=>this._sessionId,this.getSession=()=>this._session,this.updateAnnotationActivationConfig=async()=>{await Promise.all(this._annotationListeners.map((e=>{var t;return null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325704,`updateAnnotationActivationConfig called for ${e.annotationListenerType}`),e.updateAnnotationActivationConfig()})))},this.activateAnnotations=async e=>{const t=this._annotationListeners.filter((t=>null==e?void 0:e.some((e=>e===t.annotationListenerType))));await Promise.all(t.map((e=>{var t;return null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325703,`activateAnnotations called for ${e.annotationListenerType}`),e.activateAnnotations(this._session,this._sessionId)})))},this.releaseAnnotations=async e=>{const t=this._annotationListeners.filter((t=>null==e?void 0:e.some((e=>e===t.annotationListenerType))));return(await Promise.all(t.map((e=>{var t;return null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325702,`deactivateAnnotations called for ${e.annotationListenerType}`),e.deactivateAnnotations(this._session)})))).every(Boolean)},this.submitSignal=(e,t,n)=>{var r,i,o;const a=new Xe({parentPath:this._augloopDocumentSerializer.getParentPath(this,n),items:[{id:t,body:e}]});this._session.submitOperation(a),null===(r=this._aggregateLogger)||void 0===r||r.incrementEventCount(512325701,`submitted a signal of type: ${null!==(o=null===(i=e.H_)||void 0===i?void 0:i.T_)&&void 0!==o?o:"unknown"}`)},this.onDocumentCreated=e=>{for(const t of this._clientSubscribers)t.onDocumentCreated(this,e)},this.onSessionDisconnected=()=>{this.sessionWasDisconnected=!0,this._logger.warn(507773218,"Augloop session has disconnected")},this.onSessionConnected=async e=>{if(!e)return;const t=this.sessionWasDisconnected;if(this.sessionWasDisconnected=!1,t){this._logger.warn(508631257,"Augloop session has reconnected"),this._augloopDocumentSerializer.sessionReconnected(this._session),this._augloopDocumentSerializer.submitSeedOperations(this._session);for(const e of this._clientSubscribers)e.onSessionReconnected(this);this._hostEmitter.emit(_.a.hostModelRehydrateTiles,{address:this._sessionId,message:[]}),this._hostEmitter.emit(_.a.hostModelRehydrateTilesFinished,{address:this._sessionId,message:[]})}else this._logger.warn(508421253,"Augloop session has initially connected"),this._augloopDocumentSerializer.submitSeedOperations(this._session)}}submitOperation(e){var t,n;this._session.submitOperation(e);const r=ke.a.getTypeNameFor(e);null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325706,`_submitItemsOperation called with ${r}`),null===(n=this._aggregateLogger)||void 0===n||n.incrementEventCount(512325705,`items submitted through ${r}`,e.items.length)}}const jt=Object(d.a)("AugloopSessionFactory"),Rt=Object(d.a)("IOrchestrator");class xt{constructor(e){ke.a.assign(xt,this,e)}static getTypeName(){return"AugLoop_Core_Blob"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[xt.getTypeName()])}}xt.H_={T_:xt.getTypeName(),B_:xt.getBaseTypes()};class Dt{constructor(e){ke.a.assign(Dt,this,e)}static getTypeName(){return"AugLoop_Core_Binary"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Dt.getTypeName()])}}Dt.H_={T_:Dt.getTypeName(),B_:Dt.getBaseTypes()};class Mt{constructor(e){ke.a.assign(Mt,this,e)}static getTypeName(){return"AugLoop_Core_TileGroup"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Mt.getTypeName()])}}Mt.H_={T_:Mt.getTypeName(),B_:Mt.getBaseTypes()};class Lt{constructor(e){ke.a.assign(Lt,this,e)}static getTypeName(){return"AugLoop_Core_Session"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Lt.getTypeName()])}}Lt.H_={T_:Lt.getTypeName(),B_:Lt.getBaseTypes()};class Bt{constructor(e){ke.a.assign(Bt,this,e)}static getTypeName(){return"AugLoop_Core_Document"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Bt.getTypeName()])}}Bt.H_={T_:Bt.getTypeName(),B_:Bt.getBaseTypes()};class Ft{constructor(e){ke.a.assign(Ft,this,e)}static getTypeName(){return"AugLoop_Core_SubDocument"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ft.getTypeName()])}}Ft.H_={T_:Ft.getTypeName(),B_:Ft.getBaseTypes()};class Ut{constructor(e){ke.a.assign(Ut,this,e)}static getTypeName(){return"AugLoop_Core_GridCell"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ut.getTypeName()])}}Ut.H_={T_:Ut.getTypeName(),B_:Ut.getBaseTypes()};class qt{constructor(e){ke.a.assign(qt,this,e)}static getTypeName(){return"AugLoop_Core_GridNeighborhoodContext"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[qt.getTypeName()])}}qt.H_={T_:qt.getTypeName(),B_:qt.getBaseTypes()};class zt{constructor(e){ke.a.assign(zt,this,e)}static getTypeName(){return"AugLoop_Core_ItemFilter"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[zt.getTypeName()])}}zt.H_={T_:zt.getTypeName(),B_:zt.getBaseTypes()};class Wt{constructor(e){ke.a.assign(Wt,this,e)}static getTypeName(){return"AugLoop_Core_DynamicContext"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Wt.getTypeName()])}}Wt.H_={T_:Wt.getTypeName(),B_:Wt.getBaseTypes()};class Vt{constructor(e){ke.a.assign(Vt,this,e)}static getTypeName(){return"AugLoop_Core_ContextHolder"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Vt.getTypeName()])}}Vt.H_={T_:Vt.getTypeName(),B_:Vt.getBaseTypes()};class Gt{constructor(e){ke.a.assign(Gt,this,e)}static getTypeName(){return"AugLoop_Core_UserContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Gt.getTypeName()])}}Gt.H_={T_:Gt.getTypeName(),B_:Gt.getBaseTypes()};class Ht{constructor(e){ke.a.assign(Ht,this,e)}static getTypeName(){return"AugLoop_Core_TenantContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ht.getTypeName()])}}Ht.H_={T_:Ht.getTypeName(),B_:Ht.getBaseTypes()};class $t{constructor(e){ke.a.assign($t,this,e)}static getTypeName(){return"AugLoop_Core_EventsHolder"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[$t.getTypeName()])}}$t.H_={T_:$t.getTypeName(),B_:$t.getBaseTypes()};class Kt{constructor(e){ke.a.assign(Kt,this,e)}static getTypeName(){return"AugLoop_Core_UserCommandsHolder"}static getBaseTypes(){return["AugLoop_Core_EventsHolder"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Kt.getTypeName()])}}Kt.H_={T_:Kt.getTypeName(),B_:Kt.getBaseTypes()};let Jt=class{constructor(e){this._clientSubscribers=e,this.hasCreatedDocument=!1}sessionReconnected(e){this.hasCreatedDocument=!1}submitSeedOperations(e){const t=new Bt({isReadonly:!1}),n=new Fe({parentPath:["session"],items:[{id:"doc",body:t}]});try{e.submitSeedOperations([n])}catch(e){}}getParentPath(e,t){if(!this.hasCreatedDocument){this.hasCreatedDocument=!0;for(const n of this._clientSubscribers)n.onDocumentCreated(e,t)}return["session","doc"]}};Jt=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(ge.a)(Re)),Object(le.f)(0,Object(Et.a)())],Jt);const Qt=Object(d.a)("IALSessionFromHost"),Yt=(Object(d.a)("ProofingSettingsRequestTypes"),Object(d.a)("IAugloopDocumentSerializer"));let Xt=class{constructor(e,t,n,r,i,o,a,s,u,c){this._hostEmitter=e,this._hostSettings=t,this._logger=n,this._e2eMetric=r,this._paragraphDeltasEnabled=i,this._clientSubscribers=o,this._sessionOrPromise=a,this._aggregateLogger=s,this._augloopSessionFactory=u,this._sessions=new Map,this._runtimeInstances=new Set,this._listenersInitialized=!1,this._fetchALSessionMutex=new kt.a,this.initialize=async()=>{this._sessionOrPromise||this._augloopSessionFactory||this._logger.error(509694866,"Failed to initialize AugLoop, there is no runtime available"),this._hostSettings.enableOrchestration&&(this._logger.log(570782413,At.a.Info,"Initializing Orchestrator."),this._hostEmitter.on(_.a.hostModelParagraphTextTiles,this._handleTiles),this._hostEmitter.on(_.a.hostModelDelta,this._handleDelta),this._hostEmitter.on(_.a.hostModelFormattingDelta,this._handleDelta),this._hostEmitter.on(_.a.hostModelTextTile,this._handleTile),this._hostEmitter.on(_.a.hostModelMoveTextTile,this._handleMove));for(const e of this._clientSubscribers)e.register(this,this._augloopDocumentSerializer);this._listenersInitialized=!0},this.shutDown=()=>{this._logger.log(570782414,At.a.Debug,"Shutting down Orchestrator."),this._listenersInitialized||this._logger.log(570782415,At.a.Error,"Trying to delete event listeners in Orchestrator when they have already been deleted.");for(const e of this._clientSubscribers)e.unregister();for(const e of this._sessions.values())e.getSession()!==this._sessionFromHost&&e.close();for(const e of this._runtimeInstances)e.uninitialize();this._sessions.clear(),this._runtimeInstances.clear(),this._listenersInitialized=!1,this._sessionOrPromise=void 0,this._sessionFromHost=void 0},this.deactivateAnnotations=async e=>{const t=(await Promise.all([...this._sessions.keys()].map((t=>{var n;return null===(n=this._sessions.get(t))||void 0===n?void 0:n.releaseAnnotations(e)})))).every(Boolean);return t||this._logger.error(526209822,"Some annotations failed to be deactivated."),t},this.activateAnnotations=async e=>{for(const t of this._sessions.values())await t.activateAnnotations(e)},this.getOrCreateSession=async e=>{var t;const n=await this._fetchALSessionMutex.lock(),r=null!==(t=this._sessions.get(e))&&void 0!==t?t:await this._createSession(e);return n(),r},this.getSessions=async e=>{if(!e)return this._sessions;const t=new Map;for(const n of e)t.set(n,await this.getOrCreateSession(n));return t},this._createSession=async e=>{const t=[];for(const e of this._clientSubscribers)t.push(e.createAnnotationListener());let n="function"==typeof this._sessionOrPromise?await this._sessionOrPromise():this._sessionOrPromise;if(n)this._sessionFromHost=n;else{if(!this._augloopSessionFactory)return;{const{session:t,runtime:r}=await this._augloopSessionFactory(this._augloopDocumentSerializer,e);n=t,r&&this._runtimeInstances.add(r)}}if(!n)return;const r=new Nt(e,this._logger,t,n,this._aggregateLogger,this._augloopDocumentSerializer,this._hostEmitter,this._clientSubscribers);await r.initialize();for(const e of this._clientSubscribers)e.onInitialize(r);return this._sessions.set(e,r),r},this._handleDelta=async e=>{const t=e.message;if(t.sourceType===Pt.a.TileNode)return;const n=await this.getOrCreateSession(e.address);n&&(this._e2eMetric.startEntry(`${t.tileId}--${t.tileVersion}`),n.submitDelta([...this._augloopDocumentSerializer.getParentPath(n,t.documentModel),t.tileId],t.delta,t.tileVersion))},this._handleTiles=async e=>{this._paragraphDeltasEnabled.check()||await this._handleTileMessages(e.address,e.message)},this._handleTile=async e=>{this._paragraphDeltasEnabled.check()&&e.message.data.isTextNode&&await this._handleTileMessages(e.address,[e.message])},this._handleTileMessages=async(e,t)=>{const n=await this.getOrCreateSession(e);if(n)for(const r of t){const t=r.data;let i;switch(r.messageType){case mt.a.NewData:this._e2eMetric.startEntry(`${t.tileId}--${t.tileVersion}`),i=new Fe({parentPath:this._augloopDocumentSerializer.getParentPath(n,t.documentModel),items:[{id:t.tileId,body:t.tile,revId:`${t.tileVersion}`,sourceTimestamp:Date.now()}],prevId:r.data.prevId,nextId:r.data.nextId});break;case mt.a.RemoveData:i=new We({parentPath:this._augloopDocumentSerializer.getParentPath(n,t.documentModel),items:[{id:t.tileId,sourceTimestamp:Date.now()}]});break;case mt.a.ChangeData:this._e2eMetric.startEntry(`${t.tileId}--${t.tileVersion}`),i=new ze({parentPath:this._augloopDocumentSerializer.getParentPath(n,t.documentModel),items:[{id:t.tileId,body:t.tile,revId:`${t.tileVersion}`,sourceTimestamp:Date.now()}]})}n.submitOperation(i),this._hostEmitter.emit(_.a.hostModelTextTileEmittedToAugloop,{address:e,message:r})}},this._handleMove=async e=>{const t=e.message;await this._handleTileMessages(e.address,[{messageType:mt.a.RemoveData,data:{tileId:t.oldTileId,tileVersion:t.tileVersion,documentModel:t.oldDocumentModel,tile:void 0,changeType:Pt.b.Code,isTextNode:!1}},{messageType:mt.a.NewData,data:{tileId:t.newTileId,tileVersion:t.tileVersion,documentModel:t.newDocumentModel,tile:t.tile,changeType:Pt.b.Code,isTextNode:!1,prevId:t.prevId,nextId:t.nextId}}])},this._augloopDocumentSerializer=null!=c?c:new Jt(o)}};Xt=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(_.b)),Object(le.f)(1,Object(pe.a)(S.a)),Object(le.f)(2,Object(pe.a)(o.a)),Object(le.f)(3,Object(pe.a)(H.b)),Object(le.f)(4,Object(pe.a)(F.a)),Object(le.f)(5,Object(ge.a)(Re)),Object(le.f)(5,Object(Et.a)()),Object(le.f)(6,Object(pe.a)(Qt)),Object(le.f)(6,Object(Et.a)()),Object(le.f)(7,Object(Et.a)()),Object(le.f)(7,Object(pe.a)(xe.a)),Object(le.f)(8,Object(Et.a)()),Object(le.f)(8,Object(pe.a)(jt)),Object(le.f)(9,Object(Et.a)()),Object(le.f)(9,Object(pe.a)(Yt))],Xt);var Zt=n(356),en=n(423),tn=n(723);let nn=class{constructor(e){this._hostSettings=e,this.transform=e=>e?rn(e,!!this._hostSettings.enableAutoCorrect):[]}};function rn(e,t){var n;if(!t)return e;for(const t of e)(null===(n=t.languages)||void 0===n?void 0:n.includes(t.languageId||""))||Object(tn.a)(t);return e}nn=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(S.a))],nn);var on=n(582);let an=class{constructor(e,t){this._hostSettings=e,this._roamingDictionaryFeature=t,this.transform=e=>{if(!e)return[];return sn(e,!!this._hostSettings.enableV2RoamingDictionary,!!this._hostSettings.enableRoamingService,this._roamingDictionaryFeature)}}};function sn(e,t,n,r){if(!n||!t||!(null==r?void 0:r.isReady()))return e;const i=r.getRoamingDictionary();return e.filter((e=>{const t=Object(Zt.c)(e.context,e.startInContext,e.length);return!t||(!Object(on.b)(e)||!(null==i?void 0:i.testWord(t,!1)))}))}an=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(S.a)),Object(le.f)(1,Object(pe.a)(Z.a))],an);var un=n(495);const cn=["ja-JP","zh-CN","zh-TW"];let ln=class{constructor(e,t){this._proofingPersistedStore=e,this._settings=t,this.transform=e=>{const t=this._proofingPersistedStore.getCachedEntry(de.a.ProofingLanguages).storeEntryValue;return dn(e,this._settings.maxSuggestionItemsDisplayNumber,this._settings.maxSuggestionDisplayPerLanguageNumber,t)}}};function dn(e,t,n,r){if(!e||0===e.length)return[];const i=[],o=function(e,t){const n=new Map,r=new Map;for(const i of e){const e=i,o=Object(un.b)(i.tileId);e.tileId=o.tileId,e.languageId=o.languageCode;const a=vn(o.tileId),{languageId:s,priority:u}=e,c=n.get(a);if(c){const t=r.get(a);c.critiques.push(e),Sn(t,s,u)}else{const i=wn(t,s,u);r.set(a,i),n.set(a,{critiques:[e],detectedLanguages:[]})}}for(const e of n.keys()){const t=n.get(e),i=r.get(e);if(t&&i){t.detectedLanguages=fn(i);for(const e of t.critiques)e.languages=t.detectedLanguages}}return n}(e,r);for(const e of o){const o=e[1],a=o.critiques.sort(_n);i.push(...hn(a,o.detectedLanguages,t,n,r))}return i}function fn(e){let t,n=[];for(const r of e){const e=r[0],i=r[1];void 0===t||t>i?(t=i,n=[e]):t===i&&n.push(e)}return n}function hn(e,t,n,r,i){let o=0,a=-1,s=0;const u=[];for(const c of e){const l=Tn(c.start);if(l===a||l<s)continue;a=l,s=l+Tn(c.length);const d=[];let f=Ee.c.High;for(let n=o;n<e.length;n+=1){o=n;const r=e[n],i=Tn(r.start);if(!(l<=i&&i<=s))break;{f=pn(f,r.priority),(r.priority===Ee.c.High||t.includes(r.languageId||""))&&d.push(r);const e=i+Tn(r.length);e>s&&(s=e)}}const h=gn(d,f,n,r,i);h&&u.push(h)}return u}function pn(e,t){const n=null!=t?t:Ee.c.High;return n===Ee.c.Medium?Ee.c.Medium:n===Ee.c.Low&&e!==Ee.c.Medium?Ee.c.Low:e}function gn(e,t,n,r,i){if(0===e.length)return;const o=e.filter((e=>e.priority===t));if(0===o.length)return;if(t===Ee.c.High)return function(e,t,n,r){var i;let o;const a=e[0],s=[],u=new Map;let c=n;for(const l of t){const t=e.filter((e=>e.languageId===l));if(cn.includes(l)){if(yn(Object(Zt.c)(a.context,a.startInContext,a.length)))return;continue}if(!t||0===t.length)return;const d=t[0],f=d.suggestions,h=bn(d);h&&(a.supportedActions=1|(null!==(i=a.supportedActions)&&void 0!==i?i:0));const p=mn(f,u,s,l,h,c);p.actionable.length>0?(s.length>0&&c===n&&(c=r,s.splice(c),p.actionable.splice(c)),s.push(...p.actionable)):o||(o=p.nonActionable)}if(s.length>0){for(const e of s)e.languageIds=u.get(e.text);a.suggestions=function(e,t){return e.sort(((e,n)=>{if(!e.languageIds||!n.languageIds)return 0;const r=n.languageIds.length-e.languageIds.length;if(0!==r)return r;for(let r=0;r<e.languageIds.length;r+=1){const i=t.indexOf(e.languageIds[r])-t.indexOf(n.languageIds[r]);if(0!==i)return i}return 0}))}(s,t)}else a.suggestions=o?[o]:[];return a}(o,i,n,r);let a=o[0];if(o.length>1){const e=o.filter((e=>e.languageId===i[0]));e.length>0&&(a=e[0])}return a.suggestions=function(e,t){const n=e.suggestions&&e.suggestions.length>t?e.suggestions.splice(0,t):e.suggestions;if(n&&e.languageId)for(const t of n)t.languageIds=e.languageId?[e.languageId]:[];return n}(a,n),a}function mn(e,t,n,r,i,o){const a={actionable:[],nonActionable:void 0};if(!e)return a;for(let u=0;u<e.length;u+=1){const c=e[u];if(On(t,c.text,r),u<o){!(1&~(s=e[u]).action&&2&~s.action&&4&~s.action)||i?n.every((e=>e.text!==c.text))&&a.actionable.push(c):a.nonActionable=e[u]}}var s;return a}function yn(e){return!!e&&/[\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\uff66-\uff9f]/.test(e)}function bn(e){return void 0!==e.supportedActions&&!(1&~e.supportedActions)}function vn(e){let t="";if(e)try{t=JSON.parse(e).elementId.id}catch(e){}return t}function wn(e,t,n){return new Map(e.map((e=>[e,n===Ee.c.High&&e===t?1:0])))}function Sn(e,t,n){var r;if(e&&t&&n===Ee.c.High){const n=null!==(r=e.get(t))&&void 0!==r?r:0;e.set(t,n+1)}}function _n(e,t){return Tn(e.start)-Tn(t.start)}function Tn(e){return null!=e?e:0}function On(e,t,n){const r=e.get(t);r?r.push(n):e.set(t,[n])}ln=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(K.a)),Object(le.f)(1,Object(pe.a)(S.a))],ln);let Cn=class{constructor(e,t,n,r){this._logger=e,this._multiLangTileCheckResponseTransformer=t,this._autoCorrectTransformer=n,this._customDictionaryTransformer=r}async transform(e,t){this._logger.debug(571318788,"Transforming response");let n=this._multiLangTileCheckResponseTransformer.transform(t.critiques);return n=this._autoCorrectTransformer.transform(n),this._customDictionaryTransformer&&(n=this._customDictionaryTransformer.transform(n)),En(n,e.languageUXId,this.parseTileHeader)}parseTileHeader(e){return In(e,(()=>{this._logger.logEvent(571318789,en.a.TileIdParseException,At.a.Error,`Parsing tile ID ${e} failed`,s.a.SamplingPolicy.CriticalBusinessImpact)}))}};async function En(e,t,n){return Promise.all(e.map((async e=>{var r,i,o,a;return{tileId:n(e.tileId),traceId:e.traceId,categoryTitle:e.categoryTitle,explanationTitle:e.explanationTitle,explanation:e.explanation,explanationLabel:e.explanationLabel,supportedActions:null!==(r=e.supportedActions)&&void 0!==r?r:0,suggestions:kn(e.suggestions),languageId:t,start:null!==(i=e.start)&&void 0!==i?i:0,length:null!==(o=e.length)&&void 0!==o?o:0,priority:null!==(a=e.priority)&&void 0!==a?a:Ee.c.High,typeId:e.typeId,textInContext:Object(Zt.c)(e.context,e.startInContext,e.length),metadata:e.metadata}})))}function In(e,t){if(e)try{return JSON.parse(e)}catch(e){return void(null==t||t())}}function kn(e){return e?e.map((e=>{var t,n;return{text:e.text,description:e.description,confidenceLevel:null!==(t=e.confidenceLevel)&&void 0!==t?t:bt.c.High,source:null!==(n=e.source)&&void 0!==n?n:bt.d.None,action:e.action,bucketId:e.bucketId,numberOfInstances:e.numberOfInstances,languages:e.languageIds}})):[]}var An;Cn=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(o.a)),Object(le.f)(1,Object(pe.a)(ln)),Object(le.f)(2,Object(pe.a)(nn)),Object(le.f)(3,Object(Et.a)()),Object(le.f)(3,Object(pe.a)(an))],Cn);let Pn=An=class{constructor(e,t){this._proofingStore=e,this._descriptorManager=t}async buildValidRequest(e,t){return{appId:await this._proofingStore.read(de.a.AppId),languageId:t,descriptors:await this._descriptorManager.buildDescriptors(),lookupWords:An.buildLookupWords(e),mode:0}}static buildLookupWords(e){const t=[];return e&&e.forEach((e=>{t.push({word:e.text})})),t}};Pn=An=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(K.a)),Object(le.f)(1,Object(pe.a)(Ie.a))],Pn);var Nn,jn=n(78),Rn=n(569);let xn=Nn=class{constructor(e,t,n){this._hostSettings=e,this._roamingDictionaryFeature=t,this._roamingDictionaryBroker=n}shouldKeep(e){if(!this._hostSettings.enableV2RoamingDictionary||!this._hostSettings.enableRoamingService)return!0;if(!e.body)return!1;const t=e.body;return!Nn.supportsAddToDictionary(t)||!this.checkWordIsInDictionary(t.context.trim())}checkWordIsInDictionary(e){var t;if(this._roamingDictionaryBroker)return!!this._roamingDictionaryBroker.isRoamingDictionaryReady&&this._roamingDictionaryBroker.checkWordIsInDictionary(e);{if(!this._roamingDictionaryFeature.isReady())return!1;const n=this._roamingDictionaryFeature.getRoamingDictionary();return null!==(t=null==n?void 0:n.testWord(e,!1))&&void 0!==t&&t}}static supportsAddToDictionary(e){return!!e.critiqueActions&&(e.critiqueActions&jn.a.AddToDictionary)===jn.a.AddToDictionary}};xn=Nn=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(S.a)),Object(le.f)(1,Object(pe.a)(Z.a)),Object(le.f)(2,Object(Et.a)()),Object(le.f)(2,Object(pe.a)(Rn.a))],xn);let Dn=class{constructor(e){this._dictionaryFilterer=e}filter(e){return e.filter((e=>this._dictionaryFilterer.shouldKeep(e)))}};Dn=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(xn))],Dn);var Mn=n(652),Ln=n(26),Bn=n(491);let Fn=class{constructor(e,t,n,r,i,o){this._userInfoStrategy=e,this._editorService=t,this._hostSettings=n,this._logger=r,this._hostEmitters=i,this._sessionContextProvider=o,this._maxCacheSize=3,this._cachedResponses=new Map}async initialize(){for(const e of this._hostEmitters)e.on(_.a.configV2RequestEvent,(async e=>this._handleRequest(e.message)))}shutDown(){}async _handleRequest(e){var t;const n=e.request;if(!n.languageId)return!1;let r="";try{r="Error while fetching user info";const i=await this._userInfoStrategy.executeAsync(!1);let o;this._editorService.xUserId=null==i?void 0:i.userId,i&&(o=Object(Pe.a)(n.descriptors,this._hostSettings.enhancedUpsellEnabled,i.licenseType)),r="Error while fetching session context";const a=await this._sessionContextProvider();if(a.sessionId&&(this._editorService.xUserSessionId=a.sessionId),a.composeSessionId&&(this._editorService.xUserComposeSessionId=a.composeSessionId),e.refresh||!this._cachedResponses.has(n.languageId)||this._cachedLicenseType!==o){this._cachedLicenseType!==o&&this._cachedResponses.clear(),r="Failed to send config request";let e,t=await this._editorService.configV2(n);if(t.responseStatus===bt.a.Success){if(void 0===o||o===Ln.c.NoLicense){this._overrideLicenseType(n),r="Failed to send config request, for overridden license type";const i=await this._editorService.configV2(n);i.responseStatus===bt.a.Success&&(r="Error while comparing current and subscription responses",e=Object(Bn.a)(t.critiqueCategoryInfoList,i.critiqueCategoryInfoList),t=i)}this._cachedLicenseType=o,this._cachedHasPremiumValue=e,this._setCacheValue(n.languageId,t.critiqueCategoryInfoList)}}const s=null!==(t=this._cachedResponses.get(n.languageId))&&void 0!==t?t:[];r="Error while emitting config data",this._hostEmitters.forEach((e=>{e.emit(_.a.configV2ResponseEvent,{message:{data:s,hasPremiumValue:this._cachedHasPremiumValue,language:n.languageId,hasGrammar:-1!==s.findIndex((e=>e.priority&&e.priority>0))},address:void 0})}))}catch(e){this._logger.error(561292929,`${r} : ${e.message}`)}return!0}_overrideLicenseType(e){e.descriptors||(e.descriptors=[]);const t=e.descriptors.find((e=>"LicenseType"===e.name));t?t.value=Ln.c.Subscription:e.descriptors.push({name:"LicenseType",value:Ln.c.Subscription})}_setCacheValue(e,t){for(this._cachedResponses.has(e)&&this._cachedResponses.delete(e);this._cachedResponses.size>=this._maxCacheSize;)this._cachedResponses.delete(this._cachedResponses.keys().next().value);this._cachedResponses.set(e,t)}};Fn=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(N.a)),Object(le.f)(1,Object(pe.a)(Mn.b)),Object(le.f)(2,Object(pe.a)(S.a)),Object(le.f)(3,Object(pe.a)(o.a)),Object(le.f)(4,Object(ge.a)(_.c)),Object(le.f)(5,Object(pe.a)(a.a))],Fn);let Un=class{constructor(e,t,n,r,i,o,a,s){this._userInfoStrategy=e,this._hostEmitter=t,this._editorService=n,this._settings=r,this._logger=i,this._transformer=o,this._hostSettings=a,this._sessionContextProvider=s}async initialize(){this._hostEmitter.on(_.a.tileCheckRequestV1,(async e=>this.handleRequest(e)))}shutDown(){}async handleRequest(e){let t;try{t=await this._userInfoStrategy.executeAsync(!1)}catch(e){this._logger.error(559548186,"Get user info failed")}try{const n=await this._sessionContextProvider(),r=e.address,i=await qn(e.message,this._editorService,this._hostSettings.enhancedUpsellEnabled,null==t?void 0:t.userId,null==t?void 0:t.licenseType,n.sessionId,n.composeSessionId),o=await this._transformer.transform(e.message,i);!this._settings.emitRemoval||i.responseStatus!==bt.a.Success&&i.responseStatus!==bt.a.PartialSuccess||this._tryEmitClearTileCritiques(e,o),this._hostEmitter.emit(_.a.tileCheckResponseV1,{address:r,message:o})}catch(e){this._logger.error(559548187,`Editor service call failed: [Error] ${e.message} [Stack] ${e.stack}`)}return!1}_tryEmitClearTileCritiques(e,t){var n;const r=e.address,i=zn(null!==(n=e.message.content)&&void 0!==n?n:[],null!=t?t:[]);void 0!==i&&this._hostEmitter.emit(_.a.clearTileCritiques,{address:r,message:i})}};async function qn(e,t,n,r,i,o,a){t.xUserId=r,t.xUserSessionId=o,t.xUserComposeSessionId=a,Object(Pe.a)(e.descriptors,n,i);return await t.postTileCheck(e)}function zn(e,t){const n=new Set(e.map((e=>function(e){var t;const n=JSON.parse(e.tileId);return null!==(t=n.header)&&void 0!==t?t:n}(e))));for(const e of t)n.delete(JSON.stringify(e.tileId));if(0===n.size)return;const r=[];for(const e of n)try{const t={header:JSON.parse(e),data:"",proofingLanguages:[]};r.push(t)}catch(e){}return r}Un=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(N.a)),Object(le.f)(1,Object(pe.a)(_.b)),Object(le.f)(2,Object(pe.a)(Mn.e)),Object(le.f)(3,Object(pe.a)(Ce.a)),Object(le.f)(4,Object(pe.a)(o.a)),Object(le.f)(5,Object(pe.a)(Cn)),Object(le.f)(6,Object(pe.a)(S.a)),Object(le.f)(7,Object(pe.a)(a.a))],Un);var Wn=n(728),Vn=n(137),Gn=n(293),Hn=n(488),$n=n(424),Kn=n(496),Jn=n(219);let Qn=class{constructor(e,t,n,r,i){this._tileNodeReader=e,this._hostSettings=t,this._optimizedRehydrationEnabled=n,this._logger=r,this._textEventPublisher=i}pollNodes(e,t,n,r,i,o,a,s){var u,c,l,d;if(this._textEventPublisher&&!0===this._hostSettings.sdkV2Enabled){const r=[];for(const e of t)if(this._tileNodeReader.isTileNode(e))try{const t=Object(Jn.a)(e);r.push({text:e.pullText(),mutationChangeType:n,tileNodeId:e.id,rehydrateCritiques:i,forceTileDiffEmission:a,mutationWasTextReplacement:s,documentModel:null==t?void 0:t.documentModel,previousNodeId:this._tileNodeReader.getPreviousTileId(e),nextNodeId:this._tileNodeReader.getNextTileId(e),optimizedRehydrationEnabled:this._optimizedRehydrationEnabled.check(),brokerOptions:{critiques:null==o?void 0:o.get(e.id),forceReflow:!0}})}catch(e){null===(c=this._logger)||void 0===c||c.error(0,"SimplifiedNodePoller: Exception occurred.",e)}else null===(u=this._logger)||void 0===u||u.error(0,"SimplifiedNodePoller: Found children of unsupported type.",{nodeType:e.nodeType,stack:(new Error).stack});this._textEventPublisher.publishTextChangeEvent(r,e)}else for(const e of t)if(this._tileNodeReader.isTileNode(e))try{this._tileNodeReader.reconcile(e,n,null==o?void 0:o.get(e.id),!0,i,a,s)}catch(e){null===(d=this._logger)||void 0===d||d.error(0,"SimplifiedNodePoller: Exception occurred.",e)}else null===(l=this._logger)||void 0===l||l.error(509727256,"SimplifiedNodePoller: Found children of unsupported type.",{nodeType:e.nodeType,stack:(new Error).stack})}removeQueuedTiles(e){}};Qn=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(Kn.a)),Object(le.f)(1,Object(pe.a)(S.a)),Object(le.f)(2,Object(pe.a)(Hn.a)),Object(le.f)(3,Object(Et.a)()),Object(le.f)(3,Object(pe.a)(o.a)),Object(le.f)(4,Object(Et.a)()),Object(le.f)(4,Object(pe.a)($n.a))],Qn);var Yn=n(609);class Xn{constructor(){this.imports=[Yn.a]}get uniqueId(){return Object(Vn.a)(507918371)}configureRootServices(e){e.bind(Rt).to(Xt),e.bind(Gn.a).to(Qn)}}var Zn=n(471),er={util:{},roots:{default:{}}},tr=(er.util,er.roots.default||(er.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.count=0,e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.durationMs=0,e.prototype.success=!1,e.prototype.resultDescription="",e.prototype.resultJSON="",e.prototype.resultSignature="",e.prototype.operationName="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.joinContextId="",e.prototype.ariaTenant="",e.prototype.ariaNamespace="",e.prototype.dataFields="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/OperationEvent"},e}()),nr=n(548);class rr extends tr{constructor(e,t){super(e),this.eventName="Operation",this.options=t,this.durationMs=null==e?void 0:e.durationMs,e&&null!=e.count||(this.count=1)}setClientMetadata(e,t){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,null!=t&&t||(this.clientFlights=e.flights),this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientDeviceId=e.deviceId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setMetricCustomDimensions(e,t){if(!this.options)throw new Error(`Attempting to set custom dimensions ${e} to operation ${this.operationName} without activating MetricCount or MetricDuration`);this.options.metricCustomDimensions=this.options.metricCustomDimensions||{},this.options.metricCustomDimensions[e]=t}setDataField(e,t){if(null==t)return;const n=this.dataFields?JSON.parse(this.dataFields):{};n[e]=t,this.dataFields=JSON.stringify(n)}setDataFields(e){this.dataFields?this.dataFields=JSON.stringify(Object.assign(Object.assign({},JSON.parse(this.dataFields)),e)):this.dataFields=JSON.stringify(e)}start(){return this.startTime=Object(nr.a)(),this}stop(){const e=Object(nr.a)();return this.durationMs=Math.round(e-this.startTime),this}getMetrics(e){var t,n;const r={};if(this.operationName)switch(this.operationName){case"SessionHealthOrphanedEventsWithoutProperSessionKey":case"SessionHealthOrphanedSessions":case"WorkflowActivationState":r[this.operationName+".CountV2"]={dimensionNames:rr.getOrphanedSessionHealthDimensionNames.bind(rr),dimensionValues:this.getOrphanedSessionHealthDimensionValues(),value:this.count};break;case"MarkUnhealthySession":case"MarkHealthWarningSession":r[this.operationName+".Reason"]={dimensionNames:rr.getSessionHealthDimensionNames.bind(rr),dimensionValues:this.getSessionHealthDimensionValues(),value:1};break;default:if("matchmaker_timer"===this.operationName&&(r["Workflow.DurationMs"]={dimensionNames:rr.getWorkflowDimensionNames.bind(rr),dimensionValues:this.getWorkflowDimensionValues(),value:this.durationMs||0},r["Workflow.Count"]={dimensionNames:rr.getWorkflowDimensionNames.bind(rr),dimensionValues:this.getWorkflowDimensionValues(),value:1}),void 0!==this.durationMs){const n=`${this.operationName}.DurationMsV2`;((null===(t=this.options)||void 0===t?void 0:t.metricDuration)||e.indexOf(n)>=0)&&(r[n]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.durationMs})}{const t=`${this.operationName}.CountV2`;((null===(n=this.options)||void 0===n?void 0:n.metricCount)||e.indexOf(t)>=0)&&(r[t]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.count})}}return r}getDimensionNames(){var e,t;let n=rr.dimensionNames;if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions){n=n.slice();for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)n.push(e)}return n}getDimensionValues(){var e,t;const n=[this.success,this.clientAppName,this.clientAppPlatform,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3];if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions)for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)n.push(this.options.metricCustomDimensions[e]);return n}static getOrphanedSessionHealthDimensionNames(){return this.orphanedSessionHealthDimensionNames}getOrphanedSessionHealthDimensionValues(){return[this.success,this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getSessionHealthDimensionNames(){return this.sessionHealthDimensionNames}getSessionHealthDimensionValues(){return[this.resultSignature,this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getWorkflowDimensionNames(){return this.workflowDimensionNames}getWorkflowDimensionValues(){return[this.resultSignature,this.resourceId,this.resourceId,this.success]}}rr.dimensionNames=["Success","ClientAppName","ClientAppPlatform","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],rr.orphanedSessionHealthDimensionNames=["Success","ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],rr.sessionHealthDimensionNames=["Reason","ClientAppName","ClientAppPlatform","ClientAppVersion","Dimension0","Dimension1","Dimension2","Dimension3"],rr.workflowDimensionNames=["ResultSignature","WorkflowId","ResourceId","Success"];var ir,or,ar=n(1092);!function(e){e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance"}(ir||(ir={})),function(e){e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.RequiredServiceDataEvent=110]="RequiredServiceDataEvent"}(or||(or={}));const sr="n~",ur=/\|\~/g;class cr{constructor(){this.count=0,this.measureSums=new Map}}class lr{constructor(e,t,n,r,i){this.buckets=new Map,this.init=e=>{this.log=e},this.add=(e,t=!0)=>{if(!this.condition||!this.condition(e))return!0===t&&this.log(e,!1),!1;const n=[];for(const t of this.dimensions)if(void 0===e[t]||null===e[t])n.push(null);else{let r="";"boolean"==typeof e[t]?r="b~":"number"==typeof e[t]&&(r=sr),n.push(`${r}${e[t].toString().replace(ur,"_")}`)}const r=n.join("|");let i=this.buckets.get(r);if(!i){i=new cr,i.traceLevel=e.traceLevel;for(const e of this.avgMeasures)i.measureSums.set(e,0);this.buckets.set(r,i)}i.count++;for(const t of this.avgMeasures)e[t]&&i.measureSums.set(t,i.measureSums.get(t)+e[t]);return!0},this.flush=(e=!1)=>{this.buckets.forEach(((e,t)=>{const n={traceLevel:e.traceLevel,eventName:this.eventName,count:e.count},r=t.split("|");for(let e=0;e<this.dimensions.length;e++){const t=this.dimensions[e],i=r[e];0===i.indexOf("b~")?n[t]="b~true"===i:0===i.indexOf(sr)?n[t]=parseInt(i.slice(2),10):n[t]=i}for(const t of this.avgMeasures)n[t]=Math.round(e.measureSums.get(t)/e.count);this.log(n,!0)})),this.buckets.clear(),e&&(this.condition=null,clearInterval(this.interval))},this.eventName=e,this.condition=t,this.dimensions=n,this.avgMeasures=r,i>0&&(this.interval=setInterval(this.flush,1e3*i))}}const dr=["cloud-dev.microsoft","officeppe.com","cloud.microsoft","office.com","office365.us","ic.gov","microsoft.scloud","microsoftonline.cn"],fr=(e,t,n,r)=>new lr(e,(e=>e.success&&n.indexOf(e[t])>=0),[t,"ariaNamespace","resourceId","success","resultSignature","clientDocSessionId","dimension0","dimension1","dimension2","dimension3"],["durationMs"],r),hr=e=>{if(!e)return e;for(const t of dr)if(e.indexOf(t)>=0)return e;return"**redacted**"};class pr{constructor(e){this.level=Zn.a.info,this.hostCallbacks=e}log(e){if(null==this.hostCallbacks||null==this.hostCallbacks.sendTelemetryEvent)return;const t=(e,t,n,r,i)=>{let o=t.charAt(0).toUpperCase()+t.slice(1),a={DocSessionId:e.clientDocSessionId,ResourceId:e.resourceId,ResultDescription:e.resultDescription,ResultSignature:e.resultSignature,Dimension0:e.dimension0,Dimension1:e.dimension1,Dimension2:e.dimension2,Dimension3:e.dimension3,JoinContextId:e.joinContextId,ServerSessionKey:this.serverSessionKey};n&&(a=Object.assign(Object.assign({},a),JSON.parse(n)));const s=r||pr.augLoopAriaTenantToken,u=i||s!=pr.augLoopAriaTenantToken?i:pr.augLoopAriaNamespace;o=o||pr.operationNamePlaceholder;const c={CV:e.cv,Duration:1e3*(e.durationMs||0),Count:e.count,AggMode:2,Success:e.success};this.hostCallbacks.sendTelemetryEvent(s,u?`${u}_${o}`:o,a,"Office.System.Activity",c,!1,ir.ProductServiceUsage|ir.ProductServicePerformance,or.RequiredServiceDataEvent)},n=(e,t,n)=>{this.hostCallbacks.sendDiagnosticTrace&&this.hostCallbacks.sendDiagnosticTrace(e,t,n)};if("Workflow.MetricsOnly"==e.category);else if("Operation"===e.eventName){const n=e;t(n,n.operationName,n.dataFields,void 0,n.ariaNamespace)}else if("SessionHealth"===e.eventName){t(e,e.sessionHealthEventName)}else if("WorkflowOperation"===e.eventName){const n=e;t(n,n.operationName,n.dataFields,n.ariaTenant,n.ariaNamespace)}else"Log"===e.eventName&&n(e.tagId,e.traceLevel,e.message)}setServerSessionKey(e){this.serverSessionKey=e}}pr.augLoopAriaTenantToken="3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770",pr.augLoopAriaNamespace="Office_AugLoop_Client",pr.operationNamePlaceholder="OperationNameNotProvided";var gr=n(797),mr=n.n(gr);class yr{constructor(){this.hadEgressError=!1,this.isClosing=!1,this.pendingEgress=[]}init(e,t,n,r,i){this.ws=new mr.a(e),this.logOp=new rr({operationName:yr.className,success:!0}).start(),this.logOp.setClientMetadata(i,!0),this.ingressByteCountOp=new rr({operationName:"WSIngressByteOrderOfMagnitude",success:!0}),this.ingressByteCountOp.setClientMetadata(i,!0),this.ws.addEventListener("open",(e=>{n(),this.logOp.resourceId="OnOpen",this.logOp.resultDescription="",this.logOp.success=!0,this.logOp.dimension0=this.pendingEgress.length.toString(),ar.a.info(508843801,ar.b.CoreDefault,this.logOp.stop())})),this.ws.addEventListener("message",(e=>{this.logIngressCount(e.data),t(e.data)})),this.ws.addEventListener("error",(e=>{this.errorMessage=e.message,this.logOp.resourceId="OnError",this.logOp.resultDescription=this.errorMessage,this.logOp.success=!1,ar.a.info(508843800,ar.b.CoreDefault,this.logOp.stop()),this.ws.close()})),this.ws.addEventListener("close",(e=>{this.logOp.resourceId="OnClose",this.logOp.resultDescription=e?`code: ${e.code}. reason: ${e.reason}`:"",this.logOp.success=!0,ar.a.info(508843799,ar.b.CoreDefault,this.logOp.stop()),r(this.errorMessage),this.isClosing=!1}))}egress(e){const t=e.obj;this.ws.send(t,(e=>{e&&!this.hadEgressError&&(this.hadEgressError=!0,this.logOp.resourceId="OnEgressError",this.logOp.resultDescription=e.message,this.logOp.success=!1,ar.a.info(508843797,ar.b.CoreDefault,this.logOp.stop()))}))}close(){this.isClosing||(this.isClosing=!0,this.ws.close())}logIngressCount(e){const t=e.length;t>1e5&&(this.ingressByteCountOp.start(),this.ingressByteCountOp.dimension2=t.toString().length.toString(),ar.a.info(508843794,ar.b.CoreDefault,this.ingressByteCountOp.stop()))}}yr.className="WebSocketWorker";class br{constructor(e){this.childCount=0,this.id=e||function(){for(let e=0;e<wr;e++)Sr[e]=vr[Math.floor(Math.random()*vr.length)];return Sr.join("")}()}static fromString(e,t){if(!e)throw new Error("Received invalid correlation vector string");let n;return n=e.endsWith(".0")?new br(e.substring(0,e.length-2)):new br(e),t&&(n.childCount=t),n}newChild(){return++this.childCount,new br(this.id+"."+this.childCount.toString())}toString(){return this.id.length>127?this.id.substring(0,127)+"!":this.id}}const vr=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],wr=22,Sr=new Array(wr);var _r,Tr,Or,Cr={util:{},roots:{default:{}}},Er=(Cr.util,Cr.roots.default||(Cr.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.sessionHealthEventName="",e.prototype.source="",e.prototype.reason="",e.prototype.reasonDependency="",e.prototype.subReason="",e.prototype.impact="",e.prototype.success=!1,e.prototype.durationMs=0,e.prototype.count=0,e.prototype.message="",e.prototype.affectedWorkflows="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.resultDescription="",e.prototype.resultSignature="",e.prototype.joinContextId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionHealthEvent"},e}());!function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.ClientRuntime=5]="ClientRuntime"}(_r||(_r={})),function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.Network=5]="Network",e[e.AugLoopDependency=6]="AugLoopDependency",e[e.WorkflowDependency=7]="WorkflowDependency",e[e.ClientRuntime=8]="ClientRuntime"}(Tr||(Tr={})),function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.MissingInput=2]="MissingInput",e[e.MissingOutput=3]="MissingOutput"}(Or||(Or={}));class Ir extends Er{constructor(e,t){var n,r;super({source:_r[e.source],reason:Tr[e.reason],reasonDependency:e.reasonDependency,subReason:e.subReason,sessionHealthEventName:e.sessionHealthEventName,impact:Or[e.impact],success:e.success,durationMs:null!==(n=e.durationMs)&&void 0!==n?n:0,count:"number"==typeof e.count?e.count:1,message:e.message,affectedWorkflows:(null!==(r=e.affectedWorkflows)&&void 0!==r?r:[]).join(","),resourceId:e.resourceId,dimension0:e.dimension0,dimension1:e.dimension1,dimension2:e.dimension2,dimension3:e.dimension3,cv:e.cv,resultSignature:e.resultSignature,resultDescription:e.resultDescription,joinContextId:e.joinContextId}),this.eventName="SessionHealth",t&&this.setClientMetadata(t),this.metricCount=e.metricCount,this.metricDuration=e.metricDuration}getMetrics(){const e={};return(void 0===this.metricCount||this.metricCount)&&(e[`${this.sessionHealthEventName}.CountV2`]={dimensionNames:()=>Ir.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.count}),(void 0===this.metricDuration||this.metricDuration)&&(e[`${this.sessionHealthEventName}.DurationMsV2`]={dimensionNames:()=>Ir.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.durationMs}),e}setClientMetadata(e){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientFlights=e.flights,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent,this.clientDeviceId=e.deviceId),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setReason(e){return this.reason=Tr[e],this}setSource(e){return this.source=_r[e],this}setImpact(e){return this.impact=Or[e],this}setAffectedWorkflows(e){return this.affectedWorkflows=(null!=e?e:[]).join(","),this}getAffectedWorkflows(){return this.affectedWorkflows.split(",")}start(){return this.startTime=Object(nr.a)(),this}stop(){const e=Object(nr.a)();return this.durationMs=Math.round(e-this.startTime),this}getDimensionValues(){var e;return[this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.success?"1":"0",`${this.reason}_${this.reasonDependency}`,this.impact,null!==(e=this.getAffectedWorkflows()[0])&&void 0!==e?e:"",this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}}Ir.dimensionNames=["ClientAppName","ClientAppPlatform","ClientAppVersion","Success","Reason","Impact","FirstAffectedWorkflow","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"];var kr=n(466),Ar=n.n(kr);class Pr{constructor(){this.listeners=new Map,this.lastId=0}addListener(e){if(!e)throw new Error("No callback provided for data listener");return this.listeners.set(this.lastId,e),this.lastId++}removeListener(e){this.listeners.delete(e)}notifyListeners(e){this.listeners.forEach((t=>{t(e)}))}}class Nr extends Pr{constructor(e){super(),this.name=e}static getInstance(e){let t=this.allSettings.get(e);if(!t){t=new Nr(e);const n=Nr.tryGetConfigProperty(Nr.currentConfig,e);n.success&&t.updateValue(n.value),this.allSettings.set(e,t)}return t}static getPatternInstance(e){let t=this.allPatternSettings.get(e);if(!t){t={regex:new RegExp(e),setting:new Nr(e)};const n=Nr.tryGetConfigPropertyByPattern(Nr.currentConfig,t.regex);t.setting.updateValue(n),this.allPatternSettings.set(e,t)}return t.setting}static setNewConfig(e){Nr.currentConfig=e,ar.a.info(572837966,ar.b.CoreDefault,`New config: ${JSON.stringify(e)}`),Nr.allSettings.forEach(((e,t)=>{const n=Nr.tryGetConfigProperty(Nr.currentConfig,t).value;e.updateValue(n)&&(ar.a.info(572837967,ar.b.CoreDefault,`Setting new value for ${t}: ${n instanceof Object?JSON.stringify(n):n}`),e.notifyListeners(n))})),Nr.allPatternSettings.forEach(((t,n)=>{const r=Nr.tryGetConfigPropertyByPattern(e,t.regex);t.setting.updateValue(r)&&(ar.a.info(508432774,ar.b.CoreDefault,`Setting new value for pattern ${n}: ${JSON.stringify(r)}`),t.setting.notifyListeners(r))}))}static tryGetConfigProperty(e,t){return e&&e.hasOwnProperty(t)?{success:!0,value:Nr.selectApplicableValue(e[t])}:{success:!1,value:void 0}}static tryGetConfigPropertyByPattern(e,t){const n=[];if(e){const r=Object.getOwnPropertyNames(e).filter((e=>t.test(e)));for(const t of r)n.push({name:t,value:Nr.selectApplicableValue(e[t])})}return n}static setGlobalFilter(e){Nr.globalFilter=e}static clear(){Nr.currentConfig=void 0,Nr.allSettings.clear(),Nr.allPatternSettings.clear()}static selectApplicableValue(e){let t;if(e){const n=e.find((e=>!Nr.globalFilter||Nr.globalFilter(e)));n&&(t=n.value)}return t}getName(){return this.name}getValue(){return this.value}updateValue(e){return!Ar()(this.value,e)&&(ar.a.info(572837968,ar.b.CoreDefault,`Received new property value for ${this.getName()}:`,e),this.value=e,!0)}}Nr.allSettings=new Map,Nr.allPatternSettings=new Map;const jr=new class extends Pr{constructor(e,t){super(),this.listenerId=NaN,this.defaultValue=t,this.setting=Nr.getInstance(e)}getDefaultValue(){return this.defaultValue}addListener(e){return Number.isNaN(this.listenerId)&&(this.listenerId=this.setting.addListener((()=>{this.notifyListeners(this.getValue())}))),super.addListener(e)}removeListener(e){super.removeListener(e),0!=this.listeners.size||Number.isNaN(this.listenerId)||(this.setting.removeListener(this.listenerId),this.listenerId=NaN)}getValue(){const e=this.setting.getValue();return void 0===e?this.defaultValue:e}}("disabledChangeGates",[]);var Rr,xr,Dr,Mr,Lr,Br,Fr;Rr||(Rr={}),function(e){e[e.Unknown=0]="Unknown",e[e.InvalidRequest=1]="InvalidRequest",e[e.InvalidResponse=2]="InvalidResponse",e[e.RuntimeNotInitialized=3]="RuntimeNotInitialized",e[e.RequestCancelled=4]="RequestCancelled",e[e.ResponseReceivedAfterFinalResponse=5]="ResponseReceivedAfterFinalResponse"}(xr||(xr={})),function(e){e[e.Unknown=0]="Unknown",e[e.Found=302]="Found",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.TooManyRequests=429]="TooManyRequests",e[e.SocketDisconnect=499]="SocketDisconnect",e[e.InternalServerError=500]="InternalServerError",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.UnsupportedMessage=1e3]="UnsupportedMessage",e[e.Cancelled=1001]="Cancelled",e[e.EgressError=1002]="EgressError",e[e.SyncMessageException=2e3]="SyncMessageException",e[e.SyncMessageUnsupported=2001]="SyncMessageUnsupported",e[e.SyncMessageUnexpectedSeed=2002]="SyncMessageUnexpectedSeed",e[e.SyncMessageUnsupportedBatch=2003]="SyncMessageUnsupportedBatch",e[e.SyncMessageQueueFull=2004]="SyncMessageQueueFull",e[e.SyncMessageTooLateOrDuplicate=2005]="SyncMessageTooLateOrDuplicate",e[e.SyncMessageGroupIdMismatch=2006]="SyncMessageGroupIdMismatch",e[e.SyncMessageGroupStop=2007]="SyncMessageGroupStop",e[e.SyncMessageLost=2008]="SyncMessageLost",e[e.SyncMessageUnprocessedDuplicate=2009]="SyncMessageUnprocessedDuplicate",e[e.SyncMessageSessionClosed=2010]="SyncMessageSessionClosed",e[e.SyncMessageAbandoned=2011]="SyncMessageAbandoned",e[e.TokenValidationError=2100]="TokenValidationError",e[e.TokenDecryptError=2101]="TokenDecryptError",e[e.TokenTypeError=2102]="TokenTypeError",e[e.TokenUserBlocked=2103]="TokenUserBlocked",e[e.AnnotationActivationInvalidType=2200]="AnnotationActivationInvalidType",e[e.AnnotationReleaseTokenNotFound=2300]="AnnotationReleaseTokenNotFound"}(Dr||(Dr={})),function(e){e[e.IdentityChange=0]="IdentityChange"}(Mr||(Mr={})),function(e){e[e.Idle=0]="Idle",e[e.Pending=1]="Pending"}(Lr||(Lr={}));class Ur{constructor(e){ke.a.assign(Ur,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ur.getTypeName()])}}Ur.H_={T_:Ur.getTypeName(),B_:Ur.getBaseTypes()};class qr{constructor(e){ke.a.assign(qr,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Response"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[qr.getTypeName()])}}qr.H_={T_:qr.getTypeName(),B_:qr.getBaseTypes()};class zr{constructor(e){ke.a.assign(zr,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_StreamingResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[zr.getTypeName()])}}zr.H_={T_:zr.getTypeName(),B_:zr.getBaseTypes()};class Wr{constructor(e){ke.a.assign(Wr,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_StreamingRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Wr.getTypeName()])}}Wr.H_={T_:Wr.getTypeName(),B_:Wr.getBaseTypes()};class Vr{constructor(e){ke.a.assign(Vr,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ExecutionError"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Vr.getTypeName()])}}Vr.H_={T_:Vr.getTypeName(),B_:Vr.getBaseTypes()};class Gr{constructor(e){ke.a.assign(Gr,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsClientError"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Gr.getTypeName()])}}Gr.H_={T_:Gr.getTypeName(),B_:Gr.getBaseTypes()};class Hr{constructor(e){ke.a.assign(Hr,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsErrorInfo"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Hr.getTypeName()])}}Hr.H_={T_:Hr.getTypeName(),B_:Hr.getBaseTypes()};class $r{constructor(e){ke.a.assign($r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[$r.getTypeName()])}}$r.H_={T_:$r.getTypeName(),B_:$r.getBaseTypes()};class Kr{constructor(e){ke.a.assign(Kr,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TimeoutErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Kr.getTypeName()])}}Kr.H_={T_:Kr.getTypeName(),B_:Kr.getBaseTypes()};class Jr{constructor(e){ke.a.assign(Jr,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_RateLimitErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Jr.getTypeName()])}}Jr.H_={T_:Jr.getTypeName(),B_:Jr.getBaseTypes()};class Qr{constructor(e){ke.a.assign(Qr,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Qr.getTypeName()])}}Qr.H_={T_:Qr.getTypeName(),B_:Qr.getBaseTypes()};class Yr{constructor(e){ke.a.assign(Yr,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Yr.getTypeName()])}}Yr.H_={T_:Yr.getTypeName(),B_:Yr.getBaseTypes()};class Xr{constructor(e){ke.a.assign(Xr,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Xr.getTypeName()])}}Xr.H_={T_:Xr.getTypeName(),B_:Xr.getBaseTypes()};class Zr{constructor(e){ke.a.assign(Zr,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Zr.getTypeName()])}}Zr.H_={T_:Zr.getTypeName(),B_:Zr.getBaseTypes()};class ei{constructor(e){ke.a.assign(ei,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseReason"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[ei.getTypeName()])}}ei.H_={T_:ei.getTypeName(),B_:ei.getBaseTypes()};class ti{constructor(e){ke.a.assign(ti,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionSwapOnClose"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionCloseReason"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[ti.getTypeName()])}}ti.H_={T_:ti.getTypeName(),B_:ti.getBaseTypes()};class ni{constructor(e){ke.a.assign(ni,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[ni.getTypeName()])}}ni.H_={T_:ni.getTypeName(),B_:ni.getBaseTypes()};class ri{constructor(e){ke.a.assign(ri,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[ri.getTypeName()])}}ri.H_={T_:ri.getTypeName(),B_:ri.getBaseTypes()};class ii{constructor(e){ke.a.assign(ii,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[ii.getTypeName()])}}ii.H_={T_:ii.getTypeName(),B_:ii.getBaseTypes()};class oi{constructor(e){ke.a.assign(oi,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[oi.getTypeName()])}}oi.H_={T_:oi.getTypeName(),B_:oi.getBaseTypes()};class ai{constructor(e){ke.a.assign(ai,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[ai.getTypeName()])}}ai.H_={T_:ai.getTypeName(),B_:ai.getBaseTypes()};class si{constructor(e){ke.a.assign(si,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultStateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[si.getTypeName()])}}si.H_={T_:si.getTypeName(),B_:si.getBaseTypes()};class ui{constructor(e){ke.a.assign(ui,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[ui.getTypeName()])}}ui.H_={T_:ui.getTypeName(),B_:ui.getBaseTypes()};class ci{constructor(e){ke.a.assign(ci,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[ci.getTypeName()])}}ci.H_={T_:ci.getTypeName(),B_:ci.getBaseTypes()};class li{constructor(e){ke.a.assign(li,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[li.getTypeName()])}}li.H_={T_:li.getTypeName(),B_:li.getBaseTypes()};class di{constructor(e){ke.a.assign(di,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[di.getTypeName()])}}di.H_={T_:di.getTypeName(),B_:di.getBaseTypes()};class fi{constructor(e){ke.a.assign(fi,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BatchedMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[fi.getTypeName()])}}fi.H_={T_:fi.getTypeName(),B_:fi.getBaseTypes()};class hi{constructor(e){ke.a.assign(hi,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[hi.getTypeName()])}}hi.H_={T_:hi.getTypeName(),B_:hi.getBaseTypes()};class pi{constructor(e){ke.a.assign(pi,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_MicroSyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[pi.getTypeName()])}}pi.H_={T_:pi.getTypeName(),B_:pi.getBaseTypes()};class gi{constructor(e){ke.a.assign(gi,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[gi.getTypeName()])}}gi.H_={T_:gi.getTypeName(),B_:gi.getBaseTypes()};class mi{constructor(e){ke.a.assign(mi,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDeleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[mi.getTypeName()])}}mi.H_={T_:mi.getTypeName(),B_:mi.getBaseTypes()};class yi{constructor(e){ke.a.assign(yi,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultsMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[yi.getTypeName()])}}yi.H_={T_:yi.getTypeName(),B_:yi.getBaseTypes()};class bi{constructor(e){ke.a.assign(bi,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[bi.getTypeName()])}}bi.H_={T_:bi.getTypeName(),B_:bi.getBaseTypes()};class vi{constructor(e){ke.a.assign(vi,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenFailureMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[vi.getTypeName()])}}vi.H_={T_:vi.getTypeName(),B_:vi.getBaseTypes()};class wi{constructor(e){ke.a.assign(wi,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[wi.getTypeName()])}}wi.H_={T_:wi.getTypeName(),B_:wi.getBaseTypes()};class Si{constructor(e){ke.a.assign(Si,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_KeepAlive"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Si.getTypeName()])}}Si.H_={T_:Si.getTypeName(),B_:Si.getBaseTypes()};class _i{constructor(e){ke.a.assign(_i,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[_i.getTypeName()])}}_i.H_={T_:_i.getTypeName(),B_:_i.getBaseTypes()};class Ti{constructor(e){ke.a.assign(Ti,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ti.getTypeName()])}}Ti.H_={T_:Ti.getTypeName(),B_:Ti.getBaseTypes()};class Oi{constructor(e){ke.a.assign(Oi,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionCompleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Oi.getTypeName()])}}Oi.H_={T_:Oi.getTypeName(),B_:Oi.getBaseTypes()};class Ci{constructor(e){ke.a.assign(Ci,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Message"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ci.getTypeName()])}}Ci.H_={T_:Ci.getTypeName(),B_:Ci.getBaseTypes()};class Ei{constructor(e){ke.a.assign(Ei,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Response"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ei.getTypeName()])}}Ei.H_={T_:Ei.getTypeName(),B_:Ei.getBaseTypes()};class Ii{constructor(e){ke.a.assign(Ii,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ii.getTypeName()])}}Ii.H_={T_:Ii.getTypeName(),B_:Ii.getBaseTypes()};class ki{constructor(e){ke.a.assign(ki,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[ki.getTypeName()])}}ki.H_={T_:ki.getTypeName(),B_:ki.getBaseTypes()};class Ai{constructor(e){ke.a.assign(Ai,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2CallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ai.getTypeName()])}}Ai.H_={T_:Ai.getTypeName(),B_:Ai.getBaseTypes()};class Pi{constructor(e){ke.a.assign(Pi,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BridgeMessage"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Pi.getTypeName()])}}Pi.H_={T_:Pi.getTypeName(),B_:Pi.getBaseTypes()};class Ni{constructor(e){ke.a.assign(Ni,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionConnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ni.getTypeName()])}}Ni.H_={T_:Ni.getTypeName(),B_:Ni.getBaseTypes()};class ji{constructor(e){ke.a.assign(ji,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDisconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[ji.getTypeName()])}}ji.H_={T_:ji.getTypeName(),B_:ji.getBaseTypes()};class Ri{constructor(e){ke.a.assign(Ri,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionReconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ri.getTypeName()])}}Ri.H_={T_:Ri.getTypeName(),B_:Ri.getBaseTypes()};class xi{constructor(e){ke.a.assign(xi,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SubmittedCustomMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[xi.getTypeName()])}}xi.H_={T_:xi.getTypeName(),B_:xi.getBaseTypes()};class Di{constructor(e){ke.a.assign(Di,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ServerAuthenticationStateChangeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Di.getTypeName()])}}Di.H_={T_:Di.getTypeName(),B_:Di.getBaseTypes()};class Mi{constructor(e){ke.a.assign(Mi,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ClaimsChallengeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Mi.getTypeName()])}}Mi.H_={T_:Mi.getTypeName(),B_:Mi.getBaseTypes()};class Li{constructor(e){if(this.cache=new Map,this.options=e||{sweepInterval:100},null!=this.options.idleDurationMs&&this.options.idleDurationMs<=0)throw new Error("Idle duration must be positive");if(this.interval=this.options.sweepInterval||100,this.interval<=0)throw new Error("Sweep interval must be a positive number")}static setLogIntervalError(e){Li.logIntervalError=e}put(e,t,n,r,i,o,a){if(null==n||n<=0)throw new Error("Cache timeout must be a positive number");(null==i||i<=0)&&(i=this.options.idleDurationMs);const s={value:t,lastUsed:i?Date.now():void 0,expire:n+Date.now(),idleDurationMs:i,expireCallback:r,expiringTriggerTime:o+Date.now(),expiringCallback:a};return this.cache.set(e,s),this.timeout||(this.timeout=setInterval(this.onInterval.bind(this),this.interval),this.timeout.unref&&this.timeout.unref()),t}del(e){if(this.options.delCallback){const t=this.cache.get(e);t&&this.options.delCallback(e,t.value)}const t=this.cache.delete(e);return 0===this.size()&&this.clear(),t}clear(){this.timeout&&(clearInterval(this.timeout),this.timeout=void 0),this.cache.clear()}get(e){let t=this.cache.get(e);if(t){if(this.options.idleDurationMs&&(t.lastUsed=Date.now()),t.expire<Date.now()&&(this.del(e),t.expireCallback&&t.expireCallback(e,t.value),t=this.cache.get(e),!t))return;return t.value}}keys(){return this.cache.keys()}forEach(e){this.cache.forEach(((t,n)=>{e(t.value,n)}))}size(){return this.cache.size}updateExpireTime(e,t){return!!(this.cache.has(e)&&t>=0)&&(this.cache.get(e).expire=t+Date.now(),!0)}onInterval(){const e=Date.now();this.cache.forEach(((t,n)=>{try{if(t.idleDurationMs&&t.lastUsed<e-t.idleDurationMs)return this.del(n),void(this.options.idleCallback&&this.options.idleCallback(n,t.value));t.expire<e&&(this.del(n),t.expireCallback&&t.expireCallback(n,t.value)),t.expiringTriggerTime<e&&t.expiringCallback&&(t.expiringCallback(n,t.value),t.expiringCallback=void 0)}catch(e){Li.logIntervalError&&Li.logIntervalError(e)}}))}}function Bi(e){const t=["AugLoop_Excel_Session_Protocol_","AugLoop_Powerpoint_Session_Protocol_","AugLoop_Session_Protocol_"];let n;for(const r of t)if(0===e.indexOf(r)){n=r;break}if(!n)return"MalformedMessageName";const r="Message",i=e.indexOf(r,e.length-7)===e.length-7;return e.slice(n.length,i?-7:void 0)}!function(e){e.ClientDisconnected="Client disconnected.",e.UnsupportedSyncMessage="SyncMessages with seq = -1 are not supported anymore.",e.UnexpectedSeedMessage="Unexpected seed message",e.SyncMessageUnsupportedBatch="SyncMessage with unsupported batching.",e.AnnotationTokenNotFound="Token not found"}(Br||(Br={})),function(e){e.ProvisionTokenValidationError="Token provision message didn't pass token validation.",e.ProvisionTokenDecryptAndTransformError="Token provision message didn't pass token decrypt and transform."}(Fr||(Fr={}));class Fi{constructor(e){this.config=e,this.nextMessageId=1,this.pendingResponseCallbacks=new Li({sweepInterval:5e3}),this.messageCallbacks=new Map,this.messageIdPrefix=e.messageIdPrefix,this.source="c"===e.messageIdPrefix?_r.ClientRuntime:_r.Core,this.stats={sendMessageCount:0,sendMessageClientDisconnectedErrors:0,sendMessageErrors:0,sendMessageDurationMsMax:0,processMessageCount:0,processMessageProvisionTokenErrors:0,processMessageErrors:0,processMessageDurationMsMax:0}}setClientMetadata(e){this.clientMetadata=e}setEgress(e){this.egress=e,this.config.resendPendingMessagesOnReconnect&&this.egress&&this.pendingResponseCallbacks.forEach(((e,t)=>{e.logOp.dimension1=(e.sendCount++).toString(),this.egress(e.message,(t=>this.onEgressError(t,e)))}))}ingress(e,t){qr.typeGuard(e)?(this.processResponse(e),t()):this.processMessage(e,t),ni.typeGuard(e)&&!e.reconnectAllowed&&this.clearAllPendingResponses()}sendMessage(e,t,n,r=0){var i,o;const a=new Ir({sessionHealthEventName:"SendMessage",source:this.source,reason:Tr.Client,impact:this.source===_r.ClientRuntime?Or.MissingInput:Or.MissingOutput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv,resourceId:Bi(ke.a.getTypeNameFor(e)),dimension0:r.toString()}).start(),s=()=>{if(a.setClientMetadata(this.clientMetadata),a.success)ar.a.info(572836e3,ar.b.CoreDefault,a.stop());else{const e="ErrorWithoutPendingResponse"===a.resultSignature||"ResponseCallbackException"===a.resultSignature||"We called into done callback"!==a.message;a.message=JSON.stringify({errorNotPropagatedToDoneCallback:e}),ar.a.error(572836001,ar.b.CoreDefault,a.stop())}};((e,t,...n)=>{const r=-1===jr.getValue().indexOf(e);return t?r?t(...n):void 0:r})("PersistMessageId")?e.messageId=null!==(i=e.messageId)&&void 0!==i?i:`${this.messageIdPrefix}${this.nextMessageId++}`:e.messageId=`${this.messageIdPrefix}${this.nextMessageId++}`,fi.typeGuard(e)&&e.messages.forEach(((t,n)=>t.messageId=e.messageId+"."+n));const u=ke.a.getTypeNameFor(e)===ni.getTypeName(),c={message:e,logOp:a,logEvent:s,callback:void 0,sendCount:1};if(!n&&!u){c.callback=(n,r)=>{var i;if(n?(a.success=!1,a.resultSignature=n.error,a.resultDescription=`Error for ${ke.a.getTypeNameFor(e)} message ${e.messageId}${hi.typeGuard(e)?`, seq ${e.seq}`:""}: ${n.error}`):a.resultSignature="Success",t)try{a.message="We called into done callback",t(n,r)}catch(e){a.success=!1,a.resultSignature="ResponseCallbackException",a.resultDescription="Web"===(null===(i=this.clientMetadata)||void 0===i?void 0:i.appPlatform)?JSON.stringify({message:e.message,stack:e.stack}):JSON.stringify({message:e.message})}s(),this.updateSendMessageStats(a.success,a.durationMs,n?new Error(n.error):void 0)};const n=()=>{c.callback(new Kr({code:Dr.RequestTimeout,error:"Timeout waiting for response"}),void 0)};let r=this.config.responseTimeoutMs;if(Xr.typeGuard(e)){const t=e;r=t.longPollTimeoutHint>=15e3&&t.longPollTimeoutHint<=3e5?t.longPollTimeoutHint+5e3:12e4}else Wr.typeGuard(e)&&(r=null!==(o=e.maxDelayMs)&&void 0!==o?o:12e4);this.pendingResponseCallbacks.put(e.messageId,c,r,n)}this.egress&&this.egress(e,(e=>this.onEgressError(e,c)),r)}onEgressError(e,t){var n,r;if(e){const i=t.message,o=this.pendingResponseCallbacks.get(t.message.messageId);o?(this.pendingResponseCallbacks.del(i.messageId),o.callback(new $r({messageId:i.messageId,code:Dr.EgressError,error:e.message}))):ni.typeGuard(i)?(t.logOp.success=null!==(r=null===(n=e.message)||void 0===n?void 0:n.endsWith("Client disconnected."))&&void 0!==r&&r,t.logOp.resultSignature="ErrorSendingSessionCloseMessage",t.logOp.resultDescription=`Error for ${ke.a.getTypeNameFor(i)} message ${i.messageId}: ${e.message}`,t.logEvent()):(t.logOp.success=!1,t.logOp.resultSignature="ErrorWithoutPendingResponse",t.logOp.resultDescription=`Error for ${ke.a.getTypeNameFor(i)} message ${i.messageId}: ${e.message}`,t.logEvent())}}queryEgressCacheSize(){return this.pendingResponseCallbacks.size()}onMessage(e,t){this.messageCallbacks.set(e,t)}getStats(){return this.stats}hasMessageCallback(e){return this.messageCallbacks.has(e)}cancelPendingResponseCallbacks(){this.pendingResponseCallbacks.forEach(((e,t)=>{e&&(this.pendingResponseCallbacks.del(t),e.callback(new $r({messageId:t,code:Dr.Cancelled,error:"Cancelled"})))}))}clearAllPendingResponses(){if(0==this.pendingResponseCallbacks.size())return;const e=new rr({operationName:"PurgePendingResponses",resultDescription:this.pendingResponseCallbacks.size().toString(),success:!0});ar.a.info(572836002,ar.b.CoreDefault,e),this.pendingResponseCallbacks.clear()}processMessage(e,t){const n=new Ir({sessionHealthEventName:"ProcessMessage",source:this.source,reason:Tr.Client,impact:this.source===_r.ClientRuntime?Or.MissingOutput:Or.MissingInput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv}).start(),r=()=>{if(n.setClientMetadata(this.clientMetadata),n.success)ar.a.info(572836003,ar.b.CoreDefault,n.stop());else{const e="UnsupportedMessage"===n.resourceId||"Timeout"===n.resultSignature||"OnResponseInvokedMoreThanOnce"===n.resultSignature||"MessageCallbackException"===n.resultSignature||"We called into messageCallback"!==n.message;n.message=JSON.stringify({errorHappenedOutsideRegisteredMessageCallback:e}),ar.a.error(572836032,ar.b.CoreDefault,n.stop())}};let i=this.messageCallbacks.get(ke.a.getTypeNameFor(e));i?n.resourceId=Bi(ke.a.getTypeNameFor(e)):i=(e,t)=>{n.resourceId=Bi(ke.a.getTypeNameFor(e)),"MalformedMessageName"!==n.resourceId&&(n.resourceId="UnsupportedMessage"),t(new $r({messageId:e.messageId,code:Dr.UnsupportedMessage,error:`Message type ${ke.a.getTypeNameFor(e)} is not supported`}))};let o=!1;const a=(i,a)=>{o?(n.success=!1,n.resultSignature="OnResponseInvokedMoreThanOnce",n.resultDescription=`Invoked onResponse for ${ke.a.getTypeNameFor(e)} message ${e.messageId} more than once`):i?(n.success=!1,n.resultSignature=i.error,void 0!==i.code&&(n.dimension0=Dr[i.code]),n.resultDescription=`Error for ${ke.a.getTypeNameFor(e)} message ${e.messageId}: ${i.error}`):n.resultSignature="Success",o=!0,r(),i&&!ke.a.matchesTypesFor(i,[$r.getTypeName()])&&(i=new $r({error:"Internal Server Error"})),this.updateProcessMessageStats(n.success,n.durationMs,i?new Error(i.error):void 0),i?(i.messageId=e.messageId,t(i)):a?(a.messageId=e.messageId,t(void 0,a)):t()};try{n.message="We called into messageCallback",i(e,a)}catch(e){n.success=!1,n.resultSignature="MessageCallbackException",n.resultDescription=JSON.stringify({message:e.message,stack:e.stack}),r(),this.updateProcessMessageStats(!1,n.durationMs,e),t()}}processResponse(e){var t;const n=new rr({operationName:"ProcessResponse"});if(n.success=!0,n.setClientMetadata(this.clientMetadata),n.start(),e.messageId){const t=this.pendingResponseCallbacks.get(e.messageId),r=null==t?void 0:t.callback;if(r){if(zr.typeGuard(e)&&!e.finalResponse){const n=t.message.maxDelayMs;this.pendingResponseCallbacks.updateExpireTime(e.messageId,n)}else this.pendingResponseCallbacks.del(e.messageId);ke.a.matchesTypesFor(e,[$r.getTypeName()])?r(e):r(void 0,e)}else n.resultSignature="NoPendingMessage",n.resultDescription=`${e.messageId}`,n.success=!1}else n.resultSignature="NoMessageIdSetInResponse",$r.typeGuard(e)?n.resultDescription=e.error:n.resultDescription="MessageId is not available",n.success=!1;"Production"!==(null===(t=this.clientMetadata)||void 0===t?void 0:t.releaseAudienceGroup)&&(n.resourceId=Bi(ke.a.getTypeNameFor(e)),ar.a.info(572836034,ar.b.CoreDefault,n.stop()))}updateSendMessageStats(e,t,n){this.stats.sendMessageCount++,this.stats.sendMessageDurationMsMax=Math.max(t,this.stats.sendMessageDurationMsMax),e||n?e&&n&&ar.a.warn(572836036,ar.b.CoreDefault,"Succeeded send message provided error object."):ar.a.warn(572836035,ar.b.CoreDefault,"Failed send message did not provide error object."),e||(n&&n.message===Br.ClientDisconnected?this.stats.sendMessageClientDisconnectedErrors++:this.stats.sendMessageErrors++)}updateProcessMessageStats(e,t,n){this.stats.processMessageCount++,this.stats.processMessageDurationMsMax=Math.max(t,this.stats.processMessageDurationMsMax),e||n?e&&n&&ar.a.warn(572836038,ar.b.CoreDefault,"Succeeded process message provided error object."):ar.a.warn(572836037,ar.b.CoreDefault,"Failed process message did not provide error object."),e||(n&&n.message===Fr.ProvisionTokenValidationError?this.stats.processMessageProvisionTokenErrors++:this.stats.processMessageErrors++)}}var Ui,qi=n(546);!function(e){e[e.Undefined=0]="Undefined",e[e.Schema=1]="Schema",e[e.Boolean=2]="Boolean",e[e.Number=3]="Number",e[e.String=4]="String",e[e.Buffer=5]="Buffer",e[e.Function=6]="Function"}(Ui||(Ui={}));class zi{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(zi,this,e)}static getTypeName(){return"AugLoop_Core_Annotation"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[zi.getTypeName()])}}zi.H_={T_:zi.getTypeName(),B_:zi.getBaseTypes()};class Wi{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(Wi,this,e)}static getTypeName(){return"AugLoop_Core_BinaryClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Wi.getTypeName()])}}Wi.H_={T_:Wi.getTypeName(),B_:Wi.getBaseTypes()};class Vi{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(Vi,this,e)}static getTypeName(){return"AugLoop_Core_StreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Vi.getTypeName()])}}Vi.H_={T_:Vi.getTypeName(),B_:Vi.getBaseTypes()};class Gi{constructor(e){ke.a.assign(Gi,this,e)}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Gi.getTypeName()])}}Gi.H_={T_:Gi.getTypeName(),B_:Gi.getBaseTypes()};class Hi{constructor(e){ke.a.assign(Hi,this,e)}static getTypeName(){return"AugLoop_Core_DirtyAreaSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Hi.getTypeName()])}}Hi.H_={T_:Hi.getTypeName(),B_:Hi.getBaseTypes()};class $i{constructor(e){ke.a.assign($i,this,e)}static getTypeName(){return"AugLoop_Core_DirtyDocumentSignal"}static getBaseTypes(){return["AugLoop_Core_DirtyAreaSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[$i.getTypeName()])}}$i.H_={T_:$i.getTypeName(),B_:$i.getBaseTypes()};class Ki{static createHealthCheckRequest(e){return{payload:{},payloadSchema:{category:Ui.Schema,schema:{name:"HealthCheckRequest"}},requestedSchema:{category:Ui.Schema,schema:{name:"HealthCheckResponse"}},clientMetadata:e}}static isFeatureEnabled(e,t,n=!1,r="None"){return e&&e.isFeatureEnabled?e.isFeatureEnabled("Microsoft.Office.AugLoop."+t,r).catch((()=>Promise.resolve(n))):Promise.resolve(n)}static isChangeGateEnabled(e,t){return e&&e.isChangeGateEnabled?e.isChangeGateEnabled(t):Promise.resolve(!1)}static convertWebSocketUrlToHttp(e){return this.convertUrl(e,!1)}static convertServiceUrlToWebSocket(e){return this.convertUrl(e,!0)}static convertUrl(e,t){if(!e)return e;const n=e.split(":");let r=n[0].toLowerCase();return 0==r.indexOf(t?"http":"ws")?(r=t?r.replace("http","ws"):r.replace("ws","http"),n[0]=r,n.join(":")):e}static deepEquals(e,t){return Ar()(e,t)}static collectTelemetry(e,t,n,r,i,o){var a,s,u,c;e.start(),e.resultSignature=null!=r?r:"",e.resultDescription=null!=i?i:"",e.success=n,o?(e.dimension0=null!==(a=o[0])&&void 0!==a?a:"",e.dimension1=null!==(s=o[1])&&void 0!==s?s:"",e.dimension2=null!==(u=o[2])&&void 0!==u?u:"",e.dimension3=null!==(c=o[3])&&void 0!==c?c:""):(e.dimension0="",e.dimension1="",e.dimension2="",e.dimension3=""),t.log((()=>ar.a.info(508367457,ar.b.CoreDefault,e.stop())))}}Ki.getCurrentTimeMs=()=>Date.now?Date.now():(new Date).getTime();class Ji{constructor(e){this.maxNumberOfLogs=40,this.numberOfLogs=0,this.id=e}log(e){if(this.numberOfLogs<this.maxNumberOfLogs&&(this.numberOfLogs++,e(),this.numberOfLogs===this.maxNumberOfLogs)){const e=new rr({operationName:"OnLastLog",success:!0,resourceId:this.id,resultDescription:`Limit for number of logs for id: ${this.id} reached - all next logs will be dropped`});ar.a.warn(572838107,ar.b.CoreDefault,e)}}}ke.a.getTypeName(),zi.getTypeName(),Gi.getTypeName();const Qi=(e,t=0)=>Number.isFinite(e)?e:t;var Yi,Xi=n(647),Zi=n.n(Xi);!function(e){e.ArrivedBeforeReseeding="Message is dropped from queue since it arrived before reseeding is started",e.DroppedAsOldestInQueue="Message is dropped as oldest in full queue",e.DroppedBecauseClientDisconnected="Message is dropped because client is disconnected from server"}(Yi||(Yi={}));class eo{constructor(e){this.logOp=new rr({operationName:"MessageQueue",success:!0}),this.queue=new Zi.a(1e3),this.callbacks=e}clear(){this.queue.clear()}size(){return this.queue.length}push(e,t,n){const r=this.queue;if(1e3===r.length){this.logOp.resourceId="QueueFull",this.logOp.durationMs=0,this.logOp.success=!1,ar.a.warn(508843746,ar.b.CoreDefault,this.logOp);const e=r.shift();e.onResponse&&e.onResponse(new $r({error:Yi.DroppedAsOldestInQueue}))}r.push({message:e,onResponse:t,timeQueued:Ki.getCurrentTimeMs(),attemptNumber:n})}sendOnSessionInitialized(e){const t=this.queue.length;let n=0;if(t>0){const r=Ki.getCurrentTimeMs()-this.queue.get(0).timeQueued;for(;this.queue.length>0&&this.callbacks.canSendMessage();){const t=this.queue.shift();e&&this.containSequencedSyncMessage(t)?(n++,t.onResponse&&t.onResponse(new $r({error:Yi.ArrivedBeforeReseeding}))):t.message instanceof Uint8Array?this.callbacks.sendBytes(t.message):this.callbacks.sendMessage(t.message,t.onResponse,t.attemptNumber)}this.logOp.resourceId="SendOnSessionInitialized",this.logOp.resultDescription=`Queue size before: ${t}, after: ${this.queue.length}. droppedSyncMessages: ${n}`,this.logOp.durationMs=r,this.logOp.success=!0,ar.a.warn(508843745,ar.b.CoreDefault,this.logOp)}}containSequencedSyncMessage(e){return e.message instanceof hi&&ke.a.matchesTypesFor(e.message,[hi.getTypeName()])&&e.message.seq>=0||e.message instanceof fi&&ke.a.matchesTypesFor(e.message,[fi.getTypeName()])}}var to;!function(e){e[e.Initing=0]="Initing",e[e.Running=1]="Running",e[e.Disconnected=2]="Disconnected",e[e.Closed=3]="Closed"}(to||(to={}));const no=(e,t,n,r)=>{t&&(t.cv||(t.cv=e.cvParent.newChild().toString()),e.messageEndpoint.sendMessage(t,((t,r)=>{t||ke.a.getTypeNameFor(r)!==gi.getTypeName()||(e.stats.lastSyncMessage=Date.now()),n&&n(t,r)}),void 0,r))},ro=(e,t,n,r)=>{t&&(e.messageQueue.push(t,n,r),e.networkWorkerManager.init(void 0,e.customInitPromise).catch((e=>{const t=new rr({operationName:"WorkerManagerInit",success:!1,resultDescription:`${e}`});ar.a.error(508843789,ar.b.CoreDefault,t)})))},io=(e,t)=>{t&&(e.messageQueue.push(t),e.networkWorkerManager.init(void 0,e.customInitPromise).catch((e=>{ar.a.error(508843788,ar.b.CoreDefault,`Init failed: ${e}`)})))};class oo{constructor(e){this.context=e}onEnter(e){}sendMessage(e,t,n,r){}sendBytes(e){}canSendMessage(){return!1}onConnectionClose(){}}class ao extends oo{constructor(){super(...arguments),this.stateName=to.Initing,this.possibleNextStates=[to.Running,to.Disconnected,to.Closed]}sendMessage(e,t,n){ke.a.matchesTypesFor(e,[Qr.getTypeName()])?no(this.context,e,t,n):ro(this.context,e,t)}sendBytes(e){io(this.context,e)}onConnectionClose(){this.context.setState(to.Disconnected)}}class so extends oo{constructor(){super(...arguments),this.stateName=to.Running,this.possibleNextStates=[to.Disconnected,to.Closed]}onEnter(e){e&&e.isSessionReseedingStarted&&this.context.resetNextSyncSequenceId(),this.context.messageQueue.sendOnSessionInitialized(e&&e.isSessionReseedingStarted)}sendMessage(e,t,n,r){no(this.context,e,t,n)}sendBytes(e){e&&this.context.networkWorkerManager.egressBytes(e)}canSendMessage(){return!0}onConnectionClose(){this.context.setState(to.Disconnected)}}class uo extends oo{constructor(){super(...arguments),this.stateName=to.Disconnected,this.possibleNextStates=[to.Initing,to.Closed]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks()}sendMessage(e,t,n,r){if(ke.a.matchesTypesFor(e,[Qr.getTypeName()]))this.context.setState(to.Initing),no(this.context,e,t,n);else if(ke.a.matchesTypesFor(e,[ni.getTypeName()]))this.context.setState(to.Closed);else{if(!r)return void ro(this.context,e,t,n);t&&t(new $r({messageId:e.messageId,error:Yi.DroppedBecauseClientDisconnected}))}}sendBytes(e){io(this.context,e)}}class co extends oo{constructor(){super(...arguments),this.stateName=to.Closed,this.possibleNextStates=[]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks()}}var lo=n(1093);var fo=n(385);const ho="Request timed out";function po(e,t,n){const r=new fo.Request(e,t);return go.add(r,n)}const go=new class{constructor(e,t,n){if(this.requestInProgress=!1,this.queuedRequests=[],null==e)throw new Error("No request.");this.fetch=e,this.fetchTimeout=t,this.queueTimeout=n}tryProcessNextRequest(){if(this.requestInProgress=!1,this.queuedRequests.length>0){const[e,t,n]=this.queuedRequests.shift();clearTimeout(n),this.add(e,t)}}add(e,t){if(this.requestInProgress){const n=setTimeout((()=>{t(new Error("Timed out waiting in queue"),null),this.queuedRequests.shift()}),this.queueTimeout);this.queuedRequests.push([e,t,n])}else{this.requestInProgress=!0;new Promise(((t,n)=>{let r=!1;const i=setTimeout((()=>{r=!0,n(new Error("Fetch timed out"))}),this.fetchTimeout);this.fetch(e).then((e=>{r||(clearTimeout(i),t(e))})).catch((e=>{r||(clearTimeout(i),n(e))}))})).then((e=>{t(null,e),this.tryProcessNextRequest()})).catch((e=>{t(e,null),this.tryProcessNextRequest()}))}}}(fo.fetch,2e4,12e4);class mo{constructor(e,t,n){this.lastPingTime=0,this.lastPongTime=0,this.lastEgressTime=0,this.remainingPingFailures=3,this.isPingPongSuccessful=!1,this.pingPongLogOp=new rr({operationName:"WebSocketReliabilityManager",success:!0}).start(),this.pingPongLogOp.setClientMetadata(n,!0),this.worker=e,this.rateControllerClose=t}start(){this.logOperation(!0,"ping","initial ping"),this.ping(),this.isPingPongSuccessful=!0,this.startInterval()}onResponse(){this.lastPongTime=Date.now()}isReliabilityResponse(e){return"string"==typeof e&&1===e.length&&e===mo.pingPongMessage}close(){this.logOperation(!0,"ping","close"),this.lastPingTime=0,this.lastPongTime=0,this.isPingPongSuccessful=!1,this.clearPingInterval(),this.worker=void 0}checkConnection(){return this.isPingPongSuccessful}postEgress(){this.lastEgressTime=Date.now()}needsParsedResponses(){return!1}ping(){this.lastPingTime=Date.now(),this.worker&&this.worker.egress({obj:mo.pingPongMessage})}startInterval(){this.pingInterval=setInterval((()=>{if(this.isPingPongSuccessful=this.lastPongTime>=this.lastPingTime&&this.lastPongTime-this.lastPingTime<=3e4,this.lastPongTime>this.lastEgressTime)return;const e=this.lastPongTime-this.lastPingTime;this.isPingPongSuccessful?(this.remainingPingFailures=3,this.ping()):this.remainingPingFailures>0?(--this.remainingPingFailures,this.ping()):(this.logOperation(!1,"ping","Pong still not received after all retry attempts",[`${e}`,`${this.remainingPingFailures}`]),this.worker?this.worker.close():this.rateControllerClose())}),3e4)}clearPingInterval(){this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0)}logOperation(e,t,n,r){var i,o,a,s;this.pingPongLogOp.start(),this.pingPongLogOp.success=e,this.pingPongLogOp.resultSignature=t,this.pingPongLogOp.resultDescription=n,r&&(this.pingPongLogOp.dimension0=null!==(i=r[0])&&void 0!==i?i:"",this.pingPongLogOp.dimension1=null!==(o=r[1])&&void 0!==o?o:"",this.pingPongLogOp.dimension2=null!==(a=r[2])&&void 0!==a?a:"",this.pingPongLogOp.dimension3=null!==(s=r[3])&&void 0!==s?s:""),ar.a.info(507320073,ar.b.CoreDefault,this.pingPongLogOp.stop())}}mo.pingPongMessage="~";class yo{constructor(e,t,n){this.remainingRetryAttempts=4,this.isAsleep=!1,this.isLongPollSuccessful=!1,this.isActiveLongPoll=!1,this.isResponseReceived=!1,this.lastEgressTime=0,this.longPollLogOp=new rr({operationName:"OnLongPollMessage",success:!0}),this.clientMetadata=t,this.sessionCorrelationVector=n,this.longPollLogOp.setClientMetadata(this.clientMetadata,!0),this.worker=e}start(){const e=new rr({operationName:"StartHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),ar.a.info(508163399,ar.b.CoreDefault,e.stop()),this.trySendLongPoll(!0),this.isLongPollSuccessful=!0}onResponse(e){if(!e||this.isResponseReceived){const e=new rr({operationName:"HttpReliabilityManagerFailure",success:!1}).start();return e.setClientMetadata(this.clientMetadata,!0),void ar.a.info(508162497,ar.b.CoreDefault,e.stop())}this.isResponseReceived=!0,this.isActiveLongPoll=!1;const t=e;t.error?(this.isLongPollSuccessful=!1,--this.remainingRetryAttempts,this.remainingRetryAttempts>0?(this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription=`Retry attempts left : ${this.remainingRetryAttempts}`,this.longPollLogOp.resultSignature=t.error,ar.a.info(508163398,ar.b.CoreDefault,this.longPollLogOp.stop()),"Request timed out"===t.error||3===this.remainingRetryAttempts?this.trySendLongPoll(!0):this.enqueueSendLongPoll()):(this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription="Long poll still not received after all retry attempts",ar.a.info(508163397,ar.b.CoreDefault,this.longPollLogOp.stop()),this.worker&&this.worker.close())):(this.longPollLogOp.success=!0,this.longPollLogOp.resultDescription="Long poll received",ar.a.info(508163401,ar.b.CoreDefault,this.longPollLogOp.stop()),this.remainingRetryAttempts=4,this.isLongPollSuccessful=!0,this.trySendLongPoll())}close(){const e=new rr({operationName:"CloseHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),ar.a.info(508162467,ar.b.CoreDefault,e.stop()),this.sendLongPollTimer&&(clearTimeout(this.sendLongPollTimer),this.sendLongPollTimer=void 0),this.isActiveLongPoll=!1,this.isLongPollSuccessful=!1,this.worker=void 0}checkConnection(){if(this.isAsleep){this.isAsleep=!1;const e=new rr({operationName:"AwakenHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),ar.a.info(508162496,ar.b.CoreDefault,e.stop()),this.trySendLongPoll(!0)}return this.isLongPollSuccessful}isReliabilityResponse(e){return"string"!=typeof e&&Zr.typeGuard(e)}postEgress(){this.lastEgressTime=Date.now(),this.trySendLongPoll()}needsParsedResponses(){return!0}enqueueSendLongPoll(){this.sendLongPollTimer=setTimeout((()=>{this.trySendLongPoll(!0)}),2e4)}trySendLongPoll(e){if(!this.worker){const e=new rr({operationName:"LongPollNoOp",success:!0}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Worker is undefined",void ar.a.info(507281438,ar.b.CoreDefault,e.stop())}if(!0===this.isActiveLongPoll){const e=new rr({operationName:"LongPollNoOp",success:!0}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Already active long poll",void ar.a.info(508163396,ar.b.CoreDefault,e.stop())}if(this.isActiveLongPoll=!0,Date.now()-this.lastEgressTime>6e4&&!e){this.isActiveLongPoll=!1,this.isAsleep=!0;const e=new rr({operationName:"LongPollSleep",success:!0}).start();return e.setClientMetadata(this.clientMetadata),e.resultDescription=`isAsleep: ${this.isAsleep}, isActiveLongPoll: ${this.isActiveLongPoll}`,void ar.a.info(507278739,ar.b.CoreDefault,e.stop())}this.longPollLogOp.start(),this.isResponseReceived=!1,this.worker.egress({obj:this.getLongPollMessageString(),isHttpSessionLongPollMessage:!0,isHttpSessionInitMessage:!1})}getLongPollMessageString(){const e=new Xr({longPollTimeoutHint:15e3});return this.sessionCorrelationVector&&(e.cv=this.sessionCorrelationVector().newChild().toString()),JSON.stringify(e)}}const bo=JSON.stringify(new Zr({error:ho}));class vo{constructor(){this.isClosed=!1,this.pendingEgress=[]}init(e,t,n,r){const i=new rr({operationName:"HttpWorkerInit",success:!0}).start(),o=e.split("/?x-origin=");2===o.length?(this.url=Ki.convertWebSocketUrlToHttp(o[0]),this.origin=o[1]):(this.url=Ki.convertWebSocketUrlToHttp(e),this.origin=void 0),this.ingress=t,this.onOpen=n,this.onClose=r,ar.a.info(507839180,ar.b.CoreDefault,i.stop())}egress(e){const t=new rr({operationName:"HttpEgress",success:!0}).start();if(!this.isConnectedToSession()&&!e.isHttpSessionInitMessage)return this.pendingEgress.push(e),t.success=!1,t.resultDescription="NotConnected, pendingQueueSize:  "+this.pendingEgress.length.toString(),void ar.a.info(508163394,ar.b.CoreDefault,t.stop());const n=this.getRequestInfo(e,t);if(!n.url)return t.success=!1,t.resultDescription="Could not generate HTTP request",void ar.a.error(508163393,ar.b.CoreDefault,t.stop());e.isHttpSessionLongPollMessage?this.egressLongPoll(n,t):po(n.url,n.request,((e,n)=>{e?this.onEgressError(t,"OnEgressError:"+(null==e?void 0:e.message)):n&&n.ok?n.text().then((e=>{t.success=!0,ar.a.info(508163362,ar.b.CoreDefault,t.stop()),this.ingressInternal(e)})).catch((e=>{this.onEgressError(t,"OnEgressParseError: "+(null==e?void 0:e.message))})):this.onEgressError(t,"OnEgressResponseError: "+(null==e?void 0:e.message)+`, Status ${null==n?void 0:n.status}: ${null==n?void 0:n.statusText}`)}))}close(){const e=new rr({operationName:"HttpWorkerClose",success:!0}).start();if(this.isClosed)return e.resultDescription="AlreadyClosed",void ar.a.info(508163360,ar.b.CoreDefault,e.stop());ar.a.info(508163359,ar.b.CoreDefault,e.stop()),this.isClosed=!0,this.sessionSettings=void 0,this.onClose&&(this.onClose(void 0),this.onClose=void 0)}onEgressError(e,t){e.success=!1,e.resultDescription=t,ar.a.error(508163358,ar.b.CoreDefault,e.stop()),this.isClosed||this.close()}ingressInternal(e,t){let n=e;t||(n=this.formatServerInput(e));const r=e=>{Yr.typeGuard(e)&&this.onSessionInitResponse(e)};n&&(this.logIngressCount(n),this.ingress(n,r))}onSessionInitResponse(e){const t=new rr({operationName:"HttpWorkerOpen",success:!0}).start();if(!(e.sessionKey&&e.origin&&e.anonymousToken&&e.sessionUrlBase))return t.success=!1,t.resultDescription="SessionInitResponse missing information",void ar.a.error(507809949,ar.b.CoreDefault,t.stop());ar.a.info(508163357,ar.b.CoreDefault,t.stop()),this.setSessionSettings(e.sessionKey,e.origin,e.anonymousToken,e.sessionUrlBase),this.onOpen(),this.pendingEgress.forEach((e=>{this.egress(e)})),this.pendingEgress=[]}egressLongPoll(e,t){var n,r,i;(n=e.url,r=2e4,i=e.request,new Promise(((e,t)=>{const o=setTimeout((()=>{t(new Error(ho))}),r);Object(fo.fetch)(n,i||{}).then((t=>{clearTimeout(o),e(t)})).catch((e=>{clearTimeout(o),t(e)}))}))).then((e=>{e&&e.ok?e.text().then((e=>{t.success=!0,t.resourceId="LongPoll",ar.a.info(508163355,ar.b.CoreDefault,t.stop()),this.ingressInternal(e)})).catch((e=>{this.onEgressError(t,"LongPollFetchParseError: "+(null==e?void 0:e.message))})):this.onEgressError(t,"LongPollFetchStatusFailure: "+(null==e?void 0:e.statusText))})).catch((e=>{e.message===ho?(t.success=!1,t.resultDescription="LongPollFetchResponseTimeout:"+(null==e?void 0:e.message),ar.a.error(508163353,ar.b.CoreDefault,t.stop()),this.ingressInternal(bo,!0)):this.onEgressError(t,"LongPollFetchResponseError: "+(null==e?void 0:e.message))}))}getRequestInfo(e,t){const n=this.getUrl(null==e?void 0:e.isHttpSessionInitMessage),r=this.getHeader(e,t);return t.resultSignature=n,{url:n,request:{method:"POST",headers:r,body:e.obj}}}getUrl(e){const t=this.sessionSettings&&this.sessionSettings.sliceUrl?this.sessionSettings.sliceUrl:this.url;return e?t+"/sessioninit":this.isConnectedToSession()?t+"/session/"+this.sessionSettings.sessionKey:""}getHeader(e,t){if(null==e?void 0:e.isHttpSessionInitMessage){const e=new fo.Headers({"Content-Type":"application/json"});return this.origin&&e.set("x-origin",this.origin),e}if(this.isConnectedToSession()){let n;return e.obj instanceof Uint8Array||e.obj instanceof ArrayBuffer?(n=new fo.Headers({"Content-Type":"application/jsond2"}),t.dimension0=e.obj.byteLength.toString().length.toString()):n=new fo.Headers({"Content-Type":"application/json"}),n.append("Authorization",`Bearer ${this.sessionSettings.anonymousToken}`),n.set("x-origin",this.sessionSettings.origin),n}return new fo.Headers}setSessionSettings(e,t,n,r){const i=r.replace("/session","");this.sessionSettings={sessionKey:e,origin:t,anonymousToken:n,sliceUrl:i}}isConnectedToSession(){return this.sessionSettings&&this.sessionSettings.sessionKey.length>0&&this.sessionSettings.anonymousToken.length>0&&this.sessionSettings.origin.length>0&&this.sessionSettings.sliceUrl.length>0&&!this.isClosed}formatServerInput(e){return e.length>1?e.substring(1,e.length-1):""}logIngressCount(e){const t=e.length;if(t>1e5){const e=new rr({operationName:"HttpIngressByteOrderOfMagnitude",success:!0}).start();e.dimension2=t.toString().length.toString(),ar.a.info(508409622,ar.b.CoreDefault,e.stop())}}}var wo=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};const So=1e5,_o=1e4,To=3e6,Oo=1e3;class Co{constructor(e){var t;this.emptyMessageId=0,this.egressMessageCount=0,this.egressByteCount=0,this.prevSeq=-1,this.pendingQueue=[],this.rpsThreshold=150,this.bpsThreshold=5e8,this.isClosing=!1,this.messageQueue=void 0,this.egressRateLogOp=new rr({operationName:"NetworkEgressRate",success:!0}),this.egressedCache=new Map,this.initPromise=new Promise((e=>{this.resolveInitPromise=e})),this.dynamicRateControllerEnabled=null!==(t=null==e?void 0:e.dynamicRateControllerEnabled)&&void 0!==t&&t,this.dynamicRateControllerEnabled&&(this.messageQueue=new Zi.a)}init(e,t,n,r,i,o){this.worker=e,this.ingress=t,this.queryEgressCacheSize=n,this.clientMetadata=i,this.networkMode=r,this.reliabilityManager=((e,t,n,r)=>e instanceof vo?new yo(e,n,r):new mo(e,t,n))(this.worker,this.close.bind(this),void 0,o),this.egressRateLogOp.setClientMetadata(this.clientMetadata,!0),this.dynamicRateControllerEnabled&&(this.resetRateLimiter(),this.onCloseController=new Promise((e=>{this.resolveCloseControllerPromise=e})),this.queueProcessingCompletePromise=new Promise((e=>{this.resolveQueueProcessingCompletePromise=e})),this.processQueue()),this.resolveInitPromise()}open(){const e=new rr({operationName:"NetworkRateControllerOpen",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),this.initPromise.then((()=>{if(!this.reliabilityManager)return e.success=!1,void(e.resultDescription="Reliability Manager is undefined");this.egressRateControlIntervalStart=Date.now(),this.reliabilityManager.start(),this.dynamicRateControllerEnabled||(this.egressRateControlTimer=setInterval((()=>this.flush()),1e3),this.flush())})).catch((t=>{var n;e.success=!1,e.resultDescription=null!==(n="Catch: "+(null==t?void 0:t.message))&&void 0!==n?n:""})).finally((()=>{ar.a.info(507834384,ar.b.CoreDefault,e.stop())}))}ingressFromWorker(e,t){this.reliabilityManager?this.reliabilityManager.needsParsedResponses()||!this.reliabilityManager.isReliabilityResponse(e)?this.ingress(e,(e=>{null==t||t(e),this.reliabilityManager.needsParsedResponses()&&this.reliabilityManager.isReliabilityResponse(e)&&this.reliabilityManager.onResponse(e)})):this.reliabilityManager.onResponse():this.ingress(e,t)}onRateLimitErrorResponse(e){if(this.dynamicRateControllerEnabled){const t=new rr({operationName:"NetworkRateControllerOnRateLimitResponse",success:!0}).start();t.setClientMetadata(this.clientMetadata,!0),t.resultSignature=`rateLimitAlreadyStarted: ${void 0!==this.rateLimitTimeout}`,t.setDataField("RetryAfterMs",e.retryAfterMs),t.setDataField("QueueSize",this.messageQueue.length),this.startRateLimiting(e.retryAfterMs),ar.a.info(507388684,ar.b.CoreDefault,t.stop())}}setRpsBps(e,t){const n=new rr({operationName:"NetworkRateControllerRateLimitsSet",success:!0}).start();n.setClientMetadata(this.clientMetadata,!0),e&&(this.rpsThreshold=.9*e,n.resultDescription+=`maxRPS: ${e}, rpsThreshold: ${this.rpsThreshold}; `),t&&(this.bpsThreshold=.9*t,n.resultDescription+=`maxRPS: ${t}, rpsThreshold: ${this.bpsThreshold}; `),ar.a.info(507388683,ar.b.CoreDefault,n.stop())}close(){var e,t;return wo(this,void 0,void 0,(function*(){const n=new rr({operationName:"NetworkRateControllerClose",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();if(n.setClientMetadata(this.clientMetadata,!0),this.isClosing=!0,this.dynamicRateControllerEnabled){null===(e=this.resolveCloseControllerPromise)||void 0===e||e.call(this);const r=null===(t=this.reliabilityManager)||void 0===t?void 0:t.checkConnection();n.setDataField("QueueSizeBeforeFlush",this.messageQueue.length),0!=this.messageQueue.length&&r&&(yield this.queueProcessingCompletePromise),n.setDataField("QueueSizeAfterFlush",this.messageQueue.length),n.setDataField("IsConnected",r)}this.reliabilityManager?this.reliabilityManager.close():n.resultDescription="Reliability Manager is undefined",this.worker=void 0,this.prevSeq=-1,this.clearEgressControlTimeout(),this.reliabilityManager=void 0,ar.a.info(507834381,ar.b.CoreDefault,n.stop())}))}clearMessageQueues(){this.pendingQueue=[],this.egressedCache.clear(),this.messageQueue=void 0}egress(e,t=0){var n,r,i;if(!this.reliabilityManager)return void this.logEgressActivity(!1,"Reliability Manager is undefined","");const o=this.getMessageSize(e);if(o>=To)this.logEgressActivity(!1,"Message size exceeded 3000000",`Message size: ${o}`);else{if((e.obj instanceof ArrayBuffer||e.isHttpSessionInitMessage)&&this.worker)return this.logEgressActivity(!0,`isArrayBuffer: ${e.obj instanceof ArrayBuffer}, isHttpSessionInitMessage: ${e.isHttpSessionInitMessage}`,""),void this.worker.egress(e);if(this.validateSyncMessage(e.messageId,e.seqId),this.dynamicRateControllerEnabled){const i=null!==(n=e.messageId)&&void 0!==n?n:"id"+this.emptyMessageId++,o={obj:e.obj,seqId:null==e?void 0:e.seqId,messageId:i,isHttpSessionInitMessage:null==e?void 0:e.isHttpSessionInitMessage},a=t>0,s=new rr({operationName:"NetworkRateControllerQueueItem",success:!0,dimension3:`isRetry: ${a}`}).start();s.setClientMetadata(this.clientMetadata,!0);const u={message:o,logOp:s};if(s.dimension0="Enqueue",a?this.messageQueue.unshift(u):this.messageQueue.push(u),this.messageQueue.length>1e4)throw this.messageQueue.shift(),new Error("MessageQueue max size reached.");ar.a.info(507388547,ar.b.CoreDefault,s.stop()),null===(r=this.resolveQueueNotEmptyPromise)||void 0===r||r.call(this)}else{const t=this.queryEgressCacheSize(),n=this.egressMessageCount>=this.rpsThreshold,r=this.egressByteCount>=this.bpsThreshold,o=t>_o,a=this.reliabilityManager.checkConnection(),s=0!==this.pendingQueue.length,u=this.pendingQueue.length>=1e4;if(!a||n||r||s||u||o){let c="";const l=[];(s||u)&&(c+=u?"Pending queue max exceeded. ":"Pending queue not empty. ",l.push(this.pendingQueue.length.toString().length.toString())),o&&(c+=t>=_o?"Egressed cache max exceeded. ":"",l.push(t.toString().length.toString())),n&&(c+="RPS exceeded. ",l.push(this.egressMessageCount.toString().length.toString())),r&&(c+="BPS exceeded. ",l.push(this.egressByteCount.toString().length.toString())),c+=a?"":"Not connected. ",this.logEgressActivity(!0,`networkMode: ${this.networkMode}`,c,l);const d=null!==(i=e.messageId)&&void 0!==i?i:"id"+this.emptyMessageId++;return void this.pendingQueue.push({obj:e.obj,seqId:null==e?void 0:e.seqId,messageId:d,isHttpSessionInitMessage:null==e?void 0:e.isHttpSessionInitMessage})}this.sendToNetworkWorker(e)}}}getMessageSize(e){return e.obj instanceof ArrayBuffer?e.obj.byteLength:e.obj.length}sendToNetworkWorker(e){try{if(!this.worker)return void this.logEgressActivity(!1,"NetworkWorker is undefined","SendToNetworkWorkerFailure");if(!this.reliabilityManager)return void this.logEgressActivity(!1,"Reliability Manager is undefined","SendToNetworkWorkerFailure");this.worker.egress(e),this.reliabilityManager.postEgress();const t=this.getMessageSize(e);this.logEgressCount(t)}catch(e){this.logEgressActivity(!1,"SendToNetworkWorkerFailure",e?e.message:"")}}flush(){if(!this.reliabilityManager){const e=new rr({operationName:"NetworkRateControllerFlushFailure",success:!1,dimension3:`networkMode: ${this.networkMode}`}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Reliability Manager is undefined",void ar.a.info(507834373,ar.b.CoreDefault,e.stop())}let e=0,t=0;for(;this.pendingQueue.length>0&&this.queryEgressCacheSize()<_o&&e<this.rpsThreshold&&t<this.bpsThreshold&&this.reliabilityManager.checkConnection();){const n=this.pendingQueue.shift();this.sendToNetworkWorker(n),e++,t+=this.getMessageSize(n)}}processQueue(){var e,t;return wo(this,void 0,void 0,(function*(){if(!this.reliabilityManager){const e=new rr({operationName:"NetworkRateControllerProcessQueueFailure",success:!1,dimension3:`networkMode: ${this.networkMode}`}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Reliability Manager is undefined",void ar.a.info(507573643,ar.b.CoreDefault,e.stop())}const n=new rr({operationName:"NetworkRateControllerProcessQueue",success:!0}).start();for(;;){if(0===this.messageQueue.length){if(this.isClosing){n.setDataField("ExitReason","Stage#1 Closing");break}yield Promise.race([this.queueNotEmpty(),this.onCloseController])}if(this.rateLimitTimeout){const e=new rr({operationName:"NetworkRateControllerRateLimitBackoff",dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),e.setDataField("QueueLengthBeforeBackoff",this.messageQueue.length),yield Promise.race([this.rateLimitTimeout,this.onCloseController]),e.setDataField("QueueLengthAfterBackoff",this.messageQueue.length),e.setDataField("IsClosing",this.isClosing),e.success=!0,this.rateLimitTimeout=void 0,this.resetRateLimiter(),ar.a.info(507281410,ar.b.CoreDefault,e.stop())}if(!(null===(e=this.reliabilityManager)||void 0===e?void 0:e.checkConnection())){if(this.isClosing){n.setDataField("ExitReason","Stage#2 Closing");break}yield this.checkConnectionPromise(),this.connectionPromise=void 0}if(!this.reliabilityManager){n.setDataField("ExitReason","Stage#2 ReliabilityManager null");break}for(;this.messageQueue.length>0&&this.reliabilityManager.checkConnection();){if(Date.now()-this.egressRateControlIntervalStart>=Oo)this.resetRateLimiter();else if(this.egressMessageCount>=this.rpsThreshold||this.egressByteCount>=this.bpsThreshold){const e=Date.now()-this.egressRateControlIntervalStart,t=Oo-e+100;let n="";this.egressMessageCount>=this.rpsThreshold&&(n+="RPS exceeded."),this.egressByteCount>=this.bpsThreshold&&(n+="BPS exceeded.");const r="rateLimitHit",i=new rr({operationName:"NetworkRateControllerEgress",dimension3:`networkMode: ${this.networkMode}`}).start();i.setClientMetadata(this.clientMetadata,!0),i.success=!0,i.resultDescription=r,i.resultSignature=n,i.dimension0=this.messageQueue.length.toString().length.toString(),i.dimension1="rateLimitHit",i.setDataField("QueueLength",this.messageQueue.length),i.setDataField("RateLimitDelayMs",t),ar.a.info(507281409,ar.b.CoreDefault,i.stop()),this.startRateLimiting(t);break}const e=this.messageQueue.shift();e.logOp.dimension0="Dequeue",this.sendToNetworkWorker(e.message),ar.a.info(507388682,ar.b.CoreDefault,e.logOp.stop())}this.onQueueNotEmpty=void 0,this.resolveQueueNotEmptyPromise=void 0}this.resolveQueueProcessingCompletePromise(),this.resolveQueueProcessingCompletePromise=void 0,n.setClientMetadata(this.clientMetadata,!0),n.setDataField("QueueSize",this.messageQueue.length),n.setDataField("IsConnected",null===(t=this.reliabilityManager)||void 0===t?void 0:t.checkConnection()),n.setDataField("IsClosing",this.isClosing),ar.a.info(507368671,ar.b.CoreDefault,n.stop())}))}queueNotEmpty(){return this.onQueueNotEmpty||(this.onQueueNotEmpty=new Promise((e=>{this.resolveQueueNotEmptyPromise=e}))),this.onQueueNotEmpty}checkConnectionPromise(){return this.connectionPromise||(this.connectionPromise=new Promise((e=>{setTimeout(e,1e3)}))),this.connectionPromise}startRateLimiting(e){this.rateLimitTimeout||(this.rateLimitTimeout=new Promise((t=>{setTimeout(t,e)})))}resetRateLimiter(){this.egressRateControlIntervalStart=Date.now(),this.egressMessageCount=0,this.egressByteCount=0}clearEgressControlTimeout(){this.egressRateControlTimer&&(clearInterval(this.egressRateControlTimer),this.egressRateControlTimer=void 0)}validateSyncMessage(e,t){if(!(void 0===t||void 0===e||t<=this.prevSeq)){if(t&&t!==this.prevSeq+1){const e=new rr({operationName:"NetworkRateControllerAbandonedSyncMessage",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Gap in sync message",e.dimension0=`${this.prevSeq}`,e.dimension1=`${t}`,e.dimension2=""+(t-this.prevSeq),ar.a.info(507834370,ar.b.CoreDefault,e.stop())}this.prevSeq=t}}logEgressActivity(e,t,n,r){var i,o,a,s;const u=new rr({operationName:"NetworkRateControllerEgress",dimension3:`networkMode: ${this.networkMode}`}).start();u.setClientMetadata(this.clientMetadata,!0),u.success=e,u.resultDescription=t,u.resultSignature=n,r&&(u.dimension0=null!==(i=r[0])&&void 0!==i?i:"",u.dimension1=null!==(o=r[1])&&void 0!==o?o:"",u.dimension2=null!==(a=r[2])&&void 0!==a?a:"",u.dimension3=null!==(s=r[3])&&void 0!==s?s:""),ar.a.info(507626007,ar.b.CoreDefault,u.stop())}logEgressCount(e){const t=Date.now();t-this.egressRateControlIntervalStart>Oo&&((this.egressMessageCount>50||this.egressByteCount>So)&&(this.egressRateLogOp.start(),this.egressRateLogOp.resultDescription=this.egressMessageCount>50?"rps logging threshold exceeded":"",this.egressRateLogOp.resultDescription=this.egressByteCount>So?"bps logging threshold exceeded":"",this.egressRateLogOp.dimension0=(t-this.egressRateControlIntervalStart).toString(),this.egressRateLogOp.dimension1=`${this.egressMessageCount}`,this.egressRateLogOp.dimension2=`${this.egressByteCount}`,this.egressRateLogOp.dimension3=`networkMode: ${this.networkMode}`,ar.a.info(508843792,ar.b.CoreDefault,this.egressRateLogOp.stop())),this.egressRateControlIntervalStart=t,this.egressMessageCount=0,this.egressByteCount=0),this.egressMessageCount++,this.egressByteCount+=null!=e?e:0}}var Eo;!function(e){e[e.JSWebSockets=0]="JSWebSockets",e[e.LocalWorkflowsOnly=1]="LocalWorkflowsOnly",e[e.HostWebSockets=2]="HostWebSockets",e[e.HttpFallback=3]="HttpFallback"}(Eo||(Eo={}));class Io{constructor(e,t,n,r,i,o,a,s,u,c,l){this.logCountLimiter=new Ji(Io.className),this.isWorkerReady=!1,this.permanentlyClosed=!1,this.currentReconnectAttempt=0,this.lastInitializationAttemptTimeMs=0,this.offlineInterval=void 0,this.alreadyLoggedReconnectAttempt=!1,this.httpTestsLeft=5,this.httpTestsSuccessCount=0,this.workerOpenCount=0,this.testHttpConnection=e=>{const t=Ki.convertWebSocketUrlToHttp(this.globalUrl),n=!e,r=null!=e?e:new rr({operationName:"HttpsTest",resourceId:hr(t),success:!1,resultDescription:"",resultSignature:"HttpResponse:"}).start();po(t,{method:"POST",headers:{"content-type":"application/json","X-CorrelationId":r.cv},body:JSON.stringify(Ki.createHealthCheckRequest(this.clientMetadata))},((e,t)=>{e?(r.dimension1="HttpErr",r.resultDescription+=`HttpErr: ${e.message}`):t&&t.ok?(r.dimension1="HttpOK",this.leaveOfflineMode(),this.httpTestsSuccessCount++,n&&(r.success=!0)):(r.dimension1="HttpNoResp",r.resultDescription+=`HttpStatus: ${null==t?void 0:t.status}`),n&&r.stop(),this.logCountLimiter.log((()=>{ar.a.info(508843780,ar.b.CoreDefault,r)}))}))},this.globalUrl=e,this.clientMetadata=t,this.workerFactory=n,this.sessionInitializer=r,this.ingress=i,this.queryEgressCacheSize=o,this.onConnectionClose=a,this.onDetectedWSBlock=s,this.sessionCorrelationVector=u,this.httpFallbackEnabled=c.httpFallbackEnabled,this.dynamicRateControllerEnabled=c.dynamicRateControllerEnabled,this.networkWorkerLogOp=new rr({operationName:"CreateNetworkWorker",success:!0}),this.networkMode=l||Eo.JSWebSockets,this.initNetworkMode=this.networkMode}init(e,t,n=!1){if(this.permanentlyClosed)return Promise.reject(new Error("permanentlyClosed"));if(this.isWorkerReady||this.pendingInitPromise)return this.pendingInitPromise?this.pendingInitPromise:Promise.resolve();this.extensionConfigs=e||this.extensionConfigs;const r=()=>{if(n||!this.alreadyLoggedReconnectAttempt){const e=n?Io.initialAttemptTimeout:Io.reconnectAttemptTimeout;this.connTimeout=setTimeout((()=>{const t=new rr({operationName:"ConnectionFailingOrSlow",dimension0:n?"Initial":"Reconnect",dimension1:e.toString(),dimension2:this.currentReconnectAttempt.toString()});ar.a.info(508843787,ar.b.CoreDefault,t),this.alreadyLoggedReconnectAttempt=!n,this.connTimeout=void 0}),e)}};return t?this.pendingInitPromise=t().catch((e=>{const t=new rr({operationName:"WorkerManagerCustomInit",success:!1,resultDescription:`${e}`});ar.a.error(508843786,ar.b.CoreDefault,t)})).then((()=>{r(),this.initInternal()})):(this.pendingInitPromise=Promise.resolve(),r(),this.initInternal()),this.pendingInitPromise}egress(e,t){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.egressInternal(e,t)})):(this.egressInternal(e,t),Promise.resolve())}egressBytes(e){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.egressBytesInternal(e)})):(this.egressBytesInternal(e),Promise.resolve())}getNetworkMode(){return this.networkMode}getInitNetworkMode(){return this.initNetworkMode}onRateLimitErrorResponse(e){this.dynamicRateControllerEnabled&&this.getNetworkRateController().onRateLimitErrorResponse(e)}close(e){this.isWorkerReady=!1,this.dynamicRateControllerEnabled&&this.networkRateController&&this.getNetworkRateController().close(),this.worker&&(this.worker.close(),this.worker=null),!this.dynamicRateControllerEnabled&&this.networkRateController&&this.getNetworkRateController().close(),this.networkRateController=null,this.permanentlyClosed=e||this.permanentlyClosed,this.permanentlyClosed&&(this.leaveOfflineMode(),clearTimeout(this.connTimeout))}initInternal(){if(this.isWorkerReady=!1,this.permanentlyClosed||this.isOffline()){const e=new rr({operationName:"WorkerManagerInitOffline",success:!0,resultSignature:this.permanentlyClosed?"PermanentlyClosed":"Offline"});ar.a.info(508843785,ar.b.CoreDefault,e)}else this.currentReconnectAttempt>0?setTimeout((()=>{this.tryToConnectAndInitializeSession()}),((e,t,n)=>{let r=0;const i=Ki.getCurrentTimeMs()?Ki.getCurrentTimeMs()-t:0,o=[1e3,2e3,5e3,1e4,6e4];return r=o[Math.max(0,Math.min(o.length-1,e-1))],r=Math.max(r-i,1e3),r=n&&n>0?Math.min(5e3,r):r,r})(this.currentReconnectAttempt,this.lastInitializationAttemptTimeMs,this.httpFallbackEnabled?this.httpTestsSuccessCount:void 0)):this.getNetworkMode()===Eo.HttpFallback?setTimeout((()=>{this.tryToConnectAndInitializeSession()}),100):this.tryToConnectAndInitializeSession()}egressInternal(e,t){if(!this.isWorkerReady&&!ke.a.matchesTypesFor(e,[Qr.getTypeName()]))return void(ke.a.matchesTypesFor(e,[qr.getTypeName()])||ar.a.error(508843784,ar.b.CoreDefault,new rr({operationName:"UnexpectedEgressCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`})));let n,r;if(ke.a.matchesTypesFor(e,[pi.getTypeName()])?(this.castBinaryData(e),n=lo.a.serialize(e)):n=JSON.stringify(e),hi.typeGuard(e)&&(r=e.seq),this.bypassRateController(e))return void this.worker.egress({obj:n});const i=Qr.typeGuard(e)&&this.getNetworkMode()===Eo.HttpFallback;this.getNetworkRateController().egress({obj:n,isHttpSessionInitMessage:i,messageId:e.messageId,seqId:r},t)}bypassRateController(e){return ni.typeGuard(e)}egressBytesInternal(e){this.isWorkerReady?this.getNetworkRateController().egress({obj:e}):ar.a.error(508843783,ar.b.CoreDefault,new rr({operationName:"UnexpectedEgressBytesCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`}))}tryToConnectAndInitializeSession(){this.currentReconnectAttempt++,this.lastInitializationAttemptTimeMs=Ki.getCurrentTimeMs();const e=t=>{if(this.permanentlyClosed||this.isOffline())return;const n=this.sliceUrl?this.sliceUrl:this.globalUrl;t.setDataField("connectionUrl",hr(n)),this.connect(n),this.sessionInitializer.initSession({isTokenRefresh:!1,isReconnectOnSameSlice:!!this.sliceUrl,extensionConfigs:this.extensionConfigs,onResponse:(n,r)=>{if(t.success=!n,t.resourceId=r?hr(r.sliceUrl):"",t.dimension2=this.getNetworkModeLogString(),this.getNetworkMode()===Eo.HttpFallback?(t.resultDescription=n?`HTTP Error: ${n.error}`:"",t.dimension0=t.success?"HTTPOK":"HTTPFail"):(t.resultDescription=n?`WS Error: ${n.error}`:"",t.dimension0=t.success?"WSOK":"WSFail"),n||!this.worker)return this.sliceUrl=void 0,this.close(),this.httpTestsLeft>0?(this.httpTestsLeft--,this.testHttpConnection(t.stop())):(this.httpFallbackEnabled?this.getNetworkMode()===Eo.JSWebSockets?0===this.workerOpenCount&&this.httpTestsSuccessCount>=5?(t.dimension1="WSBlocked",t.dimension3="HTTP Fallback",this.networkMode=Eo.HttpFallback,this.currentReconnectAttempt=0,this.resetHttpTestsCounter()):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="WSOffline"):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="HTTPOffline"):0===this.workerOpenCount&&this.httpTestsSuccessCount>=5?(this.permanentlyClosed=!0,t.dimension1="WSBlocked",this.onDetectedWSBlock()):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="WSOffline"),this.logCountLimiter.log((()=>{ar.a.info(508843782,ar.b.CoreDefault,t.stop())}))),void this.initInternal();if(this.logCountLimiter.log((()=>{ar.a.info(508843781,ar.b.CoreDefault,t.stop())})),r.forceReconnect){this.close();const t=new rr({operationName:"ForcedReconnect"}).start();t.resultSignature=`globalUrl: ${this.globalUrl}. sliceUrl: ${this.sliceUrl}`,this.sliceUrl=void 0,setTimeout((()=>{e(t)}),1e3)}else clearTimeout(this.connTimeout),this.sliceUrl=r.sliceUrl,this.dynamicRateControllerEnabled&&this.getNetworkRateController().setRpsBps(r.maxRPS,r.maxBPS),this.ready();this.resetHttpTestsCounter()}})},t=new rr({operationName:"TryToConnectAndInitializeSession",resultSignature:`Reconnection attempt #${this.currentReconnectAttempt}`}).start();e(t)}getNetworkRateController(){return this.networkRateController||(this.networkRateController=new Co({dynamicRateControllerEnabled:this.dynamicRateControllerEnabled})),this.networkRateController}connect(e){const t=this.getNetworkMode();this.networkWorkerLogOp.start(),this.networkWorkerLogOp.resultDescription=this.getNetworkModeLogString(),this.networkWorkerLogOp.dimension0=t.toString(),this.logCountLimiter.log((()=>ar.a.info(508372418,ar.b.CoreDefault,this.networkWorkerLogOp.stop()))),this.worker=this.workerFactory(t),this.worker.init(e,this.getNetworkRateController().ingressFromWorker.bind(this.networkRateController),(()=>{this.workerOpenCount++,this.getNetworkRateController().open(),this.leaveOfflineMode()}),(e=>{this.close(),this.onConnectionClose(e)}),this.clientMetadata),this.getNetworkRateController().init(this.worker,this.ingress,this.queryEgressCacheSize,t,this.clientMetadata,this.sessionCorrelationVector)}ready(){this.isWorkerReady=!0,this.pendingInitPromise=void 0,this.currentReconnectAttempt=0}castBinaryData(e){if(e){if(Array.isArray(e.__binaryMembers__))for(const t of e.__binaryMembers__)ArrayBuffer.isView(e[t])||(e[t]=new Uint8Array(e[t]));for(const t of Object.keys(e))"object"==typeof e[t]&&null!==e[t]&&this.castBinaryData(e[t])}}isOffline(){return!!this.offlineInterval}startOfflineMode(){this.offlineInterval=setInterval((()=>{this.testHttpConnection()}),6e4)}leaveOfflineMode(){this.isOffline()&&(clearInterval(this.offlineInterval),this.offlineInterval=void 0,this.resetHttpTestsCounter(),this.tryToConnectAndInitializeSession())}resetHttpTestsCounter(){this.httpTestsLeft=5,this.httpTestsSuccessCount=0}getNetworkModeLogString(){return"NetworkMode: "+(this.getNetworkMode()===Eo.JSWebSockets?"WebSocket":"HTTP")}}Io.initialAttemptTimeout=1e5,Io.reconnectAttemptTimeout=2e4,Io.className="NetworkWorkerManager";class ko{constructor(e){ke.a.assign(ko,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowRegistrationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[ko.getTypeName()])}}ko.H_={T_:ko.getTypeName(),B_:ko.getBaseTypes()};class Ao{constructor(e){ke.a.assign(Ao,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ao.getTypeName()])}}Ao.H_={T_:Ao.getTypeName(),B_:Ao.getBaseTypes()};class Po{constructor(e){ke.a.assign(Po,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Po.getTypeName()])}}Po.H_={T_:Po.getTypeName(),B_:Po.getBaseTypes()};class No{constructor(e){ke.a.assign(No,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_RuntimeInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[No.getTypeName()])}}No.H_={T_:No.getTypeName(),B_:No.getBaseTypes()};class jo{constructor(e){ke.a.assign(jo,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_DiagnosticTraceMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[jo.getTypeName()])}}jo.H_={T_:jo.getTypeName(),B_:jo.getBaseTypes()};class Ro{constructor(e){ke.a.assign(Ro,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ro.getTypeName()])}}Ro.H_={T_:Ro.getTypeName(),B_:Ro.getBaseTypes()};class xo{constructor(e){ke.a.assign(xo,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryFlushMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[xo.getTypeName()])}}xo.H_={T_:xo.getTypeName(),B_:xo.getBaseTypes()};class Do{constructor(e){ke.a.assign(Do,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_SessionCloseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Do.getTypeName()])}}Do.H_={T_:Do.getTypeName(),B_:Do.getBaseTypes()};class Mo{constructor(e){ke.a.assign(Mo,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowDefinitionOverrideMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Mo.getTypeName()])}}Mo.H_={T_:Mo.getTypeName(),B_:Mo.getBaseTypes()};class Lo{constructor(e){ke.a.assign(Lo,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_StreamingRequest","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Lo.getTypeName()])}}Lo.H_={T_:Lo.getTypeName(),B_:Lo.getBaseTypes()};class Bo{constructor(e){ke.a.assign(Bo,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsResponseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_StreamingResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Bo.getTypeName()])}}Bo.H_={T_:Bo.getTypeName(),B_:Bo.getBaseTypes()};class Fo extends qi.EventEmitter{constructor(e,t,n,r,i,o,a,s,u){super(),this.cvParent=new br,this.logOp=new rr({operationName:"SessionState",success:!0}).start(),this.sessionStateChangeLogCountLimiter=new Ji("SessionState"),this.logRetryTelemetry=!0,this.stats=t,this.allStates={[to.Initing]:new ao(this),[to.Running]:new so(this),[to.Disconnected]:new uo(this),[to.Closed]:new co(this)},this.setState(to.Initing),this.messageEndpoint=new Fi({messageIdPrefix:"c",responseTimeoutMs:3e4,resendPendingMessagesOnReconnect:!1}),this.messageEndpoint.setClientMetadata(i),this.messageEndpoint.setEgress(this.egress.bind(this)),this.messageEndpoint.onMessage(ni.getTypeName(),((e,t)=>{this.onSessionCloseMessage(e,t)})),this.networkWorkerManager=new Io(e,i,n,r,this.ingress.bind(this),this.messageEndpoint.queryEgressCacheSize.bind(this.messageEndpoint),this.onConnectionClose.bind(this),(()=>{this.onSessionClose(void 0,"WSNotSupported")}),this.getCorrelationVector.bind(this),a,u),this.messageQueue=new eo({sendMessage:(e,t,n,r)=>this.state.sendMessage(e,t,n,r),sendBytes:this.sendBytes.bind(this),canSendMessage:()=>this.state.canSendMessage()}),r.on("connect",((e,t,n,r,i,o,a)=>{this.setState(to.Running,"",{isSessionReseedingStarted:e&&t}),this.emit("connect",e,n,r,i,o,a)})),r.on("reconnect",(()=>this.emit("reconnect"))),r.on("serverAuthenticationStateChange",(e=>this.emit("serverAuthenticationStateChange",e))),this.resetNextSyncSequenceId=()=>this.emit("resetNextSyncSequenceId"),this.tokenRefreshManager=o,this.delayBeforeSocketClose=a.delayBeforeSocketClose,this.gateUtils=s,this.gateUtils&&this.gateUtils.isChangeGateEnabled("LogRetryMessageEvent").then((e=>{this.logRetryTelemetry=e})).catch((()=>{}))}setState(e,t,n){if(this.state&&e===this.state.stateName)return;const r=this.state?to[this.state.stateName]:"undefined",i=this.state?this.state.possibleNextStates.indexOf(e)>=0:e===to.Initing;this.sessionStateChangeLogCountLimiter.log((()=>{this.logOp.stop(),this.logOp.resourceId=`New state: ${i?to[e]:r}`,this.logOp.resultDescription=`Previous state: ${r}`,this.logOp.dimension0=`Attempted state: ${to[e]||"undefined"}`,this.logOp.resultSignature=t+(this.state&&!i?"Unexpected state change":""),this.logOp.success=i,ar.a.info(508843791,ar.b.CoreDefault,this.logOp)})),i&&(this.state=this.allStates[e],this.logOp.start(),this.state.onEnter(n))}init(e,t){return this.extensionConfigs=e,this.customInitPromise=t,this.networkWorkerManager.init(this.extensionConfigs,this.customInitPromise,!0)}sendMessage(e,t,n){this.retrySendMessage(e,t,Fo.maxRetries,n)}sendBytes(e){this.state.sendBytes(e)}onMessage(e,t){this.messageEndpoint.onMessage(e,t)}getCorrelationVector(){return this.cvParent}getNetworkWorkerManager(){return this.networkWorkerManager}forceReconnect(e){return this.extensionConfigs=e||this.extensionConfigs,this.networkWorkerManager.close(!1),new Promise((e=>setTimeout((()=>{e(this.networkWorkerManager.init(this.extensionConfigs))}),100)))}closeSession(e){if(this.sendMessage(new ni),this.delayBeforeSocketClose)setTimeout((()=>{this.networkWorkerManager.close(!0);const t=e||new ei({reasonDescription:"ClientRequested"});this.onSessionClose(new ni({reconnectAllowed:!1,reason:t}),"ClientRequested")}),100);else{this.networkWorkerManager.close(!0);const t=e||new ei({reasonDescription:"ClientRequested"});this.onSessionClose(new ni({reconnectAllowed:!1,reason:t}),"ClientRequested")}}ingress(e,t){let n;try{n=JSON.parse(e)}catch(e){ar.a.error(508843790,ar.b.CoreDefault,new rr({operationName:"ProcessMessage",resourceId:"Unknown",success:!1,resultSignature:"ParseError",resultDescription:e.message,durationMs:0}))}if(n){if(t&&qr.typeGuard(n)&&t(n),this.networkWorkerManager.getNetworkMode()===Eo.HttpFallback&&Zr.typeGuard(n)){const e=n;if(e.batch)for(const t of e.batch)this.messageEndpoint.ingress(t,((e,t)=>this.egress(e||t,(()=>{}))));return}this.messageEndpoint.ingress(n,((e,t)=>this.egress(e||t,(()=>{}))))}}egress(e,t,n){e&&this.networkWorkerManager.egress(e,n).then((()=>t())).catch((e=>t(e)))}onSessionCloseMessage(e,t){e.reconnectAllowed?this.networkWorkerManager.close():this.onSessionClose(e,"CloseMessageReceived"),t()}onSessionClose(e,t){this.setState(to.Closed,t),this.tokenRefreshManager.clearAllTimeouts(),this.onConnectionClose(void 0),e&&this.emit("sessionClose",e)}onConnectionClose(e){this.state.onConnectionClose(),this.stats.lastConnectionClose=Ki.getCurrentTimeMs(),this.emit("disconnect",e)}retrySendMessage(e,t,n,r,i){const o=Fo.maxRetries-n;this.state.sendMessage(e,((a,s)=>{var u,c,l,d;i&&(a&&0==n?(i.success=!1,ar.a.info(507025311,ar.b.CoreDefault,i.stop())):a&&n>0?(i.dimension0=(o+1).toString(),i.dimension1=null!==(u=a.code.toString())&&void 0!==u?u:"NoErrorCode",i.resultSignature=null!==(c=a.error)&&void 0!==c?c:"NoErrorMessage"):(i.success=!0,ar.a.info(507025310,ar.b.CoreDefault,i.stop()))),a&&n>0&&this.canBeRetried(e)&&this.isTransientError(a)?(this.logRetryTelemetry&&!i&&((i=new rr({operationName:"RetrySendMessage",success:!0,dimension0:o.toString()}).start()).resourceId=ke.a.getTypeNameFor(e),i.dimension1=null!==(l=a.code.toString())&&void 0!==l?l:"NoErrorCode",i.resultSignature=null!==(d=a.error)&&void 0!==d?d:"NoErrorMessage",i.resultDescription=`Retrying message with messageId: ${e.messageId}${hi.typeGuard(e)?`, seq: ${e.seq}`:""}`),ke.a.matchesTypesFor(a,[Jr.getTypeName()])&&this.networkWorkerManager.onRateLimitErrorResponse(a),this.retrySendMessage(e,t,n-1,r)):t&&t(a,s)}),o,r)}canBeRetried(e){return!ke.a.matchesTypesFor(e,[Qr.getTypeName(),pi.getTypeName(),Lo.getTypeName()])}isTransientError(e){const t=e.error;return t!==Br.SyncMessageUnsupportedBatch&&t!==Br.UnexpectedSeedMessage&&t!==Br.UnsupportedSyncMessage&&t!==Br.AnnotationTokenNotFound&&t!==Yi.ArrivedBeforeReseeding&&t!==Yi.DroppedAsOldestInQueue&&t!==Yi.DroppedBecauseClientDisconnected}}var Uo;Fo.maxRetries=2,function(e){e[e.NotAuthenticated=0]="NotAuthenticated",e[e.Pending=1]="Pending",e[e.Authenticated=2]="Authenticated",e[e.WacUserInfoAuthenticated=3]="WacUserInfoAuthenticated",e[e.TokenMissingInteractionRequired=4]="TokenMissingInteractionRequired"}(Uo||(Uo={}));var qo,zo,Wo,Vo,Go,Ho,$o,Ko,Jo,Qo,Yo,Xo,Zo,ea,ta,na,ra,ia,oa,aa,sa,ua,ca;!function(e){e[e.None=0]="None",e[e.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl",e[e.AlCodedLocation=2]="AlCodedLocation",e[e.Token=3]="Token"}(qo||(qo={})),function(e){e[e.NewDocument=0]="NewDocument",e[e.EditDocument=1]="EditDocument",e[e.ViewOnlyDocument=2]="ViewOnlyDocument"}(zo||(zo={}));class la{}la.lowerIndexBound=1,la.maxNumberOfRows=1048576,la.maxNumberOfColumns=16384,la.firstColumnName="A",la.lastColumnName="XFD",function(e){e[e.Unknown=0]="Unknown",e[e.LiveId=1]="LiveId",e[e.OrgId=2]="OrgId",e[e.ActiveDirectory=3]="ActiveDirectory",e[e.ADAL=4]="ADAL",e[e.SSPI=5]="SSPI",e[e.OAuth2=6]="OAuth2",e[e.Badger=7]="Badger"}(Wo||(Wo={})),function(e){e[e.Augloop=0]="Augloop",e[e.Substrate=1]="Substrate"}(Vo||(Vo={})),function(e){e[e.Unknown=0]="Unknown",e[e.TokenMissingInteractionRequired=1]="TokenMissingInteractionRequired"}(Go||(Go={}));class da{constructor(e,t,n,r){this.sendMessage=e,this.annotationType=t,this.options=n,this.token=`${t}-${da.nextActivationResultBatchId++}`,this.annotationDoesNotExistOnServiceEnabled=r}activate(e,t){return new Promise(((n,r)=>{this.sendMessage(new oi({annotationType:this.annotationType,token:this.token,config:this.options?this.options.config:void 0,ignoreExistingAnnotations:e,sendStateUpdates:this.options?!!this.options.stateUpdateCallback:void 0,forceReturnCachedAnnotations:this.options?this.options.forceReturnCachedAnnotations:void 0,returnAnnotationDoesNotExist:this.annotationDoesNotExistOnServiceEnabled||!1}),((e,t)=>{e?r(new Error(e.error)):(ai.typeGuard(t)&&this.annotationDoesNotExistOnServiceEnabled&&(this.annotationDoesNotExistOnService=t.annotationNotExists),n({token:this.token}))}),t)}))}release(){return new Promise(((e,t)=>{this.annotationDoesNotExistOnService&&this.annotationDoesNotExistOnServiceEnabled?e(!1):this.sendMessage(new ui({token:this.token}),((n,r)=>{n?t(new Error(n.error)):e(r.lastRelease)}))}))}}da.nextActivationResultBatchId=1,function(e){e[e.Input=0]="Input",e[e.Exception=1]="Exception",e[e.WaitOn=2]="WaitOn",e[e.StopAndFilterWorkflow=3]="StopAndFilterWorkflow"}(Ho||(Ho={})),function(e){e[e.Unknown=0]="Unknown",e[e.NoOutput=1]="NoOutput",e[e.Authentication=2]="Authentication",e[e.JoinTimedOut=3]="JoinTimedOut",e[e.LambdaThrow=4]="LambdaThrow",e[e.LambdaErrorCallback=5]="LambdaErrorCallback"}($o||($o={})),function(e){e[e.ExceedingMaxSize=0]="ExceedingMaxSize",e[e.GroupComplete=1]="GroupComplete",e[e.BatchIntervalElapsed=2]="BatchIntervalElapsed"}(Ko||(Ko={}));class fa{constructor(e,t,n,r){this.batchesByGroupingKey=new Map,this.getOrderOfMagnitudeDimension=e=>e<0?"Negative":0===e?"0":1===e?"1":`Magnitude ${e.toString().length}`,this.submit=e,this.onSummary=r,this.reduceBatchOperationsEnabled=t,this.batchMessagesEnabled=n}addBatchItem(e,t,n,r,i,o){const{delayMs:a,delayMsMax:s,maxInputSize:u,estimateSize:c,groupingKeyExtractor:l}=t,d=c(e),f=l(e);if(t.split&&d>u){let a;try{a=t.split(e)}catch(e){const t=new Error("Split error: "+e.message);return void(o?o(t):ar.a.error(573366352,ar.b.CoreDefault,t))}if(a&&Array.isArray(a.inputs)&&a.inputs.length>1){let e;const s=[],u=o?(t,n)=>{if(e=e||t,s.push(n),s.length===a.inputs.length){let n;try{n=a.join(s)}catch(t){return void o(new Error("Join error: "+t.message))}o(e,n)}}:void 0;for(let e=0;e<a.inputs.length;e++){const o=a.inputs[e];this.addBatchItem(o,t,n,r,i&&e===a.inputs.length-1,u)}return}}let h=this.batchesByGroupingKey.get(f);if(h&&h.size+d>u&&(this.executeBatch(f,h,t,Ko.ExceedingMaxSize),h=void 0),h||(h={items:[],size:0,hasItemsWithCallbacks:!1,context:n,creationTime:Date.now()},this.batchesByGroupingKey.set(f,h)),this.batchMessagesEnabled){const t=h.items[h.items.length-1];t&&t.cv===r&&t.callback===o?(t.input=[...t.input,...e],t.size+=d):h.items.push({input:e,size:d,cv:r,callback:o})}else h.items.push({input:e,size:d,callback:o});h.size+=d,h.hasItemsWithCallbacks=h.hasItemsWithCallbacks||!!o,this.batchMessagesEnabled||(h.cv=r),h.groupComplete=i,h.groupComplete?this.executeBatch(f,h,t,Ko.GroupComplete):(Date.now()-h.creationTime+a<s&&(clearTimeout(h.timeout),h.timeout=void 0),h.timeout||(h.timeout=setTimeout((()=>{this.executeBatch(f,h,t,Ko.BatchIntervalElapsed)}),a)))}removeAllBatchedItems(){this.batchesByGroupingKey.forEach((e=>{e.timeout&&clearTimeout(e.timeout)})),this.batchesByGroupingKey.clear()}reduceBatchOperations(e){const t=new rr({operationName:"ReduceBatchOperations"}).start();let n=0,r=0,i=0;const o=new Set,a=[],s=(e,t)=>e.parentPath.toString()+"/"+e.parentRevId+"/"+t.id;for(const t of e.input.reverse()){const e=[];for(const a of t.input.reverse())if(ze.typeGuard(a)){const t=[];for(const e of a.items){i++;const u=s(a,e);o.has(u)?r++:(t.push(e),o.add(u),n++)}0!==t.length&&(a.items=t,e.push(a))}else if(Fe.typeGuard(a)){for(const e of a.items){const t=s(a,e);o.delete(t)}e.push(a)}else e.push(a);0!==e.length&&a.push({input:e.reverse(),size:t.size,cv:t.cv,callback:t.callback})}e.input=a.reverse(),0!=i&&(t.dimension0=`${this.getOrderOfMagnitudeDimension(r)}`,t.dimension1=`noOp: ${0===r}`),t.success=i-r==n,ar.a.info(507839488,ar.b.CoreDefault,t.stop())}executeBatch(e,t,n,r){clearTimeout(t.timeout),t.timeout=void 0,this.batchesByGroupingKey.delete(e);const i=t.items,o=new rr({operationName:"ExecuteBatch",cv:this.batchMessagesEnabled?"":t.cv,resourceId:t.context.name,resultDescription:`batching duration: ${Date.now()-t.creationTime}ms`,dimension0:`${this.batchMessagesEnabled?"Batched items count":"Batched ops count:"} ${this.getOrderOfMagnitudeDimension(i.length)}`,dimension1:`Size ${this.getOrderOfMagnitudeDimension(t.size)}`,dimension2:r.toString()}).start(),a=(e,n,r)=>{let a;if(n&&n.exceptionType===$o.NoOutput)o.success=!0,ar.a.info(573366353,ar.b.CoreDefault,o.stop());else{const r=`${e} error: ${n?n.message||n:"Unknown error"}`;a=n||new Error(r),o.success=!1,o.resultDescription=`Batch of ${i.length} items of size ${t.size} with ${r}`,o.resultSignature=`${e} Error`,ar.a.error(573366354,ar.b.CoreDefault,o.stop())}if(t.hasItemsWithCallbacks)for(const e of i)e.callback&&e.callback(a,r)};let s;try{s=n.multiplex(this.batchMessagesEnabled?i:i.map((e=>e.input)))}catch(e){return void a("Multiplex",e)}this.reduceBatchOperationsEnabled&&this.batchMessagesEnabled&&"operations"==e&&this.reduceBatchOperations(s),this.submit(s.input,t,((e,r)=>{if(e||r&&("exceptionType"in r||r instanceof Error))a("Submit",e||r,r);else if(t.hasItemsWithCallbacks||n.summaryExtractor){let u,c,l;if(t.hasItemsWithCallbacks)try{if(u=s.demultiplex(r),u.length!==i.length)throw new Error("Mismatched output length")}catch(e){return void a("Demultiplex",e)}if(n.summaryExtractor)try{[l,c]=n.summaryExtractor(r)}catch(e){return void a("SummaryExtractor",e)}if(o.success=!0,ar.a.info(573366342,ar.b.CoreDefault,o.stop()),t.hasItemsWithCallbacks)for(let e=0;e<i.length;e++)i[e].callback&&i[e].callback(void 0,u[e]);c&&this.onSummary(l,c,t.context)}else o.success=!0,ar.a.info(573366343,ar.b.CoreDefault,o.stop())}))}}!function(e){e[e.EditorLowPrivilege=0]="EditorLowPrivilege",e[e.AugLoopLowPrivilege=1]="AugLoopLowPrivilege",e[e.Anonymous=2]="Anonymous",e[e.ClientAssertion=3]="ClientAssertion",e[e.ClientAssertionV2=4]="ClientAssertionV2",e[e.AutoClpLowPrivilege=5]="AutoClpLowPrivilege",e[e.AutoClpAppOnlyLowPrivilege=6]="AutoClpAppOnlyLowPrivilege",e[e.Substrate=7]="Substrate",e[e.WacUserInfo=8]="WacUserInfo",e[e.OwaExchange=9]="OwaExchange",e[e.SmartCompose=10]="SmartCompose",e[e.WritingAnalyticsLowPrivilege=11]="WritingAnalyticsLowPrivilege",e[e.DWEngineLowPrivilege=12]="DWEngineLowPrivilege",e[e.SubstrateApp=13]="SubstrateApp",e[e.CortanaAppPop=14]="CortanaAppPop",e[e.OfficeAppsAppOnly=15]="OfficeAppsAppOnly",e[e.PPTFrontdoorAppPop=16]="PPTFrontdoorAppPop",e[e.EditorAppOnlyLowPrivilege=17]="EditorAppOnlyLowPrivilege",e[e.AugLoopApp=18]="AugLoopApp",e[e.MeetingIntelligenceApp=19]="MeetingIntelligenceApp",e[e.GraphApp=20]="GraphApp",e[e.IceServicesApp=21]="IceServicesApp",e[e.AzureMapsApp=22]="AzureMapsApp",e[e.SpoApp=23]="SpoApp",e[e.OneDrive=24]="OneDrive",e[e.GoogleDrive=25]="GoogleDrive",e[e.GettyApp=26]="GettyApp",e[e.Dropbox=27]="Dropbox",e[e.GooglePhotos=28]="GooglePhotos",e[e.EditorApp=29]="EditorApp",e[e.AmazonKindle=30]="AmazonKindle",e[e.ShredderApp=31]="ShredderApp",e[e.FormsLowPrivilege=32]="FormsLowPrivilege",e[e.VivaSalesLowPrivilege=33]="VivaSalesLowPrivilege",e[e.IntentSvcApp=34]="IntentSvcApp",e[e.DcgLowPrivilege=35]="DcgLowPrivilege",e[e.CSALowPrivilege=36]="CSALowPrivilege",e[e.ConsumerSydneyLowPrivilege=37]="ConsumerSydneyLowPrivilege",e[e.CompliantSydneyApp=38]="CompliantSydneyApp",e[e.M365AdminApp=39]="M365AdminApp",e[e.MeetingArtifactsServiceLowPrivilege=40]="MeetingArtifactsServiceLowPrivilege",e[e.AlchemyApp=41]="AlchemyApp",e[e.M365Admin=42]="M365Admin",e[e.ConsumerShellApp=43]="ConsumerShellApp",e[e.PowerQueryLowPrivilege=44]="PowerQueryLowPrivilege",e[e.CIIApp=45]="CIIApp",e[e.ConsumerShell=46]="ConsumerShell",e[e.AssistCopilotLowPrivilege=47]="AssistCopilotLowPrivilege",e[e.Pva=48]="Pva",e[e.TeamsCopilotServiceLowPrivilege=49]="TeamsCopilotServiceLowPrivilege",e[e.CallAnalytics=50]="CallAnalytics",e[e.IncomingPFT=51]="IncomingPFT",e[e.GraphExchange=52]="GraphExchange",e[e.EXOAdmin=53]="EXOAdmin",e[e.InsightsServicesLowPrivilege=54]="InsightsServicesLowPrivilege",e[e.VivaServicesLowPrivilege=55]="VivaServicesLowPrivilege",e[e.EcsAppOnly=56]="EcsAppOnly",e[e.ShredderLowPrivilege=57]="ShredderLowPrivilege",e[e.SpoLowPrivilege=58]="SpoLowPrivilege",e[e.PromptValidationApp=59]="PromptValidationApp",e[e.CompliantSydneyLowPrivilege=60]="CompliantSydneyLowPrivilege",e[e.SubstrateTenantFeedbackApp=61]="SubstrateTenantFeedbackApp",e[e.MonitoringPlatform=62]="MonitoringPlatform",e[e.YammerLowPrivilege=63]="YammerLowPrivilege",e[e.VivaLearningLowPrivilege=64]="VivaLearningLowPrivilege",e[e.VivaInsightsLowPrivilege=65]="VivaInsightsLowPrivilege",e[e.ClientAugLoopApp=66]="ClientAugLoopApp",e[e.AssistAuthLowPrivilege=67]="AssistAuthLowPrivilege",e[e.VivaLearningSearchPreProdLowPrivilege=68]="VivaLearningSearchPreProdLowPrivilege",e[e.SubstrateSearchApp=69]="SubstrateSearchApp",e[e.SparkContentPlatformLowPrivilege=70]="SparkContentPlatformLowPrivilege",e[e.SparkContentPlatformPopApp=71]="SparkContentPlatformPopApp",e[e.ConsumerSydneyApp=72]="ConsumerSydneyApp",e[e.BusinessAssistAuthLowPrivilege=73]="BusinessAssistAuthLowPrivilege",e[e.AzureResourceManager=74]="AzureResourceManager",e[e.AlchemyPortal=75]="AlchemyPortal",e[e.VivaUserSkillsApp=76]="VivaUserSkillsApp",e[e.VivaEngageAppPop=77]="VivaEngageAppPop",e[e.SubstrateAppOnly=78]="SubstrateAppOnly",e[e.PowerAutomateFlowCreationLowPrivilege=79]="PowerAutomateFlowCreationLowPrivilege",e[e.PowerAutomateConnectionCreationLowPrivilege=80]="PowerAutomateConnectionCreationLowPrivilege",e[e.PowerAutomateAuthorizeConnectionLowPrivilege=81]="PowerAutomateAuthorizeConnectionLowPrivilege",e[e.TCAAppPop=82]="TCAAppPop",e[e.BusinessAssistAuthAppPop=83]="BusinessAssistAuthAppPop",e[e.HolmesApp=84]="HolmesApp",e[e.GraphAppOnly=85]="GraphAppOnly",e[e.SimsApp=86]="SimsApp",e[e.VivaOrgInsightsLowPrivilege=87]="VivaOrgInsightsLowPrivilege",e[e.VivaGoalsAppPop=88]="VivaGoalsAppPop",e[e.GCBotAppPop=89]="GCBotAppPop",e[e.ShredderV2App=90]="ShredderV2App",e[e.ShredderV2LowPrivilege=91]="ShredderV2LowPrivilege",e[e.AmplifyProfileService=92]="AmplifyProfileService",e[e.AzureDevopsLowPrivilege=93]="AzureDevopsLowPrivilege",e[e.CommuteServices=94]="CommuteServices",e[e.GCBotAppOnly=95]="GCBotAppOnly",e[e.TCAAppOnly=96]="TCAAppOnly"}(Jo||(Jo={})),function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(Qo||(Qo={})),function(e){e.AuthorizationCode="authorization_code",e.ClientCredentials="client_credentials",e.RefreshToken="refresh_token"}(Yo||(Yo={})),function(e){e[e.LoggedIn=0]="LoggedIn",e[e.LoggedOut=1]="LoggedOut"}(Xo||(Xo={})),function(e){e[e.SingleItem=0]="SingleItem",e[e.Reduce=1]="Reduce",e[e.Grid=2]="Grid",e[e.DynamicText=3]="DynamicText",e[e.Join=4]="Join",e[e.Generic=5]="Generic"}(Zo||(Zo={})),function(e){e.Default="Default",e.Copilot="Copilot"}(ea||(ea={})),function(e){e[e.Default=0]="Default",e[e.LocalOnly=1]="LocalOnly",e[e.Exclusive=2]="Exclusive"}(ta||(ta={})),function(e){e[e.PreActivate=0]="PreActivate",e[e.Default=1]="Default",e[e.DelayActivate=1]="DelayActivate",e[e.NeverActivate=2]="NeverActivate"}(na||(na={})),function(e){e[e.Required=-3]="Required",e[e.Optional=-1]="Optional"}(ra||(ra={})),function(e){e[e.Never=0]="Never",e[e.Always=1]="Always"}(ia||(ia={})),function(e){e[e.PreSeed=1]="PreSeed",e[e.OnSeed=2]="OnSeed",e[e.PostSeed=4]="PostSeed",e[e.All=5]="All"}(oa||(oa={})),function(e){e[e.UpstreamWorkflowsReady=0]="UpstreamWorkflowsReady",e[e.AnnotationMetadataUpdated=1]="AnnotationMetadataUpdated",e[e.DeltaUpdate=2]="DeltaUpdate",e[e.NonExclusiveTriggerSignals=3]="NonExclusiveTriggerSignals"}(aa||(aa={})),function(e){e[e.Character=1]="Character",e[e.Paragraph=2]="Paragraph"}(sa||(sa={})),function(e){e.Input="Input",e.Delta="Delta",e.UILanguage="UILanguage",e.MaxInputCount="MaxInputCount"}(ua||(ua={})),function(e){e.SetPredefinedAnnotation="SetPredefinedAnnotation",e.ClearAnnotations="ClearAnnotations"}(ca||(ca={}));const ha=(e,t)=>{const n=[];for(const r of null!=e?e:[])if(void 0===t||t===r.cardinality)for(const e of r.contextTypes)n.push([e,r.cardinality,r.producerWaitPolicy]);return n},pa="\\",ga=(e,t)=>Object.assign(Object.assign({},t),{parentPath:e}),ma=e=>Array.isArray(e)?5===e.length?`${e[0]}${pa}${e[1]}${pa}${e[2]}${pa}${e[3]}${pa}${e[4]}`:4===e.length?`${e[0]}${pa}${e[1]}${pa}${e[2]}${pa}${e[3]}`:3===e.length?`${e[0]}${pa}${e[1]}${pa}${e[2]}`:2===e.length?`${e[0]}${pa}${e[1]}`:1===e.length?e[0]:e.join(pa):"(malformed path)";var ya;!function(e){e[e.Local=0]="Local",e[e.External=1]="External"}(ya||(ya={}));class ba{constructor(){this.graphNodeByLocationAndWorkflowId=new Map}getWorkflow(e,t){var n;const r=this.getLocation(t);return null===(n=this.graphNodeByLocationAndWorkflowId.get(r))||void 0===n?void 0:n.get(e)}addWorkflow(e,t=!1){if(this.getWorkflow(e.id,t)){const n=new rr({operationName:"AddWorkflowToGraphFailure",success:!1,resourceId:e.id,resultDescription:`Adding a new with workflow with a duplicated workflowId: ${t}`}).start();return void ar.a.error(524300630,ar.b.CoreDefault,n.stop())}const n=this.getLocation(t),r=new va(e,n);this.addWorkflowAsDependency(r);let i=this.graphNodeByLocationAndWorkflowId.get(n);i||(i=new Map,this.graphNodeByLocationAndWorkflowId.set(n,i)),i.set(e.id,r)}getUpstreamRuntimeVisibleWorkflows(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const n of t.values()||[]){const t=this.createWorkflowDefinition(n.workflow);n.workflow.visibility===ta.LocalOnly?this.compressDownstreamWorkflows(t,n):t.outputTypes.push(...n.workflow.outputTypes),0!==t.inputTypes.length&&e.push(t)}return e}removeWorkflows(e){const t=this.getLocation(e),n=this.graphNodeByLocationAndWorkflowId.get(t),r=Array.from((null==n?void 0:n.values())||[]);for(const e of r){for(const t of e.upstreamWorkflows.values())t.downstreamWorkflows.delete(e);for(const t of e.downstreamWorkflows.values())t.upstreamWorkflows.delete(e);n.delete(e.workflow.id)}}getWorkflowsDefinitions(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const n of t.values()||[])e.push(n.workflow);return e}getWorkflowNodes(e){const t=[];for(const e of this.graphNodeByLocationAndWorkflowId.values())for(const n of e.values())t.push(n);return t}getLocation(e){return e?ya.External:ya.Local}createWorkflowDefinition(e){return Object.assign(Object.assign({},e),{outputTypes:[]})}compressDownstreamWorkflows(e,t){for(const n of t.downstreamWorkflows)if(n.workflow.visibility!==ta.LocalOnly){if(n.workflow.kind!==Zo.Join||-1!==e.inputTypes.indexOf(n.workflow.collectionScopeType))for(const t of n.workflow.outputTypes)-1===e.outputTypes.indexOf(t)&&e.outputTypes.push(t)}else this.compressDownstreamWorkflows(e,n)}addWorkflowAsDependency(e){for(const t of this.graphNodeByLocationAndWorkflowId.values())for(const n of t.values()){for(const t of n.workflow.inputTypes)-1!==e.workflow.outputTypes.indexOf(t)&&this.addWorkflowChain(e,n);for(const t of n.workflow.outputTypes)-1!==e.workflow.inputTypes.indexOf(t)&&this.addWorkflowChain(n,e)}}addWorkflowChain(e,t){e.downstreamWorkflows.add(t),t.upstreamWorkflows.add(e)}}class va{constructor(e,t){this.isActivated=!0,this.upstreamWorkflows=new Set,this.downstreamWorkflows=new Set,this.location=t,this.workflow=Object.assign(Object.assign({},e),{inputTypes:Array.isArray(e.inputTypes)?e.inputTypes:[],outputTypes:Array.isArray(e.outputTypes)?e.outputTypes:[]})}}const wa=e=>({id:e.id,kind:e.kind,visibility:e.visibility,collectionScopeType:e.collectionScopeType,inputTypes:e.inputTypes,outputTypes:e.outputTypes,correlatedSignals:e.correlatedSignals}),Sa=(e,t)=>null!=e&&(null!=t&&(e.length>0&&(e===t||0===t.indexOf(e)&&"."===t.charAt(e.length))));class _a{constructor(){this.workflowDefByWorkflowAndContextId=new Map,this.workflowDefByWorkflow=new Map}static mergeDefinitions(e,t,n){return Object.assign(Object.assign(Object.assign({},e),t),n)}mergeWorkflowDefinition(e,t,n){if(n){const r=((e,t,n)=>{let r=e.get(t);return r||(r=n(),e.set(t,r)),r})(this.workflowDefByWorkflowAndContextId,e.id,(()=>new Map));r.set(n,_a.mergeDefinitions(e,r.get(n),t))}else this.workflowDefByWorkflow.set(e.id,_a.mergeDefinitions(e,this.workflowDefByWorkflow.get(e.id),t))}getWorkflowDefinition(e,t){var n;let r;return t&&(r=null===(n=this.workflowDefByWorkflowAndContextId.get(e.id))||void 0===n?void 0:n.get(t)),r||(r=this.workflowDefByWorkflow.get(e.id)),r||(r=e),r}deleteWorkflowDefinition(e,t){const n=this.workflowDefByWorkflowAndContextId.get(e.id);n&&(n.delete(t),0===n.size&&this.workflowDefByWorkflowAndContextId.delete(e.id))}}const Ta=new Set([Fe.getTypeName(),ze.getTypeName(),Xe.getTypeName(),Qe.getTypeName()]);class Oa{constructor(e,t){this.nextId=1,this.runtimeKind=e,this.workflowGraph=t}static isParentContextId(e,t){return Sa(e,t)}applyContextIdOnOperations(e){for(const t of e){const e=ke.a.getTypeNameFor(t);if(this.isSupportedOperation(e))for(const e of t.items)e.contextId?e.source&&this.workflowGraph.getWorkflow(e.source,!1)?e.contextId=this.addNewContextId(e.contextId):this.tryLogMessage(new rr({operationName:"ApplyContextIdOnOperations",success:!0}).start(),"Item with a contextId but without a workflow source atribute"):e.contextId=this.addNewContextId()}}addNewContextId(e){const t=`${this.runtimeKind}${this.nextId++}`;return e?`${e}.${t}`:t}isSupportedOperation(e){return Ta.has(e)}tryLogMessage(e,t,n=!0){e&&(e.success=n,e.resultDescription=t,ar.a.verbose(527308633,ar.b.CoreDefault,e.stop()))}}var Ca,Ea;!function(e){e[e.Idle=1]="Idle",e[e.Pending=2]="Pending",e[e.Running=3]="Running",e[e.Executed=4]="Executed"}(Ca||(Ca={}));class Ia{constructor(e){this.scopeItemsByContextId=new Map,this.itemsByWorkflowAndContextId=new Map,this.workflowDefinitionManager=e}setScopeItem(e,t){var n;const r=e.contextId;if(r)if(this.itemsByWorkflowAndContextId.has(t.id)||this.itemsByWorkflowAndContextId.set(t.id,new Map),this.itemsByWorkflowAndContextId.get(t.id).set(r,[]),this.scopeItemsByContextId.has(r)){if(null===(n=this.itemsByWorkflowAndContextId.get(t.id))||void 0===n?void 0:n.has(r)){const n=new rr({resultDescription:`Trying to set new scope item: ${e.id} with already existing contextId ${r} for workflow ${t.id}`,operationName:"WIS.setScopeItem",resourceId:t.id,success:!0}).start();ar.a.verbose(527291288,ar.b.CoreDefault,n.stop())}}else this.scopeItemsByContextId.set(r,e)}updateScopeItemPath(e,t,n){var r,i;if(!e)return;const o=this.scopeItemsByContextId.get(e);if(!o)return;const a=o.parentPath;this.scopeItemsByContextId.set(e,ga(t,o));const s=null!==(i=null===(r=this.itemsByWorkflowAndContextId.get(n.id))||void 0===r?void 0:r.get(e))&&void 0!==i?i:[];for(let e=0;e<s.length;e++)s[e]=ga([...t,...s[e].parentPath.slice(0,a.length)],s[e])}getScopeItem(e,t){var n;for(const r of(null===(n=this.itemsByWorkflowAndContextId.get(t.id))||void 0===n?void 0:n.keys())||[])if(Sa(r,e))return this.scopeItemsByContextId.get(r)}addItemToWorkflowList(e,t){const n=e.contextId;if(!n)return;const r=this.itemsByWorkflowAndContextId.get(t.id);if(r)for(const[i,o]of r)if(Sa(i,n)){o.push(e);const n=new rr({resultDescription:`Items for contextId ${i}: [${o.map((e=>e.id)).join(",")}]`,operationName:"WIS.addItemOnContextIdList",resourceId:t.id,success:!0}).start();ar.a.info(526403808,ar.b.CoreDefault,n.stop())}}isWorkflowReady(e,t){const n=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.getGeneratedItems(e,t).length>=n}getItemsToExecute(e,t){const n=this.getGeneratedItems(e,t);return this.itemsByWorkflowAndContextId.get(t.id).delete(e),n}onWorkflowExecuted(e,t){const n=e.contextId,r=this.itemsByWorkflowAndContextId.get(t.id);r&&(r.delete(n),0===r.size&&this.itemsByWorkflowAndContextId.delete(t.id)),this.hasWorkflowsAwaitingExecution(n)||this.scopeItemsByContextId.delete(n)}getGeneratedItems(e,t){var n;if(!(null===(n=this.itemsByWorkflowAndContextId.get(t.id))||void 0===n?void 0:n.get(e)))return[];const r=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.itemsByWorkflowAndContextId.get(t.id).get(e).slice(0,r)}hasWorkflowsAwaitingExecution(e){for(const t of this.itemsByWorkflowAndContextId.values())for(const n of t.keys())if(n===e)return!0;return!1}}!function(e){e.JsClient="C",e.Server="S"}(Ea||(Ea={}));var ka=n(336),Aa=n(48),Pa=n(299);function Na(e,t,n=!1){let r,i,o={firstDiffLeft:0,firstDiffRight:t.length};return e.length<t.length?(r=e,i=t):(r=t,i=e),0===i.indexOf(r)?(o.firstDiffLeft=r.length,o.firstDiffRight=0):i.endsWith(r)?(o.firstDiffLeft=0,o.firstDiffRight=r.length):(o=function(e,t,n=!1){const r={firstDiffLeft:0,firstDiffRight:t.length};let i;for(i=0;i<e.length&&i<t.length;i+=1){const r=e.charCodeAt(i),o=t.charCodeAt(i);if(!(r===o||ja(r,n)&&ja(o,n)))break}for(r.firstDiffLeft=i,i=0;i<e.length&&i<t.length;i+=1){const r=e.charCodeAt(e.length-i-1),o=t.charCodeAt(t.length-i-1);if(!(r===o||ja(r,n)&&ja(o,n)))break}return r.firstDiffRight=i,r}(e,t,n),o.firstDiffLeft+o.firstDiffRight>r.length&&(o.firstDiffRight=r.length-o.firstDiffLeft)),function(e,t,n){if(e.firstDiffLeft>0){const r=e.firstDiffLeft<t.length&&Ra(t,e.firstDiffLeft),i=e.firstDiffLeft<n.length&&Ra(n,e.firstDiffLeft);(r||i)&&(e.firstDiffLeft-=1)}if(e.firstDiffRight>1){const r=e.firstDiffRight<t.length&&Ra(t,t.length-e.firstDiffRight),i=e.firstDiffRight<n.length&&Ra(n,n.length-e.firstDiffRight);(r||i)&&(e.firstDiffRight-=1)}}(o,e,t),o}function ja(e,t=!1){switch(e){case 12288:case 8197:case 32:case 11:case 9:case 160:return!0;case 13:case 10:case 65532:return!t}return!1}function Ra(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343}const xa=/[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]/g,Da=/[.!?]/g;function Ma(e,t){const n=[],r=Ba(e,t);return r&&n.push(r),n}function La(e,t){const n=[],r=Ba(e,t);r&&n.push(r);const i=function(e,t,n){var r,i,o,a,s,u;const c=e,l=t;if((null==c?void 0:c.ipPosition)===(null==l?void 0:l.ipPosition)&&(null==c?void 0:c.isColdIp)===(null==l?void 0:l.isColdIp))return;if((null==c?void 0:c.isColdIp)===(null==l?void 0:l.isColdIp)&&n)if(n.deltaType===Aa.b.Add){if((null==l?void 0:l.ipPosition)===(null!==(r=n.position)&&void 0!==r?r:0)+(null!==(i=n.length)&&void 0!==i?i:0))return}else if(n.deltaType===Aa.b.Update){if((null==l?void 0:l.ipPosition)===(null!==(o=n.position)&&void 0!==o?o:0)+(null!==(s=null===(a=n.content)||void 0===a?void 0:a.length)&&void 0!==s?s:0))return}else if(n.deltaType===Aa.b.Delete&&(null==l?void 0:l.ipPosition)===(null!==(u=n.position)&&void 0!==u?u:0))return;return new Pa.a({deltaType:Aa.b.CursorUpdate,cursorData:{ipPosition:null==l?void 0:l.ipPosition,isColdIp:null==l?void 0:l.isColdIp}})}(e,t,r);i&&n.push(i);const o=function(e,t,n){var r,i,o,a,s,u,c;const l=e,d=t;if((null===(r=d.formattedRanges)||void 0===r?void 0:r.length)<=(null===(i=l.formattedRanges)||void 0===i?void 0:i.length))if(n){let e=l.formattedRanges?[...l.formattedRanges]:[];const t=function(e,t,n){if(!e)return;if(t.deltaType===Aa.b.Add){const t=e.find((e=>e.start===n&&0===e.length));if(t)return t;n=Math.max(n-1,0)}const r=e.find((e=>0===e.length?e.start===n:e.start<=n&&n<e.start+e.length));return r}(l.formattedRanges,n,n.position),r=t?e.indexOf(t):-1;if(-1!==r&&(n.position+(n.length||0)>t.start+t.length?t.length=n.position+(null!==(o=n.content)&&void 0!==o?o:"").length-t.start:t.length+=(null!==(a=n.content)&&void 0!==a?a:"").length-(n.length||0),e[r]=t),e.length>0){for(const t of e.slice(r+1))t.start<n.position||(n.position+(n.length||0)>t.start?(t.length=t.start+t.length-(n.position+(n.length||0)),t.start=n.position+(null!==(s=n.content)&&void 0!==s?s:"").length):t.start+=(null!==(u=n.content)&&void 0!==u?u:"").length-(n.length||0));e=e.filter((e=>e.length>0))}const i=null!==(c=null==d?void 0:d.formattedRanges)&&void 0!==c?c:[];if(Ar()(e,i)||0===e.length&&0===i.length)return}else if(Ar()(null==l?void 0:l.formattedRanges,null==d?void 0:d.formattedRanges))return;return new Pa.a({deltaType:Aa.b.FormattingUpdate,formattedRanges:null==d?void 0:d.formattedRanges})}(e,t,r);o&&n.push(o);const a=function(e,t){const n=e,r=t;let i;const o={};let a=!1;for(i in r)-1===["ipPosition","isColdIp","content","formattedRanges"].indexOf(i)&&(Ar()(r[i],n[i])||(a=!0,o[i]=r[i]));if(a)return new Pa.a({deltaType:Aa.b.OtherNonContentUpdate,otherNonContentData:o});return}(e,t);return a&&n.push(a),n}function Ba(e,t){const n=e.content,r=t.content,i=Na(n,r),o=i.firstDiffLeft,a=n.length-i.firstDiffRight,s=r.length-i.firstDiffRight;let u,c=Aa.b.Update;if(n.length!==r.length)a===o?(c=Aa.b.Add,u=n[n.length-1]):s===o&&(c=Aa.b.Delete,u=r[r.length-1]);else if(n===r)return;let l,d=0;switch(c){case Aa.b.Update:d=a-o,l=r.substring(o,s);break;case Aa.b.Add:l=r.substring(o,s);break;case Aa.b.Delete:d=a-o,l=n.substring(o,a)}const f=function(e,t){const n=Array.from(e.matchAll(xa));if(xa.lastIndex=0,0===n.length)return Aa.c.Chars;if(1===n.length){if(0===n[0].index)return t&&Da.test(t)?Aa.c.Sentence:t&&!xa.test(t)?Aa.c.Word:Aa.c.Chars;if(n[0].index+1===e.length)return Da.test(e[n[0].index-1])?Aa.c.Sentence:xa.test(e[n[0].index-1])?Aa.c.Chars:Aa.c.Word;if(e[n[0].index-1]){const t=e[n[0].index-1];if(Da.test(t))return Aa.c.Sentence;if(xa.test(t))return Aa.c.Chars}return Aa.c.Word}const r=Array.from(e.matchAll(Da));if(Da.lastIndex=0,0===r.length)return Aa.c.PartialSentence;if(r.length>1)return Aa.c.Paragraph;if(r[0].index+1<=e.length)return xa.test(e[r[0].index+1])?Aa.c.Sentence:Aa.c.Paragraph;return}(l,u);if(void 0!==f)return new Pa.a({content:c!==Aa.b.Delete?l:void 0,deltaType:c,unit:f,position:o,length:c!==Aa.b.Add?d:0})}class Fa{constructor(){this.deltaBuilderHandlers=new Map,this.registerDeltaBuilderHandler(ka.b.getTypeName(),Ma),this.registerDeltaBuilderHandler(ka.a.getTypeName(),La)}registerDeltaBuilderHandler(e,t){this.deltaBuilderHandlers.set(e,t)}executeDeltaBuilderHandler(e,t,n){const r=this.deltaBuilderHandlers.get(e);return r?r(t,n):[]}}const Ua=(e,t)=>t?qa([...t,e]):e,qa=e=>e.join("\\");class za{constructor(e){this.createTextTileDeltasFromItem=(e,t)=>{var n;const r=new rr({operationName:"CreateTextTileDeltaFromItem",success:!0}).start();try{if(!e)return r.success=!1,r.resultDescription="Unable to create text tile delta, parent item is undefined",void ar.a.info(524883085,ar.b.CoreDefault,r.stop());if(!e.body)return r.success=!1,r.resultDescription="Unable to create text tile delta, parent item has undefined body",void ar.a.info(524883086,ar.b.CoreDefault,r.stop());const i=e.body;if(!ka.b.typeGuard(i))return r.success=!1,void(r.resultDescription=`Unable to create text tile delta, parent item body is not proper type: expected ${ka.b.getTypeName()}, received ${ke.a.getTypeNameFor(i)}`);const o=Ua(e.id,t),a=null!==(n=this.lastSeenTileByTileId.get(o))&&void 0!==n?n:new ka.b({content:""}),s=this.createDeltas(a,i);return s&&0!==s.length?(r.dimension0=s.length.toString(),this.lastSeenTileByTileId.set(o,i)):(r.dimension0="0",r.resultDescription="No delta differences found"),ar.a.info(524883087,ar.b.CoreDefault,r.stop()),s}catch(e){return r.success=!1,r.resultDescription=`Error creating text tile delta: ${e}`,void ar.a.info(524883088,ar.b.CoreDefault,r.stop())}},this.lastSeenTileByTileId=null!=e?e:new Map,this.deltaBuilder=new Fa}addItemToLocalMap(e,t){const n=Ua(e.id,t),r=e.body;ka.b.typeGuard(r)&&!this.lastSeenTileByTileId.has(n)&&this.lastSeenTileByTileId.set(n,r)}deleteItemFromLocalMap(e,t){const n=Ua(e.id,t);this.lastSeenTileByTileId.has(n)&&this.lastSeenTileByTileId.delete(n)}moveItemsInLocalMap(e,t,n){const r=new Set(n),i=qa(t),o=qa(e),a=[],s=(e,t)=>e.length>t.length?e.substring(t.length+1).split("\\")[0]:void 0;for(const[e,t]of this.lastSeenTileByTileId)if(e.startsWith(i)){const n=s(e,i);if(void 0===n||r.has(n)){const n=e.replace(i,o);a.push({item:t,newPathKey:n,prevPathKey:e})}}for(const e of a)this.lastSeenTileByTileId.delete(e.prevPathKey),this.lastSeenTileByTileId.set(e.newPathKey,e.item)}createDeltas(e,t){return this.deltaBuilder.executeDeltaBuilderHandler(ke.a.getTypeNameFor(t),e,t)}}function Wa(){return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}const Va=e=>Ga(e,Number.POSITIVE_INFINITY),Ga=(e,t)=>{let n=0;const r=[],i=[e];for(;i.length>0;){const e=i.pop(),o=typeof e;if("boolean"===o)n+=4;else if("string"===o)n+=2*e.length;else if("number"===o)n+=8;else if("object"===o&&e&&-1===r.indexOf(e))if(e instanceof Uint8Array)n+=e.length;else{r.push(e);for(const t in e)i.push(e[t])}if(n>t)return n}return n};var Ha=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};function $a(e,t){return Ha(this,void 0,void 0,(function*(){const{authToken:n,origin:r,sessionUrl:i}=e,{body:o,cv:a,method:s,requestUrl:u}=t,c=yield Object(fo.fetch)(u||i,{method:s,headers:Object.assign({Authorization:`Bearer ${n}`,"x-origin":r,"x-correlationid":a},t.headers),body:o});if(200!==c.status)throw new Error(`Unexpected status code: ${c.status}`);return c}))}const Ka=(e,t)=>{t?(e.resultDescription=t,e.success=!1,ar.a.error(507646878,ar.b.CoreDefault,e.stop())):ar.a.info(507646877,ar.b.CoreDefault,e.stop())};function Ja(e,t,n,r){let i;$a(e,{headers:{"Content-Type":"application/jsond"},body:lo.a.serialize(t),cv:n.cv,method:"POST"}).then((e=>e.json())).catch((e=>{i=new $r({messageId:t.messageId,error:e.message})})).then((e=>{Ka(n,i?i.error:void 0),r(i,e)}))}function Qa(e,t,n,r){const{sessionUrl:i}=e;let o;$a(e,{cv:r.cv,method:"GET",requestUrl:t.refType===qo.AlCodedLocation?`${i}/blob/${t.value}`:t.value}).then((e=>e.arrayBuffer())).then((e=>new Uint8Array(e))).catch((e=>{o=e})).then((e=>{Ka(r,o?o.message:void 0),n(o,e)}))}class Ya extends qi.EventEmitter{init(){return Promise.resolve()}sendMessage(e,t,n){}onMessage(e,t){}forceReconnect(){return Promise.resolve()}closeSession(){}sendBytes(e){}getCorrelationVector(){return new br}getNetworkWorkerManager(){}setState(e){}}var Xa=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};var Za,es;!function(e){e[e.LocalWorkflow=0]="LocalWorkflow",e[e.ServerWorkflow=1]="ServerWorkflow",e[e.Submitted=2]="Submitted"}(Za||(Za={})),function(e){e[e.Internal=0]="Internal",e[e.External=1]="External"}(es||(es={}));const ts=(e,t)=>{t?(e.resultDescription=t,e.success=!1,ar.a.error(509203144,ar.b.CoreDefault,e.stop())):ar.a.info(509203143,ar.b.CoreDefault,e.stop())},ns=e=>!e.items.some((e=>e.source&&0===e.source.indexOf("ThirdParty")));class rs{constructor(e){var t;this.annotationActivationTrackers=new Map,this.annotationCallbacks=new Map,this.annotationResultStates=new Map,this.tokensByAnnotationType=new Map,this.registeredContextTypes=new Set,this.availableContexts=new Map,this.nextSyncSequenceId=1,this.allowSeed=!0,this.allowGroupSeed=!0,this.seedGroupSize=0,this.batchedSeedMessageGroupSize=0,this.hasSessionConnected=!1,this.isSessionClosed=!1,this.serverAuthenticationState=Uo.NotAuthenticated,this.sessionCloseCallbacks=new Map,this.connectCallbacks=new Map,this.reconnectCallbacks=new Map,this.disconnectCallbacks=new Map,this.sessionStateCallbackToken=0,this.workflowGraph=new ba,this.workflowDefinitionManager=new _a,this.contextIdManager=new Oa(Ea.JsClient,this.workflowGraph),this.workflowItemStorage=new Ia(this.workflowDefinitionManager),this.pendingConnectCallbacks=[],this.onAnnotationsSubmittedEnabled=!1,this.reduceBatchOperationsEnabled=!1,this.batchMessagesEnabled=!1,this.cachedClaimsChallenge={claimsVersion:0,actionRequired:!1},this.tokenMessageVersion=1,this.hostCallbacks=e.hostCallbacks,this.sessionManager=e.sessionManager,this.batchMessagesEnabled=e.batchMessagesEnabled||!1,this.reduceBatchOperationsEnabled=e.reduceBatchOperationsEnabled||!1,this.operationBatchConfig=e.batchOptions?this.getOperationBatchConfig(e.batchOptions):void 0,this.extensionConfigs=e.extensionConfigs,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.localWorkflowManager=e.localWorkflowManager,this.annotationResultsProcessor=e.annotationResultsProcessor,e.workflowRuntimeFactory&&(this.workflowRuntime=e.workflowRuntimeFactory(this.sessionManager)),this.localRegisteredWorkflows=e.localRegisteredWorkflows||[],this.enableRemoteExecutionNotification=e.enableRemoteExecutionNotification||!1,this.networkMode=e.networkMode,this.egress=e.egress,this.serverAuthenticationStateChangeCallback=[],this.claimsChallengeCallback=[],this.onAnnotationsSubmittedEnabled=e.onAnnotationsSubmittedEnabled||!1,this.annotationDoesNotExistOnServiceEnabled=e.annotationDoesNotExistOnServiceEnabled||!1,this.sessionManager.on("sessionClose",this.onSessionClose.bind(this)),this.sessionManager.on("reconnect",this.onReconnect.bind(this)),this.sessionManager.on("connect",this.onConnect.bind(this)),this.sessionManager.on("disconnect",this.onDisconnect.bind(this)),this.sessionManager.on("resetNextSyncSequenceId",this.resetNextSyncSequenceId.bind(this)),this.sessionManager.on("serverAuthenticationStateChange",this.onServerAuthenticationStateChange.bind(this)),this.sessionManager.onMessage(yi.getTypeName(),this.workflowRuntime?this.onAnnotationResultsFromLocal.bind(this):this.onAnnotationResultsFromServer.bind(this)),this.sessionManager.onMessage(si.getTypeName(),this.onAnnotationResultStateMessage.bind(this)),this.sessionManager.onMessage(Oi.getTypeName(),this.onWorkflowExecutionCompleteMessage.bind(this)),this.sessionManager.onMessage(Mi.getTypeName(),this.onClaimsChallengeMessage.bind(this)),e.isDeltaGeneratorEnabled&&(this.enableSyncDeltaSending=!e.disableSyncDeltaSending,this.syncDeltaTimeout=null!==(t=e.syncDeltaTimeout)&&void 0!==t?t:700,this.enableDeltaGenerator()),this.setServerAuthenticationStateChangeCallback(this.updateGraphOnAuthStateChange.bind(this)),this.setClaimsChallengeCallback(this.requestAuthTokenWithClaims.bind(this))}getSessionReconnectParams(){if(!this.connectParams)throw new Error("Session has not been established yet.");return{sessionUrl:this.connectParams.sessionUrl,origin:this.connectParams.origin,authToken:this.connectParams.authToken,nextSyncSequenceId:this.nextSyncSequenceId}}setNextSequenceId(e){this.nextSyncSequenceId=e}tryGetDocSessionId(){if(this.clientMetadata&&this.clientMetadata.docSessionId)return this.clientMetadata.docSessionId}getSessionStateCallbackToken(e){var t;return e+"-callback-"+(null!==(t=this.tryGetDocSessionId())&&void 0!==t?t:"unknown")+"-"+this.sessionStateCallbackToken++}updateGraphOnAuthStateChange(e){this.tryActivateWorkflows()}tryActivateWorkflows(){if(this.enableRemoteExecutionNotification){const e=new rr({operationName:"GraphServerWorkflowActivation",success:!0}).setClientMetadata(this.clientMetadata).start(),t=[];this.workflowGraph.getWorkflowNodes().filter((e=>e.location===ya.External)).forEach((e=>{this.localWorkflowManager.canActivateWorkflow(e,this)?e.isActivated=!0:(this.localWorkflowManager.deactivateServerWorkflow(e,this),t.push(e.workflow.id))})),e.resultDescription=`deactivated workflows: [${t.join()}]`,ar.a.info(508879493,ar.b.CoreDefault,e.stop())}}initialize(){return this.localWorkflowManager&&this.localWorkflowManager.addSession(this),this.registerLocalWorkflowsWithoutGraphInit(this.localRegisteredWorkflows),this.sessionManager.init(this.extensionConfigs,this.hostCallbacks.onInitSession?this.hostCallbacks.onInitSession:void 0,this.egress).then((()=>(this.localWorkflowManager&&this.localWorkflowManager.setTokenCallback(this.getAuthToken.bind(this)),this)))}isLocalWorkflowRegistered(e){return this.getLocalRegisteredWorkflows().some((t=>e===t.id))}get isConnected(){return!!this.connectParams}get hasConnected(){return this.hasSessionConnected}get isClosed(){return this.isSessionClosed}getServerAuthenticationState(){return this.serverAuthenticationState}getContextIdManager(){return this.contextIdManager}getWorkflowItemStorage(){return this.workflowItemStorage}getWorkflowDefinition(e,t){return this.workflowDefinitionManager.getWorkflowDefinition(e,t)}registerLocalWorkflows(e){this.registerLocalWorkflowsWithoutGraphInit(e),this.trySendWorkflowGraphInitMessage()}registerLocalWorkflowsWithoutGraphInit(e){if(e.length){if(this.workflowRuntime)for(const t of e)this.workflowRuntime.registerWorkflow(t),this.sendMessageToSession(new ko({workflowDefinition:t}));if(this.localWorkflowManager)for(const t of e)this.localWorkflowManager.registerLocalWorkflow(t,this)}}registerLocalWorkflow(e){this.registerLocalWorkflows([e]);const t=new rr({operationName:"SessionRegisterLocalWorkflow",resourceId:e.id,success:!0}).setClientMetadata(this.clientMetadata).start();ts(t)}activateAnnotation(e,t,n){var r;const i=new da(this.sendMessageToSession.bind(this),e,t,this.annotationDoesNotExistOnServiceEnabled);if(t&&t.callback){let n=this.annotationCallbacks.get(e);n||(n=new Map,this.annotationCallbacks.set(e,n)),n.set(i.token,t.callback)}const o=null!==(r=this.tokensByAnnotationType.get(e))&&void 0!==r?r:[];return-1===o.indexOf(i.token)&&o.push(i.token),this.tokensByAnnotationType.set(e,o),this.annotationActivationTrackers.set(i.token,i),this.activateAnnotationForTracker(i,{ignoreExistingAnnotations:!1,sendOnlyIfConnected:!1})}activateAnnotationForTracker(e,t){const n=new rr({operationName:"ActivateAnnotation",resourceId:e.annotationType,success:!0}).setClientMetadata(this.clientMetadata).start();return e.activate(t.ignoreExistingAnnotations,t.sendOnlyIfConnected).then((r=>(n.resultSignature="Ok",n.resultDescription=`Activated annotation ${e.annotationType} with token ${e.token}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`,ts(n),r))).catch((r=>{throw ts(n,`error on activate annotation type ${e.annotationType}: ${r}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`),r}))}updateAnnotationConfig(e,t){const n=new li({token:e,config:t});this.sendMessageToSession(n);const r=this.annotationActivationTrackers.get(e);r&&r.options&&(r.options.config=t)}releaseAnnotation(e){const t=this.annotationActivationTrackers.get(e);if(t){this.annotationActivationTrackers.delete(e);const n=this.annotationCallbacks.get(t.annotationType);return n&&(n.delete(e),0==n.size&&this.annotationCallbacks.delete(t.annotationType)),t.release()}return Promise.resolve(!1)}setAnnotationState(e,t,n){const r={state:n};this.submitOperation(new qe({parentPath:e,items:[{id:t}],M_:r}))}setAnnotationMetadata(e,t,n){this.submitOperation(new qe({parentPath:e,items:[{id:t}],M_:n}))}submitOperation(e,t){this.submitOperations([e],t)}submitOperations(e,t){var n,r;if(t||(t=this.generateCorrelationId()),this.contextIdManager.applyContextIdOnOperations(e),this.updateWorkflowExecutionStates(e),!this.onAnnotationsSubmittedEnabled){const[n,r]=this.partitionAnnotationOperations(e);this.executeCallbacksOnAnnotationSubmitted(n,t)}const i=e.filter(this.filterOperationsForSession.bind(this)).filter(ns);if(this.workflowRuntime){if(this.onAnnotationsSubmittedEnabled){const[e,n]=this.partitionAnnotationOperations(i);this.onAnnotationsSubmitted(e,t),this.submitOperationsToSession(n,t)}else this.submitOperationsToSession(i,t);return}const o=[];if(this.deltaGenerator){const e=new rr({operationName:"ExecuteDeltaGenerator",success:!0}).setClientMetadata(this.clientMetadata).start();for(const e of i)if(ze.typeGuard(e))o.push(...this.createDeltasFromUpdateOperation(e));else{const t=e;for(const i of t.items)Fe.typeGuard(e)?this.deltaGenerator.addItemToLocalMap(i,t.parentPath):We.typeGuard(e)?this.deltaGenerator.deleteItemFromLocalMap(i,t.parentPath):Ue.typeGuard(e)&&this.deltaGenerator.moveItemsInLocalMap(e.parentPath,e.prevParentPath,null!==(r=null===(n=e.items)||void 0===n?void 0:n.map((e=>e.id)))&&void 0!==r?r:[]);o.push(e)}ts(e)}if(this.onAnnotationsSubmittedEnabled){const[e,n]=this.partitionAnnotationOperations(o.length?o:i);this.onAnnotationsSubmitted(e,t),this.submitOperationsToSession(n,t)}else this.submitOperationsToSession(o.length?o:i,t);this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e,this,!0)}submitSeedOperations(e,t){if(!this.allowSeed)throw new Error("Cannot submit seed operations more than once per session");if(this.networkMode===Eo.LocalWorkflowsOnly&&this.localWorkflowManager)return void this.localWorkflowManager.runLocalWorkflows(e,this);t||(t=this.generateCorrelationId()),this.allowSeed=!1,this.allowGroupSeed=!1;const[n,r]=this.partitionAnnotationOperations(e);this.onAnnotationsSubmittedEnabled?this.onAnnotationsSubmitted(n,t):this.executeCallbacksOnAnnotationSubmitted(n,t),this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?r:e,!0,t):this.sendMessageToSession(new hi({cv:t,seq:0,ops:this.onAnnotationsSubmittedEnabled?r:e}))}submitSeedGroupOperations(e,t,n){if(!this.allowGroupSeed)throw new Error("Seed operations are not allowed for this session");if(this.networkMode===Eo.LocalWorkflowsOnly&&this.localWorkflowManager)return void this.localWorkflowManager.runLocalWorkflows(e,this);n||(n=this.generateCorrelationId()),t&&(this.allowGroupSeed=!1),this.allowSeed=!1;const[r,i]=this.partitionAnnotationOperations(e);this.executeCallbacksOnAnnotationSubmitted(r,n),this.onAnnotationsSubmittedEnabled?this.onAnnotationsSubmitted(r,n):this.executeCallbacksOnAnnotationSubmitted(r,n),this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?i:e,!!t,n):(this.seedGroupSize++,this.sendMessageToSession(new hi({cv:n,seq:0,ops:this.onAnnotationsSubmittedEnabled?i:e,groupId:"Seed",groupSize:t?this.seedGroupSize:void 0,groupComplete:t||void 0})))}submitCustomMessage(e){return new Promise(((t,n)=>{this.sendMessageToSession(e,((r,i)=>{r?n(new Error(`${r.error}; for message type: ${ke.a.getTypeNameFor(e)}`)):t(i)}))}))}submitLargeBinaryDataMessage(e){return new Promise(((t,n)=>{this.sendMessageToSessionPostEndpoint(e,((e,r)=>{e?n(new Error(e.error)):t(r)}))}))}requestBinaryDataForBlob(e){return e.data?Promise.resolve(e.data):e.dataPointer&&e.dataPointer.refType!==qo.None?new Promise(((t,n)=>{this.requestBinaryDataFromSessionBlobEndpoint(e.dataPointer,((e,r)=>{e?n(e):t(r)}))})):Promise.reject(new Error("Blob does not have a data pointer"))}requestCacheDump(e){if(e)throw new Error("NYI");return this.submitCustomMessage(new ri)}forceReconnect(e){return this.extensionConfigs=e,this.sessionManager.forceReconnect(e)}close(e){this.isSessionClosed=!0,this.sessionManager.closeSession(e),this.workflowRuntime&&this.workflowRuntime.close(),this.localWorkflowManager&&this.localWorkflowManager.closeSession(this),this.graphInitMessageTimer&&(clearTimeout(this.graphInitMessageTimer),this.graphInitMessageTimer=void 0)}authenticateInteractive(){return Xa(this,void 0,void 0,(function*(){if(this.cachedClaimsChallenge.claimsVersion>0&&!this.cachedClaimsChallenge.actionRequired)return;const e=yield this.requestAuthTokenInteractive(this.cachedClaimsChallenge,{interactive:!0});if(vi.typeGuard(e))throw new Error(e.reason)}))}getClientMetadata(){return this.clientMetadata}getUserContext(){return this.userContext}setSessionCloseCallback(e){const t=this.getSessionStateCallbackToken("close");return e&&this.sessionCloseCallbacks.set(t,e),t}setConnectCallback(e){const t=this.getSessionStateCallbackToken("connect");return e&&this.connectCallbacks.set(t,e),t}setDisconnectCallback(e){const t=this.getSessionStateCallbackToken("disconnect");return e&&this.disconnectCallbacks.set(t,e),t}setReconnectCallback(e){const t=this.getSessionStateCallbackToken("reconnect");return e&&this.reconnectCallbacks.set(t,e),t}removeSessionStateCallback(e){function t(t){return!!t.has(e)&&(t.delete(e),!0)}return t(this.sessionCloseCallbacks)||t(this.reconnectCallbacks)||t(this.disconnectCallbacks)||t(this.connectCallbacks)}setServerAuthenticationStateChangeCallback(e){this.serverAuthenticationStateChangeCallback.push(e),e(this.serverAuthenticationState)}setClaimsChallengeCallback(e){this.cachedClaimsChallenge.actionRequired&&e(this.cachedClaimsChallenge),this.claimsChallengeCallback.push(e)}getConnectParams(){return this.connectParams}setOfflineMode(){this.sessionManager=new Ya}onAnnotationResults(e,t,n){ar.a.info(508916486,ar.b.CoreDefault,new rr({operationName:"OnAnnotationResultsEgress",dimension0:null==e?void 0:e.annotationType,success:!0,cv:e.cv})),n(void 0,new qr),t===Za.LocalWorkflow&&this.contextIdManager.applyContextIdOnOperations(e.ops),this.updateWorkflowExecutionStates(e.ops),this.egress&&this.egress(e,(()=>{})),this.annotationResultsProcessor.process(e,((e,n)=>{this.applyOperationForContext(e,n,t)}),((t,n)=>{this.triggerRegisteredAnnotationCallbacks(t,e.annotationType,n)}),(e=>{if(t!==Za.ServerWorkflow){const t=e.ops.filter(this.filterOperationsForSession.bind(this)).filter(ns);this.submitOperationsToSession(t,e.cv)}this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e.ops,this)}))}onAnnotationResultStateMessage(e,t){var n;t(void 0,new qr);for(const t of e.updates){const{annotationType:e,state:r}=t;if(!this.tokensByAnnotationType.has(e))continue;let i;i=this.annotationResultStates.has(e)?this.annotationResultStates.get(e):r===Lr.Idle?Lr.Pending:Lr.Idle;for(const t of this.tokensByAnnotationType.get(e)){const e=this.annotationActivationTrackers.get(t);(null===(n=e.options)||void 0===n?void 0:n.stateUpdateCallback)&&e.options.stateUpdateCallback(i,r)}}}submitOperationsToSession(e,t){t||(t=this.generateCorrelationId());const n=e.filter((e=>Xe.typeGuard(e))),r=e.filter((e=>!Xe.typeGuard(e)));if(n.length>0&&this.sendMessageToSession(new hi({cv:t,ops:n})),r.length>0)if(this.operationBatchConfig){if(!this.batchedOperationsManager){let e;e=this.batchMessagesEnabled?(e,t,n)=>{if(e.length){const t=new fi;t.messages=[],e.forEach((e=>{t.messages.push(new hi({cv:e.cv,seq:this.nextSyncSequenceId++,ops:e.input}))})),this.sendMessageToSession(t,(e=>{n(e?new Error(e.error):void 0)}))}}:(e,t,n)=>{this.sendMessageToSession(new hi({cv:t.cv,seq:this.nextSyncSequenceId++,ops:e}),(e=>{n(e?new Error(e.error):void 0)}))},this.batchedOperationsManager=new fa(e,this.reduceBatchOperationsEnabled,this.batchMessagesEnabled)}this.batchedOperationsManager.addBatchItem(r,this.operationBatchConfig,{name:"SubmitOperations"},t)}else this.sendMessageToSession(new hi({cv:t,seq:this.nextSyncSequenceId++,ops:r}))}sendMessageToSession(e,t){this.sessionManager.sendMessage(e,t),ni.typeGuard(e)&&this.close()}sendMessageToSessionPostEndpoint(e,t){const n=new rr({operationName:"SendLargeBinaryDataMessage",success:!0,cv:e.cv}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)Ja(this.connectParams,e,n,t);else{const r=(r=>Ja(r,e,n,t)).bind(this);this.pendingConnectCallbacks.push(r)}}requestBinaryDataFromSessionBlobEndpoint(e,t){const n=new rr({operationName:"RequestBinaryData",success:!0,cv:(new br).toString()}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)Qa(this.connectParams,e,t,n);else{const r=(r=>Qa(r,e,t,n)).bind(this);this.pendingConnectCallbacks.push(r)}}registerContextTypes(e){for(const t of e)this.activateAnnotation(t),this.registeredContextTypes.add(t)}applyOperationForContext(e,t,n){let r=ke.a.getTypeNameFor(e);if(r!=Fe.getTypeName()&&r!=Le.getTypeName()&&r!=ze.getTypeName()&&r!=We.getTypeName())return;r==Le.getTypeName()&&(r=Fe.getTypeName());const i=ga(this.resolvePlaceholdersInOperationParentPath(e.parentPath),t),o=ma(i.parentPath);if(r==Fe.getTypeName()||r==ze.getTypeName()){if(!i.body)return;const e=ke.a.getTypeNameFor(i.body);if(!this.registeredContextTypes.has(e))return;let t=this.availableContexts.get(e);t||(t=new Map,this.availableContexts.set(e,t));let a=t.get(n);if(a||(a=[],t.set(n,a)),!i.id){if(this.workflowRuntime)throw new Error("Expected item to have id already");this.localWorkflowManager&&(i.id=this.localWorkflowManager.getNextClientAnnotationId())}if(r==Fe.getTypeName())0==a.filter((e=>ma(e.parentPath)==o&&e.id==i.id)).length?a.push(i):ar.a.info(540848911,ar.b.CoreDefault,`AddOperation for (${n}, ${i.id}, ${i.source}) can't be applied as the context item with matching path and ID already exists. Use UpdateOperation instead.`);else for(let e=0;e<a.length;e++)if(a[e].id==i.id&&ma(a[e].parentPath)==o){if(a[e].source==i.source){a[e]=i;break}ar.a.warn(540848912,ar.b.CoreDefault,`UpdateOperation for (${n}, ${i.id}, ${i.source}) can't be applied as the context item with provided path and ID has different source: ${a[e].source}`)}else ar.a.warn(540848913,ar.b.CoreDefault,`UpdateOperation for (${n}, ${i.id}, ${i.source}) can't be applied as the context item with matching path and ID was not found. AddOperation should be used instead`)}else if(r==We.getTypeName()){if(!i.id)return;this.availableContexts.forEach(((e,t)=>{let r=e.get(n);r&&(r=r.filter((e=>!(ma(e.parentPath)==o&&e.id==i.id))),0==r.length?e.delete(n):e.set(n,r),0==e.size?this.availableContexts.delete(t):this.availableContexts.set(t,e))}))}}updateWorkflowExecutionStates(e){if(this.localWorkflowManager){const t=this.enableRemoteExecutionNotification?this.workflowGraph.getWorkflowNodes().map((e=>e.workflow)):this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this);for(const n of e)if(Ta.has(ke.a.getTypeNameFor(n)))for(const e of n.items)for(const n of t||[])this.localWorkflowManager.preProcessItemToWorkflow(n,e,this)}}resolveRequestedContexts(e){const t=[];for(const[n,r,i]of ha(e.requestedContextTypesRules)){if(!this.availableContexts.has(n)){if(r==ra.Required)return[!1,[]];continue}const e=Array.from(this.availableContexts.get(n).values()).reduce(((e,t)=>e.concat(t)),[]);if(0==e.length)throw new Error(`Assert: availableContexts have the entry for ${n} which does not contain any context annotation.`);t.push(...e)}return[!0,this.removeDuplicatedContextItems(t)]}removeDuplicatedContextItems(e){return e.filter(((e,t,n)=>n.findIndex((t=>Ki.deepEquals(t,e)))===t))}getContextAnnotations(e,t,n,r){var i,o;const a=n?ma(n):void 0;return null===(o=null===(i=this.availableContexts.get(e))||void 0===i?void 0:i.get(t))||void 0===o?void 0:o.filter((e=>!(a&&ma(e.parentPath)!=a||r&&e.source!=r)))}onWorkflowDefinitionOverrideMessage(e){const t=new rr({operationName:"WorkflowDefinitionOverride",success:!0}).setClientMetadata(this.clientMetadata).start(),n=e=>{throw ts(t,e),Error(`WorkflowDefinitionOverride: ${e}`)};if(!this.localWorkflowManager)return void n("Not supported by this local SessionProxy instance.");const r=this.localWorkflowManager.getWorkflowDefinitionsByName(this),i=r.get(e.sourceWorkflowId);if(!i)return void n(`Workflow registration for source workflow '${e.targetWorkflowId}' was not found.`);t.resourceId=i.id;const o=r.get(e.targetWorkflowId);o&&(o.allowDefinitionOverride?i.definitionOverrideTargetWorkflows&&-1!==i.definitionOverrideTargetWorkflows.indexOf(o.id)?(this.workflowDefinitionManager.mergeWorkflowDefinition(o,e.definition,e.contextId),t.resultDescription=`Updated config for workflow: ${e.targetWorkflowId}, context id: ${e.contextId}`,ts(t)):n(`Workflow '${i.id}' does not allow workflow definition for workflow '${o.id}'.`):n(`Workflow '${o.id}' does not allow workflow definition override.`))}applyContextIdOnOperations(e){this.contextIdManager.applyContextIdOnOperations(e)}attachToWorkflowGraph(e){this.addToWorkflowGraph(e),this.attachExecutionTrackerToEachWorkflow()}triggerRegisteredAnnotationCallbacks(e,t,n){if(this.callAnnotationCallbacks(e,t,n),this.hostCallbacks.onAnnotationResult)try{this.hostCallbacks.onAnnotationResult(e,n)}catch(e){ar.a.error(540301151,ar.b.CoreDefault,new rr({operationName:"HostCallbackOnAnnotationResultError",dimension0:t,resultDescription:`onAnnotationResult error: ${e}`}))}}attachExecutionTrackerToEachWorkflow(){this.localWorkflowManager&&this.localWorkflowManager.attachExecutionTrackerToEachWorkflow(this.workflowGraph,this,this.onWorkflowExecutionComplete.bind(this))}onWorkflowExecutionCompleteMessage(e,t){t(void 0,new qr),this.localWorkflowManager&&this.localWorkflowManager.onExternalWorkflowExecuted(e.contextId,e.workflowId,this)}onWorkflowExecutionComplete(e,t){}enableDeltaGenerator(){var e,t;this.deltaGenerator=null!==(e=this.deltaGenerator)&&void 0!==e?e:new za,this.syncDeltaTimers=null!==(t=this.syncDeltaTimers)&&void 0!==t?t:new Map}createDeltasFromUpdateOperation(e){var t,n;const r=[];ar.a.info(523776396,ar.b.CoreDefault,`Calling delta create for UpdateOperation under parent path [${e.parentPath}] (${null===(t=e.items)||void 0===t?void 0:t.length} item(s), first item id: ${(null===(n=e.items)||void 0===n?void 0:n.length)>0?e.items[0].id:"(no items)"})`);let i=[...e.parentPath];for(const t of e.items){const n=[],o=this.deltaGenerator.createTextTileDeltasFromItem(t,e.parentPath);if(null==o?void 0:o.length){for(const r of o){const o=Wa();i=[...e.parentPath,t.id];const a={id:o,revId:t.revId,body:r,contextId:t.contextId,source:t.source};n.push(a)}n.length>0&&(r.push(new Qe({parentPath:i,items:n})),this.enableSyncDeltaSending&&this.setupSyncDeltaAfterDelay(t,i,n))}else ar.a.info(523329632,ar.b.CoreDefault,`Failed to create delta on item ${t.id}`)}return r}setupSyncDeltaAfterDelay(e,t,n){var r,i,o;const a=this.syncDeltaTimers.get(e.id);a&&(clearTimeout(a),this.syncDeltaTimers.delete(e.id));const s=n.find((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.unit)===Aa.c.Chars}));if(s){const n=s.body,a={content:"",deltaType:Aa.b.Update,length:0,position:(null!==(r=null==n?void 0:n.position)&&void 0!==r?r:0)+(null!==(o=null===(i=null==n?void 0:n.content)||void 0===i?void 0:i.length)&&void 0!==o?o:0),unit:Aa.c.Sentence},u=ka.a.typeGuard(e.body)?new Pa.a(a):new Pa.b(a),c={id:Wa(),revId:e.revId,body:u,contextId:e.contextId,source:e.source},l=new Qe({parentPath:t,items:[c]}),d=setTimeout(((e,t)=>{this.submitOperation(e),this.syncDeltaTimers.delete(t)}),this.syncDeltaTimeout,l,e.id);this.syncDeltaTimers.set(e.id,d)}}addToWorkflowGraph(e){this.workflowGraph.addWorkflow(wa(e))}getAnnotations(e,t){var n,r,i;const o=new rr({operationName:"GetAnnotations",success:!0,dimension1:null===(n=e.annotationType)||void 0===n?void 0:n.toString(),dimension2:null===(r=e.maxDelayMs)||void 0===r?void 0:r.toString(),cv:e.cv}).setClientMetadata(this.clientMetadata).start(),a=this.sessionManager.getCorrelationVector(),s=new Lo({annotationTypes:e.annotationType,transientItems:e.transientItems,configs:e.configs,maxDelayMs:e.maxDelayMs,correlationInfo:{cvString:null!==(i=e.cv)&&void 0!==i?i:a.newChild().toString()}}),u=[];let c;this.sendMessageToSession(s,((e,t)=>{u.push({error:e,response:t}),null==c||c(!0)}));const l=this;let d=!1;return{[Symbol.asyncIterator]:()=>({next(){var e,n,r,i,a,s;return Xa(this,void 0,void 0,(function*(){try{0===u.length&&(yield new Promise((e=>c=e)));const f=u.shift();return t&&t.IsCancellationRequested?(o.dimension0=`Error code: ${xr.RequestCancelled}`,ts(o,"Request cancelled"),{done:!0,value:{content:void 0,error:{clientError:{code:xr.RequestCancelled,error:"Request cancelled"}}}}):(d?(o.dimension0=`Error code: ${xr.ResponseReceivedAfterFinalResponse}`,ts(o,"Response after final response has already been received")):d=null===(e=f.response)||void 0===e?void 0:e.finalResponse,o.dimension3=`final response: ${null===(n=f.response)||void 0===n?void 0:n.finalResponse}`,f.error?(o.dimension0=`Error code: ${f.error.code}`,ts(o,f.error.error)):(null===(r=f.response)||void 0===r?void 0:r.errorInfo)?(o.dimension0=`Error code: ${f.response.errorInfo}`,ts(o,"Workflow execution error")):(o.resultDescription="OK",ts(o)),{done:(null===(i=f.response)||void 0===i?void 0:i.finalResponse)||void 0!==f.error,value:{content:null===(a=f.response)||void 0===a?void 0:a.content,error:{workflowError:null===(s=f.response)||void 0===s?void 0:s.errorInfo,serverError:f.error?{code:f.error.code,error:f.error.error,retryable:null==l?void 0:l.canBeRetried(f.error)}:void 0}}})}catch(e){return o.dimension0=`Error code: ${xr.Unknown}`,ts(o,null==e?void 0:e.message),{done:!0,value:{content:void 0,error:{clientError:{code:xr.Unknown,error:null==e?void 0:e.message}}}}}}))}})}}isHttpFallback(){const e=this.sessionManager.getNetworkWorkerManager();return!(!e||e.getInitNetworkMode()!==Eo.JSWebSockets||e.getNetworkMode()!==Eo.HttpFallback)}canBeRetried(e){return(null==e?void 0:e.code)===Dr.TooManyRequests||(null==e?void 0:e.code)===Dr.RequestTimeout}getAuthToken(e,t){const n={Tickets:[]};this.clientMetadata.docSessionId&&(n.DocSessionId=this.clientMetadata.docSessionId);const r=(e=>{if(e===Jo.Substrate)return Vo.Substrate})(e);r&&(n.TokenType=r),this.hostCallbacks.requestAuthToken(n).then((n=>{var r;if(!n)throw new Error("Missing AuthTokenResponse from requestAuthToken");if(!n.Token)throw new Error("Missing Token from requestAuthToken");t(void 0,n.Token,{returnedTokenType:e,timeToLiveSec:null===(r=n.TokenProperties)||void 0===r?void 0:r.timeToLiveSec})})).catch((e=>{t(e)}))}resetNextSyncSequenceId(){this.nextSyncSequenceId=1}onReconnect(){if(this.annotationActivationTrackers.forEach((e=>{this.activateAnnotationForTracker(e,{ignoreExistingAnnotations:!0,sendOnlyIfConnected:!0}).catch((()=>{}))})),this.reconnectCallbacks.forEach(((e,t)=>{e()})),!this.connectParams)throw new Error("Expected onConnect before onReconnect")}onSessionClose(e){this.isSessionClosed=!0,this.connectParams=void 0,this.sessionCloseCallbacks.forEach(((t,n)=>{t(e)}))}onConnect(e,t,n,r,i,o){this.hasSessionConnected?e&&(this.allowSeed=!0,this.allowGroupSeed=!0,this.seedGroupSize=0,this.batchedSeedMessageGroupSize=0,this.seedBatchedOperationsManager&&(this.seedBatchedOperationsManager.removeAllBatchedItems(),this.seedBatchedOperationsManager=void 0),this.batchedOperationsManager&&(this.batchedOperationsManager.removeAllBatchedItems(),this.batchedOperationsManager=void 0),this.cachedClaimsChallenge=Object.assign(Object.assign({},this.cachedClaimsChallenge),{claimsVersion:0})):this.enableRemoteExecutionNotification&&this.addDownstreamWorkflowsIntoClientGraph(o),this.connectParams={isSeedingRequired:e,sessionUrl:t,origin:n,authToken:r},this.hasSessionConnected=!0,this.tryActivateWorkflows();for(const e of this.pendingConnectCallbacks)e(this.connectParams);this.connectCallbacks.forEach(((i,o)=>{i(e,t,n,r)})),this.serverInputTypes=i}onDisconnect(e){this.connectParams=void 0,this.disconnectCallbacks.forEach(((t,n)=>{t(e)}))}onServerAuthenticationStateChange(e){if(e!=this.serverAuthenticationState){if(this.serverAuthenticationState==Uo.Authenticated&&e==Uo.Pending)return;this.serverAuthenticationState=e;for(const e of this.serverAuthenticationStateChangeCallback)e(this.serverAuthenticationState)}}callAnnotationCallbacks(e,t,n){if(0===this.annotationCallbacks.size)return;const r=this.annotationCallbacks.get(t);r&&r.forEach((t=>{t(e,n)}))}getOperationBatchConfig(e){let t;t=this.batchMessagesEnabled?e=>({input:e,demultiplex:()=>[[]]}):e=>({input:e.filter((e=>e.length)).reduce(((e,t)=>e.concat(t)),[]),demultiplex:()=>[[]]});return{delayMs:e.delayMs,delayMsMax:e.delayMsMax,maxInputSize:e.maxInputSize,estimateSize:Va,groupingKeyExtractor:()=>"operations",multiplex:t,split:e=>{if(!(e.length<=1))return{inputs:e.reduce(((e,t)=>(e.push([t]),e)),[]),join:()=>[]}}}}sendSeedMessagesViaBatchManager(e,t,n){if(!this.seedBatchedOperationsManager){let e;e=this.batchMessagesEnabled?(e,t,n)=>{if(this.batchedSeedMessageGroupSize+=e.length,e.length){const r=new fi;r.messages=[],e.forEach((e=>{r.messages.push(new hi({cv:e.cv,seq:0,ops:e.input,groupId:"Seed",groupSize:t.groupComplete?this.batchedSeedMessageGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}))})),this.sendMessageToSession(r,(e=>{n(e?new Error(e.error):void 0)}))}}:(e,t,n)=>{this.seedGroupSize++,this.sendMessageToSession(new hi({cv:t.cv,seq:0,ops:e,groupId:"Seed",groupSize:t.groupComplete?this.seedGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}),(e=>{n(e?new Error(e.error):void 0)}))},this.seedBatchedOperationsManager=new fa(e,this.reduceBatchOperationsEnabled,this.batchMessagesEnabled)}this.seedBatchedOperationsManager.addBatchItem(e,this.operationBatchConfig,{name:"SubmitSeedOperations"},n,t)}onAnnotationResultsFromServer(e,t){this.onAnnotationResults(e,Za.ServerWorkflow,t)}onAnnotationResultsFromLocal(e,t){this.onAnnotationResults(e,Za.LocalWorkflow,t)}getLocalRegisteredWorkflows(){return this.workflowRuntime?this.workflowRuntime.getRegisteredWorkflows():this.localWorkflowManager?this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this).map((e=>wa(e))):[]}sendWorkflowGraphInitMessage(){const e=this.getLocalRegisteredWorkflows(),t=new rr({operationName:"WorkflowGraphInit",success:!0}).setClientMetadata(this.clientMetadata).start(),n=new _i({upstreamRuntimeWorkflows:e});this.sendMessageToSession(n,((n,r)=>{n?ts(t,n.error):(t.resultDescription=`local workflows: ${e.map((e=>e.id))}, remote workflows: ${r.downstreamRuntimeWorkflows.map((e=>e.id))}`,ts(t),this.onWorkflowGraphInitResponse(r))}))}trySendWorkflowGraphInitMessage(){!this.graphInitMessageTimer&&this.enableRemoteExecutionNotification&&(this.graphInitMessageTimer=setTimeout((()=>{this.graphInitMessageTimer=void 0,this.sendWorkflowGraphInitMessage()}),10))}onWorkflowGraphInitResponse(e){this.addDownstreamWorkflowsIntoClientGraph(e.downstreamRuntimeWorkflows),this.tryActivateWorkflows()}addDownstreamWorkflowsIntoClientGraph(e){this.workflowGraph.removeWorkflows(!0);for(const t of e||[])this.workflowGraph.addWorkflow(t,!0);this.workflowRuntime||this.attachExecutionTrackerToEachWorkflow()}resolvePlaceholdersInOperationParentPath(e){let t=e;return 3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("user_")&&(ar.a.info(540848914,ar.b.CoreDefault,`Replacing user context placeholder for: ${ma(e)}.`),t=["session","#userContext#"]),3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("tenant_")&&(ar.a.info(540848915,ar.b.CoreDefault,`Replacing tenant context placeholder for: ${ma(e)}.`),t=["session","#tenantContext#"]),t}filterOperationsForSession(e){return!!this.workflowRuntime||((e,t)=>{if(!Array.isArray(t)||0===t.length)return!0;if(Qe.typeGuard(e)||qe.typeGuard(e))return!0;for(const n of e.items)if(!n.body||ke.a.matchesTypesFor(n.body,t))return!0;return!1})(e,this.serverInputTypes)}executeCallbacksOnAnnotationSubmitted(e,t){this.getAnnotationOperationsByType(e).forEach(((e,n)=>{Array.from(e).forEach((e=>this.triggerRegisteredAnnotationCallbacks(e,n,t)))}))}partitionAnnotationOperations(e){return e.reduce((([e,t],n)=>n.items.some((e=>e.body&&zi.typeGuard(e.body)))?[[...e,n],t]:[e,[...t,n]]),[[],[]])}onAnnotationsSubmitted(e,t){this.getAnnotationOperationsByType(e).forEach(((e,n)=>{const r=Array.from(e);this.onAnnotationResults(new yi({annotationType:n,ops:r,cv:t}),Za.Submitted,(()=>{}))}))}getAnnotationOperationsByType(e){const t=new Map;for(const n of e)for(const e of n.items)if(e.body&&zi.typeGuard(e.body)){const r=ke.a.getTypeNameFor(e.body),i=t.get(r)||new Set;i.add(n),t.set(r,i)}return t}onClaimsChallengeMessage(e,t){e.claimsVersion>this.cachedClaimsChallenge.claimsVersion&&(this.cachedClaimsChallenge=Object.assign(Object.assign({},e),{actionRequired:!0}));for(const e of this.claimsChallengeCallback)e(this.cachedClaimsChallenge);t(void 0,new qr)}generateCorrelationId(){return this.sessionManager.getCorrelationVector().newChild().toString()}onTokenProvisionResponse(e,t){if(e||!t)return;const n=t.tokenType&&t.tokenType==Jo.WacUserInfo?Uo.WacUserInfoAuthenticated:Uo.Authenticated;this.onServerAuthenticationStateChange(n)}requestAuthTokenWithClaims(e){this.requestAuthTokenInteractive(e).catch((()=>{}))}requestAuthTokenInteractive(e,t){var n;const r=new rr({operationName:"RequestAuthTokenInteractive",success:!0,dimension0:`isInteractive: ${null!==(n=null==t?void 0:t.interactive)&&void 0!==n&&n}`}).start();r.dimension1=`HasClaims: ${!!e.claims&&e.claims.length>0}`;const i={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:Vo.Augloop,ConnectParams:this.connectParams,Claims:e.claims,Interactive:null==t?void 0:t.interactive};return this.hostCallbacks.requestAuthToken(i).then((t=>{if(!t)throw new Error("Missing AuthTokenResponse from requestAuthToken claims");if(!t.Token)throw new Error("Missing Token from requestAuthToken claims");return r.resultSignature="Token",new bi({authToken:t.Token,version:++this.tokenMessageVersion,claimsVersion:e.claimsVersion})})).catch((t=>(r.resultSignature="NoToken",r.dimension2=t.message,new vi({reason:t.message,version:++this.tokenMessageVersion,claimsVersion:e.claimsVersion})))).then((e=>new Promise(((t,n)=>{this.sendMessageToSession(e,((i,o)=>{ts(r,null==i?void 0:i.error),this.onTokenProvisionResponse(i,o),i?n(new Error(i.error)):(this.cachedClaimsChallenge.actionRequired=!1,t(e))}))}))))}}class is{}var os,as,ss;!function(e){e[e.Anonymous=0]="Anonymous",e[e.Host=1]="Host"}(os||(os={}));class us{constructor(){this.timers=new Map}scheduleRefresh(e,t,n,r){let i=this.timers.get(e);i||(i={numberOfAttempts:0},this.timers.set(e,i)),i.refreshTimeoutId&&(clearTimeout(i.refreshTimeoutId),i.refreshTimeoutId=void 0),i.expiredTimeoutId&&(clearTimeout(i.expiredTimeoutId),i.expiredTimeoutId=void 0);let o=1e3*t-us.tokenRefreshBufferMs,a=1e3*t-us.tokenExpirationBufferMs;o>0?i.numberOfAttempts=0:(++i.numberOfAttempts,o=us.tokenRefreshBackoffIntervalMs,a=us.tokenExpirationBufferMs),i.numberOfAttempts<=us.tokenRefreshMaximumAttempts&&(i.refreshTimeoutId=setTimeout((()=>{n()}),o)),r&&(i.expiredTimeoutId=setTimeout((()=>{r()}),a))}clearRefreshTimeouts(){this.clearTimeouts(!1)}clearAllTimeouts(){this.clearTimeouts(!0)}clearTimeouts(e){this.timers.forEach(((t,n)=>{t.refreshTimeoutId&&(clearTimeout(t.refreshTimeoutId),t.refreshTimeoutId=void 0),e&&t.expiredTimeoutId&&(clearTimeout(t.expiredTimeoutId),t.expiredTimeoutId=void 0),t.expiredTimeoutId||this.timers.delete(n)}))}}us.tokenRefreshBufferMs=24e4,us.tokenExpirationBufferMs=12e4,us.tokenRefreshBackoffIntervalMs=3e4,us.tokenRefreshMaximumAttempts=3;class cs extends qi.EventEmitter{constructor(e,t,n,r,i){if(super(),this.getSessionStats=e,this.clientMetadata=t,this.tokenRefreshManager=n,this.sendMessage=r,this.options=i||{},this.options.overrideSessionInitMessage=this.options.overrideSessionInitMessage||(e=>e),this.clientMetadata&&!this.clientMetadata.userSystemTimezone)try{this.clientMetadata.userSystemTimezone=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){}}initSession(e){e.onResponse=e.onResponse||(()=>{});const t=Ki.getCurrentTimeMs(),n=this.getSessionStats().lastConnectionClose&&t-this.getSessionStats().lastConnectionClose,r=this.getSessionStats().lastSyncMessage&&t-this.getSessionStats().lastSyncMessage,i=new rr({operationName:"SessionInit"}).start(),o={sessionKey:this.sessionKey,sessionId:this.clientMetadata.sessionId,timeSinceLastConnectionClose:n,timeSinceLastSyncMessage:r,isTokenRefresh:e.isTokenRefresh,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification,error:void 0},a=this.options.overrideSessionInitMessage(new Qr({protocolVersion:2,clientMetadata:this.clientMetadata,sessionKey:this.sessionKey,origin:this.origin,authToken:this.anonymousToken,extensionConfigs:e.extensionConfigs,returnWorkflowInputTypes:!0,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification}));this.sendMessage(a,((t,n)=>{if(i.success=!t,i.resultSignature=this.getSessionStats().lastConnectionClose?"Reconnect":"FirstConnect",i.resourceId=hr(null==n?void 0:n.sliceUrl),i.setClientMetadata(this.clientMetadata),(null==n?void 0:n.sessionKey)&&o.sessionKey!==n.sessionKey&&(o.sessionKey=n.sessionKey),t&&(o.error=t.error),i.resultDescription=JSON.stringify(o),ar.a.info(508843779,ar.b.CoreDefault,i.stop()),e.onResponse(t,n),t)this.emit("serverAuthenticationStateChange",Uo.NotAuthenticated);else if(e.isReconnectOnSameSlice&&n.forceReconnect)this.emit("serverAuthenticationStateChange",Uo.NotAuthenticated);else{if(!n.anonymousToken||!n.tokenExpirationSeconds)return this.emit("serverAuthenticationStateChange",Uo.NotAuthenticated),void ar.a.error(508843778,ar.b.CoreDefault,"AL Anonymous token was not generated for the session");this.anonymousToken=n.anonymousToken,this.onSuccessfulSessionInitOnServerSide(n)}}))}onSuccessfulSessionInitOnServerSide(e){this.tokenRefreshManager.scheduleRefresh(os.Anonymous,e.tokenExpirationSeconds,this.initSession.bind(this,{isTokenRefresh:!0}),(()=>{this.anonymousToken=void 0})),this.connectParams={isSeedingRequired:this.sessionKey!==e.sessionKey,sessionUrl:`${e.sessionUrlBase}/${e.sessionKey}`,origin:e.origin,authToken:this.anonymousToken},this.initHostAuthToken();const t=!!this.sessionKey;this.sessionKey=e.sessionKey,this.origin=e.origin,this.emit("connect",this.connectParams.isSeedingRequired,t,this.connectParams.sessionUrl,this.connectParams.origin,this.connectParams.authToken,e.workflowInputTypes,e.downstreamRuntimeWorkflows),t&&this.emit("reconnect")}getAuthToken(){const e={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:Vo.Augloop,ConnectParams:this.connectParams};return this.options.requestAuthToken(e).then((e=>e)).catch((()=>{}))}initHostAuthToken(){const e=this.getAuthToken.bind(this);if(this.options.requestAuthToken&&e){const t=new rr({operationName:"RefreshAuthToken",success:!0}).setClientMetadata(this.clientMetadata).start();e().then((e=>{if(e){if(!e.Token)return e.TokenError==Go.TokenMissingInteractionRequired?(this.emit("serverAuthenticationStateChange",Uo.TokenMissingInteractionRequired),t.resultDescription="Host auth token provision failed interaction required"):(this.emit("serverAuthenticationStateChange",Uo.NotAuthenticated),t.resultDescription="Host auth token provision failed"),t.success=!1,void ar.a.info(508843777,ar.b.CoreDefault,t.stop());ar.a.info(508843776,ar.b.CoreDefault,t.stop()),this.sendTokenProvisionMessage(e.Token)}else t.resultDescription="TokenResponse is not set"})).catch((e=>{this.emit("serverAuthenticationStateChange",Uo.NotAuthenticated),t.success=!1,t.resultDescription=`Error happened while attempting to fetch host token: ${e}`,ar.a.error(508843747,ar.b.CoreDefault,t.stop())}))}}sendTokenProvisionMessage(e){const t=new bi({authToken:e,version:1});this.emit("serverAuthenticationStateChange",Uo.Pending),this.sendMessage(t,this.onTokenProvisionResponse.bind(this),!0)}onTokenProvisionResponse(e,t){if(e||!t||!t.tokenExpirationSeconds)return void this.emit("serverAuthenticationStateChange",Uo.NotAuthenticated);const n=t.tokenType&&t.tokenType==Jo.WacUserInfo?Uo.WacUserInfoAuthenticated:Uo.Authenticated;this.emit("serverAuthenticationStateChange",n),this.tokenRefreshManager.scheduleRefresh(os.Host,t.tokenExpirationSeconds,this.initHostAuthToken.bind(this))}}!function(e){e[e.Undefined=0]="Undefined",e[e.Created=10]="Created",e[e.Sent=20]="Sent",e[e.Duplicated=30]="Duplicated",e[e.Seen=40]="Seen",e[e.Tried=50]="Tried",e[e.Kept=60]="Kept",e[e.Rejected=70]="Rejected"}(as||(as={})),function(e){e[e.JoinContext=0]="JoinContext",e[e.Session=1]="Session"}(ss||(ss={}));Error;var ls={util:{},roots:{default:{}}},ds=(ls.util,ls.roots.default||(ls.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.sessionKey="",e.prototype.annotationType="",e.prototype.annotationState=0,e.prototype.workflowId="",e.prototype.traceId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/AnnotationMetaDataChangeEvent"},e}());class fs extends ds{constructor(e){super(e),this.eventName="AnnotationMetaDataChange"}}class hs{constructor(e){this.item=e,this.operation=e.op,this.delta=e.delta,this.deltas=e.deltas,this.id=ma(this.itemPath),this.revId=e.revId}get itemPath(){return[...this.item.parentPath,this.item.id]}getModelIterator(){throw new Error("Method not implemented.")}getBody(){return this.item.body}getItemReference(){throw new Error("Method not implemented.")}getParentItem(e){throw new Error("Method not implemented.")}getParentItemBody(e){throw new Error("Method not implemented.")}getPrevItem(e,t){throw new Error("Method not implemented.")}getPrevItemBody(e,t){throw new Error("Method not implemented.")}getNextItem(e,t){throw new Error("Method not implemented.")}getNextItemBody(e,t){throw new Error("Method not implemented.")}getChildItem(e){throw new Error("Method not implemented.")}getChildItemBody(e){throw new Error("Method not implemented.")}getChildItems(e){throw new Error("Method not implemented.")}getChildItemBodies(e){throw new Error("Method not implemented.")}getSubtreeItem(e){throw new Error("Method not implemented.")}getSubtreeItemBody(e){throw new Error("Method not implemented.")}getSubtreeItems(e){throw new Error("Method not implemented.")}getSubtreeItemBodies(e){throw new Error("Method not implemented.")}getContextItem(e){throw new Error("Method not implemented.")}getContextItemBody(e){throw new Error("Method not implemented.")}getContextItems(e){throw new Error("Method not implemented.")}getContextItemBodies(e){throw new Error("Method not implemented.")}addAnnotation(e,t){throw new Error("Method not implemented.")}updateAnnotation(e,t){throw new Error("Method not implemented.")}deleteAnnotation(e){throw new Error("Method not implemented.")}loadSubtree(e){throw new Error("Method not implemented.")}getSourceTimestamp(){return this.item.sourceTimestamp}getContextId(){return this.item.contextId}}class ps{constructor(e,t=[]){this.scopeItem=void 0,this.rootItem=void 0,this.normalizeFilter=e=>{if(!e)return e=>void 0!==e;if("function"==typeof e)throw new Error("Not implemented yet");if((e.id?1:0)+(e.ids?1:0)+(e.itemType?1:0)+(e.itemTypes?1:0)!=1)throw new Error("Exactly one condition expected on IItemFilter");if(e.itemType)return t=>t&&ke.a.matchesTypesFor(t.body,[e.itemType]);if(e.itemTypes)return t=>t&&ke.a.matchesTypesFor(t.body,e.itemTypes);throw new Error("Not implemented yet")},this.items=[...t,e],this.scopeItem=new hs(e)}getItem(e){throw new Error("Method not implemented.")}getItems(e){throw new Error("Method not implemented.")}getItemBody(e){return this.getItemBodies(e)[0]}getItemBodies(e){const t=this.normalizeFilter(e);return this.items.filter(t).map((e=>e.body))}getItemByReference(e){throw new Error("Method not implemented.")}getItemBodyByReference(e){throw new Error("Method not implemented.")}}const gs=[Aa.b.CursorUpdate,Aa.b.FormattingUpdate,Aa.b.OtherNonContentUpdate];function ms(e,t,n){const r=new rr({operationName:"ApplyTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();try{if(!t)return r.success=!1,r.resultDescription="Unable to apply text tile delta, parent tile is undefined",void ar.a.info(538798173,ar.b.CoreDefault,r.stop());if(ke.a.getTypeNameFor(t)!==ka.b.getTypeName())return r.success=!1,r.resultDescription=`Unable to apply text tile delta, parent tile is not proper type: expected ${Pa.b.getTypeName()}, received ${ke.a.getTypeNameFor(t)}`,void ar.a.info(538798174,ar.b.CoreDefault,r.stop());const n=e,i=t.content;let o="";if(void 0===n.position||n.position<0)return r.success=!1,r.resultDescription="Unable to apply text tile delta, invalid text tile position",void ar.a.info(538798175,ar.b.CoreDefault,r.stop());switch(n.deltaType){case Aa.b.Add:o=n.position<i.length?`${i.slice(0,n.position)}${n.content}${i.slice(n.position,i.length)}`:i+n.content;break;case Aa.b.Update:n.content||n.unit!==Aa.c.Sentence||(r.dimension0="1"),o=`${i.slice(0,n.position)}${n.content}${i.slice(n.position+(n.length||0),i.length)}`;break;case Aa.b.Delete:o=`${i.slice(0,n.position)}${i.slice(n.position+(n.length||0),i.length)}`}return ar.a.info(538837071,ar.b.CoreDefault,r.stop()),new ka.b({content:o})}catch(e){return r.success=!1,r.resultDescription=`Error applying text tile delta: ${e}`,void ar.a.info(538798176,ar.b.CoreDefault,r.stop())}}function ys(e,t,n){var r,i,o,a,s,u,c,l;const d=new rr({operationName:"ApplyFormattedTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();d.clientFlights=n;try{if(!t)return d.success=!1,d.resultDescription="Unable to apply formatted text tile delta, parent tile is undefined",void ar.a.info(538798177,ar.b.CoreDefault,d.stop());if(ke.a.getTypeNameFor(t)!==ka.a.getTypeName())return d.success=!1,d.resultDescription=`Unable to apply formatted text tile delta, parent tile is not proper type: expected ${ka.a.getTypeName()}, received ${ke.a.getTypeNameFor(t)}`,void ar.a.info(538798178,ar.b.CoreDefault,d.stop());const n=t,f=e,h=n.content;let p="";if((void 0===f.position||f.position<0)&&!vs(f.deltaType))return d.success=!1,d.resultDescription="Unable to apply formatted text tile delta, invalid text tile position",void ar.a.info(538798179,ar.b.CoreDefault,d.stop());if(void 0===f.content&&!vs(f.deltaType))return d.success=!1,d.resultDescription="Unable to apply formatted text tile delta, non-delete, non-formatting, non-other-non-content-update and non-cursor-update operation without content defined",void ar.a.info(538798208,ar.b.CoreDefault,d.stop());if(f.deltaType===Aa.b.Add&&0!==f.length?ar.a.info(538798209,ar.b.CoreDefault,new rr({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta add operation with delta length, expected length 0",success:!0})):vs(f.deltaType)&&void 0!==f.content&&ar.a.info(538798210,ar.b.CoreDefault,new rr({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta delete or non-content related operation with content defined, expected undefined",success:!0})),!bs(f.deltaType)){const e=function(e,t,n){const r=new rr({operationName:"FindRangeForDelta",success:!0});if(r.start(),!e)return r.resultDescription="No formatted ranges found within the tile, skipping.",void ar.a.info(538798212,ar.b.CoreDefault,r.stop());if(t===Aa.b.Add){const t=e.find((e=>e.start===n&&0===e.length));if(t)return r.resultDescription=`Found a zero-length formatted range for add operation with start ${t.start}.`,ar.a.info(538798213,ar.b.CoreDefault,r.stop()),t;n=Math.max(n-1,0)}const i=e.find((e=>0===e.length?e.start===n:e.start<=n&&n<e.start+e.length));i?(r.resultDescription=`Updating formatted range for operation with start: ${i.start} and length: ${i.length}`,ar.a.info(538798214,ar.b.CoreDefault,r.stop())):(r.resultDescription=`Unable to find formatted range for operation at position ${n}, skipping.`,ar.a.info(538798215,ar.b.CoreDefault,r.stop()));return i}(n.formattedRanges,f.deltaType,f.position);let t=n.formattedRanges?[...n.formattedRanges]:[];const c=e?t.indexOf(e):-1;-1!==c&&(f.position+(f.length||0)>e.start+e.length?e.length=f.position+(null!==(r=f.content)&&void 0!==r?r:"").length-e.start:e.length+=(null!==(i=f.content)&&void 0!==i?i:"").length-(f.length||0),t[c]=e);let l=n.ipPosition;switch(f.deltaType){case Aa.b.Add:p=f.position<h.length?`${h.slice(0,f.position)}${f.content}${h.slice(f.position,h.length)}`:h+f.content,l=f.position+f.length;break;case Aa.b.Update:f.content||f.unit!==Aa.c.Sentence||(d.dimension0="1"),p=`${h.slice(0,f.position)}${f.content}${h.slice(f.position+(null!==(o=f.length)&&void 0!==o?o:0),h.length)}`,l=f.position+f.content.length;break;case Aa.b.Delete:p=`${h.slice(0,f.position)}${h.slice(f.position+(null!==(a=f.length)&&void 0!==a?a:0),h.length)}`,l=f.position}for(const e of t.slice(c+1))e.start<f.position||(f.position+(f.length||0)>e.start?(e.length=e.start+e.length-(f.position+(f.length||0)),e.start=f.position+(null!==(s=f.content)&&void 0!==s?s:"").length):e.start+=(null!==(u=f.content)&&void 0!==u?u:"").length-(f.length||0));t=t.filter((e=>e.length>0));const g=new ka.a(Object.assign(Object.assign({},n),{ipPosition:l,content:p,formattedRanges:t,queryRange:f.queryRange}));return ar.a.info(538837073,ar.b.CoreDefault,d.stop()),g}if(f.deltaType===Aa.b.CursorUpdate)return new ka.a(Object.assign(Object.assign({},n),{ipPosition:null===(c=f.cursorData)||void 0===c?void 0:c.ipPosition,isColdIp:null===(l=f.cursorData)||void 0===l?void 0:l.isColdIp}));if(f.deltaType===Aa.b.FormattingUpdate)return new ka.a(Object.assign(Object.assign({},n),{formattedRanges:f.formattedRanges}));if(f.deltaType===Aa.b.OtherNonContentUpdate){let e;const t={};for(e in f.otherNonContentData)t[e]=f.otherNonContentData[e];return new ka.a(Object.assign(Object.assign({},n),t))}return}catch(e){return d.success=!1,d.resultDescription=`Error applying formatted text tile delta: ${e}`,void ar.a.info(538798211,ar.b.CoreDefault,d.stop())}}function bs(e){return-1!==gs.indexOf(e)}function vs(e){return bs(e)||Aa.b.Delete===e}function ws(e){if(!e)return new Ss([],new Set,new Map,new Map);const t=e.split(";"),n=new Set,r=new Map,i=new Map;for(const e of t){const t=e.trim();if(""===t)continue;n.add(Ss.normalizeName(t));const[o,...a]=t.split(":"),s=a.join(":"),u=Ss.normalizeName(o);if(u){r.set(u,s);const e=Ss.parseName(u);e&&e!==u&&i.set(e,u)}}return new Ss(t,n,r,i)}class Ss{constructor(e,t,n,r){this.originalFlights=e,this.normalizedFlights=t,this.keyValueFlightsMap=n,this.parsedFlightsMap=r}static normalizeName(e){return null==e?void 0:e.toLowerCase()}static parseName(e){const t=null==e?void 0:e.split(".");return t?t[t.length-1]:void 0}hasFlight(e){const t=Ss.normalizeName(e),n=this.normalizedFlights.has(t),r=this.keyValueFlightsMap.has(t),i=this.parsedFlightsMap.has(t);return n||r||i}getBooleanValue(e,t){var n,r;const i=null===(n=this.getStringValue(e))||void 0===n?void 0:n.toLowerCase(),o=null===(r=this.getStringValue(this.parsedFlightsMap.get(Ss.normalizeName(e))))||void 0===r?void 0:r.toLowerCase();return"true"===i||"true"===o||"false"!==i&&"false"!==o&&t}getIntValue(e,t){const n=this.getStringValue(e),r=Number.parseInt(n,10);return Number.isNaN(r)?t:r}getStringValue(e,t){var n;return null!==(n=this.keyValueFlightsMap.get(Ss.normalizeName(e)))&&void 0!==n?n:t}getAll(){return this.originalFlights}getAllParsed(){const e=[];return this.keyValueFlightsMap.forEach(((t,n)=>{const r=null==t?void 0:t.toLowerCase();switch(r){case"true":e.push({name:n,value:!0});break;case"false":e.push({name:n,value:!1});break;default:{const i=Number.parseInt(r,10);Number.isNaN(i)?e.push({name:n,value:t}):e.push({name:n,value:i})}}})),e}}class _s{constructor(e){this.model=e.model,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.site=e.site,this.getTokenCallback=e.getTokenCallback}get flights(){var e;return null!==(e=this._flights)&&void 0!==e||(this._flights=ws(this.clientMetadata.flights)),this._flights}getToken(e,t){return this.getTokenCallback(e,t)}}class Ts{constructor(e,t,n){this.itemsContextId=new Set,this.executionState=new Map,this.graphNode=e,this.onContextIdWorkflowExecutionComplete=t,n&&(this.itemsContextId=n.itemsContextId,this.executionState=n.executionState)}addInputItemToProcess(e){this.itemsContextId.add(e)}removeProcessedInputItem(e){this.itemsContextId.delete(e)}countItemsToProcess(e){let t=0;for(const n of this.itemsContextId)0===n.indexOf(e)&&(t+=1);return t}getExecutionState(){return this.executionState}setExecutionState(e,t){return this.graphNode.isActivated?e?(this.executionState.set(e,t),!0):(ar.a.info(520217546,ar.b.CoreDefault,new rr({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:e,resultDescription:`Trying to set state ${t} for a undefined contextId (setExecutionState)`})),!1):(ar.a.info(508883415,ar.b.CoreDefault,new rr({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:e,resultDescription:`Trying to set state ${t} for a not activated workflow`})),!1)}beforeWorkflowExecution(e){this.setExecutionState(e,Ca.Pending)}afterWorkflowExecution(e){this.setExecutionState(e,Ca.Executed)&&this.tryToCompleteWorkflowExecution(e)}clearWorkflowExecutions(){this.executionState.forEach(((e,t)=>this.afterWorkflowExecution(t)))}tryToCompleteWorkflowExecution(e){if(this.executionState.get(e)===Ca.Executed&&this.canCompleteExecution(e)){this.executionState.delete(e),this.onContextIdWorkflowExecutionComplete&&this.onContextIdWorkflowExecutionComplete(this.graphNode.workflow.id,e);for(const t of this.downstreamWorkflowExecutionTrackers)for(const[n,r]of t.getExecutionState())r===Ca.Executed&&Oa.isParentContextId(e,n)&&t.tryToCompleteWorkflowExecution(n)}}canCompleteExecution(e){for(const t of this.upstreamWorkflowExecutionTrackers)for(const n of t.getExecutionState().keys())if(Oa.isParentContextId(n,e))return!1;return!0}}var Os;!function(e){e.Unknown="",e.InputReceived="input",e.JoinMaxAnnnotation="maxAnnotation",e.JoinMaxTimeout="maxTimeout",e.JoinEarlyCompletion="earlyCompletion"}(Os||(Os={}));class Cs{constructor(e,t,n){this.executionTrackersByWorkflowNameBySession=new Map,this.workflowsWithSessionAffinity=new Map,this.workflowDefinitionsWithSessionAffinity=[],this.workflowsWithoutSessionAffinity=[],this.pendingScopeExecutionNotificationsByWorkflow=new Map,this.sweepIntervalMs=200,this.sweepTimers=new Map,this.getResourceAsArrayBuffer=(e,t,n)=>this.modelDownloader?this.modelDownloader.getResourceAsArrayBuffer(e,t,n):Promise.reject(new Error("Resource Downloader never created")),this.getResourceAsURL=(e,t,n)=>this.modelDownloader?this.modelDownloader.getResourceAsURL(e,t,n):Promise.reject(new Error("Resource Downloader never created")),this.createModel=e=>(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService?this.inferenceService.then((t=>t.createModel(e))):Promise.reject(new Error("Inference Service never created"))),this.createModelInputs=()=>{if(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService)return this.inferenceService.then((e=>e.createInputs()));throw new Error("Inference Service never created")},this.nextAnnotationId=1,this.nextSignalId=1,this.modelDownloader=e,this.inferenceServiceFactory=t,n.enableDeltas&&(this.deltaHandlers=(new Map).set(ke.a.getTypeNameFor(Pa.b),ms).set(ke.a.getTypeNameFor(Pa.a),ys),this.itemsForDelta=new Map),this.enableEarlyJoin=n.enableEarlyJoin||!1,this.site={getResourceAsArrayBuffer:this.getResourceAsArrayBuffer,getResourceAsURL:this.getResourceAsURL,createModel:this.createModel,createModelInputs:this.createModelInputs}}getNextClientAnnotationId(){return"#AC"+this.nextAnnotationId++}getNextClientSignalId(){return"#SC"+this.nextSignalId++}registerLocalWorkflow(e,t){const n=new rr({operationName:"WorkflowRegistration",resourceId:e.id}).start();if(0===e.inputTypes.length)throw new Error("Invalid workflow params");t?(this.workflowsWithSessionAffinity.get(t).push(this.createWorkflowImplementation(e,t)),t.registerContextTypes(ha(e.requestedContextTypesRules).map((([e,t])=>e))),t.attachToWorkflowGraph(e),n.setClientMetadata(t.getClientMetadata())):(e.isStateful?(this.workflowDefinitionsWithSessionAffinity.push(e),this.workflowsWithSessionAffinity.forEach(((t,n)=>{t.push(this.createWorkflowImplementation(e,n))}))):this.workflowsWithoutSessionAffinity.push(this.createWorkflowImplementation(e)),this.workflowsWithSessionAffinity.forEach(((t,n)=>{n.registerContextTypes(ha(e.requestedContextTypesRules).map((([e,t])=>e))),n.attachToWorkflowGraph(e)}))),n.success=!0,ar.a.info(572838110,ar.b.CoreDefault,n.stop())}getAllRegisteredWorkflowsFromSession(e){const t=[];return t.push(...this.workflowsWithoutSessionAffinity||[]),t.push(...this.workflowsWithSessionAffinity.get(e)||[]),t.map((e=>e.workflow))}getWorkflowDefinitionsByName(e){var t;const n=new Map;return null===(t=this.workflowsWithSessionAffinity.get(e))||void 0===t||t.forEach((e=>n.set(e.workflow.id,e.workflow))),n}getWorkflowDefinitionsWithSessionAffinity(){return this.workflowDefinitionsWithSessionAffinity}attachExecutionTrackerToEachWorkflow(e,t,n){const r=e.getWorkflowNodes(),i=this.executionTrackersByWorkflowNameBySession.get(t),o=(e,r)=>{if(n&&n(e,r),this.enableEarlyJoin){(()=>{for(const e of this.executionTrackersByWorkflowNameBySession.get(t).values())if(e.graphNode.workflow.kind===Zo.Join)for(const t of e.getExecutionState().keys())if(Oa.isParentContextId(t,r))return!0;return!1})()&&(this.cancelSweepTimer(t),this.ensureSweepTimer(t),this.sweepScopeExecutionNotifications())}};for(const e of r){const t=i.get(e.workflow.id),n=new Ts(e,o.bind(this),t);i.set(e.workflow.id,n)}for(const e of i.values())this.setDownstreamWorkflowExecutionTrackers(e,i),this.setUpstreamWorkflowExecutionTrackers(e,i)}canActivateWorkflow(e,t){var n;return e.location===ya.Local||!!t.hasConnected&&!((null===(n=e.workflow.requiredTokenTypes)||void 0===n?void 0:n.length)>0&&t.getServerAuthenticationState()===Uo.NotAuthenticated)}setDownstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.downstreamWorkflowExecutionTrackers)return;e.downstreamWorkflowExecutionTrackers=new Set;const{graphNode:n}=e;for(const r of n.downstreamWorkflows||[]){const n=t.get(r.workflow.id);this.setDownstreamWorkflowExecutionTrackers(n,t),e.downstreamWorkflowExecutionTrackers.add(n)}}setUpstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.upstreamWorkflowExecutionTrackers)return;e.upstreamWorkflowExecutionTrackers=new Set;const{graphNode:n}=e;for(const r of n.upstreamWorkflows||[]){const n=t.get(r.workflow.id);this.setUpstreamWorkflowExecutionTrackers(n,t),e.upstreamWorkflowExecutionTrackers.add(n)}}deactivateServerWorkflow(e,t){var n;e.location!==ya.Local&&(null===(n=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===n||n.get(e.workflow.id).clearWorkflowExecutions(),e.isActivated=!1)}addSession(e){this.executionTrackersByWorkflowNameBySession.set(e,new Map);const t=[];for(const n of this.workflowDefinitionsWithSessionAffinity)t.push(this.createWorkflowImplementation(n)),e.attachToWorkflowGraph(n);this.workflowsWithSessionAffinity.set(e,t);for(const t of this.workflowsWithoutSessionAffinity)e.attachToWorkflowGraph(t.workflow)}closeSession(e){this.cancelSweepTimer(e);for(const t of this.workflowsWithSessionAffinity.get(e)||[])t.workflowLambda.dispose();this.workflowsWithSessionAffinity.delete(e)}setTokenCallback(e){this.getAuthTokenCallback=e}preProcessItemToWorkflow(e,t,n){const r=this.executionTrackersByWorkflowNameBySession.get(n).get(e.id);e.kind===Zo.Join&&ke.a.matchesTypesFor(t.body,e.inputTypes)&&r.addInputItemToProcess(t.contextId),(e.kind===Zo.SingleItem&&ke.a.matchesTypesFor(t.body,e.inputTypes)||e.kind===Zo.Join&&ke.a.matchesTypesFor(t.body,[e.collectionScopeType]))&&r.beforeWorkflowExecution(t.contextId)}isReadyToEarlyJoin(e,t,n){const r=r=>{var i;const o=Array.from(null!==(i=r.states)&&void 0!==i?i:[]).map((e=>`${e[0]}: ${e[1].map((e=>e.join()))}`)).join(),a=new rr({operationName:"EarlyJoinCompletion",resourceId:e.graphNode.workflow.id,joinContextId:t,success:!0}).start();a.setClientMetadata(n),a.resultDescription=`isReadyToEarlyJoin (${this.enableEarlyJoin}) -> hasProcessedAllInputItems: ${r.hasProcessedAllInputItems}, allUpstreamComplete: ${r.allUpstreamComplete}, states: ${o}`,ar.a.info(512550800,ar.b.CoreDefault,a.stop())},i=0===e.countItemsToProcess(t);if(!i)return this.enableEarlyJoin||r({hasProcessedAllInputItems:i}),!1;const{allUpstreamComplete:o,states:a}=this.areAllUpstreamWorkflowComplete(e,t);return this.enableEarlyJoin?o:(r({hasProcessedAllInputItems:i,allUpstreamComplete:o,states:a}),!1)}areAllUpstreamWorkflowComplete(e,t){const n=new Map;for(const r of e.upstreamWorkflowExecutionTrackers){const e=[];for(const[i,o]of r.getExecutionState())if(e.push([i,o]),Oa.isParentContextId(t,i))return n.set(r.graphNode.workflow.id,e),{allUpstreamComplete:!1,states:n};e.length>0&&n.set(r.graphNode.workflow.id,e)}return{allUpstreamComplete:!0,states:n}}runLocalWorkflows(e,t,n=!1){var r,i,o;const a=(e,n,r)=>{var i,o;const a=t.getWorkflowItemStorage(),{workflow:s}=e,u=null===(i=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===i?void 0:i.get(s.id),c=s.inputTypes.concat(s.kind===Zo.Join?s.collectionScopeType:[]),l=new rr({operationName:"RunLocalWorkflows",success:!0,resourceId:s.id,joinContextId:n.contextId}).start();if(l.setClientMetadata(t.getClientMetadata()),ke.a.matchesTypesFor(n.body,c)){const i=ga(r.parentPath,n);if(s.kind===Zo.Join){if(ke.a.matchesTypesFor(i.body,[s.collectionScopeType]))return a.setScopeItem(i,s),l.resultDescription=`Scope item: ${n.id} (${ke.a.getTypeNameFor(n.body)})`,ar.a.info(524126153,ar.b.CoreDefault,l.stop()),void this.setScopeExecutionNotification(t,e,i,es.Internal);{u.removeProcessedInputItem(i.contextId);const e=a.getScopeItem(i.contextId,s);if(!e)return l.resultDescription=`Filtered out join invalidation: out of scope type (${s.collectionScopeType}), item id: ${i.id}`,void ar.a.info(541173894,ar.b.CoreDefault,l.stop());a.addItemToWorkflowList(i,s),l.joinContextId=e.contextId,l.resultDescription=`Input item: ${n.id} (${ke.a.getTypeNameFor(n.body)})`}}if(ke.a.getBaseTypesFor(i.body).indexOf(Vt.getTypeName())>=0){const e=[...i.parentPath,i.id];let n=!0;for(const r of null!==(o=s.outputTypes)&&void 0!==o?o:[])if(!t.getContextAnnotations(r,Za.LocalWorkflow,e,s.id)){n=!1;break}if(n)return}const c=()=>{var r;const[o,d]=t.resolveRequestedContexts(s);if(!o)return l.resultDescription=`Required contexts are not ready for ${s.id}. Retrying execution in 500 milliseconds...`,ar.a.info(545837259,ar.b.CoreDefault,l.stop()),void setTimeout(c,500);if(s.kind===Zo.SingleItem)this.queueWorkflow({workflowInfo:e,scopeItem:i,inputItems:[i],requestedContexts:d,session:t,orchestrationMode:es.Internal,triggerReason:Os.InputReceived,onCompleteCallback:this.onWorkflowExecuted.bind(this,i,s,t)}).then((()=>{ar.a.info(509154263,ar.b.WorkflowDefault,l.stop())})).catch((e=>{l.resultDescription=e,ar.a.error(572838111,ar.b.CoreDefault,l.stop())}));else if(s.kind===Zo.Join){const i=n.contextId,o=a.getScopeItem(i,e.workflow);if(!o)return l.resultDescription=`No scope item for ${s.id} workflow from contextId ${i}`,void ar.a.info(526758475,ar.b.CoreDefault,l.stop());const c=this.isReadyToEarlyJoin(u,o.contextId,t.getClientMetadata()),f=c?Os.JoinEarlyCompletion:Os.JoinMaxAnnnotation;if(a.isWorkflowReady(o.contextId,s)||c){if(!(null===(r=this.pendingScopeExecutionNotificationsByWorkflow.get(s.id))||void 0===r?void 0:r.get(o.contextId)))return l.resultDescription=`Workflow ${s.id}, contextId ${o.contextId}, already queued, skipping new scope execution`,void ar.a.info(528048977,ar.b.CoreDefault,l.stop());const n=a.getItemsToExecute(o.contextId,s);this.queueWorkflow({workflowInfo:e,scopeItem:o,inputItems:n,requestedContexts:d,session:t,orchestrationMode:es.Internal,triggerReason:f,onCompleteCallback:this.onWorkflowExecuted.bind(this,o,s,t)}).then((()=>{ar.a.info(509154262,ar.b.WorkflowDefault,l.stop())})).catch((e=>{l.resultDescription=e,ar.a.error(541173895,ar.b.CoreDefault,l.stop())})),this.pendingScopeExecutionNotificationsByWorkflow.get(s.id).delete(o.contextId),0===this.pendingScopeExecutionNotificationsByWorkflow.get(s.id).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(s.id)}}};c()}};let s=e;n&&(s=[new Fe({parentPath:["session"],items:[{id:"#userContext#",body:new Gt}]}),new Fe({parentPath:["session"],items:[{id:"#tenantContext#",body:new Ht}]})],t.getContextIdManager().applyContextIdOnOperations(s),s=s.concat(e));for(const e of s){const n=ke.a.getTypeNameFor(e);for(const s of e.items)if(t.applyOperationForContext(e,s,Za.Submitted),n!==We.getTypeName()){if(s.body)if(n===Qe.getTypeName()&&this.deltaHandlers&&this.itemsForDelta)this.handleLocalDeltaUpdate(s,e,t);else{null===(i=this.itemsForDelta)||void 0===i||i.set(e.parentPath.concat(s.id).toString(),s);for(const t of this.workflowsWithoutSessionAffinity)a(t,s,e);for(const n of null!==(o=this.workflowsWithSessionAffinity.get(t))&&void 0!==o?o:[])a(n,s,e)}}else null===(r=this.itemsForDelta)||void 0===r||r.delete(e.parentPath.concat(s.id).toString())}}handleLocalDeltaUpdate(e,t,n){const r=new rr({operationName:"LocalDeltaUpdate",dimension0:ke.a.getTypeNameFor(e.body),success:!0});r.start();try{const i=this.deltaHandlers.get(ke.a.getTypeNameFor(e.body)),o=this.itemsForDelta.get(t.parentPath.toString());if(i&&o){const a=t.parentPath.length>0?t.parentPath.slice(0,t.parentPath.length-1):t.parentPath,s=i(e.body,o.body);if(s){const t={id:o.id,revId:e.revId,body:s,parentPath:a,delta:e.body,contextId:e.contextId},i=new Le({parentPath:t.parentPath,items:[t]});ar.a.info(539637591,ar.b.CoreDefault,r.stop()),this.runLocalWorkflows([i],n)}else r.success=!1,r.resultDescription="Failed because the handler did not produce valid updated item",ar.a.info(539637592,ar.b.CoreDefault,r.stop())}else r.success=!1,r.resultDescription="Failed due to lack of handler or parent item",ar.a.info(539637593,ar.b.CoreDefault,r.stop())}catch(e){r.success=!1,r.resultDescription=`Failed to apply delta, error: ${e}`,ar.a.info(539637594,ar.b.CoreDefault,r.stop())}}createWorkflowImplementation(e,t){const n=e.factory();return{workflow:e,workflowLambda:n,initPromise:this.initWorkflow(e.kind,n,t)}}initWorkflow(e,t,n){const r=new _s({model:void 0,clientMetadata:n?n.getClientMetadata():void 0,userContext:n?n.getUserContext():void 0,site:this.site,getTokenCallback:this.getAuthTokenCallback});return e===Zo.SingleItem||e===Zo.Join?t.init(this.site,r):Promise.resolve()}queueWorkflow(e){return this.executionTrackersByWorkflowNameBySession.get(e.session).get(e.workflowInfo.workflow.id).setExecutionState(e.scopeItem.contextId,Ca.Running),this.executeLocalWorkflow(e.workflowInfo,e.scopeItem,e.inputItems,e.session,e.requestedContexts,e.orchestrationMode,e.triggerReason).then((t=>{this.processAnnotationResults(t,e.session),e.onCompleteCallback()})).catch((t=>{throw e.onCompleteCallback(),t}))}processAnnotationResults(e,t){for(const n of e)t.onAnnotationResults(n,Za.LocalWorkflow,(()=>{}))}executeLocalWorkflow(e,t,n,r,i,o,a){return new Promise(((s,u)=>{var c,l,d;const f=[],h=e.workflow,p=new rr({operationName:"ExecuteWorkflow",resourceId:h.id,joinContextId:null!==(c=null==t?void 0:t.contextId)&&void 0!==c?c:"",resultDescription:null!=a?a:"",success:!0}).setClientMetadata(r.getClientMetadata());p.start();const g=null!==(l=null==t?void 0:t.contextId)&&void 0!==l?l:n[0].contextId,m=null!==(d=null==t?void 0:t.revId)&&void 0!==d?d:n[0].revId,y=(()=>{const e=new Map;if(t&&(t.parentPath||ar.a.error(525382231,ar.b.CoreDefault,`Missing scope item parent. Workflow: ${h.id}. Type: ${ke.a.getTypeNameFor(t.body)}`),e.set(t.body,t)),Array.isArray(n))for(const t of n)t&&t.body&&(t.parentPath||ar.a.error(525382232,ar.b.CoreDefault,`Missing parent. Workflow: ${h.id}. Type: ${ke.a.getTypeNameFor(t.body)}`),e.set(t.body,t));return e})(),b=(e,t=p)=>{if(e)return t.success=!1,t.resultDescription+="string"==typeof e?e:e.message,t.resultSignature="Exception",ar.a.error(572838112,ar.b.CoreDefault,t.stop()),"string"==typeof e?new Error(e):e;ar.a.info(572838113,ar.b.CoreDefault,t.stop())},v=new _s({model:new ps(n[0],i),clientMetadata:r.getClientMetadata(),userContext:r.getUserContext(),site:this.site,getTokenCallback:this.getAuthTokenCallback}),w=e=>{b(e?e.message:void 0),e?u(e):s(f)},S={setAnnotations:(i,a,s,c)=>{var l;const d=new rr({operationName:"SetAnnotations",resourceId:a,joinContextId:null!==(l=null==t?void 0:t.contextId)&&void 0!==l?l:"",success:!0}).setClientMetadata(r.getClientMetadata());d.start();const p=t=>{ar.a.info(555866112,ar.b.CoreDefault,new fs({annotationType:a,annotationState:t,workflowId:e.workflow.id}))};for(const e of s)e.metadata=Object.assign(Object.assign({},e.metadata),{state:as.Created}),p(as.Created);const v=y.get(i),w=ke.a.getTypeNameFor(v.body),S=(()=>{var e;if(h.kind===Zo.SingleItem&&n[0].body!==i){const e=`Expected obj to be ${n[0].body} but instead it was ${i}`;return b(e,d),void u(b(e))}let t,l;if(Array.isArray(s))if(!h.outputTypes||h.outputTypes.indexOf(a)<0)t=`Workflow said it would output one of [${h.outputTypes}] but instead output ${a}`;else if(v)for(const e of s)ke.a.matchesTypesFor(e,[zi.getTypeName()])?ke.a.getTypeNameFor(e)!==a&&(t=`Workflow produced inconsistent annotation types in setAnnotations call (${ke.a.getTypeNameFor(e)} did not match expected ${a})`):t=`Workflow produced an output that is not an annotation ${ke.a.getTypeNameFor(e)}`;else t="No item provided";else t="Workflow produced an invalid annotation array";if(t)return b(t,d),void u(b(t));if(l=c&&c.isSessionAnnotation?["session"]:c&&c.ancestorType?v.parentPath:v.parentPath.concat(v.id),o===es.External)return;const f=[],y=[];for(const t of s){t.metadata=Object.assign(Object.assign({},t.metadata),{state:as.Sent}),p(as.Sent);const n=t.id,i=n?null===(e=r.getContextAnnotations(a,Za.LocalWorkflow,l,h.id))||void 0===e?void 0:e.filter((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.id)==n})):void 0;1==(null==i?void 0:i.length)?1==i.length?y.push({id:i[0].id,source:h.id,revId:m,body:t,contextId:g}):ar.a.error(545837260,ar.b.CoreDefault,`Assert: Multiple existing context annotations with body id ${n} found for ${a} and local workflow ${h.id}).`):f.push({id:this.getNextClientAnnotationId(),source:h.id,revId:m,body:t,contextId:g})}const w=[];return f.length>0&&w.push(new Fe({parentPath:l,items:f,parentRevId:m})),y.length>0&&w.push(new ze({parentPath:l,items:y,parentRevId:m})),new yi({annotationType:a,ops:w})})();S?(c&&c.immediate?r.onAnnotationResults(S,Za.LocalWorkflow,(()=>{})):f.push(S),(w==Gt.getTypeName()||w==Ht.getTypeName()||ke.a.matchesTypesFor(v.body,[Bt.getTypeName(),Ft.getTypeName()]))&&r.submitOperationsToSession(S.ops),ar.a.info(509644822,ar.b.CoreDefault,d.stop())):ar.a.info(509644823,ar.b.CoreDefault,d.stop())},submitSignals:e=>{if(o===es.External)return void u(b("NYI"));const t=new rr({operationName:"submitSignalsAction",resourceId:h.id,success:!0}).setClientMetadata(r.getClientMetadata());for(const n of e){const e=ke.a.getTypeNameFor(n);ke.a.matchesTypesFor(n,[Gi.getTypeName()])||(t.resultDescription=`Workflow produced an output that is not an signal (${ke.a.getTypeNameFor(n)})`,ar.a.info(521413954,ar.b.CoreDefault,t)),h.outputTypes&&-1!==h.outputTypes.indexOf(e)||(t.resultDescription=`Workflow said it would output one of [${h.outputTypes}] but instead output ${e}`,ar.a.info(521413953,ar.b.CoreDefault,t)),n.timestamp&&(Cs.logTimestampUsageByWorkflowId.has(h.id)||(Cs.logTimestampUsageByWorkflowId.add(h.id),t.resultDescription=`Workflow "${h.id}" sets signal.timeStamp`,ar.a.info(509212803,ar.b.CoreDefault,t)))}const n=e.map((e=>({id:this.getNextClientSignalId(),source:h.id,revId:m,body:e,contextId:g}))),i=new Xe({parentPath:["session"],parentRevId:m,items:n});r.submitOperations([i])},done:w,overrideWorkflowDefinition:(e,n,i)=>{let o;switch(i){case ss.JoinContext:if(!t.contextId){const e="ContextId is not defined for this scope item.";throw ar.a.error(527472289,ar.b.CoreDefault,e),new Error(e)}o=t.contextId;break;case ss.Session:o=void 0;break;default:{const e="Defined scope is not supported. "+i;throw ar.a.error(527472290,ar.b.CoreDefault,e),new Error(e)}}const a=new Mo({definition:n,contextId:o,sourceWorkflowId:h.id,targetWorkflowId:e});r.onWorkflowDefinitionOverrideMessage(a)},getDynamicAnnotations:void 0,setBillingDomain:void 0},_=e.workflowLambda;if(h.kind===Zo.SingleItem){1!==n.length&&w(new Error("Single item workflows expect a single input")),v.delta=n[0].delta,v.deltas=n[0].deltas;try{const t=_;e.initPromise||(e.initPromise=t.init(this.site,v)),e.initPromise.then((()=>{t.execute(n[0].body,v,S)})).catch((e=>{b(e)}))}catch(e){b(e)}}else if(h.kind===Zo.Join){0===n.length&&w(new Error("Join workflows expect an inputs array")),v.delta=t.delta,v.deltas=t.deltas;try{const r=_;e.initPromise||(e.initPromise=r.init(this.site,v)),e.initPromise.then((()=>{r.execute(t.body,n.map((e=>e.body)),v,S)})).catch((e=>{b(e)}))}catch(e){b(e)}}else b(`Workflow kind ${h.kind} not supported`)}))}ensureSweepTimer(e){if(!this.sweepTimers.get(e)){const t=setInterval(this.onSweep.bind(this),this.sweepIntervalMs);this.sweepTimers.set(e,t)}}cancelSweepTimer(e){const t=this.sweepTimers.get(e);this.sweepTimers.get(e)&&(clearInterval(t),this.sweepTimers.delete(e))}onSweep(){this.sweepScopeExecutionNotifications()}setScopeExecutionNotification(e,t,n,r){var i,o;const a=Date.now(),s={session:e,workflowImplementation:t,scopeItem:n,startTime:a,minTime:a+Qi(t.workflow.minDelayMs,1e3),maxTime:a+Qi(t.workflow.maxDelayMs,5e3),orchestrationMode:r},u=t.workflow.kind===Zo.Join?n.contextId:s.scopeItem.parentPath.concat(n.id).join("\\");this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id)||this.pendingScopeExecutionNotificationsByWorkflow.set(t.workflow.id,new Map);if(this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).get(u)){const r=new rr({resultDescription:`Duplicated pending scope execution for ${t.workflow.id} at ${u}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(o=null==n?void 0:n.contextId)&&void 0!==o?o:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();ar.a.info(509727899,ar.b.CoreDefault,r.stop())}else{const r=new rr({resultDescription:`New pending scope execution for ${t.workflow.id} at ${u}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(i=null==n?void 0:n.contextId)&&void 0!==i?i:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();ar.a.info(539883075,ar.b.CoreDefault,r.stop()),this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).set(u,s)}this.ensureSweepTimer(e)}sweepScopeExecutionNotifications(){var e,t;const n=new Set(Array.from(this.sweepTimers.keys()));for(const[r,i]of Array.from(this.pendingScopeExecutionNotificationsByWorkflow.entries()))for(const[o,a]of Array.from(i.entries())){const{session:i,workflowImplementation:{workflow:s},orchestrationMode:u}=a,c=i.getWorkflowItemStorage(),l=new rr({operationName:"LocalScopeExecutionNotification",resourceId:s.id,joinContextId:null!==(t=null===(e=a.scopeItem)||void 0===e?void 0:e.contextId)&&void 0!==t?t:"",success:!0}).setClientMetadata(i.getClientMetadata()).start(),d=()=>{if(s.kind===Zo.Join){const e=Date.now(),{workflow:t}=a.workflowImplementation,n=a.scopeItem.contextId,r=i.getWorkflowDefinition(t,n).maxDelayMs;return c.isWorkflowReady(n,t)?(l.resultDescription=`Join Workflow: ${t.id} queuing by maxAnnotation, contextId: ${n}`,ar.a.info(528048978,ar.b.CoreDefault,l.stop()),{isValid:!0,triggerReason:Os.JoinMaxAnnnotation}):a.startTime+r<e?(l.resultDescription=`Join Workflow: ${t.id} queuing by maxTimeout, contextId: ${n}`,ar.a.info(528048979,ar.b.CoreDefault,l.stop()),{isValid:!0,triggerReason:Os.JoinMaxTimeout}):this.isReadyToEarlyJoin(this.executionTrackersByWorkflowNameBySession.get(i).get(t.id),n,i.getClientMetadata())?(ar.a.info(512550856,ar.b.CoreDefault,`Workflow: ${t.id} queuing by early completion, contextId: ${n}, timeout: ${r}`),{isValid:!0,triggerReason:Os.JoinEarlyCompletion}):{isValid:!1,triggerReason:Os.Unknown}}return{isValid:!0,triggerReason:Os.Unknown}};(()=>{const{isValid:e,triggerReason:t}=d();if(!e)return!1;const[n,r]=i.resolveRequestedContexts(s);if(!n)return!1;try{if(s.kind===Zo.Join){const e=a.scopeItem.contextId,n=c.getScopeItem(e,s);if(n){const o=c.getItemsToExecute(n.contextId,s);if(0===o.length)return l.resultDescription=`Failed to retrieve items for workflow: ${s.id}, contextId: ${e}, skipping execution`,ar.a.info(527472291,ar.b.CoreDefault,l.stop()),this.onWorkflowExecuted(n,s,i),!0;this.queueWorkflow({workflowInfo:a.workflowImplementation,scopeItem:n,inputItems:o,requestedContexts:r,session:i,orchestrationMode:u,triggerReason:t,onCompleteCallback:this.onWorkflowExecuted.bind(this,n,s,i)}).catch((e=>{l.success=!1,l.resultDescription=e.message,ar.a.error(509092189,ar.b.CoreDefault,l.stop())}))}else l.resultDescription="ContextId no longer exists, skipping workflow execution",ar.a.info(539883076,ar.b.CoreDefault,l.stop())}else l.resultDescription=`Workflow in type ${s.kind} is not supported`,ar.a.error(539883077,ar.b.CoreDefault,l.stop())}catch(e){l.resultDescription=`Trying to execute ${s.id} caused an exception: ${e}`,ar.a.warn(539883078,ar.b.CoreDefault,l.stop())}return!0})()?(this.pendingScopeExecutionNotificationsByWorkflow.get(r).delete(o),0===this.pendingScopeExecutionNotificationsByWorkflow.get(r).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(r)):n.delete(i)}if(0!==n.size)for(const e of Array.from(n)){const t=new rr({resultDescription:"No pending scope notifications left, cancelling sweep timer",operationName:"LocalScopeExecutionNotification",success:!0}).start();ar.a.debug(539883079,ar.b.CoreDefault,t.stop()),this.cancelSweepTimer(e)}}onExternalWorkflowExecuted(e,t,n){const r={id:"",parentPath:[],contextId:e},i={id:t};this.onWorkflowExecuted(r,i,n,!1)}onWorkflowExecuted(e,t,n,r=!0){var i;null===(i=this.executionTrackersByWorkflowNameBySession.get(n).get(t.id))||void 0===i||i.afterWorkflowExecution(e.contextId),r&&t.kind===Zo.Join&&n.getWorkflowItemStorage().onWorkflowExecuted(e,t)}}class Es{constructor(e=500,t=!1){this.prevSeq=-1,this.bufferingTimeMs=e,this.rejectOutdatedSequenceNumbers=t}sequence(e){return new Promise(((t,n)=>{if(e<this.prevSeq){if(this.rejectOutdatedSequenceNumbers){const t=new Error(`BufferingSequencer: Item out of order. Expecting seqId > ${this.prevSeq}. Actual seqId ${e}`);return t.name=Es.Rejected,void n(t)}this.prevSeq=-1}e!=this.prevSeq+1&&ar.a.warn(542712385,ar.b.CoreDefault,`BufferingSequencer: got out of order sequence number. Got ${e}, expected ${this.prevSeq+1}`);const r={seq:e,resolve:t};this.insertItem(r),this.runInOrder(r,!0,!1)}))}insertItem(e){if(!this.firstQueueItem)return this.firstQueueItem=e,void(this.lastQueueItem=e);let t=this.lastQueueItem,n=null;do{if(e.seq>t.seq)return e.prev=t,t.next=e,void(n?(n.prev=e,e.next=n):this.lastQueueItem=e);n=t,t=t.prev}while(t);n&&(n.prev=e),e.next=n,this.firstQueueItem=e}runInOrder(e,t,n){let r=this.prevSeq,i=!1;const o=[];for(;this.firstQueueItem;){const t=this.firstQueueItem;if(r+1!=t.seq&&(!n||t.seq>e.seq))break;r=t.seq,t.timeout&&clearTimeout(t.timeout),o.push(t),e==t&&(i=!0),this.firstQueueItem=this.firstQueueItem.next,this.firstQueueItem&&(this.firstQueueItem.prev=null)}o.length>0&&setTimeout((()=>{for(const e of o)e.resolve(e.seq)}),0),this.prevSeq=r,!i&&t&&(e.timeout=setTimeout((()=>{this.runInOrder(e,!1,!0)}),this.bufferingTimeMs))}}Es.Rejected="SequenceItemRejected";class Is{constructor(e=500){this.bufferingTimeMs=500,this.workflowIdToSequencersMap=new Map,this.bufferingTimeMs=e}create(e){if(!e.ownerId)return null;let t=this.workflowIdToSequencersMap.get(e.ownerId);return t||(t=new Es(this.bufferingTimeMs),this.workflowIdToSequencersMap.set(e.ownerId,t)),t}}var ks=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};class As{constructor(e=500,t){this.sequencerFactory=null!=t?t:new Is(e)}sequence(e){var t;return ks(this,void 0,void 0,(function*(){const n=null===(t=null==e?void 0:e.M_)||void 0===t?void 0:t.seq;if(null==n)return;const r=this.sequencerFactory.create(e);r&&(yield r.sequence(e.M_.seq))}))}}class Ps{constructor(e){this.annotationSequencer=null!=e?e:new As}process(e,t,n,r){const i=[];for(const r of e.ops){const o=[];if(null==r?void 0:r.items)for(const e of r.items){const n=this.annotationSequencer.sequence(e.body).then((()=>{t(r,e)}));o.push(n)}i.push(Promise.all(o).then((()=>{n(r,e.cv)})))}Promise.all(i).then((()=>r(e)))}}class Ns{process(e,t,n,r){for(const r of e.ops){if(null==r?void 0:r.items)for(const e of r.items)t(r,e);n(r,e.cv)}r(e)}}class js{constructor(e,t,n){this.isOrderingEnabled=e,this.orderedAnnotationResultsProcessor=null!=t?t:new Ps,this.unorderedAnnotationResultsProcessor=null!=n?n:new Ns}process(e,t,n,r){this.isOrderingEnabled()?this.orderedAnnotationResultsProcessor.process(e,t,n,r):this.unorderedAnnotationResultsProcessor.process(e,t,n,r)}}class Rs{constructor(e){this.hostCallbacks=e}isFeatureEnabled(e,t=!1,n="None"){return this.hostCallbacks&&this.hostCallbacks.isFeatureEnabled?this.hostCallbacks.isFeatureEnabled("Microsoft.Office.AugLoop."+e,n).catch((()=>Promise.resolve(t))):Promise.resolve(t)}isChangeGateEnabled(e){return this.hostCallbacks&&this.hostCallbacks.isChangeGateEnabled?this.hostCallbacks.isChangeGateEnabled(e):Promise.resolve(!1)}}class xs{constructor(e,t,n){this.sessionsByDocSessionId=new Map,this.isDeltaGeneratorEnabled=!1,this.disableSyncDeltaSending=!1,this.hasBeenInitialized=!1,this.telemetryLogger=null,this.settings={annotationsOrderingEnabled:!0,deltaOperationsEnabled:!1,checkIdbByFeatures:!1,defaultBatchingEnabled:!0,batchingWith20msIntervalEnabled:!0,onAnnotationsSubmittedEnabled:!1,httpFallbackEnabled:!1,reduceBatchOperationsEnabled:!1,batchMessagesEnabled:!1,dynamicRateControllerEnabled:!1,removeDuplicateFlights:!0,delayBeforeSocketClose:!0,annotationDoesNotExistOnService:!0},this.isDownloaderCompatible=()=>{if(this.settings.checkIdbByFeatures)return"undefined"!=typeof Array&&void 0!==Array.from&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL;if("undefined"!=typeof navigator&&navigator.userAgent){const e=navigator.userAgent;return!(!e.indexOf||e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0)}return!1},this.workerFactory=e||(e=>e&&e===Eo.HttpFallback?new vo:new yr);const r=this.createDefaultSessionManagerFactory();this.sessionManagerFactory=(...e)=>(null==t?void 0:t(...e))||r(...e),this.sessionFactory=n||(e=>new rs(e))}init(e,t,r,i){var o,a,s,u,c,l,d,f,h;const p=new rr({operationName:"InitRuntime",resourceId:hr(e),dimension1:this.hasBeenInitialized.toString()});p.start(),this.hasBeenInitialized=!0,this.hostCallbacks=r,this.gateUtils=new Rs(this.hostCallbacks),this.clientMetadata=t,this.clientMetadata&&(this.clientMetadata.runtimeVersion=n(872).version),this.telemetryLogger=new pr(this.hostCallbacks),this.shouldAddLogger(p)?(ar.a.addLogger(this.telemetryLogger),this.addLoggingAggregator(i)):(ar.a.clearLoggers(),ar.a.addLogger(this.telemetryLogger)),xs.haveCalledInit=!0,this.annotationResultsProcessor=new js((()=>this.settings.annotationsOrderingEnabled)),this.inferenceServiceFactory=i.inferenceServiceFactory,p.dimension2=Object(ar.c)(Zn.a.info).toString();const g=[];e&&(this.defaultServiceUrl=Ki.convertServiceUrlToWebSocket(e),this.serviceProtocol=this.defaultServiceUrl.split(":")[0].toLowerCase()),g.push(this.isFeatureEnabled("CheckIdbByFeatures",!1).then((e=>{this.settings.checkIdbByFeatures=e}))),g.push(this.isFeatureEnabled("AnnotationsOrderingEnabled",!0).then((e=>{this.settings.annotationsOrderingEnabled=e}))),g.push(this.isFeatureEnabled("DefaultBatchingDisabled").then((e=>{var t;(t=this.settings).defaultBatchingEnabled&&(t.defaultBatchingEnabled=!e)}))),g.push(this.isFeatureEnabled("HttpFallbackEnabled").then((e=>{var t;(t=this.settings).httpFallbackEnabled||(t.httpFallbackEnabled=e)}))),g.push(this.isFeatureEnabled("BatchingWith20msIntervalDisabled").then((e=>{var t;(t=this.settings).batchingWith20msIntervalEnabled&&(t.batchingWith20msIntervalEnabled=!e)}))),g.push(this.isFeatureEnabled("OnAnnotationsSubmittedDisabled").then((e=>{var t;(t=this.settings).onAnnotationsSubmittedEnabled&&(t.onAnnotationsSubmittedEnabled=!e)}))),g.push(this.isFeatureEnabled("ReduceBatchOperationsEnabled").then((e=>{var t;(t=this.settings).reduceBatchOperationsEnabled||(t.reduceBatchOperationsEnabled=e)}))),g.push(this.isFeatureEnabled("BatchMessagesEnabled").then((e=>{var t;(t=this.settings).batchMessagesEnabled||(t.batchMessagesEnabled=e)}))),g.push(this.isFeatureEnabled("DynamicRateControllerEnabled").then((e=>{this.settings.dynamicRateControllerEnabled=e}))),g.push(Ki.isChangeGateEnabled(this.hostCallbacks,"DelayBeforeSocketClose").then((e=>{this.settings.delayBeforeSocketClose=e}))),g.push(Ki.isChangeGateEnabled(this.hostCallbacks,"AnnotationDoesNotExistOnService").then((e=>{this.settings.annotationDoesNotExistOnService=e})));const m={enableDeltas:!1,enableEarlyJoin:!1};g.push(Promise.all([this.isFeatureEnabled("DeltaOperationsEnabled").then((e=>m.enableDeltas=e)).catch((()=>m.enableDeltas=!1)),this.isFeatureEnabled("EarlyJoinCompletionEnabled").then((e=>m.enableEarlyJoin=e)).catch((()=>m.enableEarlyJoin=!1))]).then((()=>{this.localWorkflowManager=new Cs(i.modelDownloader&&this.isDownloaderCompatible()?i.modelDownloader:void 0,this.inferenceServiceFactory,m)})));const y=ws(null!==(o=t.flights)&&void 0!==o?o:"");var b;return this.isDeltaGeneratorEnabled=y.getBooleanValue("Microsoft.Office.WordOnline.AugloopDeltas",null!==(a=i.isDeltaGeneratorEnabled)&&void 0!==a&&a),this.disableSyncDeltaSending=y.getBooleanValue("Microsoft.Office.WordOnline.DisableSyncDeltaSending",null!==(s=i.disableSyncDeltaSending)&&void 0!==s&&s),this.syncDeltaTimeout=y.getIntValue("Microsoft.Office.WordOnline.SyncDeltaTimeout",i.syncDeltaTimeout),(u=this.settings).httpFallbackEnabled||(u.httpFallbackEnabled=y.getBooleanValue("HttpFallbackEnabled",!1)),(c=this.settings).defaultBatchingEnabled&&(c.defaultBatchingEnabled=!y.getBooleanValue("DefaultBatchingDisabled",!1)),(l=this.settings).batchingWith20msIntervalEnabled&&(l.batchingWith20msIntervalEnabled=!y.getBooleanValue("BatchingWith20msIntervalDisabled",!1)),(d=this.settings).reduceBatchOperationsEnabled||(d.reduceBatchOperationsEnabled=y.getBooleanValue("ReduceBatchOperationsEnabled",!1)),(f=this.settings).batchMessagesEnabled||(f.batchMessagesEnabled=y.getBooleanValue("BatchMessagesEnabled",!1)),(h=this.settings).removeDuplicateFlights&&(h.removeDuplicateFlights=y.getBooleanValue("RemoveDuplicateFlights",!0)),p.setDataField("Flights",JSON.stringify(this.settings)),i&&i.loggableUrls&&(b=i.loggableUrls,dr.push(...b)),Promise.all(g).then((()=>{this.batchOptions=i.batchOptions,!this.batchOptions&&this.settings.defaultBatchingEnabled&&(this.batchOptions={delayMs:1,maxInputSize:1e6,delayMsMax:50},this.settings.batchingWith20msIntervalEnabled&&(this.batchOptions.delayMs=20)),this.batchOptions&&!this.batchOptions.delayMsMax&&(this.batchOptions.delayMsMax=50),i&&i.networkMode&&(i.networkMode===Eo.HttpFallback&&(i.networkMode=this.settings.httpFallbackEnabled?Eo.HttpFallback:Eo.JSWebSockets),this.networkMode=i.networkMode,i.networkMode===Eo.LocalWorkflowsOnly&&(this.sessionManagerFactory=()=>new Ya)),p.dimension0=JSON.stringify(this.batchOptions),this.logOperation(p,!0)})).catch((e=>{this.logOperation(p,!1,"Error",e?e.message:"(no error)")}))}getServiceProtocol(){return this.serviceProtocol}registerLocalWorkflow(e){this.localWorkflowManager.registerLocalWorkflow(e)}flushTelemetry(e){ar.a.flushAggregators(e)}createSession(e){var t;const n=e&&e.docSessionId?e.docSessionId:Wa(),r=e&&e.documentId?e.documentId:void 0,i=this.sessionsByDocSessionId.get(n),o=new rr({operationName:"CreateSession",resourceId:n,dimension1:this.hasBeenInitialized.toString()});if(o.start(),i&&!1===i.isClosed)throw this.logOperation(o,!1,"Error","docSessionId already exists"),new Error("docSessionId already exists");let a=e&&null!==(t=e.serviceUrl)&&void 0!==t?t:this.defaultServiceUrl;a=Ki.convertServiceUrlToWebSocket(a),a||((e=e||{}).networkMode=Eo.LocalWorkflowsOnly),!this.networkMode||void 0!==(null==e?void 0:e.networkMode)&&null!==(null==e?void 0:e.networkMode)||((e=e||{}).networkMode=this.networkMode),void 0!==(null==e?void 0:e.networkMode)&&null!==(null==e?void 0:e.networkMode)&&(null==e?void 0:e.networkMode)!==Eo.JSWebSockets||!this.hasHttpFallbackSession()||((e=e||{}).networkMode=Eo.HttpFallback),e&&e.networkMode===Eo.HttpFallback&&(e.networkMode=this.settings.httpFallbackEnabled?Eo.HttpFallback:Eo.JSWebSockets);const s=Object.assign({},this.clientMetadata);s.docSessionId=n,r&&(s.documentId=r),e&&e.flights&&(s.flights=s.flights?s.flights+";"+e.flights:e.flights),this.settings.removeDuplicateFlights&&s.flights&&(s.flights=function(e){if(!e)return"";const t=new Set,n=[];for(const r of e.split(";").reverse()){const e=r.split(":")[0],i=Ss.normalizeName(e);t.has(i)||(t.add(i),n.push(r))}return n.reverse().join(";")}(s.flights)),o.setDataField("Flights",s.flights||"");const u=this.sessionFactory({hostCallbacks:this.hostCallbacks,sessionManager:this.sessionManagerFactory(s,a,e),batchOptions:this.batchOptions,extensionConfigs:(null==e?void 0:e.extensionConfigs)||[],clientMetadata:s,userContext:e?e.userContext:void 0,localWorkflowManager:e&&e.enableComplexLocalWorkflows?void 0:this.localWorkflowManager,annotationResultsProcessor:this.annotationResultsProcessor,localRegisteredWorkflows:(null==e?void 0:e.localRegisteredWorkflows)||[],enableRemoteExecutionNotification:(null==e?void 0:e.enableRemoteExecutionNotification)||!1,networkMode:null==e?void 0:e.networkMode,egress:e?e.egress:void 0,isDeltaGeneratorEnabled:this.isDeltaGeneratorEnabled,onAnnotationsSubmittedEnabled:this.settings.onAnnotationsSubmittedEnabled,disableSyncDeltaSending:this.disableSyncDeltaSending,syncDeltaTimeout:this.syncDeltaTimeout,reduceBatchOperationsEnabled:this.settings.reduceBatchOperationsEnabled,batchMessagesEnabled:this.settings.batchMessagesEnabled,annotationDoesNotExistOnServiceEnabled:this.settings.annotationDoesNotExistOnService});return this.sessionsByDocSessionId.set(n,u),e&&e.onSessionConnect&&u.setConnectCallback(e.onSessionConnect),e&&e.onSessionDisconnect&&u.setDisconnectCallback(e.onSessionDisconnect),e&&e.onSessionReconnect&&u.setReconnectCallback(e.onSessionReconnect),e&&e.onSessionClose&&u.setSessionCloseCallback(e.onSessionClose),e&&e.onServerAuthenticationStateChangeCallback&&u.setServerAuthenticationStateChangeCallback(e.onServerAuthenticationStateChangeCallback),e&&e.onClaimsChallengeCallback&&u.setClaimsChallengeCallback(e.onClaimsChallengeCallback),this.logOperation(o,!0),u.initialize?u.initialize():Promise.resolve(u)}getSessionManagerFactory(){return this.sessionManagerFactory}shouldAddLogger(e){if(xs.haveCalledInit){const t=new Error("Runtime already initialized");return e.dimension3=t.stack,e.dimension2=Object(ar.c)(Zn.a.info).toString(),this.logOperation(e,!1,"Error",t.message),!1}return!0}createDefaultSessionManagerFactory(){return(e,t,n)=>{if(n&&n.enableComplexLocalWorkflows)throw new Error("NYI");if(n&&n.networkMode==Eo.LocalWorkflowsOnly)return new Ya;const r=new us,i=new is;let o=()=>{ar.a.error(573321615,ar.b.CoreDefault,"Unexpectedly not set sendMessage")};const a=new cs((()=>i),e,r,((e,t,n)=>{o(e,t,n)}),{requestAuthToken:this.hostCallbacks.requestAuthToken,overrideSessionInitMessage:this.hostCallbacks.overrideSessionInitMessage,enableRemoteExecutionNotification:(null==n?void 0:n.enableRemoteExecutionNotification)||!1}),s=new Fo(Ki.convertServiceUrlToWebSocket(t),i,this.workerFactory,a,e,r,this.settings,this.gateUtils,null==n?void 0:n.networkMode);return o=s.sendMessage.bind(s),s.on("disconnect",(()=>r.clearRefreshTimeouts())),s.on("connect",((e,t,n,r)=>{e&&this.hostCallbacks.setSessionData&&this.hostCallbacks.setSessionData(t,n,r);const i=t.substring(t.lastIndexOf("/")+1);this.telemetryLogger.setServerSessionKey(i)})),s}}isFeatureEnabled(e,t=!1,n="None"){return Ki.isFeatureEnabled(this.hostCallbacks,e,t,n)}hasHttpFallbackSession(){let e=!1;return this.sessionsByDocSessionId.forEach((t=>{t.isHttpFallback()&&(e=!0)})),e}logOperation(e,t,n,r){e.stop(),e.success=t,e.resultSignature=n,e.resultDescription=r,ar.a.info(573321622,ar.b.CoreDefault,e)}addLoggingAggregator(e){var t,n,r,i;Ki.isChangeGateEnabled(this.hostCallbacks,"AggregateInProductionOnly")&&"Dogfood"===this.clientMetadata.releaseAudienceGroup||(ar.a.addAggregator(fr("Operation","operationName",["ExecuteBatch","ReduceBatchOperations","ProcessResponse","LocalDeltaUpdate","ApplyFormattedTextTileDeltaForLocalWorkflows","ApplyTextTileDeltaForLocalWorkflows","FindRangeForDelta","RunModelForInferencing","GetResource","CreateTextTileDeltaFromItem","NetworkEgressControl","HttpEgress","LongPollNoOp","NetworkRateControllerAbandonedSyncMessage","NetworkRateControllerEgress","NetworkRateControllerQueueItem","NetworkRateControllerOnRateLimitResponse","NetworkRateControllerOnRateLimitError","NetworkRateControllerRateLimitsSet","NetworkRateControllerQueueItem"],null!==(t=e.telemetryAggregationIntervalSec)&&void 0!==t?t:30)),ar.a.addAggregator(fr("Operation","operationName",["ExecuteWorkflow","ExecuteLambda","EarlyJoinCompletion","OnLongPollMessage","OnAnnotationResultsEgress"],null!==(n=e.telemetryAggregationIntervalSec)&&void 0!==n?n:60)),ar.a.addAggregator(fr("Operation","operationName",["LocalScopeExecutionNotification","RunLocalWorkflows","EarlyJoinCompletion","SetAnnotations","WIS.addItemOnContextIdList","WIS.setScopeItem"],null!==(r=e.telemetryAggregationIntervalSec)&&void 0!==r?r:120)),ar.a.addAggregator(fr("SessionHealth","sessionHealthEventName",["SendMessage","ProcessMessage"],null!==(i=e.telemetryAggregationIntervalSec)&&void 0!==i?i:60)))}uninitialize(){this.flushTelemetry(!0),this.hostCallbacks=null,this.hasBeenInitialized=!1,this.telemetryLogger=null,xs.haveCalledInit=!1,ar.a.clearAggregators(),ar.a.clearLoggers()}}new xs;const Ds=(e,t)=>{const n=[];for(const i of Object.keys(e)){if(void 0===e[i]||null===e[i])continue;const o={name:t?`${t}.${i}`:i,dataType:(r=e[i],"string"==typeof r?0:"boolean"==typeof r?1:"number"==typeof r?2:0),value:e[i],classification:4};n.push(o)}var r;return n};const Ms=Object(d.a)("HostCallbacksTransformer");class Ls{constructor(e,t,n,r,i,o){this.hostCallbacksCustomizations=(e,t)=>e,this.hostSettings=e,this.descriptorManager=t,this.telemetrySink=n,this.logger=r,this.clientRuntime=i,this.aggregateLogger=o}withHostCallbacksCustomizations(e){return this.hostCallbacksCustomizations=t=>{let n=t;for(const t of e)n=t(n,this);return n},this}async build(e,t){try{const e=await this.createClientMetadata(),n=this.hostCallbacksCustomizations(this.createHostCallbacks(),this),r=this.createRuntimeOptions();await this.runPreRuntimeInit(e,r),await this.initClientRuntime(e,n,r);return{session:await this.createSession(t),runtime:this.clientRuntime}}catch(e){return this.logger.error(507392469,"Initializing augloop session runtime failed",e),{}}}logAnnotationResultOperation(e){var t;const n=ke.a.getTypeNameFor(e);null===(t=this.aggregateLogger)||void 0===t||t.incrementEventCount(0,JSON.stringify({message:"Operation received",operationType:n,nItems:e.items.length}));for(const t of e.items)this.logAnnotationResultItem(n,t)}logAnnotationResultItem(e,t){var n;const r=t.body?ke.a.getTypeNameFor(t.body):"unknown";null===(n=this.aggregateLogger)||void 0===n||n.incrementEventCount(0,JSON.stringify({message:"Annotation received",annotationType:r,operationType:e}))}async createClientMetadata(){var e,t,n,r,i,o;const a={appName:null!==(t=null===(e=this.hostSettings.hostMetadata)||void 0===e?void 0:e.appName)&&void 0!==t?t:"EditorBX",appPlatform:null!==(r=null===(n=this.hostSettings.hostMetadata)||void 0===n?void 0:n.appPlatform)&&void 0!==r?r:"Online",releaseAudienceGroup:null===(i=this.hostSettings.hostMetadata)||void 0===i?void 0:i.releaseAudienceGroup,uiLanguage:this.hostSettings.defaultLocale,sessionId:null===(o=this.hostSettings.hostMetadata)||void 0===o?void 0:o.sessionId},s=(await this.descriptorManager.buildDescriptors()).find((e=>"FlightIds"===e.name));return s&&(a.flights=s.value),a}createHostCallbacks(){return{onAnnotationResult:e=>{this.logAnnotationResultOperation(e)},isFeatureEnabled:async(e,t)=>{var n;let r;return r=(null===(n=this.hostSettings.orchestratorSettings)||void 0===n?void 0:n.augLoopIsFeatureEnabledCallback)?await this.hostSettings.orchestratorSettings.augLoopIsFeatureEnabledCallback(e,t):"Production"===t,r},onResult:()=>{},executeLocalLambda:async()=>{},areLicenseFeaturesEnabled:async()=>Promise.resolve(!1),requestAuthToken:async e=>{var t;return(async e=>({Token:e?await e():void 0}))(null===(t=this.hostSettings.orchestratorSettings)||void 0===t?void 0:t.augLoopAuthTokenCallback)},sendTelemetryEvent:(e=this.telemetrySink,(t,n,r,i,o,a,s,u)=>{const c="beee531d6e2444fe9a9a1c9aaa5b53cd-78755306-c8fb-4c51-9e77-9eb483e17ceb-6535"===t;let l,d=Ds(r);if(i){let e=Ds(o,i.split(".").slice(-1)[0]);c&&(e=[...e,...d],d=[]),l={name:i,dataFields:e}}const f={telemetryProperties:{ariaTenantToken:t,nexusTenantToken:-1},eventName:n,dataFields:d,eventFlags:{dataCategories:s,diagnosticLevel:u},eventContract:l};e.sendTelemetryEvent(f)})};var e}createRuntimeOptions(){var e;return{telemetryAggregationIntervalSec:100,initSession:!1,batchOptions:(null===(e=this.hostSettings.orchestratorSettings)||void 0===e?void 0:e.enableBatching)?{maxInputSize:128e3,delayMs:50}:void 0}}async runPreRuntimeInit(e,t){var n;(null===(n=this.hostSettings.orchestratorSettings)||void 0===n?void 0:n.preRuntimeInit)&&await Promise.all(this.hostSettings.orchestratorSettings.preRuntimeInit.map((n=>n(e,t))))}async initClientRuntime(e,t,n){await this.clientRuntime.init(this.hostSettings.orchestratorSettings.augLoopEndpoint,e,t,n)}createSession(e){var t;const n=null!==(t=null==e?void 0:e.toString())&&void 0!==t?t:(new x.a).generate();return this.clientRuntime.createSession({docSessionId:n})}}const Bs=Object(d.a)("IClientRuntime");class Fs{constructor(){this.imports=[Xn]}get uniqueId(){return Object(Vn.a)(507918289)}configureRootServices(e){var t;const n=e.get(S.a);(null===(t=n.orchestratorSettings)||void 0===t?void 0:t.enableAugLoop)&&n.orchestratorSettings.augLoopEndpoint&&(e.bind(Bs).toDynamicValue((()=>new xs)),e.bind(jt).toDynamicValue((e=>(t,n)=>{const r=e.get(S.a),i=e.get(Ie.a),a=e.get(b.c),s=e.get(o.a),u=e.getOptional(xe.a),c=((e,t,n,r,i,o)=>new Ls(e,t,n,r,i,o))(r,i,a,s,e.get(Bs),u),l=e.getAll(Ms);return c.withHostCallbacksCustomizations(l),c.build(t,n)})))}}var Us=n(777);const qs=Object(d.a)("IStorage");let zs=class{getItem(e){const t=localStorage.getItem(e);if(t)return t}setItem(e,t){localStorage.setItem(e,t)}clearItem(e){localStorage.removeItem(e)}};zs=Object(le.c)([Object(he.a)()],zs);var Ws=n(85),Vs=n(418),Gs=n(64),Hs=n(102),$s=n(420),Ks=n(192),Js=n(421);const Qs=Object(d.a)("IRemoteSettingsSyncer");var Ys=n(57),Xs=n(142);function Zs(e){const t={value:JSON.stringify(e),lastUpdated:Date.now(),manualOverride:!1};return JSON.stringify(t)}function eu(e){return{descriptors:Zs(e.descriptors),disabledWebSites:Zs(e.disabledWebSites),allowedUrls:Zs(e.allowedUrls),disabledGrammars:Zs(e.disabledGrammars),editorClientState:Zs(e.editorClientState),configurationId:Zs(e.configurationId),featureFlags:Zs(e.featureFlags),dynamicSettings:Zs(e.dynamicSettings),intervalForActivityCleanup:Zs(e.intervalForActivityCleanup),conflictingElements:Zs(e.conflictingElements)}}let tu=class extends Xs.a{constructor(e,t,n,r,i,o,a,s){super(e),this._editorService=t,this._proofingStore=n,this._logger=r,this._userInfoStrategy=i,this._sessionContextProvider=o,this._guidGenerator=a,this._timer=s,this._timerName="RemoteSettingsSyncerTimer"}async initialize(){}shutDown(){this._timer.clearTimer(this._timerName)}schedule(e,t){this._timer.setIntervalWithDelay(this._timerName,(async()=>this.sync()),t,e)}async sync(){this._logger.debug(537518984,"Starting remote settings sync");const e=await this.buildRequest();if(e){const t=await this.fetchRemoteSettings(e);if(t&&t.responseStatus===bt.a.Success){this.logTelemetry(e);const n=eu(t),r=await this.removeManualOverrides(n);if(r)return this._logger.debug(537518985,"Writing remote settings to local storage"),this.writeSettings(r)}}return this._logger.debug(537518986,"No remote settings were synced"),!1}async writeSettings(e){try{return await this._extensionStorage.set(e),!0}catch(e){this._logger.logEvent(537518987,Ys.a.SettingsSyncWriteError,At.a.Error,void 0,s.a.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}return!1}async fetchClientId(){try{const e=await this._proofingStore.read(de.a.ClientId);if(!e||""===e){const e=this._guidGenerator.generate();return await this._proofingStore.write(de.a.ClientId,e),e}return e}catch(e){return""}}async buildRequest(){var e;try{const t=await this._sessionContextProvider();let n,r;const i=await this.fetchClientId(),o=await this._userInfoStrategy.executeAsync(!1);(null==o?void 0:o.userId)?(this._editorService.xUserId=o.userId,n=o.tenantId,r=o.email):this._editorService.xUserId=i;return{appId:await this._proofingStore.read(de.a.AppId),browser:t.browserType,browserVersion:null!==(e=t.browserVersion)&&void 0!==e?e:"",email:r,extensionId:t.extensionVersion,languageUxId:t.languageUxId,storeId:t.extensionStoreId,tenantId:n,firstInstallVersion:void 0}}catch(e){this._logger.logEvent(537518988,Ys.a.SettingsSyncEditorRequestBuildError,At.a.Error,void 0,s.a.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}logTelemetry(e){if(this._lastConfigRequestUserId&&this._lastConfigRequestUserId===this._editorService.xUserId&&this._lastConfigRequest&&this._lastConfigRequest.browserVersion===e.browserVersion&&this._lastConfigRequest.email===e.email&&this._lastConfigRequest.languageUxId===e.languageUxId&&this._lastConfigRequest.tenantId===e.tenantId)return;this._lastConfigRequest=e,this._lastConfigRequestUserId=this._editorService.xUserId;const t=this._logger.getNewActivity(Ys.b.RemoteSettingSync,s.a.SamplingPolicy.CriticalExperimentation);t&&(t.success=!0,t.endNow())}async fetchRemoteSettings(e){var t;try{return await this._editorService.browserextension(e,{requestOptions:{customHeaders:{"X-UserId":null!==(t=this._editorService.xUserId)&&void 0!==t?t:""}}})}catch(e){this._logger.logEvent(537518989,Ys.a.SettingsSyncEditorServiceError,At.a.Error,void 0,s.a.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}async removeManualOverrides(e){const t={};try{const n=await this._extensionStorage.get(e);for(const r of Object.keys(n)){JSON.parse(n[r]).manualOverride?this._logger.debug(537518990,"Manual override for remote setting",r):t[r]=e[r]}}catch(e){return this._logger.logEvent(537518991,Ys.a.SettingsSyncReadOverrideError,At.a.Error,void 0,s.a.SamplingPolicy.CriticalBusinessImpact,e),void this.setLastError(e)}return t}async removePersistentKeys(){const e=Object.keys(eu({}));e.length&&await this._extensionStorage.remove(e)}};tu=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(Gs.a)),Object(le.f)(1,Object(pe.a)(Mn.a)),Object(le.f)(2,Object(pe.a)(K.a)),Object(le.f)(3,Object(pe.a)(o.a)),Object(le.f)(4,Object(pe.a)(N.a)),Object(le.f)(5,Object(pe.a)(a.a)),Object(le.f)(6,Object(pe.a)(R.a)),Object(le.f)(7,Object(pe.a)(M.a))],tu);var nu=n(585),ru=n(868),iu=n(737),ou=n(869),au=n(738),su=n(870),uu=n(442),cu=n(724),lu=n(725),du=n(726),fu=n(398);class hu{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(hu,this,e)}static getTypeName(){return"AugLoop_Copywriter_CopywriterAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[hu.getTypeName()])}}hu.H_={T_:hu.getTypeName(),B_:hu.getBaseTypes()};class pu{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(pu,this,e)}static getTypeName(){return"AugLoop_Copywriter_RewriteStart"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[pu.getTypeName()])}}pu.H_={T_:pu.getTypeName(),B_:pu.getBaseTypes()};class gu{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(gu,this,e)}static getTypeName(){return"AugLoop_Copywriter_RewriteFragment"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[gu.getTypeName()])}}gu.H_={T_:gu.getTypeName(),B_:gu.getBaseTypes()};class mu{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(mu,this,e)}static getTypeName(){return"AugLoop_Copywriter_RewriteComplete"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[mu.getTypeName()])}}mu.H_={T_:mu.getTypeName(),B_:mu.getBaseTypes()};class yu extends Ze{constructor(e,t,n){super(e,t),this._hostEmitter=e,this._logger=t,this._clientSubscriber=n,this.annotationListenerType=hu.getTypeName(),this._onAnnotationResult=e=>{if(!this._activationTokens.length)return void this._logger.error(512508554,"Invalid activation token.");if(!(e.items.length>0))return void this._logger.error(512508553,"Operation items empty.");const t=ke.a.getTypeNameFor(e);if(t!==Fe.getTypeName())return void this._logger.error(512508552,`Unexpected Copywriter annotation operation: ${t}`);this._logger.logActivity("CopywriterAnnotationReady");const n=e.items[0].body,r=e.parentPath[e.parentPath.length-1],i=this._clientSubscriber.getReturnAdress(r);this._hostEmitter.emit(_.a.copywriterSuggestionsReady,{address:i,message:{signalId:r,annotation:n}})}}async activateAnnotations(e,t){await super.activateAnnotationsBase(e,t,(()=>e?[e.activateAnnotation(this.annotationListenerType,{callback:this._onAnnotationResult})]:[]))}}class bu{constructor(e){ke.a.assign(bu,this,e)}static getTypeName(){return"AugLoop_Copywriter_CopywriterSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[bu.getTypeName()])}}bu.H_={T_:bu.getTypeName(),B_:bu.getBaseTypes()};class vu{constructor(e){ke.a.assign(vu,this,e)}static getTypeName(){return"AugLoop_Copywriter_RewriteSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[vu.getTypeName()])}}vu.H_={T_:vu.getTypeName(),B_:vu.getBaseTypes()};let wu=class{constructor(e,t,n){this._hostEmitter=e,this._logger=t,this._featureFlagsReader=n,this._signalIdToAddressMap=new Map,this._onCopywriterRequestSuggestions=async e=>{if(!this._sessionsProvider)return;const t=await this._sessionsProvider.getOrCreateSession(e.address);if(!t)return;const{text:n,types:r,signalId:i}=e.message,o=new bu({text:n,types:r});t.submitSignal(o,i),this._signalIdToAddressMap.set(i,e.address),this._logger.logActivity("CopywriterSignalSent")}}register(e){this._sessionsProvider=e,this._hostEmitter.on(_.a.copywriterRequestSuggestions,this._onCopywriterRequestSuggestions)}unregister(){this._hostEmitter.off(_.a.copywriterRequestSuggestions,this._onCopywriterRequestSuggestions)}createAnnotationListener(){return new yu(this._hostEmitter,this._logger,this)}onInitialize(e){}onSessionReconnected(e){}onDocumentCreated(e,t){}getReturnAdress(e){return this._signalIdToAddressMap.get(e)}get isEnabled(){return this._featureFlagsReader.flags.enableCopywriter}};wu=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(_.b)),Object(le.f)(1,Object(pe.a)(o.a)),Object(le.f)(2,Object(pe.a)(v.a))],wu);class Su{constructor(){this.imports=[]}get uniqueId(){return Object(Vn.a)(507918232)}configureRootServices(e){e.bind(Re).to(wu)}}var _u=n(612);class Tu{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(Tu,this,e)}static getTypeName(){return"AugLoop_AiInsert_AiInsertAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Tu.getTypeName()])}}Tu.H_={T_:Tu.getTypeName(),B_:Tu.getBaseTypes()};class Ou{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(Ou,this,e)}static getTypeName(){return"AugLoop_AiInsert_AiInsertAnnotationV2"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Ou.getTypeName()])}}Ou.H_={T_:Ou.getTypeName(),B_:Ou.getBaseTypes()};class Cu{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(Cu,this,e)}static getTypeName(){return"AugLoop_AiInsert_AiInsertStreamChunkAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Cu.getTypeName()])}}Cu.H_={T_:Cu.getTypeName(),B_:Cu.getBaseTypes()};class Eu{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ke.a.assign(Eu,this,e)}static getTypeName(){return"AugLoop_AiInsert_AiInsertStreamCompletedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Eu.getTypeName()])}}Eu.H_={T_:Eu.getTypeName(),B_:Eu.getBaseTypes()};class Iu extends Ze{constructor(e,t,n){super(e,t),this._hostEmitter=e,this._logger=t,this._clientSubscriber=n,this.annotationListenerType=Ou.getTypeName(),this._onAnnotationResult=e=>{if(!(e.items.length>0))return void this._logger.error(509219742,"AI Insert: Operation items empty.");const t=ke.a.getTypeNameFor(e);if(t!==Fe.getTypeName())return void this._logger.error(509219741,`Unexpected AI Insert annotation operation: ${t}`);const n=e.items[0].body,r=e.parentPath[e.parentPath.length-1],i=this._clientSubscriber.getReturnAdress(r);this._hostEmitter.emit(_.a.aiInsertSuggestionsReady,{address:i,message:{signalId:r,annotation:n}})}}async activateAnnotations(e,t){await super.activateAnnotationsBase(e,t,(()=>e?[e.activateAnnotation(this.annotationListenerType,{callback:this._onAnnotationResult})]:[]))}}class ku{constructor(e){ke.a.assign(ku,this,e)}static getTypeName(){return"AugLoop_AiInsert_AiInsertSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[ku.getTypeName()])}}ku.H_={T_:ku.getTypeName(),B_:ku.getBaseTypes()};class Au{constructor(e){ke.a.assign(Au,this,e)}static getTypeName(){return"AugLoop_AiInsert_AiInsertSignalV2"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Au.getTypeName()])}}Au.H_={T_:Au.getTypeName(),B_:Au.getBaseTypes()};class Pu{constructor(e){ke.a.assign(Pu,this,e)}static getTypeName(){return"AugLoop_AiInsert_LimitCount"}static getBaseTypes(){return[]}static typeGuard(e){return ke.a.matchesTypesFor(e,[Pu.getTypeName()])}}Pu.H_={T_:Pu.getTypeName(),B_:Pu.getBaseTypes()};let Nu=class{constructor(e,t,n){this._hostEmitter=e,this._logger=t,this._featureFlagsReader=n,this._signalIdToAddressMap=new Map,this._onAiInsertRequestSuggestions=async e=>{if(!this._sessionsProvider)return;const t=await this._sessionsProvider.getOrCreateSession(e.address);if(!t)return void this._logger.error(509219740,"No AL session found");const{precedingTexts:n,userPrompt:r,followingTexts:i,signalId:o,siteName:a,limitCount:s}=e.message,u=new Au({precedingTexts:n,userPrompt:r,followingTexts:i,siteName:a,limitCount:s});t.submitSignal(u,o),this._signalIdToAddressMap.set(o,e.address)}}register(e){this._sessionsProvider=e,this._hostEmitter.on(_.a.aiInsertRequestSuggestions,this._onAiInsertRequestSuggestions)}unregister(){this._hostEmitter.off(_.a.aiInsertRequestSuggestions,this._onAiInsertRequestSuggestions)}createAnnotationListener(){return new Iu(this._hostEmitter,this._logger,this)}onInitialize(e){}onSessionReconnected(e){}onDocumentCreated(e,t){}getReturnAdress(e){return this._signalIdToAddressMap.get(e)}get isEnabled(){return this._featureFlagsReader.flags.enableAiInsert}};Nu=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(_.b)),Object(le.f)(1,Object(pe.a)(o.a)),Object(le.f)(2,Object(pe.a)(v.a))],Nu);class ju{constructor(){this.imports=[]}get uniqueId(){return Object(Vn.a)(507918428)}configureRootServices(e){e.bind(Re).to(Nu)}}var Ru=n(134),xu=n(865),Du=n(656),Mu=n(133),Lu=(n(304),n(258)),Bu=n(455),Fu=n(108),Uu=n(28),qu=n(31),zu=n(213);function Wu(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Vu(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Wu(o,r,i,a,s,"next",e)}function s(e){Wu(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Gu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hu(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var $u=function(){function e(t,n,r,i,o,a,s,u,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_userInfoStrategy",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_contentScriptEmitter",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_settingsEmitter",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"_systemPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"_browserStorage",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_remoteSettingsSyncer",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"_logger",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"_announcementsPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:u}),Object.defineProperty(this,"_clientStateEmitter",{enumerable:!0,configurable:!0,writable:!0,value:c});var l,d=this;Object.defineProperty(this,"_onUserInfoChangedCallback",{enumerable:!0,configurable:!0,writable:!0,value:(l=Vu((function(e,t){return Hu(this,(function(n){return[2,d._onUserInfoChanged(e,t)]}))})),function(e,t){return l.apply(this,arguments)})}),Object.defineProperty(this,"_clientState",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}var t,n,r;return t=e,n=[{key:"emitUserRelatedInformation",value:function(e){var t=this;return Vu((function(){var n;return Hu(this,(function(r){switch(r.label){case 0:return[4,t._getUserInfo()];case 1:return(n=r.sent())?[4,t._updateHadSubscription(n.licenseType)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[4,t._emitClientState(n,e)];case 4:return r.sent(),[2,n]}}))}))()}},{key:"_getUserInfo",value:function(){var e=this;return Vu((function(){var t,n;return Hu(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e._userInfoStrategy.executeAsync(!0)];case 1:return t=r.sent(),[3,3];case 2:return n=r.sent(),e._logger.debug(509646467,"client state reset to default (".concat(JSON.stringify(n),")")),[3,3];case 3:return[2,t]}}))}))()}},{key:"_updateHadSubscription",value:function(e){var t=this;return Vu((function(){return Hu(this,(function(n){switch(n.label){case 0:return e!==Ln.c.Subscription?[3,5]:[4,t._announcementsPersistedStore.read(qu.a.PostUpsellAnnouncementHadSubscription)];case 1:return n.sent()?[3,4]:[4,t._announcementsPersistedStore.write(qu.a.PostUpsellAnnouncementVisible,!0)];case 2:return n.sent(),[4,t._announcementsPersistedStore.write(qu.a.PostUpsellAnnouncementHadSubscription,!0)];case 3:n.sent(),n.label=4;case 4:return[3,8];case 5:return void 0===e?[3,8]:[4,t._announcementsPersistedStore.write(qu.a.PostUpsellAnnouncementVisible,!1)];case 6:return n.sent(),[4,t._announcementsPersistedStore.write(qu.a.PostUpsellAnnouncementHadSubscription,!1)];case 7:n.sent(),n.label=8;case 8:return[2]}}))}))()}},{key:"_emitClientState",value:function(e,t){var n=this;return Vu((function(){var r,i,o,a;return Hu(this,(function(s){switch(s.label){case 0:if(r={state:g.a.Undefined,conflictDetected:!1,conflictDetectionAnnouncementDismissed:!1,editorPriorityShutdown:!1,isLoggedIn:!1,identityProvider:Ln.b.AAD,licenseType:void 0},!e)return[3,7];s.label=1;case 1:return s.trys.push([1,6,,7]),i={},[4,n._systemPersistedStore.read(l.a.EditorClientState)];case 2:return i.state=s.sent(),[4,n._systemPersistedStore.read(l.a.ConflictDetected)];case 3:return i.conflictDetected=s.sent(),[4,n._systemPersistedStore.read(l.a.ConflictDetectionAnnouncementDismissed)];case 4:return i.conflictDetectionAnnouncementDismissed=s.sent(),[4,n._systemPersistedStore.read(l.a.EditorPriorityShutdown)];case 5:return i.editorPriorityShutdown=s.sent(),i.isLoggedIn=!!e.userId,i.identityProvider=e.identityProvider,i.licenseType=e.licenseType,i.roamingToken=e.roamingToken,i.augLoopToken=e.augLoopToken,i.ageGroup=e.ageGroup,i.ctry=e.ctry,r=i,[3,7];case 6:return o=s.sent(),n._logger.error(509646466,"Error while assigning new client state (".concat(JSON.stringify(o),")")),[3,7];case 7:return a=n._didClientStateChange(r),n._clientState=r,a?(n._clientStateEmitter.emit("clientStateUpdated",n._clientState),[4,n._remoteSettingsSyncer.sync()]):[3,9];case 8:s.sent(),n._sendClientStateTelemetry(r),s.label=9;case 9:return n._sendClientStateMessage(n._clientState,t),[2]}}))}))()}},{key:"initialize",value:function(){var e=this;return Vu((function(){return Hu(this,(function(t){var n;return e._browserStorage.addChangeListener(e._onUserInfoChangedCallback),e._settingsEmitter.on(l.a.EditorClientState,Vu((function(){return Hu(this,(function(t){return e.emitUserRelatedInformation(),[2]}))}))),e._settingsEmitter.on(l.a.EditorPriorityShutdown,Vu((function(){return Hu(this,(function(t){return e.emitUserRelatedInformation(),[2]}))}))),e._contentScriptEmitter.on(Uu.a.getClientState,(n=Vu((function(t){var n;return Hu(this,(function(r){switch(r.label){case 0:return[4,e._getUserInfo()];case 1:return n=r.sent(),e._emitClientState(n,t.address),[2]}}))})),function(e){return n.apply(this,arguments)})),[2]}))}))()}},{key:"shutDown",value:function(){this._browserStorage.removeEventListener(this._onUserInfoChangedCallback)}},{key:"_onUserInfoChanged",value:function(e,t){var n=this;return Vu((function(){return Hu(this,(function(t){var r;return Object.keys(e).forEach((r=Vu((function(e){return Hu(this,(function(t){return"userInfo"!==e&&"identity"!==e&&"userType"!==e||n.emitUserRelatedInformation(),[2]}))})),function(e){return r.apply(this,arguments)})),[2]}))}))()}},{key:"_sendClientStateMessage",value:function(e,t){this._contentScriptEmitter.emit(Uu.a.clientState,{address:t,message:e})}},{key:"_didClientStateChange",value:function(e){var t,n,r,i,o,a,s=(null===(n=null===(t=this._clientState)||void 0===t?void 0:t.roamingToken)||void 0===n?void 0:n.accessToken)!==(null===(r=e.roamingToken)||void 0===r?void 0:r.accessToken),u=(null===(o=null===(i=this._clientState)||void 0===i?void 0:i.augLoopToken)||void 0===o?void 0:o.accessToken)!==(null===(a=e.augLoopToken)||void 0===a?void 0:a.accessToken);return!this._clientState||e.editorPriorityShutdown!==this._clientState.editorPriorityShutdown||e.isLoggedIn!==this._clientState.isLoggedIn||e.state!==this._clientState.state||e.ageGroup!==this._clientState.ageGroup||e.ctry!==this._clientState.ctry||s||u}},{key:"_sendClientStateTelemetry",value:function(e){var t,n=this._logger.getNewActivity(u.b.ClientStateChanged,s.a.SamplingPolicy.CriticalBusinessImpact);n&&((t=n.dataFields).push.apply(t,[{name:"Is_LoggedIn",dataType:s.a.DataFieldType.Boolean.valueOf(),value:e.isLoggedIn,classification:s.a.DataClassification.SystemMetadata},{name:"EditorPriority_Shutdown",dataType:s.a.DataFieldType.Boolean.valueOf(),value:e.editorPriorityShutdown,classification:s.a.DataClassification.SystemMetadata},{name:"Editor_Client_State",dataType:s.a.DataFieldType.Int64.valueOf(),value:e.state,classification:s.a.DataClassification.SystemMetadata}]),n.success=!0,n.endNow())}}],n&&Gu(t.prototype,n),r&&Gu(t,r),e}();$u=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(N.a)),Object(le.f)(1,Object(pe.a)(Uu.b)),Object(le.f)(2,Object(pe.a)(Ws.a)),Object(le.f)(3,Object(pe.a)(c.a)),Object(le.f)(4,Object(pe.a)(Gs.a)),Object(le.f)(5,Object(pe.a)(Qs)),Object(le.f)(6,Object(pe.a)(o.a)),Object(le.f)(7,Object(pe.a)(zu.a)),Object(le.f)(8,Object(pe.a)(Fu.a)),Object(le.e)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,Object])],$u);var Ku=n(494),Ju=n(307),Qu=n(308),Yu=n(135),Xu=Object(d.a)("ITabsSelector");function Zu(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function ec(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Zu(o,r,i,a,s,"next",e)}function s(e){Zu(o,r,i,a,s,"throw",e)}a(void 0)}))}}function tc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nc(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var rc=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_tabsSelector",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_logger",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"ports",{enumerable:!0,configurable:!0,writable:!0,value:{}})}var t,n,r;return t=e,(n=[{key:"registerPort",value:function(e){var t,n,r=this;if(void 0!==(null===(n=null===(t=e.sender)||void 0===t?void 0:t.tab)||void 0===n?void 0:n.id)){var i=e.sender.frameId?Number("".concat(e.sender.tab.id).concat(e.sender.frameId)):e.sender.tab.id;this.ports[i]=e,e.onDisconnect.addListener((function(){return delete r.ports[i.toString()]}))}}},{key:"sendMessage",value:function(e){var t=this;return ec((function(){var n,r,i,o,a,s,u,c,l,d,f,h,p,g,m,y,b;return nc(this,(function(v){switch(v.label){case 0:n=[],i=!0,o=!1,a=void 0,v.label=1;case 1:v.trys.push([1,10,11,12]),s=e.data[Symbol.iterator](),v.label=2;case 2:return(i=(u=s.next()).done)?[3,9]:0!==(c=u.value).address?[3,5]:void 0!==r?[3,4]:[4,t._tabsSelector.getCurrentTabId()];case 3:r=v.sent(),v.label=4;case 4:return void 0===r?(t._logger.debug(509646465,"Can't find current tab id."),[3,8]):(t.trySendMessage(r,e),[3,8]);case 5:return void 0===c.address||"number"!=typeof c.address||-1!==n.indexOf(c.address)?[3,6]:(n.push(c.address),(l=t.ports[c.address.toString()])?l.postMessage(e):t.trySendMessage(Number(c.address),e),[3,8]);case 6:return void 0!==c.address?[3,8]:[4,t._tabsSelector.getSupportedTabs()];case 7:d=v.sent(),f=!0,h=!1,p=void 0;try{for(g=d[Symbol.iterator]();!(f=(m=g.next()).done);f=!0)y=m.value,t.trySendMessage(y,e)}catch(e){h=!0,p=e}finally{try{f||null==g.return||g.return()}finally{if(h)throw p}}v.label=8;case 8:return i=!0,[3,2];case 9:return[3,12];case 10:return b=v.sent(),o=!0,a=b,[3,12];case 11:try{i||null==s.return||s.return()}finally{if(o)throw a}return[7];case 12:return[2]}}))}))()}},{key:"trySendMessage",value:function(e,t){return ec((function(){return nc(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,chrome.tabs.sendMessage(e,t)];case 1:case 2:return n.sent(),[3,3];case 3:return[2]}}))}))()}}])&&tc(t.prototype,n),r&&tc(t,r),e}();rc=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(Xu)),Object(le.f)(1,Object(pe.a)(o.a)),Object(le.e)("design:paramtypes",[Object,Object])],rc);var ic=n(252),oc=n(576),ac=n(577),sc=n(578),uc=n(309),cc=n(310),lc=n(253),dc=n(254),fc=n(255),hc=n(13);function pc(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function gc(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){pc(o,r,i,a,s,"next",e)}function s(e){pc(o,r,i,a,s,"throw",e)}a(void 0)}))}}function mc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yc(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var bc=function(){function e(t,n,r,i,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_clientStateEmitter",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_featureFlagsReader",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_proofingPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"_settingsEmitter",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"_systemPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:o});var a=this;Object.defineProperty(this,"_updateSettings",{enumerable:!0,configurable:!0,writable:!0,value:gc((function(){return yc(this,(function(e){switch(e.label){case 0:return[4,a._featureFlagsReader.refreshFlags()];case 1:return e.sent(),[4,a._disableOptionalTelemetryIfNeeded()];case 2:return e.sent(),[4,a._addOrRemoveUnInstallPage()];case 3:return e.sent(),[2]}}))}))});var s=this;Object.defineProperty(this,"_disableOptionalTelemetryIfNeeded",{enumerable:!0,configurable:!0,writable:!0,value:gc((function(){return yc(this,(function(e){switch(e.label){case 0:return s._featureFlagsReader.flags.enableBxTelemetry?[3,2]:[4,s._proofingPersistedStore.write(de.a.EnableTelemetry,!1)];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))});var u=this;Object.defineProperty(this,"_addOrRemoveUnInstallPage",{enumerable:!0,configurable:!0,writable:!0,value:gc((function(){return yc(this,(function(e){switch(e.label){case 0:return[4,u._systemPersistedStore.write(l.a.EnableUninstallSurvey,u._featureFlagsReader.flags.enableUninstallSurvey)];case 1:return e.sent(),[2]}}))}))})}var t,n,r;return t=e,(n=[{key:"initialize",value:function(){var e=this;return gc((function(){return yc(this,(function(t){return e._settingsEmitter.on(hc.a.FeatureFlags,e._updateSettings),e._clientStateEmitter.on("clientStateUpdated",e._updateSettings),e._updateSettings(),[2]}))}))()}},{key:"shutDown",value:function(){}}])&&mc(t.prototype,n),r&&mc(t,r),e}();function vc(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function wc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sc(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}bc=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(Fu.a)),Object(le.f)(1,Object(pe.a)(v.a)),Object(le.f)(2,Object(pe.a)(K.a)),Object(le.f)(3,Object(pe.a)(Ws.a)),Object(le.f)(4,Object(pe.a)(c.a)),Object(le.e)("design:paramtypes",[Object,Object,Object,Object,Object])],bc);var _c=function(){function e(t,n,r,i,o){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_featureFlagsReader",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_copywriterEnabled",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_aiInsertEnabled",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"_hostEmitter",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"_settingsEmitter",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"backgroundEventHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"onSettingsChange",{enumerable:!0,configurable:!0,writable:!0,value:function(){a.backgroundEventHandlers.forEach((function(e){return e(a.check())})),a._hostEmitter.emit(_.a.conditionalOrchestratorSettingsChanged,{address:void 0,message:void 0})}})}var t,n,r;return t=e,n=[{key:"initialize",value:function(){var e,t=this;return(e=function(){return Sc(this,(function(e){return t._settingsEmitter.on(hc.a.FeatureFlags,t.onSettingsChange),t._settingsEmitter.on(de.a.OverriddenInlineEditingSettings,t.onSettingsChange),t._settingsEmitter.on(de.a.EnableSynonymsToggle,t.onSettingsChange),[2]}))},function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){vc(o,r,i,a,s,"next",e)}function s(e){vc(o,r,i,a,s,"throw",e)}a(void 0)}))})()}},{key:"shutDown",value:function(){}},{key:"check",value:function(){return this._featureFlagsReader.flags.enableOrchestration||this._copywriterEnabled.check()||this._aiInsertEnabled.check()}}],n&&wc(t.prototype,n),r&&wc(t,r),e}();function Tc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oc(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Cc(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Oc(o,r,i,a,s,"next",e)}function s(e){Oc(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Ec(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ic(e,t,n){return Ic="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=kc(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n||e):i.value}},Ic(e,t,n||e)}function kc(e){return kc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},kc(e)}function Ac(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?Tc(e):t;var n}function Pc(e,t){return Pc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Pc(e,t)}function Nc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kc(e);if(t){var i=kc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ac(this,n)}}function jc(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}_c=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(v.a)),Object(le.f)(1,Object(pe.a)(fu.a)),Object(le.f)(2,Object(pe.a)(_u.a)),Object(le.f)(3,Object(pe.a)(_.b)),Object(le.f)(4,Object(pe.a)(Ws.a)),Object(le.e)("design:paramtypes",[Object,fu.a,_u.a,Object,Object])],_c);var Rc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pc(e,t)}(o,e);var t,n,r,i=Nc(o);function o(e,t,n,r,a,s,u,c,l,d,f,h){var p,g;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),p=i.call(this,n,r,a,s,u,c,l,d,f,h),Object.defineProperty(Tc(p),"_conditionalOrchestratorEnabled",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(Tc(p),"_featureFlagsReader",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(Tc(p),"_initialized",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Tc(p),"_originalClientSubscribers",{enumerable:!0,configurable:!0,writable:!0,value:void 0});var m=Tc(p);Object.defineProperty(Tc(p),"initialize",{enumerable:!0,configurable:!0,writable:!0,value:Cc((function(){var e;return jc(this,(function(t){return m._initialized?[2]:(m._clientSubscribers=m._enabledClientSubscribers,(null===(e=m._hostSettings.orchestratorSettings)||void 0===e?void 0:e.enableAugLoop)&&m._hostSettings.orchestratorSettings.augLoopEndpoint&&0!==m._clientSubscribers.length?(m._hostSettings.enableOrchestration&&(m._logger.log(509646658,At.a.Info,"Initializing Orchestrator."),m._hostEmitter.on(_.a.hostModelParagraphTextTiles,m._handleTiles),m._hostEmitter.on(_.a.hostModelDelta,m._handleDelta),m._hostEmitter.on(_.a.hostModelTextTile,m._handleTile),m._hostEmitter.on(_.a.hostModelMoveTextTile,m._handleMove)),m._clientSubscribers.forEach((function(e){return e.register(m,m._augloopDocumentSerializer)})),m._initialized=!0,[2]):[2])}))}))}),Object.defineProperty(Tc(p),"shutDown",{enumerable:!0,configurable:!0,writable:!0,value:function(){p._initialized&&(Ic((Tc(p),kc(o.prototype)),"shutDown",p).call(p),p._initialized=!1)}});var y=Tc(p);return Object.defineProperty(Tc(p),"onSettingsChange",{enumerable:!0,configurable:!0,writable:!0,value:Cc((function(){var e;return jc(this,(function(t){switch(t.label){case 0:return[4,y._featureFlagsReader.refreshFlags()];case 1:return t.sent(),(null===(e=y._conditionalOrchestratorEnabled)||void 0===e?void 0:e.check())?(y._clientSubscribers.length!==y._enabledClientSubscribers.length&&y.shutDown(),y.initialize()):y.shutDown(),[2]}}))}))}),p._originalClientSubscribers=c,null===(g=p._conditionalOrchestratorEnabled)||void 0===g||g.backgroundEventHandlers.push(p.onSettingsChange),p}return t=o,(n=[{key:"_enabledClientSubscribers",get:function(){return this._originalClientSubscribers.filter((function(e){return e.isEnabled}))}}])&&Ec(t.prototype,n),r&&Ec(t,r),o}(Xt);Rc=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(_c)),Object(le.f)(0,Object(Et.a)()),Object(le.f)(1,Object(pe.a)(v.a)),Object(le.f)(2,Object(pe.a)(_.b)),Object(le.f)(3,Object(pe.a)(S.a)),Object(le.f)(4,Object(pe.a)(o.a)),Object(le.f)(5,Object(pe.a)(H.b)),Object(le.f)(6,Object(pe.a)(F.a)),Object(le.f)(7,Object(ge.a)(Re)),Object(le.f)(7,Object(Et.a)()),Object(le.f)(8,Object(pe.a)(Qt)),Object(le.f)(8,Object(Et.a)()),Object(le.f)(9,Object(Et.a)()),Object(le.f)(9,Object(pe.a)(xe.a)),Object(le.f)(10,Object(Et.a)()),Object(le.f)(10,Object(pe.a)(jt)),Object(le.f)(11,Object(Et.a)()),Object(le.f)(11,Object(pe.a)(Yt)),Object(le.e)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Array,Object,Object,Function,Object])],Rc);var xc=n(90);function Dc(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Mc(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Dc(o,r,i,a,s,"next",e)}function s(e){Dc(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Lc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bc(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Fc=function(){function e(t,n,r,i,o){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_browserStorage",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_contentScriptEmitter",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_store",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"_featureFlagsReader",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"_logger",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"usageInfo",{enumerable:!0,configurable:!0,writable:!0,value:xc.e});var s=this;Object.defineProperty(this,"saveValue",{enumerable:!0,configurable:!0,writable:!0,value:Mc((function(){var e;return Bc(this,(function(t){switch(t.label){case 0:return e=JSON.stringify(s.usageInfo),[4,s._store.write(l.a.EvaluationData,e)];case 1:return t.sent(),[2]}}))}))}),Object.defineProperty(this,"showFPSSurvey",{enumerable:!0,configurable:!0,writable:!0,value:function(e){var t;a.usageInfo.fpsSurvey.shownTimes+=1,a.usageInfo.fpsSurvey.lastShown=new Date;var n=null===(t=a.usageInfo.seenEvents)||void 0===t?void 0:t.slice(-3);a._contentScriptEmitter.emit(Uu.a.showFpsSurveyPrompt,{address:e,message:null!=n?n:[]}),a.usageInfo.seenEvents=[]}});var u=this;Object.defineProperty(this,"onSuggestionAccepted",{enumerable:!0,configurable:!0,writable:!0,value:Mc((function(){var e,t,n,r,i=arguments;return Bc(this,(function(o){switch(o.label){case 0:for(e=i.length,t=new Array(e),n=0;n<e;n++)t[n]=i[n];return[4,u._store.read(l.a.EvaluationData)];case 1:return r=o.sent(),u.usageInfo=JSON.parse(r),t[0]&&Object(xc.i)(u.usageInfo,t[0].message),u._featureFlagsReader.flags.enableNotifications&&Object(xc.f)(u.usageInfo)?(u._browserStorage.get("userType").then((function(e){var n=e.userType,r=u._featureFlagsReader.flags.enableRateExtensionPromptFpsSurvey,i=u._featureFlagsReader.flags.enableRateExtensionPrompt||u._featureFlagsReader.flags.enableRateExtensionPromptEdge;Object(xc.g)(u.usageInfo,r,n)&&t[0]?u.showFPSSurvey(t[0].address):Object(xc.h)(u.usageInfo,i)&&t[0]&&(u.usageInfo.shownTimes+=1,u.usageInfo.lastShown=new Date,u._contentScriptEmitter.emit(Uu.a.showGenericRatingPrompt,{address:t[0].address,message:void 0})),u.saveValue()})),[2]):[2]}}))}))});var c=this;Object.defineProperty(this,"onAutoCorrectionTriggered",{enumerable:!0,configurable:!0,writable:!0,value:Mc((function(){return Bc(this,(function(e){switch(e.label){case 0:return[4,c.recordSeenEventsForFPS({address:void 0,message:"Autocorrect"})];case 1:return e.sent(),c._featureFlagsReader.flags.enableNotifications&&Object(xc.f)(c.usageInfo)?(c._browserStorage.get("userType").then((function(e){var t=c._featureFlagsReader.flags.enableRateExtensionPromptFpsSurvey,n=e.userType;Object(xc.g)(c.usageInfo,t,n)&&(c.showFPSSurvey(0),c.saveValue())})),[2]):[2]}}))}))});var d,f=this;Object.defineProperty(this,"recordSeenEventsForFPS",{enumerable:!0,configurable:!0,writable:!0,value:(d=Mc((function(e){return Bc(this,(function(t){switch(t.label){case 0:return f.usageInfo.seenEvents&&"number"!=typeof f.usageInfo.seenEvents||(f.usageInfo.seenEvents=[]),Object(xc.d)(f.usageInfo)?(f.usageInfo.seenEvents.push(e.message),[4,f.saveValue()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))})),function(e){return d.apply(this,arguments)})})}var t,n,r;return t=e,(n=[{key:"initialize",value:function(){var e=this;return Mc((function(){var t;return Bc(this,(function(n){switch(n.label){case 0:return[4,e._store.read(l.a.EvaluationData)];case 1:t=n.sent();try{e.usageInfo=JSON.parse(t)}catch(n){e._logger.debug(508044235,"Failed to parse evaluation data. Starting from default value.",t)}return e._contentScriptEmitter.on(Uu.a.suggestionAccepted,e.onSuggestionAccepted),e._contentScriptEmitter.on(_.a.autoCorrectionTriggered,e.onAutoCorrectionTriggered),e._contentScriptEmitter.on(Uu.a.seenEventTriggered,e.recordSeenEventsForFPS),[2]}}))}))()}},{key:"shutDown",value:function(){}}])&&Lc(t.prototype,n),r&&Lc(t,r),e}();Fc=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(Gs.a)),Object(le.f)(1,Object(pe.a)(Uu.b)),Object(le.f)(2,Object(pe.a)(c.a)),Object(le.f)(3,Object(pe.a)(v.a)),Object(le.f)(4,Object(pe.a)(o.a)),Object(le.e)("design:paramtypes",[Object,Object,Object,Object,Object])],Fc);var Uc,qc=n(791);function zc(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Wc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vc(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Gc=Uc=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_dmp",{enumerable:!0,configurable:!0,writable:!0,value:new qc.diff_match_patch}),Object.defineProperty(this,"handleMessage",{enumerable:!0,configurable:!0,writable:!0,value:function(e,n,r){r(t.executeMessage(e))}}),Object.defineProperty(this,"executeMessage",{enumerable:!0,configurable:!0,writable:!0,value:function(e){try{var n=e;return!n.eventId||"indexReadjuster"!==n.eventId||{result:t.remapIndices(n.text1,n.text2,n.sortedIndices)}}catch(e){return{error:e}}}}),Object.defineProperty(this,"remapIndices",{enumerable:!0,configurable:!0,writable:!0,value:function(e,n,r){var i=t._dmp.diff_main(e,n);if(1===i.length&&0===i[0][0])return r;var o=[],a=0,s=0,u=0,c=0,l=0,d=0,f=!0,h=!1,p=void 0;try{for(var g,m=i[Symbol.iterator]();!(f=(g=m.next()).done);f=!0){var y=g.value,b=y[0],v=y[1].length;switch(b){case 0:l=v,d=v;break;case 1:l=0,d=v;break;case-1:u+=v;continue}s+=u,u=0;for(var w=a;w<r.length;w+=1){var S=Uc.getIndex(r[w]);if(S<c)throw new Error("Indices are not sorted!");if(!(S>=c&&S<c+d))break;o[w]=0===b?Uc.getNewValue(r[w],S+s-c):Uc.getNewValue(r[w],s),a+=1}if(a===r.length)break;s+=l,c+=d}}catch(e){h=!0,p=e}finally{try{f||null==m.return||m.return()}finally{if(h)throw p}}for(var _=a;_<r.length;_+=1)o[_]=Uc.getNewValue(r[_],s);return o}}),this._dmp.Diff_Timeout=0}var t,n,r;return t=e,n=[{key:"initialize",value:function(){var e,t=this;return(e=function(){return Vc(this,(function(e){return chrome.runtime.onMessage.addListener(t.handleMessage),[2]}))},function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){zc(o,r,i,a,s,"next",e)}function s(e){zc(o,r,i,a,s,"throw",e)}a(void 0)}))})()}},{key:"shutDown",value:function(){chrome.runtime.onMessage.removeListener(this.handleMessage)}}],n&&Wc(t.prototype,n),r&&Wc(t,r),e}();function Hc(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function $c(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Hc(o,r,i,a,s,"next",e)}function s(e){Hc(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Kc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jc(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.defineProperty(Gc,"getIndex",{enumerable:!0,configurable:!0,writable:!0,value:function(e){return e.index>=0?e.index:e}}),Object.defineProperty(Gc,"getNewValue",{enumerable:!0,configurable:!0,writable:!0,value:function(e,t){return e.index>=0?(e.index=t,e):e=t}}),Gc=Uc=Object(le.c)([Object(he.a)(),Object(le.e)("design:paramtypes",[])],Gc);var Qc=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_systemPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"settingsEmitter",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_clientStateInitValue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_clientStateLastValue",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}var t,n,r;return t=e,(n=[{key:"detect",value:function(e){var t=this;return $c((function(){return Jc(this,(function(n){switch(n.label){case 0:return"update"!==e.reason&&"chrome_update"!==e.reason||t._clientStateInitValue!==g.a.Undefined?[3,5]:(t._clientStateInitValue=g.a.Disabled,[4,t._systemPersistedStore.write(l.a.EditorClientInitState,t._clientStateInitValue)]);case 1:return n.sent(),t._clientStateLastValue!==g.a.Enabled?[3,3]:[4,t._systemPersistedStore.write(l.a.EnableTeachingUiOnPageBoot,!0)];case 2:return n.sent(),[3,5];case 3:return t._clientStateLastValue!==g.a.Undefined?[3,5]:[4,t._systemPersistedStore.write(l.a.EditorClientState,g.a.Disabled)];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))()}},{key:"initialize",value:function(){var e=this;return $c((function(){return Jc(this,(function(t){switch(t.label){case 0:return[4,e._systemPersistedStore.read(l.a.EditorClientInitState)];case 1:return e._clientStateInitValue=t.sent(),e._clientStateLastValue=e._clientStateInitValue,e.settingsEmitter.on(l.a.EditorClientState,$c((function(){var t;return Jc(this,(function(n){switch(n.label){case 0:return[4,e._systemPersistedStore.read(l.a.EditorClientState)];case 1:return t=n.sent(),e._clientStateInitValue===g.a.Undefined||e._clientStateLastValue!==g.a.Disabled||t!==g.a.Enabled?[3,3]:[4,e._systemPersistedStore.write(l.a.EnableTeachingUiOnPageBoot,!0)];case 2:return n.sent(),[3,5];case 3:return e._clientStateInitValue!==g.a.Undefined||e._clientStateLastValue===g.a.Enabled||t!==g.a.Enabled?[3,5]:[4,e._systemPersistedStore.write(l.a.IsTeachingUiDismissed,!0)];case 4:n.sent(),n.label=5;case 5:return e._clientStateLastValue=t,[2]}}))}))),[2]}}))}))()}}])&&Kc(t.prototype,n),r&&Kc(t,r),e}();Qc=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(c.a)),Object(le.f)(1,Object(pe.a)(Ws.a)),Object(le.e)("design:paramtypes",[Object,Object])],Qc);var Yc=n(115),Xc=n(65),Zc=Object(d.a)("IUserInfoListener"),el=n(214),tl=n(287),nl=Object(d.a)("IContentScriptInjector"),rl=Object(d.a)("ISignInAnnouncementDetector"),il=n(179);function ol(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function al(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){ol(o,r,i,a,s,"next",e)}function s(e){ol(o,r,i,a,s,"throw",e)}a(void 0)}))}}function sl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ul(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var cl=function(){function e(t,n,r,i,o,a,s,u,c,l,d,f,h,p,g,m){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_registrar",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_systemPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_contentScriptInjector",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"_contentScriptEmitter",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"_settingsEmitter",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_remoteSettingsSyncer",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"_userInfoListener",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"_proofingPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:u}),Object.defineProperty(this,"_sessionContextProvider",{enumerable:!0,configurable:!0,writable:!0,value:c}),Object.defineProperty(this,"_announcementFlagDetector",{enumerable:!0,configurable:!0,writable:!0,value:l}),Object.defineProperty(this,"_logger",{enumerable:!0,configurable:!0,writable:!0,value:d}),Object.defineProperty(this,"_signInAnnouncementDetector",{enumerable:!0,configurable:!0,writable:!0,value:f}),Object.defineProperty(this,"_unsignedInEditorFeature",{enumerable:!0,configurable:!0,writable:!0,value:h}),Object.defineProperty(this,"_extensionTelemetrySink",{enumerable:!0,configurable:!0,writable:!0,value:p}),Object.defineProperty(this,"_featureFlagsReader",{enumerable:!0,configurable:!0,writable:!0,value:g}),Object.defineProperty(this,"_betaEnrollmentPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:m}),Object.defineProperty(this,"_uninstallUrl",{enumerable:!0,configurable:!0,writable:!0,value:"https://aka.ms/editorbxuninstall"}),Object.defineProperty(this,"_officeHomeUrl",{enumerable:!0,configurable:!0,writable:!0,value:"https://go.microsoft.com/fwlink/?linkid=859986"})}var t,n,r;return t=e,(n=[{key:"initializeComponent",value:function(){var e=this;return al((function(){var t,n,r,i,o,a,c,d,f,h,p,g,m,y,b;return ul(this,(function(v){switch(v.label){case 0:return[4,e._contentScriptInjector.registerContentScripts()];case 1:v.sent(),v.label=2;case 2:return v.trys.push([2,4,,5]),[4,e._sessionContextProvider()];case 3:return n=v.sent(),[3,5];case 4:return v.sent(),[3,5];case 5:return[4,e._extensionTelemetrySink.manualInitialize(e._proofingPersistedStore,e._settingsEmitter)];case 6:return v.sent(),[4,e._logger.initialize(e._proofingPersistedStore,e._featureFlagsReader,n,e._settingsEmitter)];case 7:return v.sent(),tl.a.addUnhandledExceptionsListeners(e._logger,u.a.UnhandledBackgroundError,"Unhandled background script error"),n||e._logger.debug(509646625,"Session context not created."),e._logger.debug(509646624,"[Background] Logger initialized"),i=(r=e._systemPersistedStore).write,o=[l.a.WebsitesWithNativeIntegration],[4,e._systemPersistedStore.read(l.a.WebsitesWithNativeIntegration)];case 8:return[4,i.apply(r,o.concat([v.sent()]))];case 9:return v.sent(),[4,e._announcementFlagDetector.initialize()];case 10:return v.sent(),e._logger.debug(509646623,"[Background] Initialization"),e._contentScriptEmitter.listenForContentScriptConnections&&e._contentScriptEmitter.listenForContentScriptConnections(e._logger),e._contentScriptEmitter.on(Uu.a.openOptionsPage,(function(){Object(il.a)()})),e._settingsEmitter.on(l.a.EnableUninstallSurvey,(function(){e._setUninstallURL()})),e._settingsEmitter.on(de.a.EnableTelemetry,(function(){e._setUninstallURL()})),e._contentScriptEmitter.on(Uu.a.uninstallParametersChangedEvent,(function(){e._setUninstallURL()})),e._setUninstallURL(),[4,e._registrar.initialize()];case 11:return v.sent(),[4,e._systemPersistedStore.read(l.a.InjectContentScriptsOnExtensionLoad)];case 12:return v.sent()?(e._logger.debug(509646622,"[Background] Injecting content scripts into all tabs"),[4,e._contentScriptInjector.injectContentScriptsIntoAllTabs()]):[3,14];case 13:v.sent(),v.label=14;case 14:return e._logger.debug(509646621,"[Background] Scheduling remote settings syncer"),d=60*(c=5)*(a=1e3),[4,e._proofingPersistedStore.getLastUpdatedTimestamp(de.a.Descriptors)];case 15:f=null!==(t=v.sent())&&void 0!==t?t:0,h=Date.now()-f,g=(p=d-h)<a?a:p,e._remoteSettingsSyncer.schedule(g,d),v.label=16;case 16:return v.trys.push([16,18,,19]),[4,e._userInfoListener.emitUserRelatedInformation()];case 17:return m=v.sent(),[3,19];case 18:return v.sent(),e._logger.error(509646620,"Retrieve user info for the first time failed"),[3,19];case 19:return m?[3,21]:[4,e._signInAnnouncementDetector.schedule(c)];case 20:v.sent(),v.label=21;case 21:return(y=e._logger.getNewActivity(u.b.BackgroundScriptInitialization,s.a.SamplingPolicy.CriticalExperimentation))?[4,e.unsignedInEditorFeatureEnabled()]:[3,23];case 22:b=v.sent(),y.dataFields.push({name:"UnsignedInFeatureEnabled",dataType:s.a.DataFieldType.Boolean.valueOf(),value:b,classification:s.a.DataClassification.EssentialServiceMetadata}),y.success=!0,y.endNow(),e._logger.debug(509646619,"[Background] Init successful"),v.label=23;case 23:return e._featureFlagsReader.flags.enableGDocsAnnotatedCanvas?[4,e._betaEnrollmentPersistedStore.getBetaExperienceState(Xc.a)]:[3,26];case 24:return v.sent()!==Yc.a.SupportEnded?[3,26]:[4,e._betaEnrollmentPersistedStore.setBetaExperienceState(Xc.a,Yc.a.Enabled)];case 25:v.sent(),v.label=26;case 26:return[2]}}))}))()}},{key:"unsignedInEditorFeatureEnabled",value:function(){var e=this;return al((function(){return ul(this,(function(t){return[2,e._unsignedInEditorFeature.emitAndEvaluateAsync({eventId:L.b.PageContext,sender:L.d.PageContext})]}))}))()}},{key:"_setUninstallURL",value:function(){var e=this;return al((function(){var t,n,r,i,o;return ul(this,(function(a){switch(a.label){case 0:return[4,e._proofingPersistedStore.read(de.a.EnableTelemetry)];case 1:return t=a.sent(),[4,e._systemPersistedStore.read(l.a.EnableUninstallSurvey)];case 2:return a.sent()&&t?(n=chrome.runtime.getManifest(),r=n?n.version:-1,[4,e._proofingPersistedStore.read(de.a.ProofingLanguages)]):(chrome.runtime.setUninstallURL(""),[2]);case 3:return i=a.sent(),o=e._officeHomeUrl,t&&(o="".concat(e._uninstallUrl,"?version=").concat(r),o=i?"".concat(o,"&proofingLanguages=").concat(i):o),chrome.runtime.setUninstallURL(encodeURI(o)),[2]}}))}))()}}])&&sl(t.prototype,n),r&&sl(t,r),e}();function ll(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function dl(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){ll(o,r,i,a,s,"next",e)}function s(e){ll(o,r,i,a,s,"throw",e)}a(void 0)}))}}function fl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hl(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}cl=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(m.a)),Object(le.f)(1,Object(pe.a)(c.a)),Object(le.f)(2,Object(pe.a)(nl)),Object(le.f)(3,Object(pe.a)(Uu.b)),Object(le.f)(4,Object(pe.a)(Ws.a)),Object(le.f)(5,Object(pe.a)(Qs)),Object(le.f)(6,Object(pe.a)(Zc)),Object(le.f)(7,Object(pe.a)(K.a)),Object(le.f)(8,Object(pe.a)(a.a)),Object(le.f)(9,Object(pe.a)(f)),Object(le.f)(10,Object(pe.a)(o.a)),Object(le.f)(11,Object(pe.a)(rl)),Object(le.f)(12,Object(pe.a)(L.a)),Object(le.f)(13,Object(pe.a)(Yu.b)),Object(le.f)(14,Object(pe.a)(v.a)),Object(le.f)(15,Object(pe.a)(el.a)),Object(le.e)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,Function,Object,Object,Object,Object,Object,Object,Object])],cl);var pl=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_configV2Handler",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_proofingPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_settingsEmitter",{enumerable:!0,configurable:!0,writable:!0,value:r});var i=this;Object.defineProperty(this,"_handleEmission",{enumerable:!0,configurable:!0,writable:!0,value:dl((function(){return hl(this,(function(e){switch(e.label){case 0:return[4,i.isCacheUpdateNeeded()];case 1:return e.sent()?[4,i._proofingPersistedStore.write(de.a.CritiqueValuePerLanguage,JSON.stringify([]))]:[3,4];case 2:return e.sent(),[4,i._configV2Handler.performCall()];case 3:e.sent(),e.label=4;case 4:return[2]}}))}))});var o=this;Object.defineProperty(this,"isCacheUpdateNeeded",{enumerable:!0,configurable:!0,writable:!0,value:dl((function(){var e,t,n,r,i,a,s,u,c,l,d;return hl(this,(function(f){switch(f.label){case 0:return[4,o._proofingPersistedStore.getLastUpdatedTimestamp(de.a.CritiqueValuePerLanguage)];case 1:return void 0===(e=f.sent())?[2,!0]:(n=JSON.parse,[4,o._proofingPersistedStore.read(de.a.CritiqueValuePerLanguage)]);case 2:return t=n.apply(JSON,[f.sent()]),[4,o._proofingPersistedStore.read(de.a.ProofingLanguages)];case 3:if(r=f.sent(),!Array.isArray(r))return[2,!1];i=!0,a=!1,s=void 0;try{for(u=function(){var e=l.value;if(-1===t.findIndex((function(t){return t.languageId===e})))return{v:!0}},c=r[Symbol.iterator]();!(i=(l=c.next()).done);i=!0)if(d=u(),"object"==((h=d)&&"undefined"!=typeof Symbol&&h.constructor===Symbol?"symbol":typeof h))return[2,d.v]}catch(e){a=!0,s=e}finally{try{i||null==c.return||c.return()}finally{if(a)throw s}}return[2,new Date(Date.now()-12096e5).getTime()>e]}var h}))}))})}var t,n,r;return t=e,(n=[{key:"initialize",value:function(){var e=this;return dl((function(){return hl(this,(function(t){switch(t.label){case 0:return[4,e.isCacheUpdateNeeded()];case 1:return t.sent()?[4,e._configV2Handler.performCall()]:[3,3];case 2:t.sent(),t.label=3;case 3:return e._settingsEmitter.on(de.a.ProofingLanguages,e._handleEmission),[2]}}))}))()}},{key:"shutDown",value:function(){}}])&&fl(t.prototype,n),r&&fl(t,r),e}();pl=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(me)),Object(le.f)(1,Object(pe.a)(K.a)),Object(le.f)(2,Object(pe.a)(Ws.a)),Object(le.e)("design:paramtypes",[me,Object,Object])],pl);var gl,ml,yl,bl,vl,wl,Sl,_l,Tl,Ol,Cl=n(608),El=n(270),Il=n(203);!function(e){e[e.Success=0]="Success",e[e.PartialSuccess=1]="PartialSuccess",e[e.Error=2]="Error",e[e.Disabled=3]="Disabled"}(gl||(gl={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low"}(ml||(ml={})),function(e){e[e.None=0]="None",e[e.OfficeOrthospeller=1]="OfficeOrthospeller",e[e.BingOneSpeller=2]="BingOneSpeller",e[e.ContextSpeller=3]="ContextSpeller",e[e.Grammar=4]="Grammar"}(yl||(yl={})),function(e){e[e.Unknown=0]="Unknown",e[e.DocumentText=1]="DocumentText"}(bl||(bl={})),function(e){e[e.Default=0]="Default",e[e.Word=1]="Word",e[e.Phrase=2]="Phrase",e[e.Sentence=4]="Sentence",e[e.Paragraph=8]="Paragraph",e[e.Page=16]="Page",e[e.Section=32]="Section",e[e.Chapter=64]="Chapter",e[e.Document=256]="Document",e[e.RawChars=16384]="RawChars"}(vl||(vl={})),function(e){e[e.Ignore=0]="Ignore",e[e.IgnoreAll=1]="IgnoreAll",e[e.AddToDictionary=2]="AddToDictionary",e[e.Delete=3]="Delete",e[e.ChangeSugg0=4]="ChangeSugg0",e[e.ChangeSugg1=5]="ChangeSugg1",e[e.ChangeSugg2=6]="ChangeSugg2",e[e.ChangeSuggOther=7]="ChangeSuggOther",e[e.ChangeAllSugg0=8]="ChangeAllSugg0",e[e.ChangeAllSugg1=9]="ChangeAllSugg1",e[e.ChangeAllSugg2=10]="ChangeAllSugg2",e[e.ChangeAllSuggOther=11]="ChangeAllSuggOther",e[e.ClickNoAction=12]="ClickNoAction",e[e.DoNotCheckThisIssue=13]="DoNotCheckThisIssue",e[e.ManualEdit=14]="ManualEdit",e[e.Autoreplace=15]="Autoreplace",e[e.AutoreplaceUndo=16]="AutoreplaceUndo",e[e.IgnoreUndo=17]="IgnoreUndo",e[e.IgnoreAllUndo=18]="IgnoreAllUndo",e[e.ChangeSugg0Undo=19]="ChangeSugg0Undo",e[e.ChangeSugg1Undo=20]="ChangeSugg1Undo",e[e.ChangeSugg2Undo=21]="ChangeSugg2Undo"}(wl||(wl={})),function(e){e[e.IsResume=0]="IsResume"}(Sl||(Sl={})),function(e){e[e.Unknown=0]="Unknown",e[e.Paragraph=1]="Paragraph",e[e.Group=2]="Group",e[e.Page=3]="Page",e[e.Document=4]="Document"}(_l||(_l={})),function(e){e[e.None=0]="None",e[e.Active=1]="Active",e[e.Provisional=2]="Provisional"}(Tl||(Tl={})),function(e){e[e.None=0]="None",e[e.Consistency=1]="Consistency"}(Ol||(Ol={}));const kl={serializedName:"Email",type:{name:"Composite",className:"Email",modelProperties:{id:{serializedName:"Id",type:{name:"String"}},subject:{serializedName:"Subject",type:{name:"String"}},body:{serializedName:"Body",type:{name:"String"}},sender:{serializedName:"Sender",type:{name:"String"}},instrumentationId:{serializedName:"InstrumentationId",type:{name:"String"}},snippet:{serializedName:"Snippet",type:{name:"String"}}}}},Al={serializedName:"File",type:{name:"Composite",className:"File",modelProperties:{id:{serializedName:"Id",type:{name:"String"}},name:{serializedName:"Name",type:{name:"String"}},extension:{serializedName:"Extension",type:{name:"String"}},uri:{serializedName:"Uri",type:{name:"String"}},instrumentationId:{serializedName:"InstrumentationId",type:{name:"String"}},snippet:{serializedName:"Snippet",type:{name:"String"}}}}},Pl={serializedName:"Acronym",type:{name:"Composite",className:"Acronym",modelProperties:{description:{serializedName:"Description",type:{name:"String"}},id:{serializedName:"Id",type:{name:"String"}},instrumentationId:{serializedName:"InstrumentationId",type:{name:"String"}},name:{serializedName:"Name",type:{name:"String"}},source:{serializedName:"Source",type:{name:"String"}},sourceEmail:{serializedName:"SourceEmail",type:{name:"Composite",className:"Email"}},sourceFile:{serializedName:"SourceFile",type:{name:"Composite",className:"File"}},sourceType:{serializedName:"SourceType",type:{name:"String"}},type:{serializedName:"Type",type:{name:"String"}}}}},Nl={serializedName:"AcronymsResponse",type:{name:"Composite",className:"AcronymsResponse",modelProperties:{transactionId:{serializedName:"TransactionId",type:{name:"String"}},acronyms:{serializedName:"Acronyms",type:{name:"Sequence",element:{type:{name:"Composite",className:"Acronym"}}}}}}},jl={serializedName:"CommonAppIdProperty",type:{name:"Composite",className:"CommonAppIdProperty",modelProperties:{appId:{serializedName:"AppId",type:{name:"String"}}}}},Rl={serializedName:"BrowserExtensionRequestV1",type:{name:"Composite",className:"BrowserExtensionRequestV1",modelProperties:Object.assign(Object.assign({},jl.type.modelProperties),{browser:{serializedName:"Browser",type:{name:"String"}},browserVersion:{serializedName:"BrowserVersion",type:{name:"String"}},clientId:{serializedName:"ClientId",type:{name:"String"}},email:{serializedName:"Email",type:{name:"String"}},extensionId:{serializedName:"ExtensionId",type:{name:"String"}},firstInstallVersion:{serializedName:"FirstInstallVersion",type:{name:"String"}},languageId:{serializedName:"LanguageId",type:{name:"String"}},languageUxId:{serializedName:"LanguageUxId",type:{name:"String"}},licenseType:{serializedName:"LicenseType",type:{name:"String"}},storeId:{serializedName:"StoreId",type:{name:"String"}},tenantId:{serializedName:"TenantId",type:{name:"String"}}})}},xl={serializedName:"BrowserExtensionResponseV1",type:{name:"Composite",className:"BrowserExtensionResponseV1",modelProperties:{responseStatus:{serializedName:"ResponseStatus",defaultValue:0,type:{name:"Enum",allowedValues:[0,1,2,3]}},requestId:{serializedName:"RequestId",type:{name:"String"}},useTileCheck:{serializedName:"UseTileCheck",defaultValue:!1,type:{name:"Boolean"}},disabledWebSites:{serializedName:"DisabledWebSites",type:{name:"Sequence",element:{type:{name:"String"}}}},allowedUrls:{serializedName:"AllowedUrls",type:{name:"Sequence",element:{type:{name:"String"}}}},disabledGrammars:{serializedName:"DisabledGrammars",type:{name:"Sequence",element:{type:{name:"String"}}}},versionEmergencyOverrides:{serializedName:"VersionEmergencyOverrides",type:{name:"Dictionary",value:{type:{name:"String"}}}},featureFlags:{serializedName:"FeatureFlags",type:{name:"Dictionary",value:{type:{name:"String"}}}},dynamicSettings:{serializedName:"DynamicSettings",type:{name:"Dictionary",value:{type:{name:"Object"}}}},descriptors:{serializedName:"Descriptors",type:{name:"String"}},spellCheckAttributes:{serializedName:"SpellCheckAttributes",type:{name:"Sequence",element:{type:{name:"String"}}}},conflictingElements:{serializedName:"ConflictingElements",type:{name:"Sequence",element:{type:{name:"String"}}}},styleObserverIntervalTime:{serializedName:"StyleObserverIntervalTime",defaultValue:0,type:{name:"Number"}},styleSampleTime:{serializedName:"StyleSampleTime",defaultValue:0,type:{name:"Number"}},rootContentMaxLengthInChars:{serializedName:"RootContentMaxLengthInChars",defaultValue:2e3,type:{name:"Number"}},schedulerDefaultWaitingTime:{serializedName:"SchedulerDefaultWaitingTime",defaultValue:0,type:{name:"Number"}},schedulerDefaultWaitingTimeIncrement:{serializedName:"SchedulerDefaultWaitingTimeIncrement",defaultValue:0,type:{name:"Number"}},schedulerDefaultMaxTime:{serializedName:"SchedulerDefaultMaxTime",defaultValue:0,type:{name:"Number"}},refreshCritiqueWaitingTime:{serializedName:"RefreshCritiqueWaitingTime",defaultValue:0,type:{name:"Number"}},requestCritiqueDelay:{serializedName:"RequestCritiqueDelay",defaultValue:0,type:{name:"Number"}},enableDirtyRangeAutoRehydration:{serializedName:"EnableDirtyRangeAutoRehydration",defaultValue:!1,type:{name:"Boolean"}},telemetryTenant:{serializedName:"TelemetryTenant",type:{name:"String"}},logGroupName:{serializedName:"LogGroupName",type:{name:"String"}},sendToAria:{serializedName:"SendToAria",defaultValue:!1,type:{name:"Boolean"}},intervalForActivityCleanup:{serializedName:"IntervalForActivityCleanup",defaultValue:0,type:{name:"Number"}},maxAllowedTimeForActivities:{serializedName:"MaxAllowedTimeForActivities",defaultValue:0,type:{name:"Number"}},calloutHoverTimeout:{serializedName:"CalloutHoverTimeout",defaultValue:0,type:{name:"Number"}},maxSuggestionItemsDisplayNumber:{serializedName:"MaxSuggestionItemsDisplayNumber",defaultValue:0,type:{name:"Number"}},editorClientState:{serializedName:"EditorClientState",type:{name:"Number"}},editorCanvas:{serializedName:"EditorCanvas",type:{name:"Object"}},configurationId:{serializedName:"ConfigurationId",type:{name:"String"}}}}},Dl={serializedName:"Descriptor",type:{name:"Composite",className:"Descriptor",modelProperties:{name:{required:!0,serializedName:"Name",type:{name:"String"}},value:{required:!0,serializedName:"Value",type:{name:"String"}}}}},Ml={serializedName:"CommonLanguageIdProperty",type:{name:"Composite",className:"CommonLanguageIdProperty",modelProperties:{languageId:{serializedName:"LanguageId",type:{name:"String"}}}}},Ll={serializedName:"CritiqueTypeOption",type:{name:"Composite",className:"CritiqueTypeOption",modelProperties:Object.assign(Object.assign({},Ml.type.modelProperties),{id:{required:!0,serializedName:"Id",type:{name:"Uuid"}},name:{serializedName:"Name",type:{name:"String"}},typeName:{serializedName:"TypeName",type:{name:"String"}},value:{required:!0,serializedName:"Value",type:{name:"String"}}})}},Bl={serializedName:"Suggestion",type:{name:"Composite",className:"Suggestion",modelProperties:{text:{required:!0,serializedName:"Text",type:{name:"String"}},description:{serializedName:"Description",type:{name:"String"}},confidenceLevel:{serializedName:"ConfidenceLevel",type:{name:"Enum",allowedValues:[0,1,2]}},source:{serializedName:"Source",type:{name:"Enum",allowedValues:[0,1,2,3,4]}},action:{required:!0,serializedName:"Action",type:{name:"Number"}},bucketId:{serializedName:"BucketId",type:{name:"Number"}},numberOfInstances:{serializedName:"NumberOfInstances",type:{name:"Number"}}}}},Fl={serializedName:"CommonAppVersionProperty",type:{name:"Composite",className:"CommonAppVersionProperty",modelProperties:{appVersion:{serializedName:"AppVersion",type:{name:"String"}}}}},Ul={serializedName:"ClientSuggestion",type:{name:"Composite",className:"ClientSuggestion",modelProperties:Object.assign(Object.assign({},Fl.type.modelProperties),{start:{serializedName:"Start",defaultValue:0,type:{name:"Number"}},length:{serializedName:"Length",defaultValue:0,type:{name:"Number"}},suggestions:{serializedName:"Suggestions",type:{name:"Sequence",element:{type:{name:"Composite",className:"Suggestion"}}}}})}},ql={serializedName:"Tiling",type:{name:"Composite",className:"Tiling",modelProperties:{tilingType:{serializedName:"TilingType",type:{name:"Enum",allowedValues:[0,1]}},paragraphIds:{serializedName:"ParagraphIds",type:{name:"Sequence",element:{type:{name:"String"}}}},paragraphRevisionIds:{serializedName:"ParagraphRevisionIds",type:{name:"Sequence",element:{type:{name:"String"}}}},numberOfParagraphsInTiling:{nullable:!0,serializedName:"NumberOfParagraphsInTiling",type:{name:"Number"}}}}},zl={serializedName:"DocumentStructureMetadata",type:{name:"Composite",className:"DocumentStructureMetadata",modelProperties:{paragraphId:{serializedName:"ParagraphId",type:{name:"String"}},paragraphRevisionId:{serializedName:"ParagraphRevisionId",type:{name:"String"}},tileId:{serializedName:"TileId",type:{name:"String"}},revisionId:{serializedName:"RevisionId",type:{name:"String"}},requestOrderInSession:{serializedName:"RequestOrderInSession",type:{name:"Number"}},areTilingsComplete:{serializedName:"AreTilingsComplete",defaultValue:!1,type:{name:"Boolean"}},tilings:{serializedName:"Tilings",type:{name:"Sequence",element:{type:{name:"Composite",className:"Tiling"}}}}}}},Wl={serializedName:"CheckRequestV1",type:{name:"Composite",className:"CheckRequestV1",modelProperties:{appId:{required:!0,serializedName:"AppId",type:{name:"String"}},appVersion:{serializedName:"AppVersion",type:{name:"String"}},descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}},languageId:{required:!0,serializedName:"LanguageId",type:{name:"String"}},languageUXId:{serializedName:"LanguageUXId",type:{name:"String"}},runOnProfileId:{serializedName:"RunOnProfileId",type:{name:"Uuid"}},textUnit:{serializedName:"TextUnit",type:{name:"Enum",allowedValues:[0,1,2,4,8,16,32,64,256,16384]}},overriddenCritiqueTypeOptions:{serializedName:"OverriddenCritiqueTypeOptions",type:{name:"Sequence",element:{type:{name:"Composite",className:"CritiqueTypeOption"}}}},autoSelect:{serializedName:"AutoSelect",type:{name:"Boolean"}},clientSuggestions:{serializedName:"ClientSuggestions",type:{name:"Sequence",element:{type:{name:"Composite",className:"ClientSuggestion"}}}},enabledLanguages:{serializedName:"EnabledLanguages",type:{name:"Sequence",element:{type:{name:"Sequence",element:{type:{name:"Composite",className:"CommonLanguageIdProperty"}}}}}},length:{serializedName:"Length",defaultValue:0,type:{name:"Number"}},requestId:{serializedName:"RequestId",type:{name:"Uuid"}},start:{serializedName:"Start",defaultValue:0,type:{name:"Number"}},text:{required:!0,serializedName:"Text",type:{name:"String"}},documentStructureMetadata:{serializedName:"DocumentStructureMetadata",type:{name:"Composite",className:"DocumentStructureMetadata"}}}}},Vl={serializedName:"CheckedSpan",type:{name:"Composite",className:"CheckedSpan",modelProperties:{start:{required:!0,serializedName:"Start",defaultValue:0,type:{name:"Number"}},length:{required:!0,serializedName:"Length",defaultValue:0,type:{name:"Number"}}}}},Gl={serializedName:"Metadatum",type:{name:"Composite",className:"Metadatum",modelProperties:{name:{required:!0,serializedName:"Name",type:{name:"String"}},value:{required:!0,serializedName:"Value",type:{name:"String"}}}}},Hl={serializedName:"Critique",type:{name:"Composite",className:"Critique",modelProperties:{traceId:{required:!0,serializedName:"TraceId",type:{name:"Uuid"}},typeId:{required:!0,serializedName:"TypeId",type:{name:"Uuid"}},categoryTitle:{required:!0,serializedName:"CategoryTitle",type:{name:"String"}},context:{serializedName:"Context",type:{name:"String"}},start:{required:!0,serializedName:"Start",defaultValue:0,type:{name:"Number"}},startInContext:{serializedName:"StartInContext",defaultValue:0,type:{name:"Number"}},length:{required:!0,serializedName:"Length",defaultValue:0,type:{name:"Number"}},languageId:{serializedName:"LanguageId",type:{name:"String"}},priority:{required:!0,serializedName:"Priority",type:{name:"Number"}},metadata:{serializedName:"Metadata",type:{name:"Sequence",element:{type:{name:"Composite",className:"Metadatum"}}}},paragraphId:{serializedName:"ParagraphId",type:{name:"String"}},paragraphRevisionId:{serializedName:"ParagraphRevisionId",type:{name:"String"}},tileId:{serializedName:"TileId",type:{name:"String"}},revisionId:{serializedName:"RevisionId",type:{name:"String"}},supportedActions:{serializedName:"SupportedActions",type:{name:"Number"}},explanationTitle:{serializedName:"ExplanationTitle",type:{name:"String"}},explanationLabel:{serializedName:"ExplanationLabel",type:{name:"String"}},explanation:{serializedName:"Explanation",type:{name:"String"}},isDocumentLevelCritique:{serializedName:"IsDocumentLevelCritique",defaultValue:!1,type:{name:"Boolean"}},suggestions:{required:!0,serializedName:"Suggestions",type:{name:"Sequence",element:{type:{name:"Composite",className:"Suggestion"}}}}}}},$l={serializedName:"ReadingConcept",type:{name:"Composite",className:"ReadingConcept",modelProperties:{id:{serializedName:"Id",type:{name:"String"}},score:{serializedName:"Score",type:{name:"Number"}}}}},Kl={serializedName:"ReadingCritique",type:{name:"Composite",className:"ReadingCritique",modelProperties:{traceId:{serializedName:"TraceId",type:{name:"Uuid"}},typeId:{serializedName:"TypeId",type:{name:"Uuid"}},categoryTitle:{serializedName:"CategoryTitle",type:{name:"String"}},context:{serializedName:"Context",type:{name:"String"}},start:{serializedName:"Start",defaultValue:0,type:{name:"Number"}},startInContext:{serializedName:"StartInContext",defaultValue:0,type:{name:"Number"}},length:{serializedName:"Length",defaultValue:0,type:{name:"Number"}},languageId:{serializedName:"LanguageId",type:{name:"String"}},priority:{serializedName:"Priority",type:{name:"Number"}},metadata:{serializedName:"Metadata",type:{name:"Sequence",element:{type:{name:"Composite",className:"Metadatum"}}}},paragraphId:{serializedName:"ParagraphId",type:{name:"String"}},paragraphRevisionId:{serializedName:"ParagraphRevisionId",type:{name:"String"}},isDocumentLevelCritique:{serializedName:"IsDocumentLevelCritique",defaultValue:!1,type:{name:"Boolean"}},readingConcepts:{serializedName:"ReadingConcepts",type:{name:"Sequence",element:{type:{name:"Composite",className:"ReadingConcept"}}}}}}},Jl={serializedName:"ReadingResponse",type:{name:"Composite",className:"ReadingResponse",modelProperties:{acronymsResponse:{serializedName:"AcronymsResponse",type:{name:"Composite",className:"AcronymsResponse"}}}}},Ql={serializedName:"CommonResponseStatusProperty",type:{name:"Composite",className:"CommonResponseStatusProperty",modelProperties:{responseStatus:{serializedName:"ResponseStatus",defaultValue:0,type:{name:"Enum",allowedValues:[0,1,2,3]}}}}},Yl={serializedName:"CheckResponseV1",type:{name:"Composite",className:"CheckResponseV1",modelProperties:Object.assign(Object.assign({},Ql.type.modelProperties),{requestId:{serializedName:"RequestId",type:{name:"Uuid"}},checkedSpans:{serializedName:"CheckedSpans",type:{name:"Sequence",element:{type:{name:"Composite",className:"CheckedSpan"}}}},critiques:{required:!0,serializedName:"Critiques",type:{name:"Sequence",element:{type:{name:"Composite",className:"Critique"}}}},metadata:{serializedName:"Metadata",type:{name:"Sequence",element:{type:{name:"String"}}}},readingCritiques:{serializedName:"ReadingCritiques",type:{name:"Sequence",element:{type:{name:"Composite",className:"ReadingCritique"}}}},readingResponse:{serializedName:"ReadingResponse",type:{name:"Composite",className:"ReadingResponse"}}})}},Xl={serializedName:"CommonCritique",type:{name:"Composite",className:"CommonCritique",modelProperties:{traceId:{serializedName:"TraceId",type:{name:"Uuid"}},typeId:{serializedName:"TypeId",type:{name:"Uuid"}},categoryTitle:{serializedName:"CategoryTitle",type:{name:"String"}},context:{serializedName:"Context",type:{name:"String"}},start:{serializedName:"Start",defaultValue:0,type:{name:"Number"}},startInContext:{serializedName:"StartInContext",defaultValue:0,type:{name:"Number"}},length:{serializedName:"Length",defaultValue:0,type:{name:"Number"}},languageId:{serializedName:"LanguageId",type:{name:"String"}},priority:{serializedName:"Priority",type:{name:"Number"}},metadata:{serializedName:"Metadata",type:{name:"Sequence",element:{type:{name:"Composite",className:"Metadatum"}}}}}}},Zl={serializedName:"CommonDescriptorsProperty",type:{name:"Composite",className:"CommonDescriptorsProperty",modelProperties:{descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}}}}},ed={serializedName:"CommonLanguageUXIdProperty",type:{name:"Composite",className:"CommonLanguageUXIdProperty",modelProperties:{languageUXId:{serializedName:"LanguageUXId",type:{name:"String"}}}}},td={serializedName:"CommonOverriddenCritiqueTypeOptions",type:{name:"Composite",className:"CommonOverriddenCritiqueTypeOptions",modelProperties:{overriddenCritiqueTypeOptions:{serializedName:"OverriddenCritiqueTypeOptions",type:{name:"Sequence",element:{type:{name:"Composite",className:"CritiqueTypeOption"}}}}}}},nd={serializedName:"CommonParagraphIdProperty",type:{name:"Composite",className:"CommonParagraphIdProperty",modelProperties:{paragraphId:{serializedName:"ParagraphId",type:{name:"String"}}}}},rd={serializedName:"CommonParagraphRevisionIdProperty",type:{name:"Composite",className:"CommonParagraphRevisionIdProperty",modelProperties:{paragraphRevisionId:{serializedName:"ParagraphRevisionId",type:{name:"String"}}}}},id={serializedName:"CommonRequestIdProperty",type:{name:"Composite",className:"CommonRequestIdProperty",modelProperties:{requestId:{serializedName:"RequestId",type:{name:"String"}}}}},od={serializedName:"CommonTileIdProperty",type:{name:"Composite",className:"CommonTileIdProperty",modelProperties:{tileId:{serializedName:"TileId",type:{name:"String"}}}}},ad={serializedName:"CommonRevisionIdProperty",type:{name:"Composite",className:"CommonRevisionIdProperty",modelProperties:{revisionId:{serializedName:"RevisionId",type:{name:"String"}}}}},sd={serializedName:"CommonRunOnProfileIdProperty",type:{name:"Composite",className:"CommonRunOnProfileIdProperty",modelProperties:{runOnProfileId:{serializedName:"RunOnProfileId",type:{name:"Uuid"}}}}},ud={serializedName:"CommonTextUnitProperty",type:{name:"Composite",className:"CommonTextUnitProperty",modelProperties:{textUnit:{serializedName:"TextUnit",type:{name:"Enum",allowedValues:[0,1,2,4,8,16,32,64,256,16384]}}}}},cd={serializedName:"ConfigRequestV1",type:{name:"Composite",className:"ConfigRequestV1",modelProperties:{appId:{required:!0,serializedName:"AppId",type:{name:"String"}},appVersion:{serializedName:"AppVersion",type:{name:"String"}},descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}},languageId:{required:!0,serializedName:"LanguageId",type:{name:"String"}},languageUXId:{serializedName:"LanguageUXId",type:{name:"String"}},requestId:{serializedName:"RequestId",type:{name:"String"}},runOnProfileId:{serializedName:"RunOnProfileId",type:{name:"Uuid"}}}}},ld={serializedName:"CritiqueTypeInfo",type:{name:"Composite",className:"CritiqueTypeInfo",modelProperties:{id:{required:!0,serializedName:"Id",type:{name:"Uuid"}},name:{required:!0,serializedName:"Name",type:{name:"String"}},isBinaryCritiqueType:{serializedName:"IsBinaryCritiqueType",type:{name:"Boolean"}},critiqueTypeValues:{serializedName:"CritiqueTypeValues",type:{name:"Sequence",element:{type:{name:"String"}}}},defaultCritiqueValue:{required:!0,serializedName:"DefaultCritiqueValue",type:{name:"Number"}},critiquePriority:{serializedName:"CritiquePriority",type:{name:"Number"}},critiqueTag:{serializedName:"CritiqueTag",type:{name:"String"}}}}},dd={serializedName:"CritiqueCategoryInfo",type:{name:"Composite",className:"CritiqueCategoryInfo",modelProperties:{id:{required:!0,serializedName:"Id",type:{name:"Uuid"}},name:{required:!0,serializedName:"Name",type:{name:"String"}},priority:{serializedName:"Priority",type:{name:"Number"}},critiqueTypeInfoList:{serializedName:"CritiqueTypeInfoList",type:{name:"Sequence",element:{type:{name:"Composite",className:"CritiqueTypeInfo"}}}}}}},fd={serializedName:"Profile",type:{name:"Composite",className:"Profile",modelProperties:Object.assign(Object.assign({},Ml.type.modelProperties),{id:{required:!0,serializedName:"Id",type:{name:"Uuid"}},title:{serializedName:"Title",type:{name:"String"}},default:{serializedName:"Default",type:{name:"Boolean"}},critiqueCategoryInfoList:{required:!0,serializedName:"CritiqueCategoryInfoList",type:{name:"Sequence",element:{type:{name:"Composite",className:"CritiqueCategoryInfo"}}}}})}},hd={serializedName:"ConfigResponseV1",type:{name:"Composite",className:"ConfigResponseV1",modelProperties:{responseStatus:{required:!0,serializedName:"ResponseStatus",defaultValue:0,type:{name:"Enum",allowedValues:[0,1,2,3]}},requestId:{required:!0,serializedName:"RequestId",type:{name:"String"}},profiles:{required:!0,serializedName:"Profiles",type:{name:"Sequence",element:{type:{name:"Composite",className:"Profile"}}}}}}},pd={serializedName:"ConfigRequestV2",type:{name:"Composite",className:"ConfigRequestV2",modelProperties:{appId:{required:!0,serializedName:"AppId",type:{name:"String"}},appVersion:{serializedName:"AppVersion",type:{name:"String"}},descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}},languageId:{required:!0,serializedName:"LanguageId",type:{name:"String"}},languageUXId:{serializedName:"LanguageUXId",type:{name:"String"}},runOnProfileId:{serializedName:"RunOnProfileId",type:{name:"Uuid"}}}}},gd={serializedName:"ConfigResponseV2",type:{name:"Composite",className:"ConfigResponseV2",modelProperties:Object.assign(Object.assign({},Ql.type.modelProperties),{critiqueCategoryInfoList:{required:!0,serializedName:"CritiqueCategoryInfoList",type:{name:"Sequence",element:{type:{name:"Composite",className:"CritiqueCategoryInfo"}}}}})}},md={serializedName:"InsightsRequestV1",type:{name:"Composite",className:"InsightsRequestV1",modelProperties:{appId:{required:!0,serializedName:"AppId",type:{name:"String"}},languageId:{required:!0,serializedName:"LanguageId",type:{name:"String"}},text:{required:!0,serializedName:"Text",type:{name:"String"}}}}},yd={serializedName:"InsightsResponseV1_AnalyzerData",type:{name:"Composite",className:"InsightsResponseV1AnalyzerData",modelProperties:{contentWordsCount:{serializedName:"ContentWordsCount",type:{name:"Number"}},functionalWordsCount:{serializedName:"FunctionalWordsCount",type:{name:"Number"}},pronounsCount:{serializedName:"PronounsCount",type:{name:"Number"}},sentencesCount:{serializedName:"SentencesCount",type:{name:"Number"}},syllablesCount:{serializedName:"SyllablesCount",type:{name:"Number"}},wordsCount:{serializedName:"WordsCount",type:{name:"Number"}},wordFrequency:{serializedName:"WordFrequency",type:{name:"Number"}},wordCharactersCount:{serializedName:"WordCharactersCount",type:{name:"Number"}},semicolonsCount:{serializedName:"SemicolonsCount",type:{name:"Number"}},wordsLongerThan8Count:{serializedName:"WordsLongerThan8Count",type:{name:"Number"}}}}},bd={serializedName:"InsightsResponseV1",type:{name:"Composite",className:"InsightsResponseV1",modelProperties:{responseStatus:{serializedName:"ResponseStatus",defaultValue:0,type:{name:"Enum",allowedValues:[0,1,2,3]}},requestId:{serializedName:"RequestId",type:{name:"String"}},analyzerData:{serializedName:"AnalyzerData",type:{name:"Composite",className:"InsightsResponseV1AnalyzerData"}}}}},vd={serializedName:"InstrumentationRequestV1",type:{name:"Composite",className:"InstrumentationRequestV1",modelProperties:{appId:{required:!0,serializedName:"AppId",type:{name:"String"}},languageId:{required:!0,serializedName:"LanguageId",type:{name:"String"}},descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}},traceId:{required:!0,serializedName:"TraceId",type:{name:"Uuid"}},critiqueGenerationTime:{serializedName:"CritiqueGenerationTime",type:{name:"Number"}},critiquePriority:{required:!0,serializedName:"CritiquePriority",type:{name:"Number"}},critiqueTypeId:{required:!0,serializedName:"CritiqueTypeId",type:{name:"Uuid"}},eventId:{required:!0,serializedName:"EventId",type:{name:"Enum",allowedValues:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]}},flaggedText:{required:!0,serializedName:"FlaggedText",constraints:{MaxLength:2e4,MinLength:1},type:{name:"String"}},metadata:{serializedName:"Metadata",type:{name:"Sequence",element:{type:{name:"Composite",className:"Metadatum"}}}},originalText:{serializedName:"OriginalText",type:{name:"String"}},preContextBegin:{serializedName:"PreContextBegin",type:{name:"Number"}},postContextEnd:{serializedName:"PostContextEnd",type:{name:"Number"}},substrateEventName:{serializedName:"SubstrateEventName",type:{name:"String"}},substrateEventCustomFields:{serializedName:"SubstrateEventCustomFields",type:{name:"Object"}},suggestions:{serializedName:"Suggestions",type:{name:"Sequence",element:{type:{name:"String"}}}},suggestionText:{serializedName:"SuggestionText",constraints:{MaxLength:2e4},type:{name:"String"}}}}},wd={serializedName:"LanguageInfoRequestV1",type:{name:"Composite",className:"LanguageInfoRequestV1",modelProperties:{appId:{required:!0,serializedName:"AppId",type:{name:"String"}},descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}},languageId:{serializedName:"LanguageId",type:{name:"String"}},languageUXId:{serializedName:"LanguageUXId",type:{name:"String"}},runOnProfileId:{serializedName:"RunOnProfileId",type:{name:"Uuid"}}}}},Sd={serializedName:"SupportedLanguage",type:{name:"Composite",className:"SupportedLanguage",modelProperties:{languageId:{required:!0,serializedName:"LanguageId",type:{name:"String"}},textUnit:{required:!0,serializedName:"TextUnit",type:{name:"Enum",allowedValues:[0,1,2,4,8,16,32,64,256,16384]}},supportedCritiqueTag:{serializedName:"SupportedCritiqueTag",type:{name:"String"}}}}},_d={serializedName:"LanguageInfoResponseV1",type:{name:"Composite",className:"LanguageInfoResponseV1",modelProperties:Object.assign(Object.assign({},Ql.type.modelProperties),{supportedLanguages:{required:!0,serializedName:"SupportedLanguages",type:{name:"Sequence",element:{type:{name:"Composite",className:"SupportedLanguage"}}}}})}},Td={serializedName:"MetadataContent",type:{name:"Composite",className:"MetadataContent",modelProperties:{metadataType:{serializedName:"MetadataType",type:{name:"Enum",allowedValues:[0]}},value:{serializedName:"Value",type:{name:"String"}},typeId:{serializedName:"TypeId",type:{name:"Uuid"}}}}},Od={serializedName:"Metadata",type:{name:"Composite",className:"Metadata",modelProperties:Object.assign(Object.assign({},ud.type.modelProperties),{textUnitId:{serializedName:"TextUnitId",type:{name:"Number"}},textUnitRevisionId:{serializedName:"TextUnitRevisionId",type:{name:"Number"}},contents:{serializedName:"Contents",type:{name:"Sequence",element:{type:{name:"Composite",className:"MetadataContent"}}}}})}},Cd={serializedName:"TextElement",type:{name:"Composite",className:"TextElement",modelProperties:{languageId:{required:!0,serializedName:"LanguageId",type:{name:"String"}},text:{required:!0,serializedName:"Text",type:{name:"String"}},id:{required:!0,serializedName:"Id",type:{name:"String"}}}}},Ed={serializedName:"NeuralBatchCheckRequestV1",type:{name:"Composite",className:"NeuralBatchCheckRequestV1",modelProperties:{appId:{required:!0,serializedName:"AppId",type:{name:"String"}},descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}},languageUXId:{serializedName:"LanguageUXId",type:{name:"String"}},overriddenCritiqueTypeOptions:{serializedName:"OverriddenCritiqueTypeOptions",type:{name:"Sequence",element:{type:{name:"Composite",className:"CritiqueTypeOption"}}}},sessionId:{serializedName:"SessionId",type:{name:"String"}},content:{required:!0,serializedName:"Content",type:{name:"Sequence",element:{type:{name:"Composite",className:"TextElement"}}}}}}},Id={serializedName:"NeuralBatchCheckResponseV1",type:{name:"Composite",className:"NeuralBatchCheckResponseV1",modelProperties:Object.assign(Object.assign({},Ql.type.modelProperties),{critiques:{required:!0,serializedName:"Critiques",type:{name:"Sequence",element:{type:{name:"Composite",className:"Critique"}}}},metadata:{serializedName:"Metadata",type:{name:"Sequence",element:{type:{name:"String"}}}}})}},kd={serializedName:"NeuralRewriteRequestV1",type:{name:"Composite",className:"NeuralRewriteRequestV1",modelProperties:{appId:{serializedName:"AppId",type:{name:"String"}},languageId:{serializedName:"LanguageId",type:{name:"String"}},mode:{serializedName:"Mode",type:{name:"Number"}},selectionLength:{serializedName:"SelectionLength",defaultValue:0,type:{name:"Number"}},selectionStart:{serializedName:"SelectionStart",defaultValue:0,type:{name:"Number"}}}}},Ad={serializedName:"NeuralRewriteResponseV1",type:{name:"Composite",className:"NeuralRewriteResponseV1",modelProperties:Object.assign(Object.assign({},Ql.type.modelProperties),{requestId:{serializedName:"RequestId",type:{name:"Uuid"}},critiques:{required:!0,serializedName:"Critiques",type:{name:"Sequence",element:{type:{name:"Composite",className:"Critique"}}}},metadata:{serializedName:"Metadata",type:{name:"Sequence",element:{type:{name:"String"}}}}})}},Pd={serializedName:"SelectedLanguages",type:{name:"Composite",className:"SelectedLanguages",modelProperties:{tildId:{serializedName:"TildId",type:{name:"String"}},selectedLanguage:{serializedName:"SelectedLanguage",type:{name:"Sequence",element:{type:{name:"Sequence",element:{type:{name:"String"}}}}}}}}},Nd={serializedName:"SupportedActions",type:{name:"Composite",className:"SupportedActions",modelProperties:{supportedActions:{serializedName:"SupportedActions",type:{name:"Number"}}}}},jd={serializedName:"TopologyNode",type:{name:"Composite",className:"TopologyNode",modelProperties:{id:{required:!0,serializedName:"Id",type:{name:"String"}},revisionId:{required:!0,serializedName:"RevisionId",type:{name:"String"}},analyzerData:{serializedName:"AnalyzerData",type:{name:"Object"}},type:{serializedName:"Type",type:{name:"Enum",allowedValues:[0,1,2,3,4]}},children:{serializedName:"Children",type:{name:"Sequence",element:{type:{name:"Composite",className:"TopologyNode"}}}},numberOfChildren:{serializedName:"NumberOfChildren",type:{name:"Number"}},areChildsOrdered:{serializedName:"AreChildsOrdered",defaultValue:!1,type:{name:"Boolean"}}}}},Rd={serializedName:"TileCheckSpan",type:{name:"Composite",className:"TileCheckSpan",modelProperties:Object.assign(Object.assign({},Ml.type.modelProperties),{start:{serializedName:"Start",defaultValue:0,type:{name:"Number"}},length:{serializedName:"Length",defaultValue:"tileElement.Text.Length - span.Start",type:{name:"Number"}},doNotCheck:{serializedName:"DoNotCheck",type:{name:"Boolean"}},analyzerData:{serializedName:"AnalyzerData",type:{name:"Object"}}})}},xd={serializedName:"TileElement",type:{name:"Composite",className:"TileElement",modelProperties:{languageId:{required:!0,serializedName:"LanguageId",type:{name:"String"}},textUnit:{serializedName:"TextUnit",type:{name:"Enum",allowedValues:[0,1,2,4,8,16,32,64,256,16384]}},text:{required:!0,serializedName:"Text",type:{name:"String"}},enabledLanguages:{serializedName:"EnabledLanguages",type:{name:"Sequence",element:{type:{name:"Sequence",element:{type:{name:"Composite",className:"CommonLanguageIdProperty"}}}}}},isClean:{serializedName:"IsClean",type:{name:"Boolean"}},analyzerData:{serializedName:"AnalyzerData",type:{name:"Object"}},spans:{serializedName:"Spans",type:{name:"Sequence",element:{type:{name:"Composite",className:"TileCheckSpan"}}}}}}},Dd={serializedName:"TileContent",type:{name:"Composite",className:"TileContent",modelProperties:{tileId:{required:!0,serializedName:"TileId",type:{name:"String"}},revisionId:{required:!0,serializedName:"RevisionId",type:{name:"String"}},analyzerData:{serializedName:"AnalyzerData",type:{name:"Object"}},tileElements:{serializedName:"TileElements",type:{name:"Sequence",element:{type:{name:"Composite",className:"TileElement"}}}}}}},Md={serializedName:"TileCheckRequestV1",type:{name:"Composite",className:"TileCheckRequestV1",modelProperties:{appId:{required:!0,serializedName:"AppId",type:{name:"String"}},descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}},languageUXId:{required:!0,serializedName:"LanguageUXId",type:{name:"String"}},runOnProfileId:{serializedName:"RunOnProfileId",type:{name:"Uuid"}},overriddenCritiqueTypeOptions:{serializedName:"OverriddenCritiqueTypeOptions",type:{name:"Sequence",element:{type:{name:"Composite",className:"CritiqueTypeOption"}}}},sessionId:{serializedName:"SessionId",type:{name:"String"}},requestOrderInSession:{serializedName:"RequestOrderInSession",type:{name:"Number"}},content:{serializedName:"Content",type:{name:"Sequence",element:{type:{name:"Composite",className:"TileContent"}}}},topology:{serializedName:"Topology",type:{name:"Composite",className:"TopologyNode"}}}}},Ld={serializedName:"TileCheckCritique",type:{name:"Composite",className:"TileCheckCritique",modelProperties:{traceId:{serializedName:"TraceId",type:{name:"Uuid"}},typeId:{serializedName:"TypeId",type:{name:"Uuid"}},categoryTitle:{serializedName:"CategoryTitle",type:{name:"String"}},context:{serializedName:"Context",type:{name:"String"}},start:{serializedName:"Start",defaultValue:0,type:{name:"Number"}},startInContext:{serializedName:"StartInContext",defaultValue:0,type:{name:"Number"}},length:{serializedName:"Length",defaultValue:0,type:{name:"Number"}},languageId:{serializedName:"LanguageId",type:{name:"String"}},priority:{serializedName:"Priority",type:{name:"Number"}},metadata:{serializedName:"Metadata",type:{name:"Sequence",element:{type:{name:"Composite",className:"Metadatum"}}}},tileId:{serializedName:"TileId",type:{name:"String"}},revisionId:{serializedName:"RevisionId",type:{name:"String"}},supportedActions:{serializedName:"SupportedActions",type:{name:"Number"}},bucketId:{serializedName:"BucketId",type:{name:"Number"}},explanationTitle:{serializedName:"ExplanationTitle",type:{name:"String"}},explanationLabel:{serializedName:"ExplanationLabel",type:{name:"String"}},explanation:{serializedName:"Explanation",type:{name:"String"}},suggestions:{serializedName:"Suggestions",type:{name:"Sequence",element:{type:{name:"Composite",className:"Suggestion"}}}},status:{serializedName:"Status",type:{name:"Enum",allowedValues:[0,1,2]}},tag:{serializedName:"Tag",type:{name:"Enum",allowedValues:[0,1]}}}}},Bd={serializedName:"TileCheckResponseV1",type:{name:"Composite",className:"TileCheckResponseV1",modelProperties:Object.assign(Object.assign({},Ql.type.modelProperties),{critiques:{serializedName:"Critiques",type:{name:"Sequence",element:{type:{name:"Composite",className:"TileCheckCritique"}}}}})}},Fd={serializedName:"UserIdentity",type:{name:"Composite",className:"UserIdentity",modelProperties:{identityProvider:{required:!0,serializedName:"IdentityProvider",type:{name:"Number"}},puid:{required:!0,serializedName:"Puid",type:{name:"String"}},tenantId:{serializedName:"TenantId",type:{name:"String"}},cid:{serializedName:"Cid",type:{name:"String"}}}}},Ud={serializedName:"postcheck-headers",type:{name:"Composite",className:"PostCheckHeaders",modelProperties:{xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}}}},qd={serializedName:"getcheck-headers",type:{name:"Composite",className:"GetCheckHeaders",modelProperties:{xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}}}},zd={serializedName:"posttilecheck-headers",type:{name:"Composite",className:"PostTileCheckHeaders",modelProperties:{xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}}}},Wd={serializedName:"configv1-headers",type:{name:"Composite",className:"ConfigV1Headers",modelProperties:{xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}}}},Vd={serializedName:"configv2-headers",type:{name:"Composite",className:"ConfigV2Headers",modelProperties:{xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}}}},Gd={serializedName:"languageinfo-headers",type:{name:"Composite",className:"LanguageinfoHeaders",modelProperties:{xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}}}},Hd={serializedName:"neuralbatchcheck-headers",type:{name:"Composite",className:"NeuralbatchcheckHeaders",modelProperties:{xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}}}},$d={serializedName:"instrumentation-headers",type:{name:"Composite",className:"InstrumentationHeaders",modelProperties:{xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}}}};const Kd={parameterPath:["options","enabledLanguages"],mapper:{serializedName:"EnabledLanguages",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:n(298).a.Csv},Jd={parameterPath:"xCorrelationId",mapper:{serializedName:"X-CorrelationId",type:{name:"Uuid"}}},Qd={parameterPath:"xUserComposeSessionId",mapper:{serializedName:"X-UserComposeSessionId",type:{name:"Uuid"}}},Yd={parameterPath:"xUserId",mapper:{serializedName:"X-UserId",type:{name:"String"}}},Xd={parameterPath:"xUserSessionId",mapper:{serializedName:"X-UserSessionId",type:{name:"Uuid"}}};var Zd=n(1040),ef=n(444);class tf extends Zd.a{constructor(e){if(e||(e={}),!e.userAgent){const t=ef.b();e.userAgent=`@editor/client-rest-api/1.221.3 ${t}`}super(void 0,e),this.baseUri=e.baseUri||this.baseUri||"https://nleditor.osi.officeppe.net/",this.requestContentType="application/json; charset=utf-8",null!==e.xCorrelationId&&void 0!==e.xCorrelationId&&(this.xCorrelationId=e.xCorrelationId),null!==e.xUserSessionId&&void 0!==e.xUserSessionId&&(this.xUserSessionId=e.xUserSessionId),null!==e.xUserComposeSessionId&&void 0!==e.xUserComposeSessionId&&(this.xUserComposeSessionId=e.xUserComposeSessionId),null!==e.xUserId&&void 0!==e.xUserId&&(this.xUserId=e.xUserId),null!==e.authorization&&void 0!==e.authorization&&(this.authorization=e.authorization),null!==e.serverToServerId&&void 0!==e.serverToServerId&&(this.serverToServerId=e.serverToServerId)}}class nf extends tf{constructor(e){super(e)}postCheck(e,t,n){return this.sendOperationRequest({body:e,options:t},of,n)}getCheck(e,t,n,r,i){return this.sendOperationRequest({appId:e,text:t,languageId:n,options:r},af,i)}insights(e,t,n){return this.sendOperationRequest({body:e,options:t},sf,n)}browserextension(e,t,n){return this.sendOperationRequest({body:e,options:t},uf,n)}postTileCheck(e,t,n){return this.sendOperationRequest({body:e,options:t},cf,n)}configV1(e,t,n){return this.sendOperationRequest({body:e,options:t},lf,n)}configV2(e,t,n){return this.sendOperationRequest({body:e,options:t},df,n)}languageinfo(e,t,n){return this.sendOperationRequest({body:e,options:t},ff,n)}neuralbatchcheck(e,t,n){return this.sendOperationRequest({body:e,options:t},hf,n)}neuralrewrite(e,t,n){return this.sendOperationRequest({body:e,options:t},pf,n)}instrumentation(e,t,n){return this.sendOperationRequest({body:e,options:t},gf,n)}}const rf=new Il.b(i),of={httpMethod:"POST",path:"NLEditor/api/V1/Check",headerParameters:[Jd,Xd,Yd,Qd],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},Wl),{required:!0})},responses:{200:{bodyMapper:Yl,headersMapper:Ud},400:{headersMapper:Ud},500:{headersMapper:Ud},default:{}},serializer:rf},af={httpMethod:"GET",path:"NLEditor/api/V1/Check",queryParameters:[{parameterPath:"appId",mapper:{required:!0,serializedName:"AppId",type:{name:"String"}}},{parameterPath:["options","autoSelect"],mapper:{serializedName:"AutoSelect",type:{name:"Boolean"}}},Kd,{parameterPath:"text",mapper:{required:!0,serializedName:"Text",type:{name:"String"}}},{parameterPath:"languageId",mapper:{required:!0,serializedName:"LanguageId",type:{name:"String"}}},{parameterPath:["options","appVersion"],mapper:{serializedName:"AppVersion",type:{name:"String"}}},{parameterPath:["options","descriptors0Name"],mapper:{serializedName:"Descriptors[0].Name",type:{name:"String"}}},{parameterPath:["options","descriptors0Value"],mapper:{serializedName:"Descriptors[0].Value",type:{name:"String"}}},{parameterPath:["options","descriptors1Name"],mapper:{serializedName:"Descriptors[1].Name",type:{name:"String"}}},{parameterPath:["options","descriptors1Value"],mapper:{serializedName:"Descriptors[1].Value",type:{name:"String"}}},{parameterPath:["options","languageUXId"],mapper:{serializedName:"LanguageUXId",type:{name:"String"}}},{parameterPath:["options","runOnProfileId"],mapper:{serializedName:"RunOnProfileId",type:{name:"String"}}},{parameterPath:["options","length"],mapper:{serializedName:"Length",type:{name:"Number"}}},{parameterPath:["options","start"],mapper:{serializedName:"Start",type:{name:"Number"}}},{parameterPath:["options","requestId"],mapper:{serializedName:"RequestId",type:{name:"Uuid"}}},{parameterPath:["options","textUnit"],mapper:{serializedName:"TextUnit",type:{name:"String"}}}],headerParameters:[Jd,Xd,Yd],responses:{200:{bodyMapper:Yl,headersMapper:qd},400:{headersMapper:qd},500:{headersMapper:qd},default:{}},serializer:rf},sf={httpMethod:"POST",path:"NLEditor/api/V1/Insights",headerParameters:[Jd,Xd,Yd],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},md),{required:!0})},responses:{200:{bodyMapper:bd},400:{},500:{},default:{}},serializer:rf},uf={httpMethod:"POST",path:"NLEditor/api/V1/BrowserExtension",headerParameters:[Jd,Xd,Yd],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},Rl),{required:!0})},responses:{200:{bodyMapper:xl},400:{},500:{},default:{}},serializer:rf},cf={httpMethod:"POST",path:"NLEditor/api/V1/TileCheck",headerParameters:[Jd,Xd,Yd,Qd],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},Md),{required:!0})},responses:{200:{bodyMapper:Bd,headersMapper:zd},400:{headersMapper:zd},500:{headersMapper:zd},default:{}},serializer:rf},lf={httpMethod:"POST",path:"NLEditor/api/V1/Config",headerParameters:[Jd,Xd,Yd,Qd],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},cd),{required:!0})},responses:{200:{bodyMapper:hd,headersMapper:Wd},400:{headersMapper:Wd},500:{headersMapper:Wd},default:{}},serializer:rf},df={httpMethod:"POST",path:"NLEditor/Config/V2",headerParameters:[Jd,Xd,Yd,Qd],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},pd),{required:!0})},responses:{200:{bodyMapper:gd,headersMapper:Vd},400:{headersMapper:Vd},500:{headersMapper:Vd},default:{}},serializer:rf},ff={httpMethod:"POST",path:"NLEditor/api/V1/LanguageInfo",headerParameters:[Jd,Xd,Yd],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},wd),{required:!0})},responses:{200:{bodyMapper:_d,headersMapper:Gd},400:{headersMapper:Gd},500:{headersMapper:Gd},default:{}},serializer:rf},hf={httpMethod:"POST",path:"NLEditor/api/V1/NeuralBatchCheck",headerParameters:[Jd,Xd,Yd],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},Ed),{required:!0})},responses:{200:{bodyMapper:Id,headersMapper:Hd},400:{headersMapper:Hd},500:{headersMapper:Hd},default:{}},serializer:rf},pf={httpMethod:"POST",path:"NLEditor/api/V1/NeuralRewrite",headerParameters:[Jd,Xd,Yd],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},kd),{required:!0})},responses:{200:{bodyMapper:Ad},400:{},500:{},default:{}},serializer:rf},gf={httpMethod:"POST",path:"NLEditor/api/V1/Instrumentation",headerParameters:[Jd,Xd,Qd,{parameterPath:"serverToServerId",mapper:{serializedName:"ServerToServerId",type:{name:"String"}}}],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},vd),{required:!0})},responses:{200:{headersMapper:$d},400:{headersMapper:$d},500:{headersMapper:$d},default:{}},serializer:rf};function mf(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yf(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function bf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vf(e,t,n){return vf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=wf(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n||e):i.value}},vf(e,t,n||e)}function wf(e){return wf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},wf(e)}function Sf(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?mf(e):t;var n}function _f(e,t){return _f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_f(e,t)}function Tf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=wf(e);if(t){var i=wf(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Sf(this,n)}}function Of(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Cf,Ef=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_f(e,t)}(o,e);var t,n,r,i=Tf(o);function o(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r=i.call(this,n),Object.defineProperty(mf(r),"featureFlagsReader",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(mf(r),"userInfoStrategy",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(mf(r),"options",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(mf(r),"regionScope",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r}return t=o,n=[{key:"sendOperationRequest",value:function(e,t,n){var r,i=this,a=this;return(r=function(){return Of(this,(function(r){return a.featureFlagsReader.flags.enableEditorServiceRouting&&a.updateBaseUri(),[2,vf(wf(o.prototype),"sendOperationRequest",i).call(a,e,t,n)]}))},function(){var e=this,t=arguments;return new Promise((function(n,i){var o=r.apply(e,t);function a(e){yf(o,n,i,a,s,"next",e)}function s(e){yf(o,n,i,a,s,"throw",e)}a(void 0)}))})()}},{key:"updateBaseUri",value:function(){var e=this;this.userInfoStrategy.execute(!1,(function(t){return t&&t.regionScope!==e.regionScope&&(e.regionScope=t.regionScope,e.baseUri=e.regionScope===Ln.d.GCC?"https://".concat(El.a.GCCHigh):e.options.baseUri),t}))}}],n&&bf(t.prototype,n),r&&bf(t,r),o}(nf);function If(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function kf(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){If(o,r,i,a,s,"next",e)}function s(e){If(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Af(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pf(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Ef=Object(le.c)([Object(he.a)(),Object(le.e)("design:paramtypes",[Object,Object,Object])],Ef);var Nf=Cf=function(){function e(t,n,r,i,o,a){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_systemPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_announcementsPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_userInfoStrategy",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"_featureFlagsReader",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"_contentScriptEmitter",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_timer",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"daysBeforeSignInAnnouncementShown",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"alarmName",{enumerable:!0,configurable:!0,writable:!0,value:"SignInAnnouncementDetector"});var u=this;Object.defineProperty(this,"onAlarm",{enumerable:!0,configurable:!0,writable:!0,value:kf((function(){return Pf(this,(function(e){switch(e.label){case 0:return[4,u.detect()];case 1:return e.sent()||u._timer.clearTimer(u.alarmName),[2]}}))}))}),Object.defineProperty(this,"_getDaysReshownAfterDismiss",{enumerable:!0,configurable:!0,writable:!0,value:function(){return s._featureFlagsReader.flags.enableSignInAnnouncementReshownWeekly?7:s._featureFlagsReader.flags.enableSignInAnnouncementReshownBiweekly?14:s._featureFlagsReader.flags.enableSignInAnnouncementReshownMonthly?30:-1}})}var t,n,r;return t=e,(n=[{key:"schedule",value:function(e){var t=this;return kf((function(){var n;return Pf(this,(function(r){return n=6e4*e,t._timer.setIntervalWithDelay(t.alarmName,t.onAlarm,n,n),[2]}))}))()}},{key:"detect",value:function(){var e=this;return kf((function(){var t,n,r,i;return Pf(this,(function(o){switch(o.label){case 0:return[4,e._getUserInfo()];case 1:return o.sent()?[2,!1]:[4,e._announcementsPersistedStore.read(qu.a.SignInAnnouncementDismissed)];case 2:return t=o.sent(),e._featureFlagsReader.flags.enableSignInAnnouncement?[4,e._systemPersistedStore.getLastUpdatedTimestamp(l.a.FirstInstallVersion)]:[2,!0];case 3:return void 0===(n=o.sent())||Cf._getDaysPassed(n)>=e.daysBeforeSignInAnnouncementShown?t?[4,e._announcementsPersistedStore.getLastUpdatedTimestamp(qu.a.SignInAnnouncementDismissed)]:[3,5]:[3,9];case 4:if(void 0===(r=o.sent()))return[2,!1];if((i=e._getDaysReshownAfterDismiss())<0||Cf._getDaysPassed(r)<i)return[2,!0];o.label=5;case 5:return e._contentScriptEmitter.emit(Uu.a.initReactApp,{address:void 0,message:void 0}),t?[4,e._announcementsPersistedStore.write(qu.a.SignInAnnouncementDismissed,!1)]:[3,7];case 6:o.sent(),o.label=7;case 7:return[4,e._announcementsPersistedStore.write(qu.a.SignInAnnouncementVisible,!0)];case 8:return o.sent(),[2,!1];case 9:return[2,!0]}}))}))()}},{key:"_getUserInfo",value:function(){var e=this;return kf((function(){var t;return Pf(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e._userInfoStrategy.executeAsync(!0)];case 1:return t=n.sent(),[3,3];case 2:return n.sent(),[3,3];case 3:return[2,t]}}))}))()}}])&&Af(t.prototype,n),r&&Af(t,r),e}();function jf(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Rf(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){jf(o,r,i,a,s,"next",e)}function s(e){jf(o,r,i,a,s,"throw",e)}a(void 0)}))}}function xf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Df(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.defineProperty(Nf,"_getDaysPassed",{enumerable:!0,configurable:!0,writable:!0,value:function(e){var t=Date.now()-e;return Math.floor(t/1e3/60/60/24)}}),Nf=Cf=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(c.a)),Object(le.f)(1,Object(pe.a)(zu.a)),Object(le.f)(2,Object(pe.a)(N.a)),Object(le.f)(3,Object(pe.a)(v.a)),Object(le.f)(4,Object(pe.a)(Uu.b)),Object(le.f)(5,Object(pe.a)(M.a)),Object(le.e)("design:paramtypes",[Object,Object,Object,Object,Object,Object])],Nf);var Mf=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_featureFlagsReader",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_announcementsPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_settingsEmitter",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"_userInfoStrategy",{enumerable:!0,configurable:!0,writable:!0,value:i});var o=this;Object.defineProperty(this,"_showUserDictionaryAnnouncement",{enumerable:!0,configurable:!0,writable:!0,value:Rf((function(){var e;return Df(this,(function(t){switch(t.label){case 0:return[4,o._featureFlagsReader.refreshFlags()];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,12,,13]),o._featureFlagsReader.flags.enableUserDictionaryAnnouncement?[3,4]:[4,o._announcementsPersistedStore.write(qu.a.EligibleForRoamingDictionaryAnnouncement,!0)];case 3:return t.sent(),[2];case 4:return[4,o._shouldShowAnnouncement()];case 5:return t.sent()?[4,o._userInfoStrategy.executeAsync(!1)]:(o._settingsEmitter.off(hc.a.FeatureFlags),[2]);case 6:return(e=t.sent())?e.roamingToken?[4,o._announcementsPersistedStore.write(qu.a.RoamingDictionaryLoggedInAnnouncementVisible,!0)]:[3,8]:[3,9];case 7:t.sent(),t.label=8;case 8:return[3,11];case 9:return[4,o._announcementsPersistedStore.write(qu.a.RoamingDictionaryLoggedOutAnnouncementVisible,!0)];case 10:t.sent(),t.label=11;case 11:return[3,13];case 12:return t.sent(),[3,13];case 13:return[2]}}))}))});var a=this;Object.defineProperty(this,"_shouldShowAnnouncement",{enumerable:!0,configurable:!0,writable:!0,value:Rf((function(){var e,t,n;return Df(this,(function(r){switch(r.label){case 0:return[4,a._announcementsPersistedStore.read(qu.a.RoamingDictionaryLoggedOutAnnouncementDismissed)];case 1:return e=r.sent(),[4,a._announcementsPersistedStore.read(qu.a.RoamingDictionaryLoggedInAnnouncementDismissed)];case 2:return t=r.sent(),[4,a._announcementsPersistedStore.read(qu.a.EligibleForRoamingDictionaryAnnouncement)];case 3:return n=r.sent(),[2,!e&&!t&&n]}}))}))})}var t,n,r;return t=e,(n=[{key:"initialize",value:function(){var e=this;return Rf((function(){return Df(this,(function(t){return e._settingsEmitter.on(hc.a.FeatureFlags,e._showUserDictionaryAnnouncement),[2]}))}))()}},{key:"shutDown",value:function(){}}])&&xf(t.prototype,n),r&&xf(t,r),e}();Mf=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(v.a)),Object(le.f)(1,Object(pe.a)(zu.a)),Object(le.f)(2,Object(pe.a)(Ws.a)),Object(le.f)(3,Object(pe.a)(N.a)),Object(le.e)("design:paramtypes",[Object,Object,Object,Object])],Mf);var Lf=n(217),Bf=n(70);function Ff(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Uf(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Ff(o,r,i,a,s,"next",e)}function s(e){Ff(o,r,i,a,s,"throw",e)}a(void 0)}))}}function qf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zf(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Wf=function(){function e(t,n,r,i,o,a,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_proofingStore",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_languageInfo",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_detector",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"_logger",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"_extensionSettings",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_contentScriptEmitter",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"_settingsEmitter",{enumerable:!0,configurable:!0,writable:!0,value:s});var u=this;Object.defineProperty(this,"_pickLanguages",{enumerable:!0,configurable:!0,writable:!0,value:Uf((function(){var e,t,n,r,i,o,a,s,c,l,d,f;return zf(this,(function(h){switch(h.label){case 0:return[4,u._proofingStore.read(de.a.DefaultProofingLanguageInitialized)];case 1:return e=h.sent(),[4,u._proofingStore.read(de.a.ProofingLanguageListInitialized)];case 2:return h.sent()?[2]:(t=[],r=Lf.a.bind,[4,u._proofingStore.read(de.a.ProofingLanguages)]);case 3:return n=new(r.apply(Lf.a,[void 0,h.sent()])),e&&t.push(n.defaultLanguageCode),[4,u._detector.getBrowserLanguages()];case 4:i=h.sent(),o=!0,a=!1,s=void 0;try{for(c=i[Symbol.iterator]();!(o=(l=c.next()).done);o=!0)if(d=l.value,t.indexOf(d)<0){if(!(f=u._languageInfo.getLanguageInfo(d)))continue;if(t.indexOf(f.languageId)<0&&t.push(f.languageId),t.length===u._extensionSettings.maxProofingLanguages)break}}catch(e){a=!0,s=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}return u._logger.debug(509646616,"Picked new default proofing languages: ".concat(t)),0===t.length?[2]:[4,u._proofingStore.write(de.a.ProofingLanguages,t)];case 5:return h.sent(),u._settingsEmitter.emit(de.a.ProofingLanguages),u._contentScriptEmitter.emit(Uu.a.uninstallParametersChangedEvent),[2]}}))}))})}var t,n,r;return t=e,(n=[{key:"initialize",value:function(){var e=this;return Uf((function(){return zf(this,(function(t){switch(t.label){case 0:return e._contentScriptEmitter.on(Uu.a.authorization,e._pickLanguages),[4,e._pickLanguages()];case 1:return t.sent(),[2]}}))}))()}},{key:"shutDown",value:function(){}}])&&qf(t.prototype,n),r&&qf(t,r),e}();Wf=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(K.a)),Object(le.f)(1,Object(pe.a)(k.a)),Object(le.f)(2,Object(pe.a)(P.a)),Object(le.f)(3,Object(pe.a)(o.a)),Object(le.f)(4,Object(pe.a)(Bf.a)),Object(le.f)(5,Object(pe.a)(Uu.b)),Object(le.f)(6,Object(pe.a)(Ws.a)),Object(le.e)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object])],Wf);const Vf={"aa-dj":"Qafar (Yabuuti)","aa-er":"Qafar (Eretria)","aa-et":"Qafar (Otobbia)","af-na":"Afrikaans (Namibi)","af-za":"Afrikaans (Suid-Afrika)","agq-cm":"Aghem (Kml)","ak-gh":"Akan (Gaana)","am-et":" ()","ar-001":[" ()",!0],"ar-ae":[" (  )",!0],"ar-bh":[" ()",!0],"ar-dj":[" ()",!0],"ar-dz":[" ()",!0],"ar-eg":[" ()",!0],"ar-er":[" ()",!0],"ar-il":[" ()",!0],"ar-iq":[" ()",!0],"ar-jo":[" ()",!0],"ar-km":[" ( )",!0],"ar-kw":[" ()",!0],"ar-lb":[" ()",!0],"ar-ly":[" ()",!0],"ar-ma":[" ( )",!0],"ar-mr":[" ()",!0],"ar-om":[" ()",!0],"ar-ps":[" ( )",!0],"ar-qa":[" ()",!0],"ar-sa":[" (  )",!0],"ar-sd":[" ()",!0],"ar-so":[" ()",!0],"ar-ss":[" ( )",!0],"ar-sy":[" ()",!0],"ar-td":[" ()",!0],"ar-tn":[" ()",!0],"ar-ye":[" ()",!0],"arn-cl":"Mapudungun (Chile)","as-in":" ()","asa-tz":"Kipare (Tadhania)","ast-es":"asturianu (Espaa)","az-cyrl-az":" ()","az-latn-az":"azrbaycan (Azrbaycan)","ba-ru":" ()","bas-cm":"sa (Kmrn)","be-by":" ()","bem-zm":"Ichibemba (Zambia)","bez-tz":"Hibena (Hutanzania)","bg-bg":" ()","bin-ng":"d (Nigeria)","bm-latn-ml":"bamanakan (Mali)","bn-bd":" ()","bn-in":" ()","bo-cn":" ()","bo-in":" ()","br-fr":"brezhoneg (Fras)","brx-in":" ()","bs-cyrl-ba":" (  )","bs-latn-ba":"bosanski (Bosna i Hercegovina)","byn-er":" ()","ca-ad":"catal (Andorra)","ca-es":"catal (catal)","ca-es-valencia":"valenci (Espanya)","ca-fr":"catal (Frana)","ca-it":"catal (Itlia)","ccp-cakm-bd":" ()","ccp-cakm-in":" ()","ce-ru":" ()","ceb-latn-ph":"Cebuano (Pilipinas)","cgg-ug":"Rukiga (Uganda)","chr-cher-us":" (  )","co-fr":"Corsu (Francia)","cs-cz":"etina (esko)","cu-ru":" ()","cy-gb":"Cymraeg (Y Deyrnas Unedig)","da-dk":"dansk (Danmark)","da-gl":"dansk (Grnland)","dav-ke":"Kitaita (Kenya)","de-at":"Deutsch (sterreich)","de-be":"Deutsch (Belgien)","de-ch":"Deutsch (Schweiz)","de-de":"Deutsch (Deutschland)","de-it":"Deutsch (Italien)","de-li":"Deutsch (Liechtenstein)","de-lu":"Deutsch (Luxemburg)","dje-ne":"Zarmaciine (Nier)","dsb-de":"dolnoserbina (Nimska)","dua-cm":"dul (Cameroun)","dv-mv":[" ( )",!0],"dyo-sn":"joola (Senegal)","dz-bt":" ()","ebu-ke":"Kembu (Kenya)","ee-gh":"Eegbe (Ghana nutome)","ee-tg":"Eegbe (Togo nutome)","el-cy":" ()","el-gr":" ()","en-001":"English (World)","en-029":"English (Caribbean)","en-150":"English (Europe)","en-ae":"English (United Arab Emirates)","en-ag":"English (Antigua & Barbuda)","en-ai":"English (Anguilla)","en-as":"English (American Samoa)","en-at":"English (Austria)","en-au":"English (Australia)","en-bb":"English (Barbados)","en-be":"English (Belgium)","en-bi":"English (Burundi)","en-bm":"English (Bermuda)","en-bs":"English (Bahamas)","en-bw":"English (Botswana)","en-bz":"English (Belize)","en-ca":"English (Canada)","en-cc":"English (Cocos (Keeling) Islands)","en-ch":"English (Switzerland)","en-ck":"English (Cook Islands)","en-cm":"English (Cameroon)","en-cx":"English (Christmas Island)","en-cy":"English (Cyprus)","en-de":"English (Germany)","en-dk":"English (Denmark)","en-dm":"English (Dominica)","en-er":"English (Eritrea)","en-fi":"English (Finland)","en-fj":"English (Fiji)","en-fk":"English (Falkland Islands)","en-fm":"English (Micronesia)","en-gb":"English (United Kingdom)","en-gd":"English (Grenada)","en-gg":"English (Guernsey)","en-gh":"English (Ghana)","en-gi":"English (Gibraltar)","en-gm":"English (Gambia)","en-gu":"English (Guam)","en-gy":"English (Guyana)","en-hk":"English (Hong Kong SAR)","en-id":"English (Indonesia)","en-ie":"English (Ireland)","en-il":"English (Israel)","en-im":"English (Isle of Man)","en-in":"English (India)","en-io":"English (British Indian Ocean Territory)","en-je":"English (Jersey)","en-jm":"English (Jamaica)","en-ke":"English (Kenya)","en-ki":"English (Kiribati)","en-kn":"English (St. Kitts & Nevis)","en-ky":"English (Cayman Islands)","en-lc":"English (St. Lucia)","en-lr":"English (Liberia)","en-ls":"English (Lesotho)","en-mg":"English (Madagascar)","en-mh":"English (Marshall Islands)","en-mo":"English (Macao SAR)","en-mp":"English (Northern Mariana Islands)","en-ms":"English (Montserrat)","en-mt":"English (Malta)","en-mu":"English (Mauritius)","en-mw":"English (Malawi)","en-my":"English (Malaysia)","en-na":"English (Namibia)","en-nf":"English (Norfolk Island)","en-ng":"English (Nigeria)","en-nl":"English (Netherlands)","en-nr":"English (Nauru)","en-nu":"English (Niue)","en-nz":"English (New Zealand)","en-pg":"English (Papua New Guinea)","en-ph":"English (Philippines)","en-pk":"English (Pakistan)","en-pn":"English (Pitcairn Islands)","en-pr":"English (Puerto Rico)","en-pw":"English (Palau)","en-rw":"English (Rwanda)","en-sb":"English (Solomon Islands)","en-sc":"English (Seychelles)","en-sd":"English (Sudan)","en-se":"English (Sweden)","en-sg":"English (Singapore)","en-sh":"English (St Helena, Ascension, Tristan da Cunha)","en-si":"English (Slovenia)","en-sl":"English (Sierra Leone)","en-ss":"English (South Sudan)","en-sx":"English (Sint Maarten)","en-sz":"English (Eswatini)","en-tc":"English (Turks & Caicos Islands)","en-tk":"English (Tokelau)","en-to":"English (Tonga)","en-tt":"English (Trinidad & Tobago)","en-tv":"English (Tuvalu)","en-tz":"English (Tanzania)","en-ug":"English (Uganda)","en-um":"English (U.S. Outlying Islands)","en-us":"English (United States)","en-vc":"English (St. Vincent & Grenadines)","en-vg":"English (British Virgin Islands)","en-vi":"English (U.S. Virgin Islands)","en-vu":"English (Vanuatu)","en-ws":"English (Samoa)","en-za":"English (South Africa)","en-zm":"English (Zambia)","en-zw":"English (Zimbabwe)","eo-001":"esperanto (Mondo)","es-419":"espaol (Latinoamrica)","es-ar":"espaol (Argentina)","es-bo":"espaol (Bolivia)","es-br":"espaol (Brasil)","es-bz":"espaol (Belice)","es-cl":"espaol (Chile)","es-co":"espaol (Colombia)","es-cr":"espaol (Costa Rica)","es-cu":"espaol (Cuba)","es-do":"espaol (Repblica Dominicana)","es-ec":"espaol (Ecuador)","es-es":"espaol (Espaa, alfabetizacin internacional)","es-es_tradnl":"espaol (Espaa, alfabetizacin tradicional)","es-gq":"espaol (Guinea Ecuatorial)","es-gt":"espaol (Guatemala)","es-hn":"espaol (Honduras)","es-mx":"espaol (Mxico)","es-ni":"espaol (Nicaragua)","es-pa":"espaol (Panam)","es-pe":"espaol (Per)","es-ph":"espaol (Filipinas)","es-pr":"espaol (Puerto Rico)","es-py":"espaol (Paraguay)","es-sv":"espaol (El Salvador)","es-us":"espaol (Estados Unidos)","es-uy":"espaol (Uruguay)","es-ve":"espaol (Venezuela)","et-ee":"eesti (Eesti)","eu-es":"euskara (euskara)","ewo-cm":"ewondo (Kamrn)","fa-ir":[" ()",!0],"ff-latn-bf":"Pulaar (Burkibaa Faaso)","ff-latn-cm":"Pulaar (Kameruun)","ff-latn-gh":"Pulaar (Ganaa)","ff-latn-gm":"Pulaar (Gammbi)","ff-latn-gn":"Pulaar (Gine)","ff-latn-gw":"Pulaar (Gine-Bisaawo)","ff-latn-lr":"Pulaar (Liberiyaa)","ff-latn-mr":"Pulaar (Muritani)","ff-latn-ne":"Pulaar (Nijeer)","ff-latn-ng":"Pulaar (Nijeriyaa)","ff-latn-sl":"Pulaar (Seraa liyon)","ff-latn-sn":"Pulaar (Senegaal)","fi-fi":"suomi (Suomi)","fil-ph":"Filipino (Pilipinas)","fo-dk":"froyskt (Danmark)","fo-fo":"froyskt (Froyar)","fr-029":"franais (carabes)","fr-be":"franais (Belgique)","fr-bf":"franais (Burkina Faso)","fr-bi":"franais (Burundi)","fr-bj":"franais (Bnin)","fr-bl":"franais (Saint-Barthlemy)","fr-ca":"franais (Canada)","fr-cd":"franais (Congo, Rpublique dmocratique du)","fr-cf":"franais (Rpublique centrafricaine)","fr-cg":"franais (Congo)","fr-ch":"franais (Suisse)","fr-ci":"franais (Cte dIvoire)","fr-cm":"franais (Cameroun)","fr-dj":"franais (Djibouti)","fr-dz":"franais (Algrie)","fr-fr":"franais (France)","fr-ga":"franais (Gabon)","fr-gf":"franais (Guyane franaise)","fr-gn":"franais (Guine)","fr-gp":"franais (Guadeloupe)","fr-gq":"franais (Guine quatoriale)","fr-ht":"franais (Hati)","fr-km":"franais (Comores)","fr-lu":"franais (Luxembourg)","fr-ma":"franais (Maroc)","fr-mc":"franais (Monaco)","fr-mf":"franais (Saint-Martin)","fr-mg":"franais (Madagascar)","fr-ml":"franais (Mali)","fr-mq":"franais (Martinique)","fr-mr":"franais (Mauritanie)","fr-mu":"franais (Maurice)","fr-nc":"franais (Nouvelle-Caldonie)","fr-ne":"franais (Niger)","fr-pf":"franais (Polynsie franaise)","fr-pm":"franais (Saint-Pierre-et-Miquelon)","fr-re":"franais (La Runion)","fr-rw":"franais (Rwanda)","fr-sc":"franais (Seychelles)","fr-sn":"franais (Sngal)","fr-sy":"franais (Syrie)","fr-td":"franais (Tchad)","fr-tg":"franais (Togo)","fr-tn":"franais (Tunisie)","fr-vu":"franais (Vanuatu)","fr-wf":"franais (Wallis-et-Futuna)","fr-yt":"franais (Mayotte)","fur-it":"furlan (Italie)","fy-nl":"Frysk (Nederln)","ga-ie":"Gaeilge (ire)","gd-gb":"Gidhlig (An Roghachd Aonaichte)","gl-es":"galego (galego)","gn-py":"Avae (Paragui)","gsw-ch":"Schwiizerttsch (Schwiiz)","gsw-fr":"Elsssisch (Frnkrisch)","gsw-li":"Schwiizerttsch (Lichteschti)","gu-in":" ()","guz-ke":"Ekegusii (Kenya)","gv-im":"Gaelg (Ellan Vannin)","ha-latn-gh":"Hausa (Gana)","ha-latn-ne":"Hausa (Nijar)","ha-latn-ng":"Hausa (Najeriya)","haw-us":"lelo Hawaii (Amelika Hui P Ia)","he-il":[" ()",!0],"hi-in":" ()","hr-ba":"hrvatski (Bosna i Hercegovina)","hr-hr":"hrvatski (Hrvatska)","hsb-de":"hornjoserbina (Nmska)","hu-hu":"magyar (Magyarorszg)","hy-am":" ()","ia-001":"interlingua (Mundo)","ibb-ng":"Ibibio-Efik (Nigeria)","id-id":"Indonesia (Indonesia)","ig-ng":"Ass Igbo (Najra)","ii-cn":" ()","is-is":"slenska (sland)","it-ch":"italiano (Svizzera)","it-it":"italiano (Italia)","it-sm":"italiano (San Marino)","it-va":"italiano (Citt del Vaticano)","iu-cans-ca":" ()","iu-latn-ca":"Inuktitut (Kanatami)","ja-jp":" ()","jgo-cm":"Ndaa (Kamln)","jmc-tz":"Kimachame (Tanzania)","jv-java-id":" (Indonesia)","jv-latn-id":"Basa Jawa (Indonesia)","ka-ge":" ()","kab-dz":"Taqbaylit (Lezzayer)","kam-ke":"Kikamba (Kenya)","kde-tz":"Chimakonde (Tanzania)","kea-cv":"kabuverdianu (Kabu Verdi)","khq-ml":"Koyra ciini (Maali)","ki-ke":"Gikuyu (Kenya)","kk-kz":"  ()","kkj-cm":"kak (Kamrun)","kl-gl":"kalaallisut (Kalaallit Nunaat)","kln-ke":"Kalenjin (Emetab Kenya)","km-kh":" ()","kn-in":" ()","ko-kp":" ()","ko-kr":"()","kok-in":" ()","kr-latn-ng":"Kanuri (Nigeria)","ks-arab-in":" ()","ks-deva-in":"","ksb-tz":"Kishambaa (Tanzania)","ksf-cm":"rikpa (kamrn)","ksh-de":"Klsch (Dotschland)","ku-arab-iq":["  ()",!0],"ku-arab-ir":" ()","kw-gb":"kernewek (Rywvaneth Unys)","ky-kg":" ()","la-001":"lingua latna (World)","lag-tz":"Klaangi (Taansana)","lb-lu":"Ltzebuergesch (Ltzebuerg)","lg-ug":"Luganda (Yuganda)","lkt-us":"Lakliyapi (Mlahaska Tamkohe)","ln-ao":"lingla (Angla)","ln-cd":"lingla (Republki ya Kong Demokratki)","ln-cf":"lingla (Repibiki ya Afrka ya Kti)","ln-cg":"lingla (Kongo)","lo-la":" ()","lrc-iq":"  (Iraq)","lrc-ir":"  (Iran)","lt-lt":"lietuvi (Lietuva)","lu-cd":"Tshiluba (Ditunga wa Kongu)","luo-ke":"Dholuo (Kenya)","luy-ke":"Luluhia (Kenya)","lv-lv":"latvieu (Latvija)","mas-ke":"Maa (Kenya)","mas-tz":"Maa (Tansania)","mer-ke":"Kmr (Kenya)","mfe-mu":"kreol morisien (Moris)","mg-mg":"Malagasy (Madagasikara)","mgh-mz":"Makua (Umozambiki)","mgo-cm":"meta (Kamalun)","mi-nz":"te reo Mori (Aotearoa)","mk-mk":" ( )","ml-in":" ()","mn-mn":" ()","mn-mong-cn":"  (    )","mn-mong-mn":"  ( )","mni-in":" (India)","moh-ca":"Kanien'kha","mr-in":" ()","ms-bn":"Melayu (Brunei)","ms-my":"Melayu (Malaysia)","ms-sg":"Melayu (Singapura)","mt-mt":"Malti (Malta)","mua-cm":"MUNDA (kameru)","my-mm":" ()","mzn-ir":" ()","naq-na":"Khoekhoegowab (Namibiab)","nb-no":"norsk bokml (Norge)","nb-sj":"norsk bokml (Svalbard og Jan Mayen)","nd-zw":"isiNdebele (Zimbabwe)","nds-de":"Neddersasssch (Dtschland)","nds-nl":"Neddersasssch (Nedderlannen)","ne-in":" ()","ne-np":" ()","nl-aw":"Nederlands (Aruba)","nl-be":"Nederlands (Belgi)","nl-bq":"Nederlands (Bonaire, Sint Eustatius en Saba)","nl-cw":"Nederlands (Curaao)","nl-nl":"Nederlands (Nederland)","nl-sr":"Nederlands (Suriname)","nl-sx":"Nederlands (Sint-Maarten)","nmg-cm":"Kwasio (Kamerun)","nn-no":"nynorsk (Noreg)","nnh-cm":"Shw ngiembn (Kmalm)","nqo-gn":[" ( )",!0],"nr-za":"isiNdebele (South Africa)","nso-za":"Sesotho sa Leboa (Afrika Borwa)","nus-ss":"Thok Nath (South Sudan)","nyn-ug":"Runyankore (Uganda)","oc-fr":"Occitan (Frana)","om-et":"Oromoo (Itoophiyaa)","om-ke":"Oromoo (Keeniyaa)","or-in":" ()","os-ge":" ()","os-ru":" ()","pa-arab-pk":[" ()",!0],"pa-in":" ()","pap-029":"Papiamentu (Caribbean)","pl-pl":"polski (Polska)","prg-001":"prsiskan (swtai)","prs-af":[" ()",!0],"ps-af":[" ()",!0],"ps-pk":[" ()",!0],"pt-ao":"portugus (Angola)","pt-br":"portugus (Brasil)","pt-ch":"portugus (Sua)","pt-cv":"portugus (Cabo Verde)","pt-gq":"portugus (Guin Equatorial)","pt-gw":"portugus (Guin-Bissau)","pt-lu":"portugus (Luxemburgo)","pt-mo":"portugus (RAE de Macau)","pt-mz":"portugus (Moambique)","pt-pt":"portugus (Portugal)","pt-st":"portugus (So Tom e Prncipe)","pt-tl":"portugus (Timor-Leste)","qps-latn-x-sh":"P Sfh","qps-ploc":"[ () !!! !!]","qps-ploca":"[  ( ) !!! !!! ]","qps-plocm":["[  ( ) !!! !!! !]",!0],"quc-latn-gt":"K'iche' (Guatemala)","quz-bo":"Runasimi (Bolivia)","quz-ec":"Runasimi (Ecuador)","quz-pe":"Runasimi (Per)","rm-ch":"rumantsch (Svizra)","rn-bi":"Ikirundi (Uburundi)","ro-md":"romn (Republica Moldova)","ro-ro":"romn (Romnia)","rof-tz":"Kihorombo (Tanzania)","ru-by":" ()","ru-kg":" ()","ru-kz":" ()","ru-md":" ()","ru-ru":" ()","ru-ua":" ()","rw-rw":"Kinyarwanda (U Rwanda)","rwk-tz":"Kiruwa (Tanzania)","sa-in":" ()","sah-ru":" ()","saq-ke":"Kisampur (Kenya)","sbp-tz":"Ishisangu (Tansaniya)","sd-arab-pk":[" ()",!0],"sd-deva-in":" (India)","se-fi":"davvismegiella (Suopma)","se-no":"davvismegiella (Norga)","se-se":"davvismegiella (Ruoa)","seh-mz":"sena (Moambique)","ses-ml":"Koyraboro senni (Maali)","sg-cf":"Sng (Kdrsse t Bafrka)","shi-latn-ma":"Tasheliyt (lmrib)","shi-tfng-ma":" ()","si-lk":" ( )","sk-sk":"slovenina (Slovensko)","sl-si":"slovenina (Slovenija)","sma-no":"arjelsaemiengele (Nrje)","sma-se":"arjelsaemiengele (Sveerje)","smj-no":"julevusmegiella (Vuodna)","smj-se":"julevusmegiella (Svierik)","smn-fi":"anarkiel (Suom)","sms-fi":"smill (Lddjnnam)","sn-latn-zw":"chiShona (Zimbabwe)","so-dj":"Soomaali (Jabuuti)","so-et":"Soomaali (Itoobiya)","so-ke":"Soomaali (Kenya)","so-so":"Soomaali (Soomaaliya)","sq-al":"shqip (Shqipri)","sq-mk":"shqip (Maqedonia e Veriut)","sq-xk":"shqip (Kosov)","sr-cyrl-ba":" (  )","sr-cyrl-cs":" (    ())","sr-cyrl-me":" ( )","sr-cyrl-rs":" ()","sr-cyrl-xk":" ()","sr-latn-ba":"srpski (Bosna i Hercegovina)","sr-latn-cs":"srpski (Srbija i Crna Gora (Biva))","sr-latn-me":"srpski (Crna Gora)","sr-latn-rs":"srpski (Srbija)","sr-latn-xk":"srpski (Kosovo)","ss-sz":"siSwati (eSwatini)","ss-za":"siSwati (South Africa)","ssy-er":"Saho (Eretria)","st-ls":"Sesotho (Lesotho)","st-za":"Sesotho (South Africa)","sv-ax":"svenska (land)","sv-fi":"svenska (Finland)","sv-se":"svenska (Sverige)","sw-cd":"Kiswahili (Jamhuri ya Kidemokrasia ya Kongo)","sw-ke":"Kiswahili (Kenya)","sw-tz":"Kiswahili (Tanzania)","sw-ug":"Kiswahili (Uganda)","syr-sy":[" ()",!0],"ta-in":" ()","ta-lk":" ()","ta-my":" ()","ta-sg":" ()","te-in":" ()","teo-ke":"Kiteso (Kenia)","teo-ug":"Kiteso (Uganda)","tg-cyrl-tj":" ()","th-th":" ()","ti-er":" ()","ti-et":" ()","tig-er":" ()","tk-tm":"Trkmen dili (Trkmenistan)","tn-bw":"Setswana (Botswana)","tn-za":"Setswana (Aforika Borwa)","to-to":"lea fakatonga (Tonga)","tr-cy":"Trke (Kbrs)","tr-tr":"Trke (Trkiye)","ts-za":"Xitsonga (South Africa)","tt-ru":" ()","twq-ne":"Tasawaq senni (Nier)","tzm-arab-ma":["   (Morocco)",!0],"tzm-latn-dz":"Tamazit n lala (Djazar)","tzm-latn-ma":"Tamazit n lala (Meuk)","tzm-tfng-ma":" ()","ug-cn":[" (  )",!0],"uk-ua":" ()","ur-in":[" ()",!0],"ur-pk":[" ()",!0],"uz-arab-af":" ()","uz-cyrl-uz":" ()","uz-latn-uz":"ozbek (Ozbekiston)","vai-latn-lr":"Vai (Laibhiya)","vai-vaii-lr":" ()","ve-za":"Tshivena (South Africa)","vi-vn":"Ting Vit (Vit Nam)","vo-001":"Volapk (World)","vun-tz":"Kyivunjo (Tanzania)","wae-ch":"Walser (Schwiz)","wal-et":" ()","wo-sn":"Wolof (Senegaal)","xh-za":"isiXhosa (eMzantsi Afrika)","xog-ug":"Olusoga (Yuganda)","yav-cm":"nuasue (Kemeln)","yi-001":[" ()",!0],"yo-bj":"d Yorb (Orlde Bn)","yo-ng":"d Yorb (Oril-d Njr)","zgh-tfng-ma":" ()","zh-cn":"()","zh-hk":"()","zh-hans-hk":" ()","zh-hans-mo":" ()","zh-mo":"()","zh-sg":"()","zh-tw":"()","zu-za":"isiZulu (iNingizimu Afrika)"},Gf={aa:["aa-ET","Qafar"],af:"af-ZA",agq:["agq-CM","Aghem"],ak:["ak-GH","Akan"],am:"am-ET",ar:"ar-SA",arn:"arn-CL",as:"as-IN",asa:["asa-TZ","Kipare"],ast:["ast-ES","asturianu"],az:["az-Latn-AZ","azrbaycan"],"az-cyrl":["az-Cyrl-AZ"," ()"],"az-latn":["az-Latn-AZ","Azrbaycanl (Latn)"],ba:"ba-RU",bas:["bas-CM","sa"],be:"be-BY",bem:["bem-ZM","Ichibemba"],bez:["bez-TZ","Hibena"],bg:"bg-BG",bin:"bin-NG",bm:["bm-Latn-ML","bamanakan"],"bm-latn":["bm-Latn-ML","bamanakan (Latin)"],bn:"bn-BD",bo:"bo-CN",br:"br-FR",brx:["brx-IN",""],bs:["bs-Latn-BA","bosanski"],"bs-cyrl":["bs-Cyrl-BA"," ()"],"bs-latn":["bs-Latn-BA","bosanski (Latinica)"],byn:["byn-ER",""],ca:"ca-ES",ccp:["ccp-Cakm-BD",""],"ccp-cakm":["ccp-Cakm-BD"," ()"],ce:["ce-RU",""],ceb:["ceb-Latn-PH","Cebuano"],"ceb-latn":["ceb-Latn-PH","Cebuano (Latin)"],cgg:["cgg-UG","Rukiga"],chr:"chr-Cher-US","chr-cher":"chr-Cher-US",co:"co-FR",cs:"cs-CZ",cu:["cu-RU",""],cy:"cy-GB",da:"da-DK",dav:["dav-KE","Kitaita"],de:"de-DE",dje:["dje-NE","Zarmaciine"],dsb:"dsb-DE",dua:["dua-CM","dul"],dv:"dv-MV",dyo:["dyo-SN","joola"],dz:["dz-BT",""],ebu:["ebu-KE","Kembu"],ee:["ee-GH","Eegbe"],el:"el-GR",en:"en-US",eo:["eo-001","esperanto"],es:"es-ES",et:"et-EE",eu:"eu-ES",ewo:["ewo-CM","ewondo"],fa:"fa-IR",ff:"ff-Latn-SN","ff-latn":"ff-Latn-SN",fi:"fi-FI",fil:"fil-PH",fo:"fo-FO",fr:"fr-FR",fur:["fur-IT","furlan"],fy:"fy-NL",ga:"ga-IE",gd:"gd-GB",gl:"gl-ES",gn:"gn-PY",gsw:"gsw-CH",gu:"gu-IN",guz:["guz-KE","Ekegusii"],gv:["gv-IM","Gaelg"],ha:["ha-Latn-NG","Hausa"],"ha-latn":["ha-Latn-NG","Hausa (Latin)"],haw:"haw-US",he:"he-IL",hi:"hi-IN",hr:"hr-HR",hsb:"hsb-DE",hu:"hu-HU",hy:"hy-AM",ia:["ia-001","interlingua"],ibb:"ibb-NG",id:"id-ID",ig:"ig-NG",ii:"ii-CN",is:"is-IS",it:"it-IT",iu:["iu-Latn-CA","Inuktitut"],"iu-cans":["iu-Cans-CA"," ()"],"iu-latn":["iu-Latn-CA","Inuktitut (Qaliujaaqpait)"],ja:"ja-JP",jgo:["jgo-CM","Ndaa"],jmc:["jmc-TZ","Kimachame"],jv:"jv-Latn-ID","jv-java":"jv-Java-ID","jv-latn":"jv-Latn-ID",ka:"ka-GE",kab:["kab-DZ","Taqbaylit"],kam:["kam-KE","Kikamba"],kde:["kde-TZ","Chimakonde"],kea:["kea-CV","kabuverdianu"],khq:["khq-ML","Koyra ciini"],ki:["ki-KE","Gikuyu"],kk:"kk-KZ",kkj:["kkj-CM","kak"],kl:"kl-GL",kln:["kln-KE","Kalenjin"],km:"km-KH",kn:"kn-IN",ko:"ko-KR",kok:"kok-IN",kr:"kr-Latn-NG","kr-latn":"kr-Latn-NG",ks:["ks-Arab-IN",""],"ks-arab":["ks-Arab-IN"," ()"],"ks-deva":"ks-Deva-IN",ksb:["ksb-TZ","Kishambaa"],ksf:["ksf-CM","rikpa"],ksh:["ksh-DE","Klsch"],ku:"ku-Arab-IQ","ku-arab":"ku-Arab-IQ",kw:["kw-GB","kernewek"],ky:"ky-KG",la:"la-001",lag:["lag-TZ","Klaangi"],lb:"lb-LU",lg:["lg-UG","Luganda"],lkt:["lkt-US","Lakliyapi"],ln:["ln-CD","lingla"],lo:"lo-LA",lrc:["lrc-IR"," "],lt:"lt-LT",lu:["lu-CD","Tshiluba"],luo:["luo-KE","Dholuo"],luy:["luy-KE","Luluhia"],lv:"lv-LV",mas:["mas-KE","Maa"],mer:["mer-KE","Kmr"],mfe:["mfe-MU","kreol morisien"],mg:["mg-MG","Malagasy"],mgh:["mgh-MZ","Makua"],mgo:["mgo-CM","meta"],mi:"mi-NZ",mk:"mk-MK",ml:["ml-IN",""],mn:["mn-MN",""],"mn-cyrl":["mn-MN"," ( )"],"mn-mong":["mn-Mong-CN","  ( )"],mni:"mni-IN",moh:"moh-CA",mr:"mr-IN",ms:"ms-MY",mt:"mt-MT",mua:["mua-CM","MUNDA"],my:["my-MM",""],mzn:["mzn-IR",""],naq:["naq-NA","Khoekhoegowab"],nb:"nb-NO",nd:["nd-ZW","isiNdebele"],nds:["nds-DE","Neddersasssch"],ne:"ne-NP",nl:"nl-NL",nmg:["nmg-CM","Kwasio"],nn:"nn-NO",nnh:["nnh-CM","Shw ngiembn"],no:["nb-NO","norsk"],nqo:"nqo-GN",nr:["nr-ZA","isiNdebele"],nso:"nso-ZA",nus:["nus-SS","Thok Nath"],nyn:["nyn-UG","Runyankore"],oc:"oc-FR",om:["om-ET","Oromoo"],or:"or-IN",os:["os-GE",""],pa:"pa-IN","pa-arab":"pa-Arab-PK","pa-guru":"pa-IN",pap:"pap-029",pl:"pl-PL",prg:["prg-001","prsiskan"],prs:"prs-AF",ps:"ps-AF",pt:"pt-BR",quc:"quc-Latn-GT","quc-latn":"quc-Latn-GT",quz:"quz-BO",rm:"rm-CH",rn:["rn-BI","Ikirundi"],ro:"ro-RO",rof:["rof-TZ","Kihorombo"],ru:"ru-RU",rw:"rw-RW",rwk:["rwk-TZ","Kiruwa"],sa:"sa-IN",sah:"sah-RU",saq:["saq-KE","Kisampur"],sbp:["sbp-TZ","Ishisangu"],sd:"sd-Arab-PK","sd-arab":"sd-Arab-PK","sd-deva":"sd-Deva-IN",se:"se-NO",seh:["seh-MZ","sena"],ses:["ses-ML","Koyraboro senni"],sg:["sg-CF","Sng"],shi:["shi-Tfng-MA",""],"shi-latn":["shi-Latn-MA","Tasheliyt (Latin)"],"shi-tfng":["shi-Tfng-MA"," (Tifinagh)"],si:"si-LK",sk:"sk-SK",sl:"sl-SI",sma:"sma-SE",smj:"smj-SE",smn:"smn-FI",sms:"sms-FI",sn:["sn-Latn-ZW","chiShona"],"sn-latn":["sn-Latn-ZW","chiShona (Latin)"],so:["so-SO","Soomaali"],sq:"sq-AL",sr:["sr-Latn-RS","srpski"],"sr-cyrl":["sr-Cyrl-RS"," ()"],"sr-latn":["sr-Latn-RS","srpski (latinica)"],ss:["ss-ZA","Siswati"],ssy:["ssy-ER","Saho"],st:"st-ZA",sv:"sv-SE",sw:"sw-KE",syr:"syr-SY",ta:"ta-IN",te:"te-IN",teo:["teo-UG","Kiteso"],tg:["tg-Cyrl-TJ",""],"tg-cyrl":["tg-Cyrl-TJ"," ()"],th:"th-TH",ti:"ti-ER",tig:["tig-ER",""],tk:"tk-TM",tn:"tn-ZA",to:["to-TO","lea fakatonga"],tr:"tr-TR",ts:["ts-ZA","Xitsonga"],tt:"tt-RU",twq:["twq-NE","Tasawaq senni"],tzm:["tzm-Latn-DZ","Tamazit n lala"],"tzm-arab":"tzm-Arab-MA","tzm-latn":["tzm-Latn-DZ","Tamazit n lala (Latin)"],"tzm-tfng":["tzm-Tfng-MA","Tamazight (Tifinagh)"],ug:"ug-CN",uk:"uk-UA",ur:"ur-PK",uz:"uz-Latn-UZ","uz-arab":["uz-Arab-AF"," ()"],"uz-cyrl":["uz-Cyrl-UZ"," ()"],"uz-latn":"uz-Latn-UZ",vai:["vai-Vaii-LR",""],"vai-latn":["vai-Latn-LR","Vai (Latin)"],"vai-vaii":["vai-Vaii-LR"," (Vai)"],ve:["ve-ZA","Tshivena"],vi:"vi-VN",vo:["vo-001","Volapk"],vun:["vun-TZ","Kyivunjo"],wae:["wae-CH","Walser"],wal:["wal-ET",""],wo:"wo-SN",xh:"xh-ZA",xog:["xog-UG","Olusoga"],yav:["yav-CM","nuasue"],yi:["yi-001",""],yo:"yo-NG",zgh:["zgh-Tfng-MA",""],"zgh-tfng":["zgh-Tfng-MA"," (Tifinagh)"],zh:["zh-CN",""],"zh-hans":"zh-CN","zh-hant":["zh-HK","()"],zu:"zu-ZA"},Hf=e=>{const t=new Map;return e.forEach((e=>{const n=((e,t=!1,n)=>{let r;const i=e.toLocaleLowerCase(),o=Vf[i];if(o&&(r=Array.isArray(o)?{languageId:e,languageName:o[0],isRtl:o[1]}:{languageId:e,languageName:o,isRtl:!1}),!r&&t){const e=Gf[i];if(e){const t=Array.isArray(e)?e[0]:e,n=Array.isArray(e)?e[1]:void 0,i=Vf[t.toLocaleLowerCase()],o=!!Array.isArray(i)&&i[1],a=Array.isArray(i)?i[0]:i;r={languageId:t,languageName:null!=n?n:a,isRtl:o}}}if(r&&n){const e=r.languageId.toLocaleLowerCase();n.find((t=>t.toLocaleLowerCase()===e))||(r=void 0)}return r})(e.languageId);n&&!t.has(e.languageId)&&t.set(e.languageId,n)})),Array.from(t.values())};function $f(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Kf(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){$f(o,r,i,a,s,"next",e)}function s(e){$f(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Jf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qf(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Yf,Xf=function(){function e(t,n,r,i,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_editorService",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_contentScriptEmitter",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_proofingStore",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"_languageInfo",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"_logger",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_languages",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}var t,n,i;return t=e,n=[{key:"initialize",value:function(){var e=this;return Kf((function(){return Qf(this,(function(t){var n;return e._contentScriptEmitter.on(Uu.a.loadLanguages,(n=Kf((function(t){return Qf(this,(function(n){switch(n.label){case 0:return[4,e._loadSupportedLanguages(t.address)];case 1:return n.sent(),[2]}}))})),function(e){return n.apply(this,arguments)})),[2]}))}))()}},{key:"shutDown",value:function(){}},{key:"languages",get:function(){return this._languages}},{key:"_loadSupportedLanguages",value:function(e){var t=this;return Kf((function(){var n,i,o,a,c,l,d;return Qf(this,(function(f){switch(f.label){case 0:if(t._languages&&t._languages.supportedLanguages.length>0)return t._emitLoadedLanguages(e),[2];n=function(e,t){return e.languageName.localeCompare(t.languageName)},i=t._logger.getNewActivity(u.b.LanguageInfoCall,s.a.SamplingPolicy.Measure),f.label=1;case 1:return f.trys.push([1,5,,6]),a={},[4,t._proofingStore.read(de.a.AppId)];case 2:return a.appId=f.sent(),c=JSON.parse,[4,t._proofingStore.read(de.a.Descriptors)];case 3:return a.descriptors=c.apply(JSON,[f.sent()]),o=a,[4,t._editorService.languageinfo(o)];case 4:return(l=f.sent()).responseStatus===r.ResponseStatus.Success&&l.supportedLanguages&&l.supportedLanguages.length>0?(t._languages={supportedLanguages:Hf(l.supportedLanguages).sort(n)},t._emitLoadedLanguages(e),i&&(i.success=!0,i.endNow()),[2]):(i&&(i.success=!1,i.endNow()),[3,6]);case 5:return d=f.sent(),i&&(i.dataFields.push({name:"Editor_Error_Response",dataType:s.a.DataFieldType.String,value:d,classification:s.a.DataClassification.EssentialServiceMetadata}),i.success=!1,i.endNow()),[3,6];case 6:return t._languages={supportedLanguages:t._languageInfo.bxDefaultSupportedLanguages().sort(n)},t._emitLoadedLanguages(e),[2]}}))}))()}},{key:"_emitLoadedLanguages",value:function(e){this.languages&&this._contentScriptEmitter.emit(Uu.a.languagesLoaded,{address:e,message:this.languages})}}],n&&Jf(t.prototype,n),i&&Jf(t,i),e}();Xf=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(nf)),Object(le.f)(1,Object(pe.a)(Uu.b)),Object(le.f)(2,Object(pe.a)(K.a)),Object(le.f)(3,Object(pe.a)(k.a)),Object(le.f)(4,Object(pe.a)(o.a)),Object(le.e)("design:paramtypes",[nf,Object,Object,Object,Object])],Xf),function(e){e.roamingSettingsLoaded="roamingSettingsLoaded"}(Yf||(Yf={}));var Zf,eh=Object(d.a)("IRoamingServiceEmitter"),th="1.0.0",nh="Web",rh=142;!function(e){e[e.dictionary=1065]="dictionary",e[e.crossPromoInWac=1315]="crossPromoInWac"}(Zf||(Zf={}));var ih,oh=[Zf.dictionary,Zf.crossPromoInWac],ah=Object(d.a)("IRoamingSettingsLoader");function sh(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function uh(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){sh(o,r,i,a,s,"next",e)}function s(e){sh(o,r,i,a,s,"throw",e)}a(void 0)}))}}function ch(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lh(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var dh=ih=function(){function e(t,n,r,i,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_featureFlagsReader",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_roamingSettingsLoader",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_settingsEmitter",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"_systemPersistedStore",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"_roamingServiceEmitter",{enumerable:!0,configurable:!0,writable:!0,value:o});var a,s=this;Object.defineProperty(this,"_setBXInstalledValue",{enumerable:!0,configurable:!0,writable:!0,value:(a=uh((function(e){var t,n,r;return lh(this,(function(i){switch(i.label){case 0:return[4,s._featureFlagsReader.refreshFlags()];case 1:if(i.sent(),!s._featureFlagsReader.flags.enableRoamingService||!s._featureFlagsReader.flags.enableWacCrossPromo)return[2];i.label=2;case 2:return i.trys.push([2,5,,6]),s._roamingSettingsLoader.hasLoadedSetting(Zf.crossPromoInWac)?(t=s._roamingSettingsLoader.getRoamingSettingValue(Zf.crossPromoInWac))&&ih._hasInstallationData(t)?[2]:[4,s._updateCrossPromoData(t)]:(s._roamingSettingsLoader.reloadSettings(),[2]);case 3:return n=i.sent(),[4,s._roamingSettingsLoader.writeRoamingServiceDictionarySettingValue(Zf.crossPromoInWac,n)];case 4:return i.sent(),s._roamingSettingsLoader.logRoamingServiceSuccess(u.b.RoamingCrossPromoSettingSaved,{name:"Is_For_Old_Installations",value:JSON.stringify(e)}),[3,6];case 5:return r=i.sent(),s._roamingSettingsLoader.logRoamingServiceError(u.a.RoamingCrossPromoSaveError,"".concat(r)||"failed to save cross promo value"),[3,6];case 6:return[2]}}))})),function(e){return a.apply(this,arguments)})});var c=this;Object.defineProperty(this,"_updateCrossPromoData",{enumerable:!0,configurable:!0,writable:!0,value:function(){var e=uh((function(e){var t,n,r;return lh(this,(function(i){switch(i.label){case 0:return t="true"===ih._removeDataTags(null==e?void 0:e.IsDismissed),[4,c._systemPersistedStore.getLastUpdatedTimestamp(l.a.FirstInstallVersion)];case 1:return n=i.sent(),r=Intl.DateTimeFormat("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}).format(null!=n?n:new Date),[2,{IsDismissed:ih._wrapWithDataTags(t),IsInstalled:ih._wrapWithDataTags(!0),InstalledDate:ih._wrapWithDataTags(r)}]}}))}));return function(t){return e.apply(this,arguments)}}()})}var t,n,r;return t=e,r=[{key:"_hasInstallationData",value:function(e){var t="true"===ih._removeDataTags(e.IsInstalled),n=ih._removeDataTags(e.InstalledDate);return t&&!!n}},{key:"_removeDataTags",value:function(e){var t;return null!==(t=null==e?void 0:e.replace("<data>","").replace("</data>","").trim().toLowerCase())&&void 0!==t?t:""}},{key:"_wrapWithDataTags",value:function(e){if(""===e)throw new Error("Cross promo value should not be empty");return"<data>".concat(e,"</data>")}}],(n=[{key:"initialize",value:function(){var e=this;return uh((function(){return lh(this,(function(t){return e._roamingServiceEmitter.on(Yf.roamingSettingsLoaded,uh((function(){return lh(this,(function(t){return[2,e._setBXInstalledValue(!1)]}))}))),e._settingsEmitter.on(hc.a.FeatureFlags,uh((function(){return lh(this,(function(t){return[2,e._setBXInstalledValue(!0)]}))}))),[2]}))}))()}},{key:"shutDown",value:function(){}}])&&ch(t.prototype,n),r&&ch(t,r),e}();function fh(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function hh(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){fh(o,r,i,a,s,"next",e)}function s(e){fh(o,r,i,a,s,"throw",e)}a(void 0)}))}}function ph(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gh(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}dh=ih=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(v.a)),Object(le.f)(1,Object(pe.a)(ah)),Object(le.f)(2,Object(pe.a)(Ws.a)),Object(le.f)(3,Object(pe.a)(c.a)),Object(le.f)(4,Object(pe.a)(eh)),Object(le.e)("design:paramtypes",[Object,Object,Object,Object,Object])],dh);var mh=function(){function e(t,n,r,i,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_featureFlagsReader",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_roamingSettingsLoader",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_roamingDictionaryFeature",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"_guidGenerator",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"_roamingDictionaryEmitter",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_roamingServiceEmitter",{enumerable:!0,configurable:!0,writable:!0,value:a});var s=this;Object.defineProperty(this,"_setRoamingDictionaryValue",{enumerable:!0,configurable:!0,writable:!0,value:hh((function(){var e,t,n,r;return gh(this,(function(i){if(!s._featureFlagsReader.flags.enableRoamingService||!s._featureFlagsReader.flags.enableV2RoamingDictionary)return[2];if(!s._roamingSettingsLoader.hasLoadedSetting(Zf.dictionary))return s._roamingSettingsLoader.reloadSettings(),[2];t=s._roamingSettingsLoader.getRoamingSettingValue(Zf.dictionary);try{if(!(n=s._roamingDictionaryFeature.getRoamingDictionary()))return[2];if(r=n.setDictionaryValue(t),s._roamingDictionaryEmitter.emit("setRoamingDictionaryState",{data:r.success,messageType:mt.a.ChangeData}),!r.success)throw new Error("".concat(null!==(e=r.errorMessage)&&void 0!==e?e:"error setting dictionary value",", setting value: ").concat(t));s._roamingDictionaryEmitter.emit("initCurrentSessionDictionary")}catch(e){s._roamingSettingsLoader.logRoamingServiceError(u.a.RoamingDictionaryInitError,"".concat(e))}return[2]}))}))});var c=this;Object.defineProperty(this,"_writeDictionaryToService",{enumerable:!0,configurable:!0,writable:!0,value:hh((function(){var e,t,n,r;return gh(this,(function(i){switch(i.label){case 0:if(!c._featureFlagsReader.flags.enableV2RoamingDictionary||!c._featureFlagsReader.flags.enableRoamingService)return[2];i.label=1;case 1:if(i.trys.push([1,3,,4]),!(t=c._roamingDictionaryFeature.getRoamingDictionary()))throw new Error("Roaming dictionary is not found");return[4,t.saveWordListToRoamingService(c._guidGenerator.generate())];case 2:if(!(n=i.sent()).success)throw new Error(null!==(e=n.errorMessage)&&void 0!==e?e:"Error while saving list");return c._roamingSettingsLoader.logRoamingServiceSuccess(u.b.WordAddedToRoamingDictionary),[3,4];case 3:return r=i.sent(),c._roamingSettingsLoader.logRoamingServiceError(u.a.RoamingDictionarySaveError,"".concat(r)),[3,4];case 4:return[2]}}))}))})}var t,n,r;return t=e,(n=[{key:"initialize",value:function(){var e=this;return hh((function(){return gh(this,(function(t){return e._roamingServiceEmitter.on(Yf.roamingSettingsLoaded,e._setRoamingDictionaryValue),e._roamingDictionaryEmitter.on("writeCurrentDictionaryToService",e._writeDictionaryToService),[2]}))}))()}},{key:"shutDown",value:function(){this._roamingServiceEmitter.off(Yf.roamingSettingsLoaded),this._roamingDictionaryEmitter.off("writeCurrentDictionaryToService")}}])&&ph(t.prototype,n),r&&ph(t,r),e}();mh=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(v.a)),Object(le.f)(1,Object(pe.a)(ah)),Object(le.f)(2,Object(pe.a)(Z.a)),Object(le.f)(3,Object(pe.a)(R.a)),Object(le.f)(4,Object(pe.a)(E.a)),Object(le.f)(5,Object(pe.a)(eh)),Object(le.e)("design:paramtypes",[Object,Object,Object,Object,Object,Object])],mh);var yh=n(121),bh=n(382);function vh(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function wh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sh(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var _h=function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_roamingDictionaryFeature",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_roamingSettingsLoader",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_featureFlagsReader",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reactToRoamingDictionaryEvent",{enumerable:!0,configurable:!0,writable:!0,value:function(e){if(!(e&&i._featureFlagsReader.flags.enableV2RoamingDictionary))return[yh.a.NoReaction,{roamingDictionary:void 0}];try{var t=i._initRoamingDictionary();return t.getLoadState()===bh.a.LOADED?[yh.a.EnableFeature,{roamingDictionary:t}]:[yh.a.DisableFeature,{roamingDictionary:t}]}catch(e){return i._roamingSettingsLoader.logRoamingServiceError(u.a.RoamingDictionaryInitError,"".concat(e)),[yh.a.DisableFeature,{roamingDictionary:void 0}]}}}),Object.defineProperty(this,"_initRoamingDictionary",{enumerable:!0,configurable:!0,writable:!0,value:function(){var e,t=new bh.b(i._roamingSettingsLoader.getAuthTokenCallback(),i._roamingSettingsLoader.getEnvironment(),rh,th,nh,i._roamingSettingsLoader.getCulture());if(i._roamingSettingsLoader.hasLoadedSetting(Zf.dictionary)){var n=i._roamingSettingsLoader.getRoamingSettingValue(Zf.dictionary),r=t.setDictionaryValue(n);if(!r.success){var o=null!==(e=r.errorMessage)&&void 0!==e?e:"Could not set roaming dictionary value";throw new Error("".concat(o,", setting value: ").concat(n))}}else i._roamingSettingsLoader.reloadSettings();return t}})}var t,n,r;return t=e,n=[{key:"initialize",value:function(){var e,t=this;return(e=function(){return Sh(this,(function(e){return t._id=t._roamingDictionaryFeature.addListener(Z.b.ClientInitialized,t.reactToRoamingDictionaryEvent),[2]}))},function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){vh(o,r,i,a,s,"next",e)}function s(e){vh(o,r,i,a,s,"throw",e)}a(void 0)}))})()}},{key:"shutDown",value:function(){this._roamingDictionaryFeature.removeListener(this._id)}}],n&&wh(t.prototype,n),r&&wh(t,r),e}();function Th(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Oh(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Th(o,r,i,a,s,"next",e)}function s(e){Th(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Ch(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Eh(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}_h=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(Z.a)),Object(le.f)(1,Object(pe.a)(ah)),Object(le.f)(2,Object(pe.a)(v.a)),Object(le.e)("design:paramtypes",[Object,Object,Object])],_h);var Ih=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_clientStateEmitter",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_roamingToken",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_setTokenFromClientState",{enumerable:!0,configurable:!0,writable:!0,value:function(e){(null==e?void 0:e.isLoggedIn)&&e.roamingToken?n._roamingToken=e.roamingToken:n._roamingToken=void 0}});var r=this;Object.defineProperty(this,"fetchToken",{enumerable:!0,configurable:!0,writable:!0,value:Oh((function(){var e,t;return Eh(this,(function(n){return[2,null!==(t=null===(e=r._roamingToken)||void 0===e?void 0:e.accessToken)&&void 0!==t?t:void 0]}))}))})}var t,n,r;return t=e,(n=[{key:"initialize",value:function(){var e=this;return Oh((function(){return Eh(this,(function(t){return e._clientStateEmitter.on("clientStateUpdated",e._setTokenFromClientState),[2]}))}))()}},{key:"shutDown",value:function(){}}])&&Ch(t.prototype,n),r&&Ch(t,r),e}();Ih=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(Fu.a)),Object(le.e)("design:paramtypes",[Object])],Ih);var kh=n(257),Ah=n(256),Ph=Object(d.a)("IRoamingServiceAuthenticator");function Nh(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function jh(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Nh(o,r,i,a,s,"next",e)}function s(e){Nh(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Rh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xh(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Dh,Mh=function(){function e(t,n,r,i,o,a,c,l){var d=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_proofingEmitter",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_proofingStore",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_logger",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"_guidGenerator",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"_featureFlagsReader",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_clientStateEmitter",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"_roamingServiceEmitter",{enumerable:!0,configurable:!0,writable:!0,value:c}),Object.defineProperty(this,"_roamingServiceAuthenticator",{enumerable:!0,configurable:!0,writable:!0,value:l}),Object.defineProperty(this,"_proofingLanguages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_settingsValueMap",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_clientState",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_onProofingLanguagesChanges",{enumerable:!0,configurable:!0,writable:!0,value:function(e){var t;(null===(t=d._proofingLanguages)||void 0===t?void 0:t.equalsTo(e.codesList))||(d._proofingLanguages=e,d._isLoggedIn()&&d._loadRoamingSettings())}});var f,h=this;Object.defineProperty(this,"_clientStateUpdated",{enumerable:!0,configurable:!0,writable:!0,value:(f=jh((function(e){return xh(this,(function(t){switch(t.label){case 0:return h._clientState=e,[4,h._featureFlagsReader.refreshFlags()];case 1:return t.sent(),h._isLoggedIn()?h._loadRoamingSettings():h._settingsValueMap=new Map,[2]}}))})),function(e){return f.apply(this,arguments)})}),Object.defineProperty(this,"_isLoggedIn",{enumerable:!0,configurable:!0,writable:!0,value:function(){return!!d._clientState&&d._clientState.isLoggedIn}}),Object.defineProperty(this,"hasLoadedSetting",{enumerable:!0,configurable:!0,writable:!0,value:function(e){return d._settingsValueMap.has(e)}});var p=this;Object.defineProperty(this,"reloadSettings",{enumerable:!0,configurable:!0,writable:!0,value:jh((function(){return xh(this,(function(e){return[2,p._loadRoamingSettings()]}))}))});var g=this;Object.defineProperty(this,"_setProofingLanguagesFromStorage",{enumerable:!0,configurable:!0,writable:!0,value:jh((function(){var e;return xh(this,(function(t){switch(t.label){case 0:return e=Lf.a.bind,[4,g._proofingStore.read(de.a.ProofingLanguages)];case 1:return g._proofingLanguages=new(e.apply(Lf.a,[void 0,t.sent()])),[2]}}))}))});var m=this;Object.defineProperty(this,"writeRoamingServiceSettingValue",{enumerable:!0,configurable:!0,writable:!0,value:function(){var e=jh((function(e,t){return xh(this,(function(n){switch(n.label){case 0:return[4,Object(kh.b)(m.getAuthTokenCallback(),m.getEnvironment(),t,rh,th,nh,m.getCulture(),m._guidGenerator.generate(),e)];case 1:return n.sent(),m._settingsValueMap.set(e,t),[2]}}))}));return function(t,n){return e.apply(this,arguments)}}()});var y=this;Object.defineProperty(this,"writeRoamingServiceDictionarySettingValue",{enumerable:!0,configurable:!0,writable:!0,value:function(){var e=jh((function(e,t){return xh(this,(function(n){switch(n.label){case 0:return[4,Object(kh.a)(y.getAuthTokenCallback(),y.getEnvironment(),t,rh,th,nh,y.getCulture(),y._guidGenerator.generate(),e)];case 1:return n.sent(),y._settingsValueMap.set(e,t),[2]}}))}));return function(t,n){return e.apply(this,arguments)}}()});var b=this;Object.defineProperty(this,"_loadRoamingSettings",{enumerable:!0,configurable:!0,writable:!0,value:jh((function(){var e;return xh(this,(function(t){switch(t.label){case 0:if(!b._featureFlagsReader.flags.enableRoamingService)return[2];t.label=1;case 1:return t.trys.push([1,4,,5]),[4,b.getAuthTokenCallback()()];case 2:return t.sent()?[4,Object(Ah.a)(b.getAuthTokenCallback(),b.getEnvironment(),rh,th,nh,b.getCulture(),b._guidGenerator.generate(),oh)]:[2];case 3:return b._settingsValueMap=t.sent(),b._roamingServiceEmitter.emit(Yf.roamingSettingsLoaded),b.logRoamingServiceSuccess(u.b.RoamingSettingsLoaded),[3,5];case 4:return e=t.sent(),b.logRoamingServiceError(u.a.RoamingServiceLoadError,"".concat(e)||"error getting settings value map"),[3,5];case 5:return[2]}}))}))}),Object.defineProperty(this,"getEnvironment",{enumerable:!0,configurable:!0,writable:!0,value:function(){return"PROD"}}),Object.defineProperty(this,"getCulture",{enumerable:!0,configurable:!0,writable:!0,value:function(){if(!d._proofingLanguages||!d._proofingLanguages.codesList||0===d._proofingLanguages.codesList.length)throw new Error("Proofing languages are not defined");return d._proofingLanguages.codesList[0]}}),Object.defineProperty(this,"getRoamingSettingValue",{enumerable:!0,configurable:!0,writable:!0,value:function(e){return d._settingsValueMap.get(e)}}),Object.defineProperty(this,"logRoamingServiceError",{enumerable:!0,configurable:!0,writable:!0,value:function(e,t){var n=d._logger.getNewActivity(e,s.a.SamplingPolicy.CriticalExperimentation);n&&(n.dataFields.push({name:"Roaming_Service_Error",dataType:s.a.DataFieldType.String.valueOf(),value:t,classification:s.a.DataClassification.EssentialServiceMetadata}),n.success=!0,n.endNow())}}),Object.defineProperty(this,"logRoamingServiceSuccess",{enumerable:!0,configurable:!0,writable:!0,value:function(e,t){var n=d._logger.getNewActivity(e,s.a.SamplingPolicy.CriticalExperimentation);n&&(t&&n.dataFields.push({name:t.name,dataType:s.a.DataFieldType.String.valueOf(),value:t.value,classification:s.a.DataClassification.EssentialServiceMetadata}),n.success=!0,n.endNow())}});var v=this;Object.defineProperty(this,"getAuthTokenCallback",{enumerable:!0,configurable:!0,writable:!0,value:function(){return jh((function(){var e;return xh(this,(function(t){switch(t.label){case 0:return[4,v._roamingServiceAuthenticator.fetchToken()];case 1:return[2,null!=(e=t.sent())?e:""]}}))}))}}),this._settingsValueMap=new Map}var t,n,r;return t=e,n=[{key:"initialize",value:function(){var e=this;return jh((function(){return xh(this,(function(t){switch(t.label){case 0:return[4,e._setProofingLanguagesFromStorage()];case 1:return t.sent(),e._proofingEmitter.on("proofingLanguageChanged",(n=jh((function(t){return xh(this,(function(n){return e._onProofingLanguagesChanges(t.data),[2]}))})),function(e){return n.apply(this,arguments)})),e._clientStateEmitter.on("clientStateUpdated",e._clientStateUpdated),[2]}var n}))}))()}},{key:"shutDown",value:function(){}}],n&&Rh(t.prototype,n),r&&Rh(t,r),e}();function Lh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Bh(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Fh(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Bh(o,r,i,a,s,"next",e)}function s(e){Bh(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Uh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qh(e){return function(e){if(Array.isArray(e))return Lh(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Lh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Lh(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zh(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Mh=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(C.a)),Object(le.f)(1,Object(pe.a)(K.a)),Object(le.f)(2,Object(pe.a)(o.a)),Object(le.f)(3,Object(pe.a)(R.a)),Object(le.f)(4,Object(pe.a)(v.a)),Object(le.f)(5,Object(pe.a)(Fu.a)),Object(le.f)(6,Object(pe.a)(eh)),Object(le.f)(7,Object(pe.a)(Ph)),Object(le.e)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object])],Mh);var Wh=Dh=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_logger",{enumerable:!0,configurable:!0,writable:!0,value:t})}var t,n,r;return t=e,r=[{key:"getBrowserTabIdsMatching",value:function(e){return Fh((function(){return zh(this,(function(t){switch(t.label){case 0:return 0===e.length?[3,2]:[4,chrome.tabs.query({url:e})];case 1:return[2,t.sent().map((function(e){return e.id})).filter((function(e){return void 0!==e}))];case 2:return[2,[]]}}))}))()}}],(n=[{key:"getSupportedTabs",value:function(){var e=this;return Fh((function(){var t,n,r,i,o,a,c,l,d,f,h,p;return zh(this,(function(g){switch(g.label){case 0:return g.trys.push([0,10,,11]),[4,e.getFormattedContentScripts()];case 1:t=g.sent(),n=new Set,r=!0,i=!1,o=void 0,g.label=2;case 2:g.trys.push([2,7,8,9]),a=t[Symbol.iterator](),g.label=3;case 3:return(r=(c=a.next()).done)?[3,6]:(l=c.value,[4,Promise.all([Dh.getBrowserTabIdsMatching(l.matches),Dh.getBrowserTabIdsMatching(l.exclude_matches)])]);case 4:d=g.sent(),f=d[0],h=d[1],f.forEach((function(e){return n.add(e)})),h.forEach((function(e){return n.delete(e)})),g.label=5;case 5:return r=!0,[3,3];case 6:return[3,9];case 7:return p=g.sent(),i=!0,o=p,[3,9];case 8:try{r||null==a.return||a.return()}finally{if(i)throw o}return[7];case 9:return[2,n];case 10:return g.sent(),e._logger.logEvent(509646532,u.a.ContentScriptInjectionError,At.a.Error,"Error in the content script injection process on extension install.",s.a.SamplingPolicy.CriticalBusinessImpact),[3,11];case 11:return[2,new Set]}}))}))()}},{key:"getFormattedContentScripts",value:function(){var e=this;return Fh((function(){var t,n,r,i,o,a;return zh(this,(function(s){switch(s.label){case 0:return i=chrome.runtime.getManifest(),o=null!==(r=null===(n=i.content_scripts)||void 0===n?void 0:n.map(e.extractMatchesFromScript))&&void 0!==r?r:[],[4,chrome.scripting.getRegisteredContentScripts()];case 1:return a=s.sent(),(t=o).push.apply(t,qh(a.map(e.extractMatchesFromScript))),[2,o]}}))}))()}},{key:"extractMatchesFromScript",value:function(e){var t,n,r;return{matches:null!==(t=e.matches)&&void 0!==t?t:[],exclude_matches:null!==(r=null!==(n=e.exclude_matches)&&void 0!==n?n:e.excludeMatches)&&void 0!==r?r:[]}}},{key:"getCurrentTabId",value:function(){return Fh((function(){return zh(this,(function(e){switch(e.label){case 0:return[4,chrome.tabs.query({active:!0})];case 1:return[2,e.sent()[0].id]}}))}))()}}])&&Uh(t.prototype,n),r&&Uh(t,r),e}();Wh=Dh=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(o.a)),Object(le.e)("design:paramtypes",[Object])],Wh);var Vh=n(92),Gh=n(36),Hh=Object(d.a)("IUserService");function $h(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Kh(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){$h(o,r,i,a,s,"next",e)}function s(e){$h(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Jh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qh(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Yh=function(){function e(t,n,r,i){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"userService",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"logger",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"storage",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"featureFlagsReader",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"refreshLongInterval",{enumerable:!0,configurable:!0,writable:!0,value:864e5}),Object.defineProperty(this,"refreshUnknownLicenseInterval",{enumerable:!0,configurable:!0,writable:!0,value:18e5}),Object.defineProperty(this,"refreshShortInterval",{enumerable:!0,configurable:!0,writable:!0,value:3e4}),Object.defineProperty(this,"initTime",{enumerable:!0,configurable:!0,writable:!0,value:Date.now()}),Object.defineProperty(this,"nextShortRefreshTimeout",{enumerable:!0,configurable:!0,writable:!0,value:this.initTime}),Object.defineProperty(this,"nextLongRefreshTimeout",{enumerable:!0,configurable:!0,writable:!0,value:this.initTime+this.refreshLongInterval}),Object.defineProperty(this,"nextRefreshForUndefLicenseTimeout",{enumerable:!0,configurable:!0,writable:!0,value:this.initTime+this.refreshUnknownLicenseInterval}),Object.defineProperty(this,"tokenRelatedFlags",{enumerable:!0,configurable:!0,writable:!0,value:{enableRoamingService:!1,enableCopywriter:!1}});var a,u=this;chrome.tabs.onActivated.addListener((function(e){u.updateExtensionsIcon()})),chrome.tabs.onUpdated.addListener((function(e){u.updateExtensionsIcon()})),this.userService.isLoggedIn().then((function(e){e?(Vh.k(Gh.b.BROWSER_ICON.DEFAULT),u.enableLicenseRefreshCallback(),u.userService.renewTokens()):(Vh.k(Gh.b.BROWSER_ICON.INACTIVE),u.disableLicenseRefreshCallback())})),this.storage.addChangeListener((function(e,t){e.identity?e.identity.newValue?(u.enableLicenseRefreshCallback(),Vh.k(Gh.b.BROWSER_ICON.DEFAULT)):(Vh.k(Gh.b.BROWSER_ICON.INACTIVE),u.disableLicenseRefreshCallback()):e.featureFlags?(o.haveTokenRelatedFlagsChanged().then((function(e){e&&u.userService.renewTokens()})),u.enableLicenseRefreshCallback(),u.userService.addAgeGroupToUserInfo()):e.BetaEnrollment&&u.updateExtensionsIcon()})),chrome.runtime.onInstalled.addListener((function(e){var t=Vh.c(),n=t?t.version:-1;"install"===e.reason?(u.logger.info(509646614,"AppInstalled",{appVersion:n}),u.userService.onInstall()):"update"===e.reason&&(u.logger.info(509646613,"AppUpdated",{appVersion:n,previousVersion:e.previousVersion}),o.storage.get("userInfo").then((function(e){Vh.f(e)&&Vh.f(e.userInfo)&&(Vh.f(e.userInfo.id)||Vh.f(e.userInfo.profile))&&o.storage.remove("userInfo")})))})),chrome.runtime.onMessage.addListener((a=Kh((function(e,t,n){var r;return Qh(this,(function(t){switch(e.eventId){case"telemetryEvent":case"newActivityTelemetryEvent":case"activitySetSuccessTelemetryEvent":case"activitySetResultTelemetryEvent":case"activityAddDataFieldTelemetryEvent":case"activityEndNowTelemetryEvent":return[2];case Gh.b.ACTIVITY.TELEMETRY.NAME:switch(e.command){case Gh.b.TELEMETRY.COMMAND.TRACK_TRACE:case Gh.b.TELEMETRY.COMMAND.TRACK_EVENT:(r=u.logger.getNewActivity(e.eventName,s.a.SamplingPolicy.CriticalExperimentation))&&r.endNow()}break;case Gh.b.ACTIVITY.AUTHENTICATION.NAME:case Gh.b.ACTIVITY.AUTHORIZATION.NAME:case Gh.b.ACTIVITY.LOGOUT.NAME:case Gh.b.ACTIVITY.REQUEST_TOKEN.NAME:return[2];default:return u.logger.warn(509646612,"Unhandled activity:".concat(e.activity)),[2]}return[2]}))})),function(e,t,n){return a.apply(this,arguments)}))}var t,n,r;return t=e,(n=[{key:"initialize",value:function(){var e=this;return Kh((function(){return Qh(this,(function(t){switch(t.label){case 0:return[4,e.userService.removeDuplicateScopes()];case 1:return t.sent(),[4,e.userService.addRegionScopeToUserInfo()];case 2:return t.sent(),[2]}}))}))()}},{key:"shutDown",value:function(){}},{key:"haveTokenRelatedFlagsChanged",value:function(){var e=this;return Kh((function(){return Qh(this,(function(t){return e.tokenRelatedFlags.enableRoamingService===e.featureFlagsReader.flags.enableRoamingService&&e.tokenRelatedFlags.enableCopywriter===e.featureFlagsReader.flags.enableCopywriter?[2,!1]:(e.tokenRelatedFlags.enableRoamingService=e.featureFlagsReader.flags.enableRoamingService,e.tokenRelatedFlags.enableCopywriter=e.featureFlagsReader.flags.enableCopywriter,[2,!0])}))}))()}},{key:"refreshLicenseCallback",value:function(e,t){var n=this;return Kh((function(){var e,r,i,o,a,s,u;return Qh(this,(function(c){switch(c.label){case 0:return r=Date.now(),i=null===(e=t.url)||void 0===e?void 0:e.startsWith("https://account.microsoft.com/"),o=i&&r>n.nextShortRefreshTimeout,a=r>n.nextLongRefreshTimeout,s=r>n.nextRefreshForUndefLicenseTimeout,o||a||s?[4,n.userService.getLicenseType()]:[2];case 1:return u=c.sent(),(r>n.nextLongRefreshTimeout||(!u||u===Gh.b.LICENSE_TYPE.UNKNOWN)&&r>n.nextRefreshForUndefLicenseTimeout)&&(n.nextLongRefreshTimeout=Date.now()+n.refreshLongInterval,n.nextRefreshForUndefLicenseTimeout=Date.now()+n.refreshUnknownLicenseInterval,n.userService.refreshLicense(Gh.b.TELEMETRY.FETCHLICENSINGINFO_REASON.RENEW).then((function(e){(null==e?void 0:e.refreshed)&&e.data?n.logger.info(509646611,"license refreshed"):n.logger.error(509646610,"failed to refresh license"),(null==e?void 0:e.refreshed)&&(n.nextLongRefreshTimeout=Date.now()+n.refreshLongInterval,n.nextRefreshForUndefLicenseTimeout=Date.now()+n.refreshUnknownLicenseInterval)}),(function(){n.logger.error(509646609,"LicenseLongRefreshFailed")}))),i?(n.logger.info(509646608,"BackgroundController account tab updated, refreshing license"),n.nextShortRefreshTimeout=Date.now()+n.refreshShortInterval,n.userService.refreshLicense(Gh.b.TELEMETRY.FETCHLICENSINGINFO_REASON.AMC).then((function(e){e.refreshed&&(n.nextShortRefreshTimeout=Date.now()+n.refreshShortInterval)}),(function(){n.logger.error(509646607,"LicenseShortRefreshFailed")})),[2]):[2]}}))}))()}},{key:"enableLicenseRefreshCallback",value:function(){var e=this;return Kh((function(){return Qh(this,(function(t){switch(t.label){case 0:return[4,e.userService.isLoggedIn()];case 1:return t.sent()?chrome.tabs.onUpdated.hasListener(e.refreshLicenseCallback.bind(e))||(e.logger.debug(509646605,"Enabling refresh license listener."),chrome.tabs.onUpdated.addListener(e.refreshLicenseCallback.bind(e))):(e.logger.debug(509646606,"Removing refresh license listener."),e.disableLicenseRefreshCallback()),[2]}}))}))()}},{key:"disableLicenseRefreshCallback",value:function(){chrome.tabs.onUpdated.removeListener(this.refreshLicenseCallback.bind(this))}},{key:"updateExtensionsIcon",value:function(){var e=this;this.userService.isLoggedIn().then((function(t){t?setTimeout((function(){e.userService.isBetaActiveForCurrentPage().then((function(e){var t=e?Gh.b.BROWSER_ICON.BETA:Gh.b.BROWSER_ICON.DEFAULT;Vh.k(t)}))}),100):Vh.k(Gh.b.BROWSER_ICON.INACTIVE)}))}}])&&Jh(t.prototype,n),r&&Jh(t,r),e}();Yh=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(Hh)),Object(le.f)(1,Object(pe.a)(o.a)),Object(le.f)(2,Object(pe.a)(Gs.a)),Object(le.f)(3,Object(pe.a)(v.a)),Object(le.e)("design:paramtypes",[Object,Object,Object,Object])],Yh);var Xh=n(792),Zh=n(149),ep=n(349),tp=n(534),np=n(344),rp=n(32),ip=n(289),op=n(417),ap=n(211),sp=Object(d.a)("ILanguageInfoLoader"),up=Object(d.a)("IDefaultLanguagePicker"),cp=n(345),lp=n(456),dp=n(580);function fp(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function hp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pp(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var gp=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,n=[{key:"initialize",value:function(){var e,t=this;return(e=function(){return pp(this,(function(e){return chrome.runtime.onMessage.addListener(t.onMessage),[2]}))},function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){fp(o,r,i,a,s,"next",e)}function s(e){fp(o,r,i,a,s,"throw",e)}a(void 0)}))})()}},{key:"shutDown",value:function(){chrome.runtime.onMessage.removeListener(this.onMessage)}},{key:"onMessage",value:function(e,t){var n;if(e&&"gDocsSupport"===e.id&&(null===(n=null==t?void 0:t.tab)||void 0===n?void 0:n.id)){var r=[];e.suppressNativeSquigglesEnabled&&r.push("content/gDocsSquiggleSuppress.js"),r.length>0&&chrome.scripting.executeScript({target:{tabId:t.tab.id},world:"MAIN",files:r})}}}],n&&hp(t.prototype,n),r&&hp(t,r),e}();gp=Object(le.c)([Object(he.a)()],gp);var mp=n(189);function yp(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function bp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vp(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var wp=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_clientStateEmitter",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_augLoopAuthenticationEmitter",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_augLoopToken",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_setTokenFromClientState",{enumerable:!0,configurable:!0,writable:!0,value:function(e){(null==e?void 0:e.isLoggedIn)&&e.augLoopToken?r._augLoopToken=e.augLoopToken:r._augLoopToken=void 0,r._emitTokenState()}})}var t,n,r;return t=e,n=[{key:"initialize",value:function(){var e,t=this;return(e=function(){return vp(this,(function(e){return t._clientStateEmitter.on("clientStateUpdated",t._setTokenFromClientState),[2]}))},function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){yp(o,r,i,a,s,"next",e)}function s(e){yp(o,r,i,a,s,"throw",e)}a(void 0)}))})()}},{key:"shutDown",value:function(){}},{key:"_emitTokenState",value:function(){var e=!!this._augLoopToken&&!!this._augLoopToken.accessToken&&!Object(mp.a)(this._augLoopToken.expiresOn.valueOf());this._augLoopAuthenticationEmitter.emit("setAugLoopState",{data:e,messageType:mt.a.ChangeData})}},{key:"augLoopToken",get:function(){return this._augLoopToken}}],n&&bp(t.prototype,n),r&&bp(t,r),e}();function Sp(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function _p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tp(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}wp=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(Fu.a)),Object(le.f)(1,Object(pe.a)(I.a)),Object(le.e)("design:paramtypes",[Object,Object])],wp);var Op=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_alarms",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"onAlarm",{enumerable:!0,configurable:!0,writable:!0,value:function(e){var n=t._alarms.get(e.name);n&&(n(),e.periodInMinutes||t.clearTimer(e.name))}})}var t,n,r;return t=e,n=[{key:"clearTimer",value:function(e){this._alarms.has(e)&&(chrome.alarms.clear(e),this._alarms.delete(e))}},{key:"setInterval",value:function(e,t,n){var r={periodInMinutes:(null!=n?n:0)/6e4};return this.setAlarm(e,t,r),e}},{key:"setTimeout",value:function(e,t,n){var r={delayInMinutes:(null!=n?n:0)/6e4};return this.setAlarm(e,t,r),e}},{key:"setIntervalWithDelay",value:function(e,t,n,r){var i={delayInMinutes:r/6e4,periodInMinutes:n/6e4};return this.setAlarm(e,t,i),e}},{key:"setAlarm",value:function(e,t,n){chrome.alarms.create(e,n),this._alarms.set(e,t)}},{key:"initialize",value:function(){var e,t=this;return(e=function(){return Tp(this,(function(e){return chrome.alarms.onAlarm.addListener(t.onAlarm),[2]}))},function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Sp(o,r,i,a,s,"next",e)}function s(e){Sp(o,r,i,a,s,"throw",e)}a(void 0)}))})()}},{key:"shutDown",value:function(){chrome.alarms.onAlarm.removeListener(this.onAlarm);var e=!0,t=!1,n=void 0;try{for(var r,i=this._alarms.keys()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;chrome.alarms.clear(o)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this._alarms.clear()}}],n&&_p(t.prototype,n),r&&_p(t,r),e}();Op=Object(le.c)([Object(he.a)()],Op);var Cp=n(583),Ep=n(733),Ip=n(184),kp=n(581);let Ap=class extends Ip.a{constructor(e,t,n,r,i,o,a,s,u){super(),this._settings=t,this._proofingLanguages=n,this._autoCorrectionBroker=r,this._descriptors=i,this._overriddenCritiqueTypeOptions=o,this._userAndSessionInfo=a,this._roamingDictionaryFeature=s,this._critiquesBrokerProperties=u,this._disposed=!1,this._publishCritiques=e=>{this.publishEvent("critiquesReceived",{tileId:e.tileNodeId,critiques:e.critiques})},this._publishUserRevertedAutoCorrection=e=>{this.publishEvent("userRevertedAutoCorrection",{critique:e.critique})},this._editorService=new Mn.e({endpoint:e}),u&&(this._critiqueBrokersHandler=new Ep.a(u.critiqueFilterer,u.paragraphFinder,u.upsellStore,this._settings.enhancedUpsellEnabled,u.proofingEnabledSettings,this._autoCorrectionBroker),this._critiqueBrokersHandler.subscribe("squiggleDataEvent",this._publishCritiques),this._critiqueBrokersHandler.subscribe("userRevertedAutoCorrection",this._publishUserRevertedAutoCorrection))}get disposed(){return this._disposed}async dispose(){var e,t,n;this._disposed||(null===(e=this._critiqueBrokersHandler)||void 0===e||e.unsubscribe("squiggleDataEvent",this._publishCritiques),null===(t=this._critiqueBrokersHandler)||void 0===t||t.unsubscribe("userRevertedAutoCorrection",this._publishUserRevertedAutoCorrection),await(null===(n=this._critiqueBrokersHandler)||void 0===n?void 0:n.dispose()),this._disposed=!0)}updateConfig(e){void 0!==e.settings&&(this._settings=e.settings),void 0!==e.proofingLanguages&&(this._proofingLanguages=e.proofingLanguages),void 0!==e.descriptors&&(this._descriptors=e.descriptors),void 0!==e.overriddenCritiqueTypeOptions&&(this._overriddenCritiqueTypeOptions=e.overriddenCritiqueTypeOptions),void 0!==e.userAndSessionInfo&&(this._userAndSessionInfo=e.userAndSessionInfo),this._critiquesBrokerProperties&&this._critiqueBrokersHandler&&void 0!==e.proofingEnabledSettings&&(this._critiquesBrokerProperties.proofingEnabledSettings=e.proofingEnabledSettings,this._critiqueBrokersHandler.setEnabledSettings(e.proofingEnabledSettings))}async processTilingMessage(e,t){var n,r,i;switch(e.messageName){case"textTilesMessage":await this.processTextTilesMessage(e,t);break;case"brokerCritiqueAction":null===(n=this._critiqueBrokersHandler)||void 0===n||n.processBrokerCritiqueAction(e);break;case"brokerMove":null===(r=this._critiqueBrokersHandler)||void 0===r||r.processBrokerMove(e);break;case"brokerReconcile":null===(i=this._critiqueBrokersHandler)||void 0===i||i.processBrokerReconcile(e)}}async processTextTilesMessage(e,t){var n,r,i,o,a,s;const u=await Object(kp.b)(e,this._settings.appId,null!==(n=this._overriddenCritiqueTypeOptions)&&void 0!==n?n:[],this._settings.maxContentLengthInChars,this._settings.unsignedInEditorFeatureEnabled,this._descriptors);if(!u)return;const c=await qn(u,this._editorService,this._settings.enhancedUpsellEnabled,null===(r=this._userAndSessionInfo)||void 0===r?void 0:r.userId,null===(i=this._userAndSessionInfo)||void 0===i?void 0:i.licenseType,null===(o=this._userAndSessionInfo)||void 0===o?void 0:o.sessionId,null===(a=this._userAndSessionInfo)||void 0===a?void 0:a.composeSessionId),l=await async function(e,t,n,r,i){let o=dn(t.critiques,n.maxSuggestionItemsDisplayNumber,n.maxSuggestionDisplayPerLanguageNumber,r);return o=rn(o,n.enableAutoCorrect),o=sn(o,!!n.enableV2RoamingDictionary,!!n.enableRoamingService,i),En(o,e.languageUXId,In)}(u,c,this._settings,this._proofingLanguages,this._roamingDictionaryFeature);if(this._settings.emitRemoval&&(c.responseStatus===bt.a.Success||c.responseStatus===bt.a.PartialSuccess)){const e=zn(null!==(s=u.content)&&void 0!==s?s:[],l);void 0!==e&&this.publishEvent("clearTiles",{tiles:e,senderId:t})}this._critiqueBrokersHandler?this.processCritiquesWithBroker(l):this.publishEvent("critiquesReceived",{critiques:l,senderId:t})}processCritiquesWithBroker(e){var t;const n=Object(Zt.d)(e);for(const e of n.keys())null===(t=this._critiqueBrokersHandler)||void 0===t||t.reconcileCritiques(e,n.get(e))}};function Pp(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Np(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Pp(o,r,i,a,s,"next",e)}function s(e){Pp(o,r,i,a,s,"throw",e)}a(void 0)}))}}function jp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rp(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Ap=Object(le.c)([Object(he.a)()],Ap);var xp=function(){function e(t,n,r,i,o,a,s,u,c,l,d){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_hostEmitter",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_hostSettings",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_featureFlagsReader",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"_descriptorManager",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"_proofingStore",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_unSignedInEditorFeature",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"_orchestratorSettings",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"_roamingDictionaryFeature",{enumerable:!0,configurable:!0,writable:!0,value:u}),Object.defineProperty(this,"_userInfoStrategy",{enumerable:!0,configurable:!0,writable:!0,value:c}),Object.defineProperty(this,"_sessionContextProvider",{enumerable:!0,configurable:!0,writable:!0,value:l}),Object.defineProperty(this,"_editorServiceProofingHandler",{enumerable:!0,configurable:!0,writable:!0,value:void 0});var f,h=this;Object.defineProperty(this,"_onCritiquesReceived",{enumerable:!0,configurable:!0,writable:!0,value:(f=Np((function(e){return Rp(this,(function(t){return 0===e.critiques.length||h._hostEmitter.emit(_.a.textAugmentationCoreResponse,{address:e.senderId,message:e.critiques}),[2]}))})),function(e){return f.apply(this,arguments)})});var p=this;Object.defineProperty(this,"_emitClearTiles",{enumerable:!0,configurable:!0,writable:!0,value:function(){var e=Np((function(e){return Rp(this,(function(t){return p._hostEmitter.emit(_.a.textAugmentationCoreRemovalResponse,{address:e.senderId,message:e.tiles}),[2]}))}));return function(t){return e.apply(this,arguments)}}()});var g=this;Object.defineProperty(this,"handleMessage",{enumerable:!0,configurable:!0,writable:!0,value:function(){var e=Np((function(e){var t;return Rp(this,(function(n){switch(n.label){case 0:return t=e.message,[4,g.updateConfig()];case 1:return n.sent(),g._editorServiceProofingHandler.processTilingMessage(t,e.address),[2]}}))}));return function(t){return e.apply(this,arguments)}}()});var m=this;Object.defineProperty(this,"updateConfig",{enumerable:!0,configurable:!0,writable:!0,value:Np((function(){var e,t,n,r,i,o,a,s;return Rp(this,(function(u){switch(u.label){case 0:return[4,m._descriptorManager.buildDescriptors()];case 1:return e=u.sent(),[4,m._proofingStore.read(de.a.ProofingLanguages)];case 2:return t=u.sent(),[4,m._proofingStore.read(de.a.OverriddenCritiqueTypeOptions)];case 3:return n=u.sent(),[4,m._unSignedInEditorFeature.emitAndEvaluateAsync({eventId:L.b.PageContext,sender:L.d.PageContext})];case 4:return r=u.sent(),i=Object.assign(Object.assign(Object.assign(Object.assign({},m._hostSettings),m._featureFlagsReader.flags),m._orchestratorSettings),{unsignedInEditorFeatureEnabled:r}),[4,m._sessionContextProvider()];case 5:o=u.sent(),u.label=6;case 6:return u.trys.push([6,8,,9]),[4,m._userInfoStrategy.executeAsync(!1)];case 7:return a=u.sent(),[3,9];case 8:return u.sent(),[3,9];case 9:return s={userId:null==a?void 0:a.userId,licenseType:null==a?void 0:a.licenseType,sessionId:o.sessionId,composeSessionId:o.composeSessionId},m._editorServiceProofingHandler.updateConfig({descriptors:e,overriddenCritiqueTypeOptions:n,proofingLanguages:t,settings:i,userAndSessionInfo:s}),[2]}}))}))});var y=Object.assign(Object.assign(Object.assign(Object.assign({},this._hostSettings),this._featureFlagsReader.flags),this._orchestratorSettings),{unsignedInEditorFeatureEnabled:!1}),b=this._proofingStore.getCachedEntry(de.a.ProofingLanguages).storeEntryValue,v=this._proofingStore.getCachedEntry(de.a.Descriptors).storeEntryValue,w=this._proofingStore.getCachedEntry(de.a.OverriddenCritiqueTypeOptions).storeEntryValue;this._editorServiceProofingHandler=new Ap("https://".concat(this._hostSettings.editorEndPoint,"/NLEditor"),y,b,d,v,w,{},this._roamingDictionaryFeature)}var t,n,r;return t=e,(n=[{key:"initialize",value:function(){var e=this;return Np((function(){return Rp(this,(function(t){switch(t.label){case 0:return e._hostEmitter.on(_.a.textAugmentationCoreRequest,e.handleMessage),e._editorServiceProofingHandler.subscribe("critiquesReceived",e._onCritiquesReceived),e._editorServiceProofingHandler.subscribe("clearTiles",e._emitClearTiles),[4,e.updateConfig()];case 1:return t.sent(),[2]}}))}))()}},{key:"shutDown",value:function(){this._hostEmitter.off(_.a.textAugmentationCoreRequest,this.handleMessage),this._editorServiceProofingHandler.unsubscribe("critiquesReceived",this._onCritiquesReceived),this._editorServiceProofingHandler.unsubscribe("clearTiles",this._emitClearTiles)}}])&&jp(t.prototype,n),r&&jp(t,r),e}();function Dp(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Mp(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Dp(o,r,i,a,s,"next",e)}function s(e){Dp(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Lp(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}xp=Object(le.c)([Object(he.a)(),Object(le.f)(0,Object(pe.a)(_.b)),Object(le.f)(1,Object(pe.a)(S.a)),Object(le.f)(2,Object(pe.a)(v.a)),Object(le.f)(3,Object(pe.a)(Ie.a)),Object(le.f)(4,Object(pe.a)(K.a)),Object(le.f)(5,Object(pe.a)(L.a)),Object(le.f)(6,Object(pe.a)(Ce.a)),Object(le.f)(7,Object(pe.a)(Z.a)),Object(le.f)(8,Object(pe.a)(N.a)),Object(le.f)(9,Object(pe.a)(a.a)),Object(le.f)(10,Object(Et.a)()),Object(le.f)(10,Object(pe.a)(Cp.a)),Object(le.e)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,Object,Function,Object])],xp),Object(Mu.b)(Object(he.a)(),Du.a);var Bp,Fp,Up=function(e){var t=new Ru.a,n=t.container;return t.addModule(p.a),n.bind(Ru.a).toValue(t),n.bind(xu.a).toValue(n),n.bind(g.b).to(cl),n.bind(nl).to(Cl.a),n.bind(m.a).to(y.a),n.bind(Xu).to(Wh),n.bind(rp.b).to(Lu.a),n.bind(Bf.a).to(lc.a),n.bind(ie.a).toExisting(Bf.a),n.bind(ip.a).toExisting(Bf.a),n.bind(op.a).toExisting(Bf.a),n.bind(Ce.a).toExisting(Bf.a),n.bind(b.b).toExisting(Bf.a),n.bind(f).to(Qc),n.bind(rl).to(Nf),n.bind(v.a).to(dp.a),n.bind(w.a).to(Us.a),n.bind(zu.a).to(ac.a),e?n.bind(S.a).toValue(e):n.bind(S.a).to(dc.a),n.bind(qs).to(zs),n.bind(_.c).to(T.a),n.bind(O.a).toExisting(_.c),n.bind(Uu.b).to(ic.a),n.bind(O.a).toExisting(Uu.b),n.bind(_.b).toExisting(Uu.b),n.bind(Zh.a).to(rc),n.bind(Ws.a).to(Vs.a),n.bind(C.a).to(T.a),n.bind(O.a).toExisting(C.a),n.bind(Fu.a).to(T.a),n.bind(E.a).to(T.a),n.bind(O.a).toExisting(E.a),n.bind(I.a).to(T.a),n.bind(O.a).toExisting(I.a),n.bind(eh).to(T.a),n.bind(ep.a).to(T.a),n.bind(O.a).toExisting(ep.a),n.bind(oe.a).to(ae.a),n.bind(se.a).to(ue.a),n.bind(sp).to(Xf),n.bind(k.a).to(A.a),n.bind(up).to(Wf),n.bind(P.a).to(Ju.a),n.bind(nf).toDynamicValue((function(e){var t=e.get(v.a),n=e.get(N.a),r=e.get(S.a),i=new h.a;return new Ef(t,n,{baseUri:"https://".concat(r.editorEndPoint),httpClient:i})})),n.bind(xp).toSelf(),n.bind(O.a).toExisting(xp),n.bind(Mn.b).toDynamicValue((function(e){var t=e.get(S.a);return new Mn.b({endpoint:"https://".concat(t.editorEndPoint,"/NLEditor")})})),n.bind(Mn.e).toDynamicValue((function(e){var t=e.get(S.a);return new Mn.e({endpoint:"https://".concat(t.editorEndPoint,"/NLEditor")})})),n.bind(Mn.c).toDynamicValue((function(e){var t=e.get(S.a);return new Mn.c({endpoint:"https://".concat(t.editorEndPoint,"/NLEditor")})})),n.bind(Mn.a).toDynamicValue((function(e){var t=e.get(S.a);return new Mn.a({endpoint:"https://".concat(t.editorEndPoint,"/NLEditor")})})),n.bind(Du.a).toDynamicValue((function(e){var t=e.get(N.a),n=e.get(S.a),r=new h.a;return new j.a(t,{baseUri:"https://".concat(n.synonymsEndPoint),httpClient:r})})),n.bind(R.a).to(x.a),n.bind(nu.a).to(ru.a),n.bind(iu.a).to(ou.a),n.bind(D.a).to(Qu.a),n.bind(au.a).to(su.a),n.bind(uu.d).to(cu.a),n.bind(uu.c).to(lu.a),n.bind(uu.b).to(du.a),n.bind(uu.a).to(du.a),n.bind(M.a).to(Op),n.bind(L.a).to(L.c),n.bind(B.a).toSelf(),n.bind(F.a).toSelf(),n.bind(fu.a).toSelf(),n.bind(_u.a).toSelf(),n.bind(U.a).toSelf(),n.bind(q.a).toSelf(),n.bind(z.a).toExisting(q.a),n.bind(W.a).toExisting(q.a),n.bind(o.a).to(V.a),n.bind(Yu.b).to(Yu.a),n.bind(b.c).toDynamicValue((function(e){return e.get(Yu.b).getTelemetrySink()})),n.bind(a.a).toDynamicValue((function(e){var t,n=function(e){switch(e){case"arm":case"arm64":return"arm";case"x86-32":return"x86-32";case"x86-64":return"x86-64";default:return}};return Mp((function(){var r,i,o,a,s;return Lp(this,(function(u){switch(u.label){case 0:if(t)return[3,5];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,chrome.runtime.getPlatformInfo()];case 2:return i=u.sent(),o=G.a.detectBrowser(),a=chrome.runtime.getManifest(),[2,t={os:i.os,arch:n(i.arch),browserType:o?o.name:"",browserVersion:o?o.version:null,extensionStoreId:chrome.runtime.id,languageUxId:chrome.i18n.getUILanguage(),extensionVersion:a.version,extensionVersionName:null!==(r=a.version_name)&&void 0!==r?r:"",sessionId:e.get(R.a).generate()}];case 3:return s=u.sent(),[2,Promise.reject(s)];case 4:return[3,6];case 5:return[2,Promise.resolve(t)];case 6:return[2]}}))}))})),n.bind(H.b).to(H.a),n.bind($.a).to($.b),n.bind(Ne).to(je),n.bind(Re).to(It),n.bind(_c).toSelf(),n.bind(Xt).to(Rc),n.bind(Gs.a).to(fc.a),n.bind(cp.a).to(lp.a),n.bind(Hs.a).to($s.a),n.bind(Ks.a).to(Js.a),n.bind(Qs).to(tu),n.bind(K.a).to(uc.a),n.bind(tp.a).toExisting(K.a),n.bind(ap.a).toExisting(K.a),n.bind(np.a).to(Ku.a),n.bind(el.a).to(sc.a),n.bind(c.a).to(cc.a),n.bind(ce.a).toExisting(c.a),n.bind(Zc).to($u),n.bind(N.a).to(Bu.a),n.bind(Ph).to(Ih),n.bind(J.a).toSelf(),n.bind(Q.a).toSelf(),n.bind(Y.a).toSelf(),n.bind(X.a).toSelf(),n.bind(Cn).toSelf(),n.bind(an).toSelf(),n.bind(Pn).toSelf(),n.bind(ln).toSelf(),n.bind(nn).toSelf(),n.bind(me).toSelf(),n.bind(fe.a).to(ye.a),n.bind(Z.a).to(ee.a),n.bind(ah).to(Mh),n.bind(xn).toSelf(),n.bind(Ct).to(Dn),n.bind(O.a).to(Fn),n.bind(O.a).toExisting(ah),n.bind(O.a).to(Se),n.bind(O.a).to(Oe.a),n.bind(O.a).to(te.a),n.bind(O.a).to(Un),n.bind(O.a).to(Wn.a),n.bind(O.a).to(oc.a),n.bind(O.a).toExisting(sp),n.bind(O.a).toExisting(up),n.bind(O.a).toExisting(Zc),n.bind(O.a).toExisting(Ws.a),n.bind(O.a).toExisting(v.a),n.bind(O.a).toExisting(w.a),n.bind(O.a).toExisting(Xt),n.bind(O.a).toExisting(fe.a),n.bind(O.a).to(bc),n.bind(O.a).to(pl),n.bind(O.a).to(Mf),n.bind(O.a).toExisting(M.a),n.bind(O.a).to(gp),n.bind(O.a).to(Fc),n.bind(O.a).to(_h),n.bind(O.a).to(mh),n.bind(O.a).to(ne.a),n.bind(O.a).to(re.a),n.bind(O.a).to(dh),n.bind(O.a).toExisting(Ph),n.bind(O.a).to(wp),n.bind(O.a).to(Gc),n.bind(O.a).toExisting(fu.a),n.bind(O.a).toExisting(_u.a),n.bind(O.a).toExisting(_c),n.bind(O.a).toExisting(U.a),n.bind(Hh).to(Xh.a),n.bind(Yh).toSelf(),n.bind(O.a).to(Yh),t.addModule(Fs),t.addModule(Su),t.addModule(ju),n},qp=n(155);function zp(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Wp(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function Vp(){var e;return e=function(e){var t,n,r,i;return Wp(this,(function(a){switch(a.label){case 0:return[4,Object(qp.b)()];case 1:a.sent(),Object(St.configure)({enforceActions:"observed"}),t=Up(e),n=t.get(o.a),r=t.get(g.b),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,r.initializeComponent()];case 3:return a.sent(),[3,5];case 4:return i=a.sent(),n.error(509206622,"BackgroundScriptInitializationError",i),n.logEvent(509206621,u.a.BackgroundScriptInitializationError,At.a.Error,"Background script initialization failed.",s.a.SamplingPolicy.CriticalBusinessImpact),[3,5];case 5:return[2,t]}}))},Vp=function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){zp(o,r,i,a,s,"next",e)}function s(e){zp(o,r,i,a,s,"throw",e)}a(void 0)}))},Vp.apply(this,arguments)}function Gp(e,t){var n=e.get(o.a),r=e.get(c.a);r.read(l.a.FirstInstallVersion).then((function(i){var o,c=t.reason;i&&""!==i?c="browser_update":"install"===t.reason?e.get(a.a)().then((function(e){r.write(l.a.FirstInstallVersion,e.extensionVersion)})).catch((function(e){n.error(509646627,"Can't save first install version: failed to fetch the session context data",e)})):"update"===t.reason&&r.write(l.a.FirstInstallVersion,"undefined");var d=n.getNewActivity(u.b.ExtensionInstalled,s.a.SamplingPolicy.CriticalExperimentation);d&&(d.dataFields.push({name:"Reason",dataType:s.a.DataFieldType.String.valueOf(),value:c,classification:s.a.DataClassification.SystemMetadata}),d.dataFields.push({name:"Previous_Version",dataType:s.a.DataFieldType.String.valueOf(),value:null!==(o=t.previousVersion)&&void 0!==o?o:"",classification:s.a.DataClassification.SystemMetadata}),d.success=!0,d.endNow())})).catch((function(e){n.error(509646626,"Failed to fetch the first installed version data",e)}))}function Hp(e,t){e.get(f).detect(t)}chrome.runtime.onInstalled.addListener((function(e){Fp?(Hp(Fp,e),Gp(Fp,e)):Bp=e})),Fp||function(){return Vp.apply(this,arguments)}().then((function(e){Fp=e,Bp&&(Hp(Fp,Bp),Gp(Fp,Bp))}))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return ye}));var r=n(35);Error;new Set("0123456789abcdefABCDEF");function i(){let e="";for(let t=0;t<32;t++){const n=Math.floor(16*Math.random());e+=12===t?"4":16===t?3&n|8:n.toString(16),7!==t&&11!==t&&15!==t&&19!==t||(e+="-")}return e}var o;"function"==typeof(null===(o=null===globalThis||void 0===globalThis?void 0:globalThis.crypto)||void 0===o?void 0:o.randomUUID)&&globalThis.crypto.randomUUID.bind(globalThis.crypto);var a,s,u,c;"undefined"!=typeof window&&window.document,"object"==typeof self&&"function"==typeof(null===self||void 0===self?void 0:self.importScripts)&&("DedicatedWorkerGlobalScope"===(null===(a=self.constructor)||void 0===a?void 0:a.name)||"ServiceWorkerGlobalScope"===(null===(s=self.constructor)||void 0===s?void 0:s.name)||null===(u=self.constructor)||void 0===u||u.name),"undefined"!=typeof Deno&&void 0!==Deno.version&&Deno.version.deno,"undefined"!=typeof Bun&&Bun.version,void 0!==globalThis.process&&Boolean(globalThis.process.version)&&Boolean(null===(c=globalThis.process.versions)||void 0===c?void 0:c.node),"undefined"!=typeof navigator&&(null===navigator||void 0===navigator||navigator.product);var l=n(242),d=n(114),f=function(){function e(){}return e.prototype.sendRequest=function(e){var t=new XMLHttpRequest;if(e.agentSettings)throw new Error("HTTP agent settings not supported in browser environment");if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");var n=e.abortSignal;if(n){var r=function(){t.abort()};n.addEventListener("abort",r),t.addEventListener("readystatechange",(function(){t.readyState===XMLHttpRequest.DONE&&n.removeEventListener("abort",r)}))}if(h(t.upload,e.onUploadProgress),h(t,e.onDownloadProgress),e.formData){for(var i=e.formData,o=new FormData,a=function(e,t){t&&t.hasOwnProperty("value")&&t.hasOwnProperty("options")?o.append(e,t.value,t.options):o.append(e,t)},s=0,u=Object.keys(i);s<u.length;s++){var c=u[s],l=i[c];if(Array.isArray(l))for(var d=0;d<l.length;d++)a(c,l[d]);else a(c,l)}e.body=o,e.formData=void 0;var f=e.headers.get("Content-Type");f&&-1!==f.indexOf("multipart/form-data")&&e.headers.remove("Content-Type")}t.open(e.method,e.url),t.timeout=e.timeout,t.withCredentials=e.withCredentials;for(var m=0,y=e.headers.headersArray();m<y.length;m++){var b=y[m];t.setRequestHeader(b.name,b.value)}return t.responseType=e.streamResponseBody?"blob":"text",t.send(void 0===e.body?null:e.body),e.streamResponseBody?new Promise((function(n,r){t.addEventListener("readystatechange",(function(){if(t.readyState===XMLHttpRequest.HEADERS_RECEIVED){var r=new Promise((function(n,r){t.addEventListener("load",(function(){n(t.response)})),g(e,t,r)}));n({request:e,status:t.status,headers:p(t),blobBody:r})}})),g(e,t,r)})):new Promise((function(n,r){t.addEventListener("load",(function(){return n({request:e,status:t.status,headers:p(t),bodyAsText:t.responseText})})),g(e,t,r)}))},e}();function h(e,t){t&&e.addEventListener("progress",(function(e){return t({loadedBytes:e.loaded})}))}function p(e){for(var t=new l.a,n=0,r=e.getAllResponseHeaders().trim().split(/[\r\n]+/);n<r.length;n++){var i=r[n],o=i.indexOf(":"),a=i.slice(0,o),s=i.slice(o+2);t.set(a,s)}return t}function g(e,t,n){t.addEventListener("error",(function(){return n(new d.a("Failed to send request to "+e.url,d.a.REQUEST_SEND_ERROR,void 0,e))})),t.addEventListener("abort",(function(){return n(new d.a("The request was aborted",d.a.REQUEST_ABORTED_ERROR,void 0,e))})),t.addEventListener("timeout",(function(){return n(new d.a("timeout of "+t.timeout+"ms exceeded",d.a.REQUEST_SEND_ERROR,void 0,e))}))}function m(e){return y(e.parameterPath,e.mapper)}function y(e,t){return"string"==typeof e?e:Array.isArray(e)?e.join("."):t.serializedName}var b=n(203);function v(e){var t=!1;for(var n in e.responses){var r=e.responses[n];if(r.bodyMapper&&r.bodyMapper.type.name===b.a.Stream){t=!0;break}}return t}var w,S,_,T=n(67),O=new DOMParser;try{void 0!==self.trustedTypes&&(_=self.trustedTypes.createPolicy("@azure/ms-rest-js#xml.browser",{createHTML:function(e){return e}}))}catch(e){console.warn('Could not create trusted types policy "@azure/ms-rest-js#xml.browser"')}function C(e){var t;try{var n=O.parseFromString(null!==(t=null==_?void 0:_.createHTML(e))&&void 0!==t?t:e,"application/xml");!function(e){if(E){var t=e.getElementsByTagNameNS(E,"parsererror");if(t.length)throw new Error(t.item(0).innerHTML)}}(n);var r=k(n.childNodes[0]);return Promise.resolve(r)}catch(e){return Promise.reject(e)}}var E="";try{var I=null!==(w=null==_?void 0:_.createHTML("INVALID"))&&void 0!==w?w:"INVALID";E=null!==(S=O.parseFromString(I,"text/xml").getElementsByTagName("parsererror")[0].namespaceURI)&&void 0!==S?S:""}catch(e){}function k(e){var t={},n=e.childNodes.length,r=e.childNodes[0],i=r&&1===n&&r.nodeType===Node.TEXT_NODE&&r.nodeValue||void 0,o=function(e){return function(e){return!!e.attributes}(e)&&e.hasAttributes()?e:void 0}(e);if(o){t.$={};for(var a=0;a<o.attributes.length;a++){var s=o.attributes[a];t.$[s.nodeName]=s.nodeValue}i&&(t._=i)}else 0===n?t="":i&&(t=i);if(!i)for(a=0;a<n;a++){var u=e.childNodes[a];if(u.nodeType!==Node.TEXT_NODE){var c=k(u);t[u.nodeName]?Array.isArray(t[u.nodeName])?t[u.nodeName].push(c):t[u.nodeName]=[t[u.nodeName],c]:t[u.nodeName]=c}}return t}var A=document.implementation.createDocument(null,null,null),P=new XMLSerializer;function N(e,t){var n=R(e,t&&t.rootName||"root")[0];return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+P.serializeToString(n)}function j(e){for(var t=[],n=0,r=Object.keys(e);n<r.length;n++){var i=r[n],o=A.createAttribute(i);o.value=e[i].toString(),t.push(o)}return t}function R(e,t){if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return(u=A.createElement(t)).textContent=e.toString(),[u];if(Array.isArray(e)){for(var n=[],r=0,i=e;r<i.length;r++)for(var o=0,a=R(i[r],t);o<a.length;o++){var s=a[o];n.push(s)}return n}if("object"==typeof e){for(var u=A.createElement(t),c=0,l=Object.keys(e);c<l.length;c++){var d=l[c];if("$"===d)for(var f=0,h=j(e[d]);f<h.length;f++){var p=h[f];u.attributes.setNamedItem(p)}else for(var g=0,m=R(e[d],d);g<m.length;g++){s=m[g];u.appendChild(s)}}return[u]}throw new Error("Illegal value passed to buildObject: "+e)}var x=n(88);var D=["application/json","text/json"],M=["application/xml","application/atom+xml"],L=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.jsonContentTypes=n&&n.json||D,i.xmlContentTypes=n&&n.xml||M,i}return Object(r.c)(t,e),t.prototype.sendRequest=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t=this;return Object(r.d)(this,(function(n){return[2,this._nextPolicy.sendRequest(e).then((function(e){return function(e,t,n){return function(e,t,n){var r=function(e){var t='Error "'+e+'" occurred while parsing the response body - '+n.bodyAsText+".",r=e.code||d.a.PARSE_ERROR,i=new d.a(t,r,n.status,n.request,n,n.bodyAsText);return Promise.reject(i)};if(!n.request.streamResponseBody&&n.bodyAsText){var i=n.bodyAsText,o=n.headers.get("Content-Type")||"",a=o?o.split(";").map((function(e){return e.toLowerCase()})):[];if(0===a.length||a.some((function(t){return-1!==e.indexOf(t)})))return new Promise((function(e){n.parsedBody=JSON.parse(i),e(n)})).catch(r);if(a.some((function(e){return-1!==t.indexOf(e)})))return C(i).then((function(e){return n.parsedBody=e,n})).catch(r)}return Promise.resolve(n)}(e,t,n).then((function(e){var t=function(e){var t,n=e.request.shouldDeserialize;t=void 0===n||("boolean"==typeof n?n:n(e));return t}(e);if(t){var r=e.request.operationSpec;if(r&&r.responses){var i=e.status,o=Object.keys(r.responses),a=0===o.length||1===o.length&&"default"===o[0],s=function(e){var t,n=e.request,r=n.operationSpec;if(r){var i=n.operationResponseGetter;t=i?i(r,e):r.responses[e.status]}return t}(e);if(a?200<=i&&i<300:!!s){if(s){if(s.bodyMapper){m=e.parsedBody;r.isXML&&s.bodyMapper.type.name===b.a.Sequence&&(m="object"==typeof m?m[s.bodyMapper.xmlElementName]:[]);try{e.parsedBody=r.serializer.deserialize(s.bodyMapper,m,"operationRes.parsedBody")}catch(f){var u=new d.a("Error "+f+" occurred in deserializing the responseBody - "+e.bodyAsText);return u.request=T.h(e.request),u.response=T.i(e),Promise.reject(u)}}else"HEAD"===r.httpMethod&&(e.parsedBody=n.status>=200&&n.status<300);s.headersMapper&&(e.parsedHeaders=r.serializer.deserialize(s.headersMapper,e.headers.rawHeaders(),"operationRes.parsedHeaders"))}}else{var c=r.responses.default;if(c){var l=v(r)?"Unexpected status code: "+i:e.bodyAsText,f=new d.a(l);f.statusCode=i,f.request=T.h(e.request),f.response=T.i(e);var h=e.parsedBody;try{if(h){var p=c.bodyMapper;if(p&&"CloudError"===p.serializedName)h.error&&(h=h.error),h.code&&(f.code=h.code),h.message&&(f.message=h.message);else{var g=h;h.error&&(g=h.error),f.code=g.code,g.message&&(f.message=g.message)}if(p){var m=h;r.isXML&&p.type.name===b.a.Sequence&&(m="object"==typeof h?h[p.xmlElementName]:[]),f.body=r.serializer.deserialize(p,m,"error.body")}}}catch(t){f.message='Error "'+t.message+'" occurred in deserializing the responseBody - "'+e.bodyAsText+'" for the default response.'}return Promise.reject(f)}}}}return Promise.resolve(e)}))}(t.jsonContentTypes,t.xmlContentTypes,e)}))]}))}))},t}(x.a);var B=function(e){function t(t,n,r,i,o,a){var s=e.call(this,t,n)||this;function u(e){return"number"==typeof e}return s.retryCount=u(r)?r:3,s.retryInterval=u(i)?i:3e4,s.minRetryInterval=u(o)?o:3e3,s.maxRetryInterval=u(a)?a:9e4,s}return Object(r.c)(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then((function(n){return F(t,e,n)})).catch((function(n){return F(t,e,n.response,void 0,n)}))},t}(x.a);function F(e,t,n,r,i){r=function(e,t,n){t||(t={retryCount:0,retryInterval:0}),n&&(t.error&&(n.innerError=t.error),t.error=n),t.retryCount++;var r=Math.pow(2,t.retryCount)-1;return r*=.8*e.retryInterval+Math.floor(Math.random()*(1.2*e.retryInterval-.8*e.retryInterval)),t.retryInterval=Math.min(e.minRetryInterval+r,e.maxRetryInterval),t}(e,r,i);var o=t.abortSignal&&t.abortSignal.aborted;if(!o&&function(e,t,n){if(null==t||t<500&&408!==t||501===t||505===t)return!1;if(!n)throw new Error("retryData for the ExponentialRetryPolicyFilter cannot be null.");return(n&&n.retryCount)<e.retryCount}(e,n&&n.status,r))return T.a(r.retryInterval).then((function(){return e._nextPolicy.sendRequest(t.clone())})).then((function(n){return F(e,t,n,r,void 0)})).catch((function(i){return F(e,t,n,r,i)}));if(o||i||!n){var a=r.error||new d.a("Failed to send the request.",d.a.REQUEST_SEND_ERROR,n&&n.status,n&&n.request,n);return Promise.reject(a)}return Promise.resolve(n)}var U=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i._requestIdHeaderName=r,i}return Object(r.c)(t,e),t.prototype.sendRequest=function(e){return e.headers.contains(this._requestIdHeaderName)||e.headers.set(this._requestIdHeaderName,T.b()),this._nextPolicy.sendRequest(e)},t}(x.a),q=n(444),z=function(){function e(){this._rawQuery={}}return e.prototype.any=function(){return Object.keys(this._rawQuery).length>0},e.prototype.set=function(e,t){if(e)if(null!=t){var n=Array.isArray(t)?t:t.toString();this._rawQuery[e]=n}else delete this._rawQuery[e]},e.prototype.get=function(e){return e?this._rawQuery[e]:void 0},e.prototype.toString=function(){var e="";for(var t in this._rawQuery){e&&(e+="&");var n=this._rawQuery[t];if(Array.isArray(n)){for(var r=[],i=0,o=n;i<o.length;i++){var a=o[i];r.push(t+"="+a)}e+=r.join("&")}else e+=t+"="+n}return e},e.parse=function(t){var n=new e;if(t){t.startsWith("?")&&(t=t.substring(1));for(var r="ParameterName",i="",o="",a=0;a<t.length;++a){var s=t[a];switch(r){case"ParameterName":switch(s){case"=":r="ParameterValue";break;case"&":i="",o="";break;default:i+=s}break;case"ParameterValue":if("&"===s)n.set(i,o),i="",o="",r="ParameterName";else o+=s;break;default:throw new Error("Unrecognized URLQuery parse state: "+r)}}"ParameterValue"===r&&n.set(i,o)}return n},e}(),W=function(){function e(){}return e.prototype.setScheme=function(e){e?this.set(e,"SCHEME"):this._scheme=void 0},e.prototype.getScheme=function(){return this._scheme},e.prototype.setHost=function(e){e?this.set(e,"SCHEME_OR_HOST"):this._host=void 0},e.prototype.getHost=function(){return this._host},e.prototype.setPort=function(e){null==e||""===e?this._port=void 0:this.set(e.toString(),"PORT")},e.prototype.getPort=function(){return this._port},e.prototype.setPath=function(e){if(e){var t=e.indexOf("://");if(-1!==t){var n=e.lastIndexOf("/",t);this.set(-1===n?e:e.substr(n+1),"SCHEME")}else this.set(e,"PATH")}else this._path=void 0},e.prototype.appendPath=function(e){if(e){var t=this.getPath();t&&(t.endsWith("/")||(t+="/"),e.startsWith("/")&&(e=e.substring(1)),e=t+e),this.set(e,"PATH")}},e.prototype.getPath=function(){return this._path},e.prototype.setQuery=function(e){this._query=e?z.parse(e):void 0},e.prototype.setQueryParameter=function(e,t){e&&(this._query||(this._query=new z),this._query.set(e,t))},e.prototype.getQueryParameterValue=function(e){return this._query?this._query.get(e):void 0},e.prototype.getQuery=function(){return this._query?this._query.toString():void 0},e.prototype.set=function(e,t){for(var n=new G(e,t);n.next();){var r=n.current();if(r)switch(r.type){case"SCHEME":this._scheme=r.text||void 0;break;case"HOST":this._host=r.text||void 0;break;case"PORT":this._port=r.text||void 0;break;case"PATH":var i=r.text||void 0;this._path&&"/"!==this._path&&"/"===i||(this._path=i);break;case"QUERY":this._query=z.parse(r.text);break;default:throw new Error("Unrecognized URLTokenType: "+r.type)}}},e.prototype.toString=function(){var e="";return this._scheme&&(e+=this._scheme+"://"),this._host&&(e+=this._host),this._port&&(e+=":"+this._port),this._path&&(this._path.startsWith("/")||(e+="/"),e+=this._path),this._query&&this._query.any()&&(e+="?"+this._query.toString()),e},e.prototype.replaceAll=function(e,t){e&&(this.setScheme(Object(T.g)(this.getScheme(),e,t)),this.setHost(Object(T.g)(this.getHost(),e,t)),this.setPort(Object(T.g)(this.getPort(),e,t)),this.setPath(Object(T.g)(this.getPath(),e,t)),this.setQuery(Object(T.g)(this.getQuery(),e,t)))},e.parse=function(t){var n=new e;return n.set(t,"SCHEME_OR_HOST"),n},e}(),V=function(){function e(e,t){this.text=e,this.type=t}return e.scheme=function(t){return new e(t,"SCHEME")},e.host=function(t){return new e(t,"HOST")},e.port=function(t){return new e(t,"PORT")},e.path=function(t){return new e(t,"PATH")},e.query=function(t){return new e(t,"QUERY")},e}();var G=function(){function e(e,t){this._text=e,this._textLength=e?e.length:0,this._currentState=null!=t?t:"SCHEME_OR_HOST",this._currentIndex=0}return e.prototype.current=function(){return this._currentToken},e.prototype.next=function(){if(H(this))switch(this._currentState){case"SCHEME":t=function(e){return Q(e,(function(e){return function(e){var t=e.charCodeAt(0);return 48<=t&&t<=57||65<=t&&t<=90||97<=t&&t<=122}(e)}))}(e=this),e._currentToken=V.scheme(t),H(e)?e._currentState="HOST":e._currentState="DONE";break;case"SCHEME_OR_HOST":!function(e){var t=Y(e,":","/","?");H(e)?":"===$(e)?"://"===J(e,3)?(e._currentToken=V.scheme(t),e._currentState="HOST"):(e._currentToken=V.host(t),e._currentState="PORT"):(e._currentToken=V.host(t),"/"===$(e)?e._currentState="PATH":e._currentState="QUERY"):(e._currentToken=V.host(t),e._currentState="DONE")}(this);break;case"HOST":!function(e){"://"===J(e,3)&&K(e,3);var t=Y(e,":","/","?");e._currentToken=V.host(t),H(e)?":"===$(e)?e._currentState="PORT":"/"===$(e)?e._currentState="PATH":e._currentState="QUERY":e._currentState="DONE"}(this);break;case"PORT":!function(e){":"===$(e)&&K(e);var t=Y(e,"/","?");e._currentToken=V.port(t),H(e)?"/"===$(e)?e._currentState="PATH":e._currentState="QUERY":e._currentState="DONE"}(this);break;case"PATH":!function(e){var t=Y(e,"?");e._currentToken=V.path(t),H(e)?e._currentState="QUERY":e._currentState="DONE"}(this);break;case"QUERY":!function(e){"?"===$(e)&&K(e);var t=function(e){var t="";e._currentIndex<e._textLength&&(t=e._text.substring(e._currentIndex),e._currentIndex=e._textLength);return t}(e);e._currentToken=V.query(t),e._currentState="DONE"}(this);break;default:throw new Error("Unrecognized URLTokenizerState: "+this._currentState)}else this._currentToken=void 0;var e,t;return!!this._currentToken},e}();function H(e){return e._currentIndex<e._textLength}function $(e){return e._text[e._currentIndex]}function K(e,t){H(e)&&(t||(t=1),e._currentIndex+=t)}function J(e,t){var n=e._currentIndex+t;return e._textLength<n&&(n=e._textLength),e._text.substring(e._currentIndex,n)}function Q(e,t){for(var n="";H(e);){var r=$(e);if(!t(r))break;n+=r,K(e)}return n}function Y(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Q(e,(function(e){return-1===t.indexOf(e)}))}var X={handleRedirects:!0,maxRetries:20};var Z=function(e){function t(t,n,r){void 0===r&&(r=20);var i=e.call(this,t,n)||this;return i.maxRetries=r,i}return Object(r.c)(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e).then((function(e){return ee(t,e,0)}))},t}(x.a);function ee(e,t,n){var r=t.request,i=t.status,o=t.headers.get("location");if(o&&(300===i||301===i&&["GET","HEAD"].includes(r.method)||302===i&&["GET","POST","HEAD"].includes(r.method)||303===i&&"POST"===r.method||307===i)&&(void 0!==r.redirectLimit&&n<r.redirectLimit||void 0===r.redirectLimit&&n<e.maxRetries)){var a=W.parse(r.url);return a.setPath(o),r.url=a.toString(),302!==i&&303!==i||"POST"!==r.method||(r.method="GET",delete r.body),e._nextPolicy.sendRequest(r).then((function(t){return ee(e,t,n+1)})).then((function(e){return function(e,t){e.redirected||(e.redirected=!0,e.url=t);return e}(e,r.url)}))}return Promise.resolve(t)}var te=function(e){function t(t,n,r){void 0===r&&(r=30);var i=e.call(this,t,n)||this;return i._retryTimeout=r,i}return Object(r.c)(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then((function(n){return function(e,t,n){if(409===n.status){var r=function(e){var t,n;if(e){try{n=JSON.parse(e)}catch(e){}if(n&&n.error&&n.error.message&&n.error.code&&"MissingSubscriptionRegistration"===n.error.code){var r=n.error.message.match(/.*'(.*)'/i);r&&(t=r.pop())}}return t}(n.bodyAsText);if(r){var i=function(e){var t,n=e.match(/.*\/subscriptions\/[a-f0-9-]+\//gi);if(!n||!n[0])throw new Error("Unable to extract subscriptionId from the given url - "+e+".");t=n[0];return t}(t.url);return function(e,t,n,r){var i=t+"providers/"+n+"/register?api-version=2016-02-01",o=t+"providers/"+n+"?api-version=2016-02-01",a=ne(r);return a.method="POST",a.url=i,e._nextPolicy.sendRequest(a).then((function(t){if(200!==t.status)throw new Error("Autoregistration of "+n+" failed. Please try registering manually.");return re(e,o,r)}))}(e,i,r,t).catch((function(){return!1})).then((function(r){return r?(t.headers.set("x-ms-client-request-id",T.b()),e._nextPolicy.sendRequest(t.clone())):n}))}}return Promise.resolve(n)}(t,e,n)}))},t}(x.a);function ne(e,t){void 0===t&&(t=!1);var n=e.clone();return t&&(n.url=e.url),n.headers.set("x-ms-client-request-id",T.b()),n.headers.set("Content-Type","application/json; charset=utf-8"),n}function re(e,t,n){var r=ne(n);return r.url=t,r.method="GET",e._nextPolicy.sendRequest(r).then((function(r){var i=r.parsedBody;return!(!r.parsedBody||!i.registrationState||"Registered"!==i.registrationState)||T.a(1e3*e._retryTimeout).then((function(){return re(e,t,n)}))}))}var ie=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.authenticationProvider=r,i}return Object(r.c)(t,e),t.prototype.signRequest=function(e){return this.authenticationProvider.signRequest(e)},t.prototype.sendRequest=function(e){var t=this;return this.signRequest(e).then((function(e){return t._nextPolicy.sendRequest(e)}))},t}(x.a);var oe=function(e){function t(t,n,r,i,o,a){var s=e.call(this,t,n)||this;return s.DEFAULT_CLIENT_RETRY_INTERVAL=3e4,s.DEFAULT_CLIENT_RETRY_COUNT=3,s.DEFAULT_CLIENT_MAX_RETRY_INTERVAL=9e4,s.DEFAULT_CLIENT_MIN_RETRY_INTERVAL=3e3,s.retryCount="number"==typeof r?r:s.DEFAULT_CLIENT_RETRY_COUNT,s.retryInterval="number"==typeof i?i:s.DEFAULT_CLIENT_RETRY_INTERVAL,s.minRetryInterval="number"==typeof o?o:s.DEFAULT_CLIENT_MIN_RETRY_INTERVAL,s.maxRetryInterval="number"==typeof a?a:s.DEFAULT_CLIENT_MAX_RETRY_INTERVAL,s}return Object(r.c)(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).catch((function(n){return ae(t,e,n.response,n)}))},t}(x.a);function ae(e,t,n,i,o){return Object(r.b)(this,void 0,void 0,(function(){var a;return Object(r.d)(this,(function(r){switch(r.label){case 0:if(o=function(e,t,n){t||(t={retryCount:0,retryInterval:0}),n&&(t.error&&(n.innerError=t.error),t.error=n),t.retryCount++;var r=Math.pow(2,t.retryCount)-1;return r*=.8*e.retryInterval+Math.floor(Math.random()*(.4*e.retryInterval)),t.retryInterval=Math.min(e.minRetryInterval+r,e.maxRetryInterval),t}(e,o,i),!(i&&i.code&&function(e,t){if(!t)throw new Error("retryData for the SystemErrorRetryPolicyFilter cannot be null.");return(t&&t.retryCount)<e.retryCount}(e,o))||"ETIMEDOUT"!==i.code&&"ESOCKETTIMEDOUT"!==i.code&&"ECONNREFUSED"!==i.code&&"ECONNRESET"!==i.code&&"ENOENT"!==i.code)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,T.a(o.retryInterval)];case 2:return r.sent(),[2,e._nextPolicy.sendRequest(t.clone())];case 3:return a=r.sent(),[2,ae(e,t,n,a,o)];case 4:return[3,6];case 5:return i?[2,Promise.reject(o.error)]:[2,n];case 6:return[2]}}))}))}var se=n(298);var ue=function(){function e(e,t,n,r,i,o,a,s,u,c,d,f,h,p,g){this.streamResponseBody=o,this.url=e||"",this.method=t||"GET",this.headers=Object(l.b)(i)?i:new l.a(i),this.body=n,this.query=r,this.formData=void 0,this.withCredentials=a||!1,this.abortSignal=s,this.timeout=u||0,this.onUploadProgress=c,this.onDownloadProgress=d,this.proxySettings=f,this.keepAlive=h,this.agentSettings=p,this.redirectLimit=g}return e.prototype.validateRequestProperties=function(){if(!this.method)throw new Error("WebResource.method is required.");if(!this.url)throw new Error("WebResource.url is required.")},e.prototype.prepare=function(e){if(!e)throw new Error("options object is required");if(null==e.method||"string"!=typeof e.method.valueOf())throw new Error("options.method must be a string.");if(e.url&&e.pathTemplate)throw new Error("options.url and options.pathTemplate are mutually exclusive. Please provide exactly one of them.");if(!(null!=e.pathTemplate&&"string"==typeof e.pathTemplate.valueOf()||null!=e.url&&"string"==typeof e.url.valueOf()))throw new Error("Please provide exactly one of options.pathTemplate or options.url.");if(e.url){if("string"!=typeof e.url)throw new Error('options.url must be of type "string".');this.url=e.url}if(e.method){var t=["GET","PUT","HEAD","DELETE","OPTIONS","POST","PATCH","TRACE"];if(-1===t.indexOf(e.method.toUpperCase()))throw new Error('The provided method "'+e.method+'" is invalid. Supported HTTP methods are: '+JSON.stringify(t))}if(this.method=e.method.toUpperCase(),e.pathTemplate){var n=e.pathTemplate,r=e.pathParameters;if("string"!=typeof n)throw new Error('options.pathTemplate must be of type "string".');e.baseUrl||(e.baseUrl="https://management.azure.com");var i=e.baseUrl,o=i+(i.endsWith("/")?"":"/")+(n.startsWith("/")?n.slice(1):n),a=o.match(/({\w*\s*\w*})/gi);if(a&&a.length){if(!r)throw new Error("pathTemplate: "+n+" has been provided. Hence, options.pathParameters must also be provided.");a.forEach((function(e){var t=e.slice(1,-1),i=r[t];if(null==i||"string"!=typeof i&&"object"!=typeof i)throw new Error("pathTemplate: "+n+" contains the path parameter "+t+" however, it is not present in "+r+" - "+JSON.stringify(r,void 0,2)+'.The value of the path parameter can either be a "string" of the form { '+t+': "some sample value" } or it can be an "object" of the form { "'+t+'": { value: "some sample value", skipUrlEncoding: true } }.');if("string"==typeof i.valueOf()&&(o=o.replace(e,encodeURIComponent(i))),"object"==typeof i.valueOf()){if(!i.value)throw new Error("options.pathParameters["+t+'] is of type "object" but it does not contain a "value" property.');o=i.skipUrlEncoding?o.replace(e,i.value):o.replace(e,encodeURIComponent(i.value))}}))}this.url=o}if(e.queryParameters){var s=e.queryParameters;if("object"!=typeof s)throw new Error('options.queryParameters must be of type object. It should be a JSON object of "query-parameter-name" as the key and the "query-parameter-value" as the value. The "query-parameter-value" may be fo type "string" or an "object" of the form { value: "query-parameter-value", skipUrlEncoding: true }.');this.url&&-1===this.url.indexOf("?")&&(this.url+="?");var u=[];for(var c in this.query={},s){var l=s[c];if(l)if("string"==typeof l)u.push(c+"="+encodeURIComponent(l)),this.query[c]=encodeURIComponent(l);else if("object"==typeof l){if(!l.value)throw new Error("options.queryParameters["+c+'] is of type "object" but it does not contain a "value" property.');l.skipUrlEncoding?(u.push(c+"="+l.value),this.query[c]=l.value):(u.push(c+"="+encodeURIComponent(l.value)),this.query[c]=encodeURIComponent(l.value))}}this.url+=u.join("&")}if(e.headers)for(var d=e.headers,f=0,h=Object.keys(e.headers);f<h.length;f++){var p=h[f];this.headers.set(p,d[p])}return this.headers.get("accept-language")||this.headers.set("accept-language","en-US"),this.headers.get("x-ms-client-request-id")||e.disableClientRequestId||this.headers.set("x-ms-client-request-id",Object(T.b)()),this.headers.get("Content-Type")||this.headers.set("Content-Type","application/json; charset=utf-8"),this.body=e.body,null!=e.body&&(e.bodyIsStream?(this.headers.get("Transfer-Encoding")||this.headers.set("Transfer-Encoding","chunked"),"application/octet-stream"!==this.headers.get("Content-Type")&&this.headers.set("Content-Type","application/octet-stream")):(e.serializationMapper&&(this.body=new b.b(e.mappers).serialize(e.serializationMapper,e.body,"requestBody")),e.disableJsonStringifyOnBody||(this.body=JSON.stringify(e.body)))),this.abortSignal=e.abortSignal,this.onDownloadProgress=e.onDownloadProgress,this.onUploadProgress=e.onUploadProgress,this.redirectLimit=e.redirectLimit,this.streamResponseBody=e.streamResponseBody,this},e.prototype.clone=function(){var t=new e(this.url,this.method,this.body,this.query,this.headers&&this.headers.clone(),this.streamResponseBody,this.withCredentials,this.abortSignal,this.timeout,this.onUploadProgress,this.onDownloadProgress,this.proxySettings,this.keepAlive,this.agentSettings,this.redirectLimit);return this.formData&&(t.formData=this.formData),this.operationSpec&&(t.operationSpec=this.operationSpec),this.shouldDeserialize&&(t.shouldDeserialize=this.shouldDeserialize),this.operationResponseGetter&&(t.operationResponseGetter=this.operationResponseGetter),t},e}(),ce=new Error("AgentPolicy is not supported in browser environment");!function(e){function t(t,n){e.call(this,t,n);throw ce}Object(r.c)(t,e),t.prototype.sendRequest=function(e){throw ce}}(x.a);var le=new Error("ProxyPolicy is not supported in browser environment");!function(e){function t(t,n){e.call(this,t,n);throw le}Object(r.c)(t,e),t.prototype.sendRequest=function(e){throw le}}(x.a);var de=n(234),fe=de.a.HttpConstants.StatusCodes,he=3;var pe=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.retryLimit=r,i}return Object(r.c)(t,e),t.prototype.sendRequest=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t=this;return Object(r.d)(this,(function(n){return[2,this._nextPolicy.sendRequest(e.clone()).then((function(n){return t.retry(e,n,0)}))]}))}))},t.prototype.retry=function(e,n,i){return Object(r.b)(this,void 0,void 0,(function(){var o,a,s;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n.status!==fe.TooManyRequests?[2,n]:(o=n.headers.get(de.a.HeaderConstants.RETRY_AFTER))&&i<this.retryLimit&&(a=t.parseRetryAfterHeader(o))?[4,Object(T.a)(a)]:[3,3];case 1:return r.sent(),[4,this._nextPolicy.sendRequest(e)];case 2:return s=r.sent(),[2,this.retry(e,s,i+1)];case 3:return[2,n]}}))}))},t.parseRetryAfterHeader=function(e){var n=Number(e);return Number.isNaN(n)?t.parseDateRetryAfterHeader(e):1e3*n},t.parseDateRetryAfterHeader=function(e){try{var t=Date.now(),n=Date.parse(e)-t;return Number.isNaN(n)?void 0:n}catch(e){return}},t}(x.a),ge=["https://management.windows.net","https://management.chinacloudapi.cn","https://management.usgovcloudapi.net","https://management.cloudapi.de"],me=function(){function e(e,t){void 0===t&&(t="https://management.azure.com/.default"),this.azureTokenCredential=e,this.scopes=t}return e.prototype.getToken=function(){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,this.azureTokenCredential.getToken(this.scopes)];case 1:if(null!==(e=t.sent()))return[2,{accessToken:e.token,tokenType:"Bearer",expiresOn:e.expiresOnTimestamp}];throw new Error("Could find token for scope")}}))}))},e.prototype.signRequest=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(n){switch(n.label){case 0:return[4,this.getToken()];case 1:return t=n.sent(),e.headers.set(de.a.HeaderConstants.AUTHORIZATION,t.tokenType+" "+t.accessToken),[2,Promise.resolve(e)]}}))}))},e}(),ye=function(){function e(e,t){var n,i;if(t||(t={}),t.baseUri&&(this.baseUri=t.baseUri),function(e){const t=e;return t&&"function"==typeof t.getToken&&(void 0===t.signRequest||t.getToken.length>0)}(e)){var o=void 0;(null==t?void 0:t.baseUri)&&ge.includes(null==t?void 0:t.baseUri)&&(o=t.baseUri+"/.default"),n=new me(e,o)}else n=e;if(n&&!n.signRequest)throw new Error("credentials argument needs to implement signRequest method");if(this._withCredentials=t.withCredentials||!1,this._httpClient=t.httpClient||new f,this._requestPolicyOptions=new x.b(t.httpPipelineLogger),Array.isArray(t.requestPolicyFactories))i=t.requestPolicyFactories;else if(i=function(e,t){var n=[];t.generateClientRequestIdHeader&&n.push((void 0===(i=t.clientRequestIdHeaderName)&&(i="x-ms-client-request-id"),{create:function(e,t){return new U(e,t,i)}}));var i;e&&("function"==typeof e.create?n.push(e):n.push((o=e,{create:function(e,t){return new ie(e,t,o)}})));var o;var a=be(t.userAgentHeaderName,q.a),s=be(t.userAgent,q.b);a&&s&&n.push(Object(q.c)({key:a,value:s}));var u=Object(r.a)(Object(r.a)({},X),t.redirectOptions);u.handleRedirects&&n.push((void 0===(c=u.maxRetries)&&(c=20),{create:function(e,t){return new Z(e,t,c)}}));var c;n.push(function(e){return void 0===e&&(e=30),{create:function(t,n){return new te(t,n,e)}}}(t.rpRegistrationRetryTimeout)),t.noRetryPolicy||(n.push({create:function(e,t){return new B(e,t,d,f,h,p)}}),n.push(function(e,t,n,r){return{create:function(i,o){return new oe(i,o,e,t,n,r)}}}()),n.push((void 0===l&&(l=he),{create:function(e,t){return new pe(e,t,l)}})));var l;var d,f,h,p;n.push((g=t.deserializationContentTypes,{create:function(e,t){return new L(e,g,t)}}));var g;var m=t.proxySettings||void 0;m&&n.push({create:function(e,t){throw le}});t.agentSettings&&n.push((t.agentSettings,{create:function(e,t){throw ce}}));return n}(n,t),t.requestPolicyFactories){var a=t.requestPolicyFactories(i);a&&(i=a)}this._requestPolicyFactories=i}return e.prototype.sendRequest=function(e){if(null==e||"object"!=typeof e)throw new Error("options cannot be null or undefined and it must be of type object.");var t,n;try{"object"==typeof(n=e)&&"string"==typeof n.url&&"string"==typeof n.method&&"object"==typeof n.headers&&Object(l.b)(n.headers)&&"function"==typeof n.validateRequestProperties&&"function"==typeof n.prepare&&"function"==typeof n.clone?(e.validateRequestProperties(),t=e):t=(t=new ue).prepare(e)}catch(e){return Promise.reject(e)}var r=this._httpClient;if(this._requestPolicyFactories&&this._requestPolicyFactories.length>0)for(var i=this._requestPolicyFactories.length-1;i>=0;--i)r=this._requestPolicyFactories[i].create(r,this._requestPolicyOptions);return r.sendRequest(t)},e.prototype.sendOperationRequest=function(e,t,n){"function"==typeof e.options&&(n=e.options,e.options=void 0);var i,o=new ue;try{var a=t.baseUrl||this.baseUri;if(!a)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a baseUri string property that contains the base URL to use.");o.method=t.httpMethod,o.operationSpec=t;var s=W.parse(a);if(t.path&&s.appendPath(t.path),t.urlParameters&&t.urlParameters.length>0)for(var u=0,c=t.urlParameters;u<c.length;u++){var l=c[u],d=ve(this,e,l,t.serializer);d=t.serializer.serialize(l.mapper,d,m(l)),l.skipEncoding||(d=encodeURIComponent(d)),s.replaceAll("{"+(l.mapper.serializedName||m(l))+"}",d)}if(t.queryParameters&&t.queryParameters.length>0)for(var f=0,h=t.queryParameters;f<h.length;f++){var p=h[f],g=ve(this,e,p,t.serializer);if(null!=g){if(g=t.serializer.serialize(p.mapper,g,m(p)),null!=p.collectionFormat)if(p.collectionFormat===se.a.Multi)if(0===g.length)g="";else for(var y in g){var w=g[y];g[y]=null==w?"":w.toString()}else p.collectionFormat!==se.a.Ssv&&p.collectionFormat!==se.a.Tsv||(g=g.join(p.collectionFormat));if(!p.skipEncoding)if(Array.isArray(g))for(var y in g)void 0!==g[y]&&null!==g[y]&&(g[y]=encodeURIComponent(g[y]));else g=encodeURIComponent(g);null!=p.collectionFormat&&p.collectionFormat!==se.a.Multi&&p.collectionFormat!==se.a.Ssv&&p.collectionFormat!==se.a.Tsv&&(g=g.join(p.collectionFormat)),s.setQueryParameter(p.mapper.serializedName||m(p),g)}}o.url=s.toString();var S=t.contentType||this.requestContentType;if(S&&o.headers.set("Content-Type",S),t.headerParameters)for(var _=0,O=t.headerParameters;_<O.length;_++){var C=O[_],E=ve(this,e,C,t.serializer);if(null!=E){E=t.serializer.serialize(C.mapper,E,m(C));var I=C.mapper.headerCollectionPrefix;if(I)for(var k=0,A=Object.keys(E);k<A.length;k++){var P=A[k];o.headers.set(I+P,E[P])}else o.headers.set(C.mapper.serializedName||m(C),E)}}var j=e.options;if(j){if(j.customHeaders)for(var R in j.customHeaders)o.headers.set(R,j.customHeaders[R]);j.abortSignal&&(o.abortSignal=j.abortSignal),j.timeout&&(o.timeout=j.timeout),j.onUploadProgress&&(o.onUploadProgress=j.onUploadProgress),j.onDownloadProgress&&(o.onDownloadProgress=j.onDownloadProgress)}o.withCredentials=this._withCredentials,function(e,t,n,r){if(r.requestBody&&r.requestBody.mapper){t.body=ve(e,n,r.requestBody,r.serializer);var i=r.requestBody.mapper,o=i.required,a=i.xmlName,s=i.xmlElementName,u=i.serializedName,c=i.type.name;try{if(null!=t.body||o){var l=m(r.requestBody);t.body=r.serializer.serialize(i,t.body,l);var d=c===b.a.Stream;r.isXML?c===b.a.Sequence?t.body=N(T.f(t.body,s||a||u),{rootName:a||u}):d||(t.body=N(t.body,{rootName:a||u})):d||(t.body=JSON.stringify(t.body))}}catch(e){throw new Error('Error "'+e.message+'" occurred in serializing the payload - '+JSON.stringify(u,void 0,"  ")+".")}}else if(r.formDataParameters&&r.formDataParameters.length>0){t.formData={};for(var f=0,h=r.formDataParameters;f<h.length;f++){var p=h[f],g=ve(e,n,p,r.serializer);if(null!=g){var y=p.mapper.serializedName||m(p);t.formData[y]=r.serializer.serialize(p.mapper,g,m(p))}}}}(this,o,e,t),null==o.streamResponseBody&&(o.streamResponseBody=v(t)),i=this.sendRequest(o).then((function(e){return function(e,t){var n=e.parsedHeaders,i=t&&t.bodyMapper,o=function(t){return Object.defineProperty(t,"_response",{value:e})};if(i){var a=i.type.name;if("Stream"===a)return o(Object(r.a)(Object(r.a)({},n),{blobBody:e.blobBody,readableStreamBody:e.readableStreamBody}));var s="Composite"===a&&i.type.modelProperties||{},u=Object.keys(s).some((function(e){return""===s[e].serializedName}));if("Sequence"===a||u){for(var c=Array.isArray(e.parsedBody)?e.parsedBody:[],l=Object(r.e)(c),d=0,f=Object.keys(s);d<f.length;d++){var h=f[d];s[h].serializedName&&(l[h]=e.parsedBody[h])}if(n)for(var p=0,g=Object.keys(n);p<g.length;p++){l[h=g[p]]=n[h]}return o(l),l}if("Composite"===a||"Dictionary"===a)return o(Object(r.a)(Object(r.a)({},n),e.parsedBody))}if(i||"HEAD"===e.request.method||T.d(e.parsedBody))return o(Object(r.a)(Object(r.a)({},n),{body:e.parsedBody}));return o(Object(r.a)(Object(r.a)({},n),e.parsedBody))}(e,t.responses[e.status])}))}catch(e){i=Promise.reject(e)}var x=n;return x&&i.then((function(e){return x(null,e._response.parsedBody,e._response.request,e._response)})).catch((function(e){return x(e)})),i},e}();function be(e,t){var n;return"string"==typeof e?n=e:(n=t(),"function"==typeof e&&(n=e(n))),n}function ve(e,t,n,r){return we(e,t,n.parameterPath,n.mapper,r)}function we(e,t,n,r,i){var o;if("string"==typeof n&&(n=[n]),Array.isArray(n)){if(n.length>0){if(r.isConstant)o=r.defaultValue;else{var a=Se(t,n);a.propertyFound||(a=Se(e,n));var s=!1;a.propertyFound||(s=r.required||"options"===n[0]&&2===n.length),o=s?r.defaultValue:a.propertyValue}var u=y(n,r);i.serialize(r,o,u)}}else for(var c in r.required&&(o={}),n){var l=r.type.modelProperties[c],d=n[c],f=we(e,t,d,l,i),h=y(d,l);i.serialize(l,f,h),void 0!==f&&(o||(o={}),o[c]=f)}return o}function Se(e,t){for(var n={propertyFound:!1},r=0;r<t.length;++r){var i=t[r];if(null==e||!(i in e))break;e=e[i]}return r===t.length&&(n.propertyValue=e,n.propertyFound=!0),n}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return y})),n.d(t,"c",(function(){return T})),n.d(t,"b",(function(){return j}));var r=n(471),i=n(796);const o=void 0!==e&&e.env?e.env.SERVICE_NAME:"client",a="abcdefghijklmnopqrstuvwxyz0123456789",s={97:0,98:1,99:2,100:3,101:4,102:5,103:6,104:7,105:8,106:9,107:10,108:11,109:12,110:13,111:14,112:15,113:16,114:17,115:18,116:19,117:20,118:21,119:22,120:23,121:24,122:25,48:26,49:27,50:28,51:29,52:30,53:31,54:32,55:33,56:34,57:35};let u,c=[],l=[],d=e=>null,f=e=>{};const h=new Map,p=new Map,g=new Map,m=new Map;var y;!function(e){e.defineCoreLogCategory=e=>({root:"Core",name:e}),e.defineWorkflowLogCategory=e=>({root:"Workflow",name:e}),e.clearLoggers=()=>{c=[],l=[],p.clear(),g.clear()},e.clearAggregators=()=>{h.clear()},e.addLogger=e=>{-1===c.indexOf(e)&&(c.push(e),b(p,e))},e.addDecidingLogger=e=>{-1===l.indexOf(e)&&(l.push(e),b(g,e))},e.setCorrelationContextCallback=e=>{u=e},e.setStartPerformanceEventCallback=e=>{d=e},e.setStopPerformanceEventCallback=e=>{f=e},e.addAggregator=e=>{e.init(((e,t)=>{I(e,t)})),h.has(e.eventName)?h.get(e.eventName).push(e):h.set(e.eventName,[e])},e.flushAggregators=e=>{h.forEach((t=>{t.forEach((t=>t.flush(e)))}))},e.setTagLevelOverride=(e,t)=>{const n=N(e);m.set(n,t)},e.resetTagLevelOverrides=()=>{m.clear()},e.error=(e,t,n,i,o,a,s,u,c,l)=>{E(e,t,r.a.error,n,i,o,a,s,u,c,l)},e.warn=(e,t,n,i,o,a,s,u,c,l)=>{E(e,t,r.a.warn,n,i,o,a,s,u,c,l)},e.info=(e,t,n,i,o,a,s,u,c,l)=>{E(e,t,r.a.info,n,i,o,a,s,u,c,l)},e.verbose=(e,t,n,i,o,a,s,u,c,l)=>{E(e,t,r.a.verbose,n,i,o,a,s,u,c,l)},e.debug=(e,t,n,i,o,a,s,u,c,l)=>{E(e,t,r.a.debug,n,i,o,a,s,u,c,l)},e.metric=(e,t,n,i,o,a,s,u,c,l)=>{E(e,t,r.a.metric,n,i,o,a,s,u,c,l)},e.formatMetric=(e,t,n,r)=>{const i={};return i[e]={dimensionNames:n,dimensionValues:r,value:t},i},e.dynamic=e=>{I(e)}}(y||(y={}));const b=(e,t)=>{const n=t.level;Object.keys(r.a).map((e=>r.a[e])).filter((e=>"string"!=typeof e)).filter((e=>e<=n)).forEach((n=>{e.has(n)?e.get(n).push(t):e.set(n,[t])}))},v=e=>{if("string"==typeof e)return e;let t="";for(let n=0;n<e.length;n++){n>0&&(t+=" ");const r=e[n];r instanceof Error?t+=JSON.stringify({message:r.message,name:r.name,stack:r.stack}):t+="object"==typeof r?JSON.stringify(r):r}return t},w=[],S=["Level","Tag"],_=["Level","Tag","Workflow"],T=e=>O(e).length,O=e=>void 0!==e?p.get(e)||w:c,C=(e,t)=>(void 0!==e?g.get(e)||[]:l).filter((e=>e.shouldLog(t))),E=(e,t,n,r,o,a,s,c,l,p,g)=>{n=m.get(e)||n;const y=O(n),b=C(n,r);if(0==y.length&&0==b.length)return;const w=d(i.a.Log),T=P(e),E=((e,t,n,r,i,o,a,s)=>{if(void 0===t&&("string"==typeof e||"object"==typeof e))return e;if(void 0===t&&"function"==typeof e)return e();const u=[];for(const c of[e,t,n,r,i,o,a,s])void 0!==c&&u.push("function"==typeof c?c():c);return u})(r,o,a,s,c,l,p,g);if(k(t))A(E)&&I({eventName:"Metrics",tagId:T,category:`${t.root}.${t.name}`,traceLevel:n,message:"",getMetrics:()=>E},!1,y,b);else if(A(E)){const e=E;e.tagId=T,e.category=`${t.root}.${t.name}`,"Operation"===e.eventName&&"Workflow"===t.root&&(e.eventName="WorkflowOperation",u&&(e.joinContextId=u().joinContextId,e.workflow=u().workflow)),e.traceLevel=n;const r=h.get(e.eventName);if(r)for(let t=0;t<r.length;++t){const n=r[t];if(n&&n.add(e,t===r.length-1))break}else I(e,!1,y,b)}else{const e=()=>{var e;return"Core"===t.root?{TraceEventV2:{dimensionNames:()=>S,dimensionValues:[String(n),T],value:1}}:{WorkflowTraceEvent:{dimensionNames:()=>_,dimensionValues:[String(n),T,u?null===(e=u())||void 0===e?void 0:e.workflow:""],value:1}}};I({eventName:"Log",tagId:T,category:`${t.root}.${t.name}`,traceLevel:n,message:v(E),getMetrics:e},!1,y,b)}f(w)},I=(e,t=!1,n,r)=>{var i,a,s,c,l,d,f,h,p,g,m,y;if(null==n&&(n=O(e.traceLevel)),r=r||w,n.length>0||r.length>0){if(e.serviceName=o,!t&&u){const t=u();t&&(e.cv=e.cv?e.cv:t.cv.toString(),e.sessionKey=e.sessionKey?e.sessionKey:t.sessionKey,e.workflow=e.workflow?e.workflow:t.workflow,e.clientAppName=e.clientAppName?e.clientAppName:null===(i=t.clientMetadata)||void 0===i?void 0:i.appName,e.clientAppPlatform=e.clientAppPlatform?e.clientAppPlatform:null===(a=t.clientMetadata)||void 0===a?void 0:a.appPlatform,e.clientAppVersion=e.clientAppVersion?e.clientAppVersion:null===(s=t.clientMetadata)||void 0===s?void 0:s.appVersion,e.clientDeviceId=e.clientDeviceId?e.clientDeviceId:null===(c=t.clientMetadata)||void 0===c?void 0:c.deviceId,e.clientDocSessionId=e.clientDocSessionId?e.clientDocSessionId:null===(l=t.clientMetadata)||void 0===l?void 0:l.docSessionId,e.clientReleaseAudienceGroup=e.clientReleaseAudienceGroup?e.clientReleaseAudienceGroup:null===(d=t.clientMetadata)||void 0===d?void 0:d.releaseAudienceGroup,e.clientReleaseChannel=e.clientReleaseChannel?e.clientReleaseChannel:null===(f=t.clientMetadata)||void 0===f?void 0:f.releaseChannel,e.clientReleaseFork=e.clientReleaseFork?e.clientReleaseFork:null===(h=t.clientMetadata)||void 0===h?void 0:h.releaseFork,e.clientRuntimeVersion=e.clientRuntimeVersion?e.clientRuntimeVersion:null===(p=t.clientMetadata)||void 0===p?void 0:p.runtimeVersion,e.clientSessionId=e.clientSessionId?e.clientSessionId:null===(g=t.clientMetadata)||void 0===g?void 0:g.sessionId,e.clientUserAgent=e.clientUserAgent?e.clientUserAgent:null===(m=t.clientMetadata)||void 0===m?void 0:m.userAgent,e.traceId=e.traceId||t.traceId,e.isClientTelemetrySampled=e.isClientTelemetrySampled?e.isClientTelemetrySampled:null===(y=t.clientMetadata)||void 0===y?void 0:y.isClientTelemetrySampled)}for(const t of n)t.log(e);for(const t of r)t.log(e)}},k=e=>e.name===j.WorkflowMetricsOnly.name&&e.root===j.WorkflowMetricsOnly.root,A=e=>!Array.isArray(e)&&"object"==typeof e,P=e=>a[e>>24&63]+a[e>>18&63]+a[e>>12&63]+a[e>>6&63]+a[63&e],N=e=>e&&5===e.length?s[e.charCodeAt(0)]<<24|s[e.charCodeAt(1)]<<18|s[e.charCodeAt(2)]<<12|s[e.charCodeAt(3)]<<6|s[e.charCodeAt(4)]:-1;class j{}j.CoreDefault=y.defineCoreLogCategory("Default"),j.CoreSystem=y.defineCoreLogCategory("System"),j.CoreUnsampled=y.defineCoreLogCategory("Unsampled"),j.WorkflowDefault=y.defineWorkflowLogCategory("Default"),j.WorkflowUnsampled=y.defineWorkflowLogCategory("Unsampled"),j.WorkflowMetricsOnly=y.defineWorkflowLogCategory("MetricsOnly"),j.PrivacyGuardEvent=y.defineCoreLogCategory("PrivacyGuardEvent")}).call(this,n(123))},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));var r=n(739);class i{static deserialize(t,n=e=>e){if(t[0]!==i.IDENTIFIERBYTE)throw new Error("Invalid Binary: Incorrect Identifier");let r=1;const o=[],a=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;r<t.byteLength;){if(r+4>t.byteLength)throw new Error("Invalid Binary: Error reading fragment length");const n=a.getUint32(r);if(r+n+4>t.byteLength)throw new Error("Invalid Binary: Fragment out of range");void 0!==e&&e.from?o.push(e.from(t.buffer,t.byteOffset+r+4,n)):o.push(new Uint8Array(t.buffer,t.byteOffset+r+4,n)),r+=4+n}if(o.length<1)throw new Error("Invalid Binary: No fragments found");const s=i.textDecoder.decode(o[0]);return JSON.parse(s,((e,t)=>{if("string"==typeof t){if(t.substring(0,i.BINARYKEYWORD.length)===i.BINARYKEYWORD){const e=parseInt(t.substring(i.BINARYKEYWORD.length),10);if("number"!=typeof e||e>=o.length-1)throw new Error("Invalid Binary: Binary index out of range");return n(o[e+1])}if(t.substring(0,i.ESCAPEKEYWORD.length)===i.ESCAPEKEYWORD)return t.substring(i.ESCAPEKEYWORD.length)}return t}))}static serialize(e){const t=[void 0],n=JSON.stringify(e,((e,n)=>ArrayBuffer.isView(n)?(t.push(n),`${i.BINARYKEYWORD}${t.length-2}`):n&&"Buffer"===n.type&&Array.isArray(n.data)?(t.push(new Uint8Array(n.data)),`${i.BINARYKEYWORD}${t.length-2}`):"string"==typeof n&&n.substring(0,i.ESCAPEKEYWORD.length)===i.ESCAPEKEYWORD?i.ESCAPEKEYWORD+n:n));t[0]=i.textEncoder.encode(n);const r=t.reduce(((e,t)=>e+4+t.byteLength),0),o=new Uint8Array(r+1);o[0]=i.IDENTIFIERBYTE;let a=1;const s=new DataView(o.buffer,o.byteOffset,o.byteLength);for(const e of t)s.setUint32(a,e.byteLength),o.set(e,a+4),a+=4+e.byteLength;return o}}i.IDENTIFIERBYTE=3,i.BINARYKEYWORD=":b",i.ESCAPEKEYWORD=":",i.textDecoder=new r.a,i.textEncoder=new r.b}).call(this,n(530).Buffer)}]);
//# sourceMappingURL=background.js.map