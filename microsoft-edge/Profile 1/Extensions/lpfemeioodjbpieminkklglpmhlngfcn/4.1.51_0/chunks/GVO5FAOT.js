import{c as Qs}from"./RCVOV644.js";import{a as le}from"./WZHIWEFG.js";import{A as re,B as yt,C as xs,E as Ln,F as pe,G as Ie,H as qe,J as ze,K as wt,V as ys,a as Os,b as kt,c as Ss,d as Ge,e as Rs,f as Ls,g as se,h as Ds,i as g,j as Ke,k as bs,l as Ut,m as j,n as H,o as Ft,p as Ps,q as Ms,r as Bs,s as Xe,t as ks,u as Ve,v as Us,w as xt,x as Ht,y as je,z as Fs}from"./OUY2RNSM.js";import{a as $e}from"./AN2KFIQS.js";import{a as Mn}from"./QWBKX6D7.js";import{a as Vs}from"./IV4N77D2.js";import{a as Gs,b as Ks}from"./7JNQ4PLR.js";import{a as Ze}from"./5KJWNJZX.js";import{a as Xs}from"./AO2JA6SJ.js";import{ba as Pn,f as Ws}from"./HO3OOGBX.js";import{i as Je,p as ws,q as Dn,s as vs,t as Ys,u as bn,x as ce}from"./HSWGCWRI.js";import{a as Hs}from"./MRYPIC4L.js";import{a as Rn}from"./BXPPDSGN.js";import{a as gs}from"./H3JIZ2LT.js";import{a as Cs,d as Ns}from"./RH65ACLS.js";import{c as Qe,d as K,f as oe,i as Bt}from"./3PS7M655.js";var js=Qe(et=>{"use strict";var Bn=Je();Object.defineProperty(et,"__esModule",{value:!0});et.default=void 0;var kn=Bn(Ze()),Un=ce(),Fn=(0,kn.default)((0,Un.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");et.default=Fn});var Vn=Qe(st=>{"use strict";var Qn=Je();Object.defineProperty(st,"__esModule",{value:!0});st.default=void 0;var Gn=Qn(Ze()),Kn=ce(),Xn=(0,Gn.default)((0,Kn.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"}),"CloseOutlined");st.default=Xn});var Jn=Qe(rt=>{"use strict";var jn=Je();Object.defineProperty(rt,"__esModule",{value:!0});rt.default=void 0;var qn=jn(Ze()),zn=ce(),$n=(0,qn.default)((0,zn.jsx)("path",{d:"M16 8v8H8V8h8m2-2H6v12h12V6z"}),"StopOutlined");rt.default=$n});var qc=Qe(Pt=>{"use strict";var Kc=Je();Object.defineProperty(Pt,"__esModule",{value:!0});Pt.default=void 0;var Xc=Kc(Ze()),Vc=ce(),jc=(0,Xc.default)((0,Vc.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"SearchOutlined");Pt.default=jc});Dn();bn();var qs=oe(Rn()),zs=oe(Mn()),$s=oe(js());var Q=oe(ce()),Js="webchatgpt-snackbar",Zs="webchatgpt-snackbar-container",X,xn=()=>(X=Ks(),null),ll=()=>X,El=()=>{X&&X.closeSnackbar&&X.closeSnackbar()},hl=()=>{var e,t;return(t=(e=document.getElementById(Js))==null?void 0:e.shadowRoot)==null?void 0:t.getElementById(Zs)},Hn=()=>{let{customTheme:e}=Vs({colorSchema:"dark"});return(0,Q.jsx)(Ys,{theme:e,children:(0,Q.jsx)(Gs,{maxSnack:3,preventDuplicate:!0,hideIconVariant:!0,autoHideDuration:3e3,anchorOrigin:{vertical:"bottom",horizontal:"right"},action:t=>(0,Q.jsx)(Ws,{onClick:()=>{X&&X.closeSnackbar&&X.closeSnackbar(t)},children:(0,Q.jsx)($s.default,{fontSize:"inherit",sx:{color:"white"}})}),children:(0,Q.jsx)(xn,{})})})},Tl=()=>{let{container:e,shadowRoot:t,emotionRoot:s}=Qs({containerId:Zs,shadowRootId:Js,presetContainerElement(a){a.style.color="#fff"}});e.style.zIndex=`${Cs.TOAST}`,document.body.appendChild(t);let n=ws({key:"webchatgpt-snackbar-emotion-cache",prepend:!0,container:s});(0,zs.createRoot)(e).render((0,Q.jsx)(qs.default.StrictMode,{children:(0,Q.jsx)(Xs,{children:(0,Q.jsx)(vs,{value:n,children:(0,Q.jsx)(Hn,{})})})}))},tt=(e,t={})=>{X.enqueueSnackbar(e,t)},yn=(e,t={})=>{tt(e,{...t,variant:"success"})},wn=(e,t={})=>{tt(e,{...t,variant:"warning"})},vn=(e,t={})=>{tt(e,{...t,variant:"info"})},Yn=(e,t={})=>{tt(e,{...t,variant:"error"})},Wn={success:yn,warning:wn,info:vn,error:Yn},ul=Wn;var ne=new Hs("ArkoseIframeGenerator"),at=class{constructor(){Bt(this,"iframeInstance",null)}async injectIframe(t){if(await this.ping(t))return!0;for(let n=0;n<1;n++){if(await $e(this.injectIframeOnce(),1e4,!1))return ne.info("inject iframe success"),!0;ne.info("inject iframe fail","retry times",n+1),this.removeIframe()}return ne.info("inject iframe fail"),!1}async generateToken(t,s){if(Ns||!await this.injectIframe(t))return"";let n=await $e(this.postMessageGenerateToken(t,s),10*1e3,"");return n||this.removeIframe(),ne.info(`generateToken ${n?"success":"fail"}`,n),n}getRootContainer(){return document.body}async ping(t){return ne.info("ping"),this.iframeInstance?await $e(new Promise(n=>{var c,E;let a=T=>{if(T.data&&T.data.id===le){let{data:d,type:A}=T.data;A==="pong"&&(ne.info("ping result",(d==null?void 0:d.success)===!0),n((d==null?void 0:d.success)===!0),window.removeEventListener("message",a))}};window.addEventListener("message",a),(E=(c=this.iframeInstance)==null?void 0:c.contentWindow)==null||E.postMessage({id:le,type:"ping",data:{model:t}},"*")}),2e3,!1)?!0:(this.removeIframe(),!1):(ne.info("ping result",!1),!1)}injectIframeOnce(){return new Promise(t=>{var a;let s=c=>{if(c.data&&c.data.id===le){let{data:E,type:T}=c.data;T==="inject_iframe_response"&&(t((E==null?void 0:E.success)===!0),window.removeEventListener("message",s))}};window.addEventListener("message",s);let n=document.createElement("iframe");n.id=at.iframeId,n.src="https://chatgpt.com/favicon.ico",n.style.cssText=`
      position: absolute !important;
      opacity: 0 !important;
      width: 1px !important;
      height: 1px !important;
      top: 0 !important;
      left: 0 !important;
      border: none !important;
      display: block !important;
      z-index: -1 !important;
      pointer-events: none;`,this.iframeInstance=n,(a=this.getRootContainer())==null||a.append(n)})}removeIframe(){var s;let t=(s=this.getRootContainer())==null?void 0:s.querySelector(`#${at.iframeId}`);t&&(this.iframeInstance=null,t.remove())}async postMessageGenerateToken(t,s){return new Promise(n=>{var c,E;let a=T=>{if(T.data&&T.data.id===le){let{data:d,type:A}=T.data;A==="get_token_response"&&(n((d==null?void 0:d.token)||""),window.removeEventListener("message",a))}};window.addEventListener("message",a),(E=(c=this.iframeInstance)==null?void 0:c.contentWindow)==null||E.postMessage({id:le,type:"get_token",data:{model:t,dx:s}},"*")})}},nt=at;Bt(nt,"iframeId","webchatgpt-arkose-token-generate-iframe");var Ol=new nt;var bl=e=>e!=null&&e.includes?e&&e.includes("524")?"Network error: 524":e&&e.includes("502")?"Network error: 502":e:e,er=e=>{try{let s=new URL(e).pathname.split(".").pop()||"";return!!["doc","xls","ppt","pdf","zip","rar","apk"].includes(s)}catch(t){return!1}},Pl=async(e,t,s)=>{var n,a,c,E;try{let d=await new gs().postMessage({event:"Client_proxyFetchAPI",data:{url:e,options:t,abortTaskId:s}});return(t==null?void 0:t.parse)==="blob"&&((a=(n=d==null?void 0:d.data)==null?void 0:n.data)!=null&&a.base64)&&(d.data.data=ys(d.data.data.base64,(t==null?void 0:t.blobContentType)||d.data.data.contentType)),{success:d.success,data:(c=d==null?void 0:d.data)==null?void 0:c.data,responseRaw:(E=d==null?void 0:d.data)==null?void 0:E.response,message:d.message,error:""}}catch(T){return{success:!1,data:null,error:(T==null?void 0:T.message)||T,responseRaw:null,message:""}}};var Zn={xml:!1,decodeEntities:!0},Ce=Zn,tr={_useHtmlParser2:!0,xmlMode:!0};function Ne(e){return e!=null&&e.xml?typeof e.xml=="boolean"?tr:{...tr,...e.xml}:e!=null?e:void 0}var z={};K(z,{contains:()=>vt,html:()=>nr,merge:()=>ra,parseHTML:()=>ta,root:()=>sa,text:()=>q,xml:()=>ar});function rr(e,t,s){return e?e(t!=null?t:e._root.children,null,void 0,s).toString():""}function ea(e,t){return!t&&typeof e=="object"&&e!=null&&!("length"in e)&&!("type"in e)}function nr(e,t){let s=ea(e)?(t=e,void 0):e,n={...Ce,...this===null||this===void 0?void 0:this._options,...Ne(t!=null?t:{})};return rr(this,s,n)}function ar(e){let t={...this._options,xmlMode:!0};return rr(this,e,t)}function q(e){let t=e||(this?this.root():[]),s="";for(let n=0;n<t.length;n++)s+=Xe(t[n]);return s}function ta(e,t,s=typeof t=="boolean"?t:!1){if(!e||typeof e!="string")return null;typeof t=="boolean"&&(s=t);let n=this.load(e,Ce,!1);return s||n("script").remove(),n.root()[0].children.slice()}function sa(){return this(this._root)}function vt(e,t){if(t===e)return!1;let s=t;for(;s&&s!==s.parent;)if(s=s.parent,s===e)return!0;return!1}function ra(e,t){if(!sr(e)||!sr(t))return;let s=e.length,n=+t.length;for(let a=0;a<n;a++)e[s++]=t[a];return e.length=s,e}function sr(e){if(Array.isArray(e))return!0;if(typeof e!="object"||!Object.prototype.hasOwnProperty.call(e,"length")||typeof e.length!="number"||e.length<0)return!1;for(let t=0;t<e.length;t++)if(!(t in e))return!1;return!0}var Gt={};K(Gt,{addClass:()=>ur,attr:()=>aa,data:()=>oa,hasClass:()=>Ea,prop:()=>ia,removeAttr:()=>la,removeClass:()=>dr,toggleClass:()=>mr,val:()=>ca});function F(e){return e.cheerio!=null}function ir(e){return e.replace(/[_.-](\w|$)/g,(t,s)=>s.toUpperCase())}function or(e){return e.replace(/[A-Z]/g,"-$&").toLowerCase()}function R(e,t){let s=e.length;for(let n=0;n<s;n++)t(e[n],n);return e}function it(e){let t="length"in e?Array.prototype.map.call(e,n=>Ft(n,!0)):[Ft(e,!0)],s=new se(t);return t.forEach(n=>{n.parent=s}),t}var ae;(function(e){e[e.LowerA=97]="LowerA",e[e.LowerZ=122]="LowerZ",e[e.UpperA=65]="UpperA",e[e.UpperZ=90]="UpperZ",e[e.Exclamation=33]="Exclamation"})(ae||(ae={}));function ge(e){let t=e.indexOf("<");if(t<0||t>e.length-3)return!1;let s=e.charCodeAt(t+1);return(s>=ae.LowerA&&s<=ae.LowerZ||s>=ae.UpperA&&s<=ae.UpperZ||s===ae.Exclamation)&&e.includes(">",t+2)}var Ee=Object.prototype.hasOwnProperty,Oe=/\s+/,Yt="data-",cr={null:null,true:!0,false:!1},Qt=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,na=/^{[^]*}$|^\[[^]*]$/;function ot(e,t,s){var n;if(!(!e||!g(e))){if((n=e.attribs)!==null&&n!==void 0||(e.attribs={}),!t)return e.attribs;if(Ee.call(e.attribs,t))return!s&&Qt.test(t)?t:e.attribs[t];if(e.name==="option"&&t==="value")return q(e.children);if(e.name==="input"&&(e.attribs.type==="radio"||e.attribs.type==="checkbox")&&t==="value")return"on"}}function he(e,t,s){s===null?Tr(e,t):e.attribs[t]=`${s}`}function aa(e,t){if(typeof e=="object"||t!==void 0){if(typeof t=="function"){if(typeof e!="string")throw new Error("Bad combination of arguments.");return R(this,(s,n)=>{g(s)&&he(s,e,t.call(s,n,s.attribs[e]))})}return R(this,s=>{g(s)&&(typeof e=="object"?Object.keys(e).forEach(n=>{let a=e[n];he(s,n,a)}):he(s,e,t))})}return arguments.length>1?this:ot(this[0],e,this.options.xmlMode)}function lr(e,t,s){return t in e?e[t]:!s&&Qt.test(t)?ot(e,t,!1)!==void 0:ot(e,t,s)}function Wt(e,t,s,n){t in e?e[t]=s:he(e,t,!n&&Qt.test(t)?s?"":null:`${s}`)}function ia(e,t){var s;if(typeof e=="string"&&t===void 0){let n=this[0];if(!n||!g(n))return;switch(e){case"style":{let a=this.css(),c=Object.keys(a);return c.forEach((E,T)=>{a[T]=E}),a.length=c.length,a}case"tagName":case"nodeName":return n.name.toUpperCase();case"href":case"src":{let a=(s=n.attribs)===null||s===void 0?void 0:s[e];return typeof URL!="undefined"&&(e==="href"&&(n.tagName==="a"||n.name==="link")||e==="src"&&(n.tagName==="img"||n.tagName==="iframe"||n.tagName==="audio"||n.tagName==="video"||n.tagName==="source"))&&a!==void 0&&this.options.baseURI?new URL(a,this.options.baseURI).href:a}case"innerText":return ks(n);case"textContent":return Xe(n);case"outerHTML":return this.clone().wrap("<container />").parent().html();case"innerHTML":return this.html();default:return lr(n,e,this.options.xmlMode)}}if(typeof e=="object"||t!==void 0){if(typeof t=="function"){if(typeof e=="object")throw new Error("Bad combination of arguments.");return R(this,(n,a)=>{g(n)&&Wt(n,e,t.call(n,a,lr(n,e,this.options.xmlMode)),this.options.xmlMode)})}return R(this,n=>{g(n)&&(typeof e=="object"?Object.keys(e).forEach(a=>{let c=e[a];Wt(n,a,c,this.options.xmlMode)}):Wt(n,e,t,this.options.xmlMode))})}}function Er(e,t,s){var n;let a=e;(n=a.data)!==null&&n!==void 0||(a.data={}),typeof t=="object"?Object.assign(a.data,t):typeof t=="string"&&s!==void 0&&(a.data[t]=s)}function hr(e,t){let s,n,a;t==null?(s=Object.keys(e.attribs).filter(c=>c.startsWith(Yt)),n=s.map(c=>ir(c.slice(Yt.length)))):(s=[Yt+or(t)],n=[t]);for(let c=0;c<s.length;++c){let E=s[c],T=n[c];if(Ee.call(e.attribs,E)&&!Ee.call(e.data,T)){if(a=e.attribs[E],Ee.call(cr,a))a=cr[a];else if(a===String(Number(a)))a=Number(a);else if(na.test(a))try{a=JSON.parse(a)}catch(d){}e.data[T]=a}}return t==null?e.data:a}function oa(e,t){var s;let n=this[0];if(!n||!g(n))return;let a=n;return(s=a.data)!==null&&s!==void 0||(a.data={}),e?typeof e=="object"||t!==void 0?(R(this,c=>{g(c)&&(typeof e=="object"?Er(c,e):Er(c,e,t))}),this):Ee.call(a.data,e)?a.data[e]:hr(a,e):hr(a)}function ca(e){let t=arguments.length===0,s=this[0];if(!s||!g(s))return t?void 0:this;switch(s.name){case"textarea":return this.text(e);case"select":{let n=this.find("option:selected");if(!t){if(this.attr("multiple")==null&&typeof e=="object")return this;this.find("option").removeAttr("selected");let a=typeof e!="object"?[e]:e;for(let c=0;c<a.length;c++)this.find(`option[value="${a[c]}"]`).attr("selected","");return this}return this.attr("multiple")?n.toArray().map(a=>q(a.children)):n.attr("value")}case"input":case"option":return t?this.attr("value"):this.attr("value",e)}}function Tr(e,t){!e.attribs||!Ee.call(e.attribs,t)||delete e.attribs[t]}function ct(e){return e?e.trim().split(Oe):[]}function la(e){let t=ct(e);for(let s=0;s<t.length;s++)R(this,n=>{g(n)&&Tr(n,t[s])});return this}function Ea(e){return this.toArray().some(t=>{let s=g(t)&&t.attribs.class,n=-1;if(s&&e.length)for(;(n=s.indexOf(e,n+1))>-1;){let a=n+e.length;if((n===0||Oe.test(s[n-1]))&&(a===s.length||Oe.test(s[a])))return!0}return!1})}function ur(e){if(typeof e=="function")return R(this,(n,a)=>{if(g(n)){let c=n.attribs.class||"";ur.call([n],e.call(n,a,c))}});if(!e||typeof e!="string")return this;let t=e.split(Oe),s=this.length;for(let n=0;n<s;n++){let a=this[n];if(!g(a))continue;let c=ot(a,"class",!1);if(!c)he(a,"class",t.join(" ").trim());else{let E=` ${c} `;for(let T=0;T<t.length;T++){let d=`${t[T]} `;E.includes(` ${d}`)||(E+=d)}he(a,"class",E.trim())}}return this}function dr(e){if(typeof e=="function")return R(this,(a,c)=>{g(a)&&dr.call([a],e.call(a,c,a.attribs.class||""))});let t=ct(e),s=t.length,n=arguments.length===0;return R(this,a=>{if(g(a))if(n)a.attribs.class="";else{let c=ct(a.attribs.class),E=!1;for(let T=0;T<s;T++){let d=c.indexOf(t[T]);d>=0&&(c.splice(d,1),E=!0,T--)}E&&(a.attribs.class=c.join(" "))}})}function mr(e,t){if(typeof e=="function")return R(this,(E,T)=>{g(E)&&mr.call([E],e.call(E,T,E.attribs.class||"",t),t)});if(!e||typeof e!="string")return this;let s=e.split(Oe),n=s.length,a=typeof t=="boolean"?t?1:-1:0,c=this.length;for(let E=0;E<c;E++){let T=this[E];if(!g(T))continue;let d=ct(T.attribs.class);for(let A=0;A<n;A++){let _=d.indexOf(s[A]);a>=0&&_<0?d.push(s[A]):a<=0&&_>=0&&d.splice(_,1)}T.attribs.class=d.join(" ")}return this}var es={};K(es,{add:()=>Ka,addBack:()=>Xa,children:()=>ba,closest:()=>Ca,contents:()=>Pa,each:()=>Ma,end:()=>Ga,eq:()=>wa,filter:()=>ka,filterArray:()=>Zt,find:()=>_a,first:()=>Ha,get:()=>va,has:()=>xa,index:()=>Wa,is:()=>Ua,last:()=>ya,map:()=>Ba,next:()=>Na,nextAll:()=>ga,nextUntil:()=>Oa,not:()=>Fa,parent:()=>Aa,parents:()=>pa,parentsUntil:()=>Ia,prev:()=>Sa,prevAll:()=>Ra,prevUntil:()=>La,siblings:()=>Da,slice:()=>Qa,toArray:()=>Ya});var Et=oe(Ln(),1);var ha=new Set(["first","last","eq","gt","nth","lt","even","odd"]);function Te(e){return e.type!=="pseudo"?!1:ha.has(e.name)?!0:e.name==="not"&&Array.isArray(e.data)?e.data.some(t=>t.some(Te)):!1}function fr(e,t,s){let n=t!=null?parseInt(t,10):NaN;switch(e){case"first":return 1;case"nth":case"eq":return isFinite(n)?n>=0?n+1:1/0:0;case"lt":return isFinite(n)?n>=0?Math.min(n,s):1/0:0;case"gt":return isFinite(n)?1/0:0;case"odd":return 2*s;case"even":return 2*s-1;case"last":case"not":return 1/0}}function _r(e){for(;e.parent;)e=e.parent;return e}function lt(e){let t=[],s=[];for(let n of e)n.some(Te)?t.push(n):s.push(n);return[s,t]}var Ta={type:pe.Universal,namespace:null},ua={type:pe.Pseudo,name:"scope",data:null};function Vt(e,t,s={}){return jt([e],t,s)}function jt(e,t,s={}){if(typeof t=="function")return e.some(t);let[n,a]=lt(qe(t));return n.length>0&&e.some(ze(n,s))||a.some(c=>pr(c,e,s).length>0)}function da(e,t,s,n){let a=typeof s=="string"?parseInt(s,10):NaN;switch(e){case"first":case"lt":return t;case"last":return t.length>0?[t[t.length-1]]:t;case"nth":case"eq":return isFinite(a)&&Math.abs(a)<t.length?[a<0?t[t.length+a]:t[a]]:[];case"gt":return isFinite(a)?t.slice(a+1):[];case"even":return t.filter((c,E)=>E%2===0);case"odd":return t.filter((c,E)=>E%2===1);case"not":{let c=new Set(Ar(s,t,n));return t.filter(E=>!c.has(E))}}}function qt(e,t,s={}){return Ar(qe(e),t,s)}function Ar(e,t,s){if(t.length===0)return[];let[n,a]=lt(e),c;if(n.length){let E=Xt(t,n,s);if(a.length===0)return E;E.length&&(c=new Set(E))}for(let E=0;E<a.length&&(c==null?void 0:c.size)!==t.length;E++){let T=a[E];if((c?t.filter(_=>g(_)&&!c.has(_)):t).length===0)break;let A=pr(T,t,s);if(A.length)if(c)A.forEach(_=>c.add(_));else{if(E===a.length-1)return A;c=new Set(A)}}return typeof c!="undefined"?c.size===t.length?t:t.filter(E=>c.has(E)):[]}function pr(e,t,s){var n;if(e.some(Ie)){let a=(n=s.root)!==null&&n!==void 0?n:_r(t[0]),c={...s,context:t,relativeSelector:!1};return e.push(ua),ht(a,e,c,!0,t.length)}return ht(t,e,s,!1,t.length)}function Ir(e,t,s={},n=1/0){if(typeof e=="function")return Cr(t,e);let[a,c]=lt(qe(e)),E=c.map(T=>ht(t,T,s,!0,n));return a.length&&E.push(Kt(t,a,s,n)),E.length===0?[]:E.length===1?E[0]:re(E.reduce((T,d)=>[...T,...d]))}function ht(e,t,s,n,a){let c=t.findIndex(Te),E=t.slice(0,c),T=t[c],d=t.length-1===c?a:1/0,A=fr(T.name,T.data,d);if(A===0)return[];let p=(E.length===0&&!Array.isArray(e)?Ve(e).filter(g):E.length===0?(Array.isArray(e)?e:[e]).filter(g):n||E.some(Ie)?Kt(e,[E],s,A):Xt(e,[E],s)).slice(0,A),I=da(T.name,p,T.data,s);if(I.length===0||t.length===c+1)return I;let C=t.slice(c+1),N=C.some(Ie);if(N){if(Ie(C[0])){let{type:L}=C[0];(L===pe.Sibling||L===pe.Adjacent)&&(I=wt(I,yt,!0)),C.unshift(Ta)}s={...s,relativeSelector:!1,rootFunc:L=>I.includes(L)}}else s.rootFunc&&s.rootFunc!==Et.trueFunc&&(s={...s,rootFunc:Et.trueFunc});return C.some(Te)?ht(I,C,s,!1,a):N?Kt(I,[C],s,a):Xt(I,[C],s)}function Kt(e,t,s,n){let a=ze(t,s,e);return Cr(e,a,n)}function Cr(e,t,s=1/0){let n=wt(e,yt,t.shouldTestNextSiblings);return Fs(a=>g(a)&&t(a),n,!0,s)}function Xt(e,t,s){let n=(Array.isArray(e)?e:[e]).filter(g);if(n.length===0)return n;let a=ze(t,s);return a===Et.trueFunc?n:n.filter(a)}var fa=/^\s*[~+]/;function _a(e){var t;if(!e)return this._make([]);let s=this.toArray();if(typeof e!="string"){let c=F(e)?e.toArray():[e];return this._make(c.filter(E=>s.some(T=>vt(T,E))))}let n=fa.test(e)?s:this.children().toArray(),a={context:s,root:(t=this._root)===null||t===void 0?void 0:t[0],xmlMode:this.options.xmlMode,lowerCaseTags:this.options.lowerCaseTags,lowerCaseAttributeNames:this.options.lowerCaseAttributeNames,pseudos:this.options.pseudos,quirksMode:this.options.quirksMode};return this._make(Ir(e,n,a))}function zt(e){return function(t,...s){return function(n){var a;let c=e(t,this);return n&&(c=Zt(c,n,this.options.xmlMode,(a=this._root)===null||a===void 0?void 0:a[0])),this._make(this.length>1&&c.length>1?s.reduce((E,T)=>T(E),c):c)}}}var Se=zt((e,t)=>{let s=[];for(let n=0;n<t.length;n++){let a=e(t[n]);s.push(a)}return new Array().concat(...s)}),$t=zt((e,t)=>{let s=[];for(let n=0;n<t.length;n++){let a=e(t[n]);a!==null&&s.push(a)}return s});function Jt(e,...t){let s=null,n=zt((a,c)=>{let E=[];return R(c,T=>{for(let d;(d=a(T))&&!(s!=null&&s(d,E.length));T=d)E.push(d)}),E})(e,...t);return function(a,c){s=typeof a=="string"?T=>Vt(T,a,this.options):a?Re(a):null;let E=n.call(this,c);return s=null,E}}function ue(e){return Array.from(new Set(e))}var Aa=$t(({parent:e})=>e&&!j(e)?e:null,ue),pa=Se(e=>{let t=[];for(;e.parent&&!j(e.parent);)t.push(e.parent),e=e.parent;return t},re,e=>e.reverse()),Ia=Jt(({parent:e})=>e&&!j(e)?e:null,re,e=>e.reverse());function Ca(e){var t;let s=[];if(!e)return this._make(s);let n={xmlMode:this.options.xmlMode,root:(t=this._root)===null||t===void 0?void 0:t[0]},a=typeof e=="string"?c=>Vt(c,e,n):Re(e);return R(this,c=>{for(;c&&g(c);){if(a(c,0)){s.includes(c)||s.push(c);break}c=c.parent}}),this._make(s)}var Na=$t(e=>xt(e)),ga=Se(e=>{let t=[];for(;e.next;)e=e.next,g(e)&&t.push(e);return t},ue),Oa=Jt(e=>xt(e),ue),Sa=$t(e=>Ht(e)),Ra=Se(e=>{let t=[];for(;e.prev;)e=e.prev,g(e)&&t.push(e);return t},ue),La=Jt(e=>Ht(e),ue),Da=Se(e=>Us(e).filter(t=>g(t)&&t!==e),re),ba=Se(e=>Ve(e).filter(g),ue);function Pa(){let e=this.toArray().reduce((t,s)=>H(s)?t.concat(s.children):t,[]);return this._make(e)}function Ma(e){let t=0,s=this.length;for(;t<s&&e.call(this[t],t,this[t])!==!1;)++t;return this}function Ba(e){let t=[];for(let s=0;s<this.length;s++){let n=this[s],a=e.call(n,s,n);a!=null&&(t=t.concat(a))}return this._make(t)}function Re(e){return typeof e=="function"?(t,s)=>e.call(t,s,t):F(e)?t=>Array.prototype.includes.call(e,t):function(t){return e===t}}function ka(e){var t;return this._make(Zt(this.toArray(),e,this.options.xmlMode,(t=this._root)===null||t===void 0?void 0:t[0]))}function Zt(e,t,s,n){return typeof t=="string"?qt(t,e,{xmlMode:s,root:n}):e.filter(Re(t))}function Ua(e){let t=this.toArray();return typeof e=="string"?jt(t.filter(g),e,this.options):e?t.some(Re(e)):!1}function Fa(e){let t=this.toArray();if(typeof e=="string"){let s=new Set(qt(e,t,this.options));t=t.filter(n=>!s.has(n))}else{let s=Re(e);t=t.filter((n,a)=>!s(n,a))}return this._make(t)}function xa(e){return this.filter(typeof e=="string"?`:has(${e})`:(t,s)=>this._make(s).find(e).length>0)}function Ha(){return this.length>1?this._make(this[0]):this}function ya(){return this.length>0?this._make(this[this.length-1]):this}function wa(e){var t;return e=+e,e===0&&this.length<=1?this:(e<0&&(e=this.length+e),this._make((t=this[e])!==null&&t!==void 0?t:[]))}function va(e){return e==null?this.toArray():this[e<0?this.length+e:e]}function Ya(){return Array.prototype.slice.call(this)}function Wa(e){let t,s;return e==null?(t=this.parent().children(),s=this[0]):typeof e=="string"?(t=this._make(e),s=this[0]):(t=this,s=F(e)?e[0]:e),Array.prototype.indexOf.call(t,s)}function Qa(e,t){return this._make(Array.prototype.slice.call(this,e,t))}function Ga(){var e;return(e=this.prevObject)!==null&&e!==void 0?e:this._make([])}function Ka(e,t){let s=this._make(e,t),n=re([...this.get(),...s.get()]);return this._make(n)}function Xa(e){return this.prevObject?this.add(e?this.prevObject.filter(e):this.prevObject):this}var ts={};K(ts,{_makeDomArray:()=>Va,after:()=>si,append:()=>za,appendTo:()=>ja,before:()=>ni,clone:()=>Ti,empty:()=>ci,html:()=>li,insertAfter:()=>ri,insertBefore:()=>ai,prepend:()=>$a,prependTo:()=>qa,remove:()=>ii,replaceWith:()=>oi,text:()=>hi,toString:()=>Ei,unwrap:()=>ei,wrap:()=>Ja,wrapAll:()=>ti,wrapInner:()=>Za});function Nr(e){return function(s,n,a,c){if(typeof Buffer!="undefined"&&Buffer.isBuffer(s)&&(s=s.toString()),typeof s=="string")return e(s,n,a,c);let E=s;if(!Array.isArray(E)&&j(E))return E;let T=new se([]);return $(E,T),T}}function $(e,t){let s=Array.isArray(e)?e:[e];t?t.children=s:t=null;for(let n=0;n<s.length;n++){let a=s[n];a.parent&&a.parent.children!==s&&je(a),t?(a.prev=s[n-1]||null,a.next=s[n+1]||null):a.prev=a.next=null,a.parent=t}return t}function Va(e,t){return e==null?[]:F(e)?t?it(e.get()):e.get():Array.isArray(e)?e.reduce((s,n)=>s.concat(this._makeDomArray(n,t)),[]):typeof e=="string"?this._parse(e,this.options,!1,null).children:t?it([e]):[e]}function gr(e){return function(...t){let s=this.length-1;return R(this,(n,a)=>{if(!H(n))return;let c=typeof t[0]=="function"?t[0].call(n,a,this._render(n.children)):t,E=this._makeDomArray(c,a<s);e(E,n.children,n)})}}function J(e,t,s,n,a){var c,E;let T=[t,s,...n],d=t===0?null:e[t-1],A=t+s>=e.length?null:e[t+s];for(let _=0;_<n.length;++_){let p=n[_],I=p.parent;if(I){let N=I.children.indexOf(p);N>-1&&(I.children.splice(N,1),a===I&&t>N&&T[0]--)}p.parent=a,p.prev&&(p.prev.next=(c=p.next)!==null&&c!==void 0?c:null),p.next&&(p.next.prev=(E=p.prev)!==null&&E!==void 0?E:null),p.prev=_===0?d:n[_-1],p.next=_===n.length-1?A:n[_+1]}return d&&(d.next=n[0]),A&&(A.prev=n[n.length-1]),e.splice(...T)}function ja(e){return(F(e)?e:this._make(e)).append(this),this}function qa(e){return(F(e)?e:this._make(e)).prepend(this),this}var za=gr((e,t,s)=>{J(t,t.length,0,e,s)}),$a=gr((e,t,s)=>{J(t,0,0,e,s)});function Or(e){return function(t){let s=this.length-1,n=this.parents().last();for(let a=0;a<this.length;a++){let c=this[a],E=typeof t=="function"?t.call(c,a,c):typeof t=="string"&&!ge(t)?n.find(t).clone():t,[T]=this._makeDomArray(E,a<s);if(!T||!H(T))continue;let d=T,A=0;for(;A<d.children.length;){let _=d.children[A];g(_)?(d=_,A=0):A++}e(c,d,[T])}return this}}var Ja=Or((e,t,s)=>{let{parent:n}=e;if(!n)return;let a=n.children,c=a.indexOf(e);$([e],t),J(a,c,0,s,n)}),Za=Or((e,t,s)=>{H(e)&&($(e.children,t),$(s,e))});function ei(e){return this.parent(e).not("body").each((t,s)=>{this._make(s).replaceWith(s.children)}),this}function ti(e){let t=this[0];if(t){let s=this._make(typeof e=="function"?e.call(t,0,t):e).insertBefore(t),n;for(let c=0;c<s.length;c++)s[c].type==="tag"&&(n=s[c]);let a=0;for(;n&&a<n.children.length;){let c=n.children[a];c.type==="tag"?(n=c,a=0):a++}n&&this._make(n).append(this)}return this}function si(...e){let t=this.length-1;return R(this,(s,n)=>{let{parent:a}=s;if(!H(s)||!a)return;let c=a.children,E=c.indexOf(s);if(E<0)return;let T=typeof e[0]=="function"?e[0].call(s,n,this._render(s.children)):e,d=this._makeDomArray(T,n<t);J(c,E+1,0,d,a)})}function ri(e){typeof e=="string"&&(e=this._make(e)),this.remove();let t=[];return this._makeDomArray(e).forEach(s=>{let n=this.clone().toArray(),{parent:a}=s;if(!a)return;let c=a.children,E=c.indexOf(s);E<0||(J(c,E+1,0,n,a),t.push(...n))}),this._make(t)}function ni(...e){let t=this.length-1;return R(this,(s,n)=>{let{parent:a}=s;if(!H(s)||!a)return;let c=a.children,E=c.indexOf(s);if(E<0)return;let T=typeof e[0]=="function"?e[0].call(s,n,this._render(s.children)):e,d=this._makeDomArray(T,n<t);J(c,E,0,d,a)})}function ai(e){let t=this._make(e);this.remove();let s=[];return R(t,n=>{let a=this.clone().toArray(),{parent:c}=n;if(!c)return;let E=c.children,T=E.indexOf(n);T<0||(J(E,T,0,a,c),s.push(...a))}),this._make(s)}function ii(e){let t=e?this.filter(e):this;return R(t,s=>{je(s),s.prev=s.next=s.parent=null}),this}function oi(e){return R(this,(t,s)=>{let{parent:n}=t;if(!n)return;let a=n.children,c=typeof e=="function"?e.call(t,s,t):e,E=this._makeDomArray(c);$(E,null);let T=a.indexOf(t);J(a,T,1,E,n),E.includes(t)||(t.parent=t.prev=t.next=null)})}function ci(){return R(this,e=>{H(e)&&(e.children.forEach(t=>{t.next=t.prev=t.parent=null}),e.children.length=0)})}function li(e){if(e===void 0){let t=this[0];return!t||!H(t)?null:this._render(t.children)}return R(this,t=>{if(!H(t))return;t.children.forEach(n=>{n.next=n.prev=n.parent=null});let s=F(e)?e.toArray():this._parse(`${e}`,this.options,!1,t).children;$(s,t)})}function Ei(){return this._render(this)}function hi(e){return e===void 0?q(this):typeof e=="function"?R(this,(t,s)=>this._make(t).text(e.call(t,s,q([t])))):R(this,t=>{if(!H(t))return;t.children.forEach(n=>{n.next=n.prev=n.parent=null});let s=new Ge(`${e}`);$(s,t)})}function Ti(){return this._make(it(this.get()))}var ss={};K(ss,{css:()=>ui});function ui(e,t){if(e!=null&&t!=null||typeof e=="object"&&!Array.isArray(e))return R(this,(s,n)=>{g(s)&&Sr(s,e,t,n)});if(this.length!==0)return Rr(this[0],e)}function Sr(e,t,s,n){if(typeof t=="string"){let a=Rr(e),c=typeof s=="function"?s.call(e,n,a[t]):s;c===""?delete a[t]:c!=null&&(a[t]=c),e.attribs.style=di(a)}else typeof t=="object"&&Object.keys(t).forEach((a,c)=>{Sr(e,a,t[a],c)})}function Rr(e,t){if(!e||!g(e))return;let s=mi(e.attribs.style);if(typeof t=="string")return s[t];if(Array.isArray(t)){let n={};return t.forEach(a=>{s[a]!=null&&(n[a]=s[a])}),n}return s}function di(e){return Object.keys(e).reduce((t,s)=>`${t}${t?" ":""}${s}: ${e[s]};`,"")}function mi(e){if(e=(e||"").trim(),!e)return{};let t={},s;for(let n of e.split(";")){let a=n.indexOf(":");if(a<1||a===n.length-1){let c=n.trimEnd();c.length>0&&s!==void 0&&(t[s]+=`;${c}`)}else s=n.slice(0,a).trim(),t[s]=n.slice(a+1).trim()}return t}var rs={};K(rs,{serialize:()=>_i,serializeArray:()=>Ai});var Lr="input,select,textarea,keygen",fi=/%20/g,Dr=/\r?\n/g;function _i(){return this.serializeArray().map(s=>`${encodeURIComponent(s.name)}=${encodeURIComponent(s.value)}`).join("&").replace(fi,"+")}function Ai(){return this.map((e,t)=>{let s=this._make(t);return g(t)&&t.name==="form"?s.find(Lr).toArray():s.filter(Lr).toArray()}).filter('[name!=""]:enabled:not(:submit, :button, :image, :reset, :file):matches([checked], :not(:checkbox, :radio))').map((e,t)=>{var s;let n=this._make(t),a=n.attr("name"),c=(s=n.val())!==null&&s!==void 0?s:"";return Array.isArray(c)?c.map(E=>({name:a,value:E.replace(Dr,`\r
`)})):{name:a,value:c.replace(Dr,`\r
`)}}).toArray()}var Z=class{constructor(t,s,n){if(this.length=0,this.options=n,this._root=s,t){for(let a=0;a<t.length;a++)this[a]=t[a];this.length=t.length}}};Z.prototype.cheerio="[cheerio object]";Z.prototype.splice=Array.prototype.splice;Z.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator];Object.assign(Z.prototype,Gt,es,ts,ss,rs);function br(e,t){return function s(n,a,c=!0){if(n==null)throw new Error("cheerio.load() expects a string");let E={...Ce,...Ne(a)},T=e(n,E,c,null);class d extends Z{_make(p,I){let C=A(p,I);return C.prevObject=this,C}_parse(p,I,C,N){return e(p,I,C,N)}_render(p){return t(p,this.options)}}function A(_,p,I=T,C){if(_&&F(_))return _;let N={...E,...Ne(C)},L=typeof I=="string"?[e(I,N,!1,null)]:"length"in I?I:[I],S=F(L)?L:new d(L,null,N);if(S._root=S,!_)return new d(void 0,S,N);let b=typeof _=="string"&&ge(_)?e(_,N,!1,null).children:pi(_)?[_]:Array.isArray(_)?_:void 0,w=new d(b,S,N);if(b)return w;if(typeof _!="string")throw new Error("Unexpected type of selector");let x=_,W=p?typeof p=="string"?ge(p)?new d([e(p,N,!1,null)],S,N):(x=`${p} ${x}`,S):F(p)?p:new d(Array.isArray(p)?p:[p],S,N):S;return W?W.find(x):w}return Object.assign(A,z,{load:s,_root:T,_options:E,fn:d.prototype,prototype:d.prototype}),A}}function pi(e){return!!e.name||e.type==="root"||e.type==="text"||e.type==="comment"}var Ii=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),D="\uFFFD",i;(function(e){e[e.EOF=-1]="EOF",e[e.NULL=0]="NULL",e[e.TABULATION=9]="TABULATION",e[e.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",e[e.LINE_FEED=10]="LINE_FEED",e[e.FORM_FEED=12]="FORM_FEED",e[e.SPACE=32]="SPACE",e[e.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",e[e.QUOTATION_MARK=34]="QUOTATION_MARK",e[e.AMPERSAND=38]="AMPERSAND",e[e.APOSTROPHE=39]="APOSTROPHE",e[e.HYPHEN_MINUS=45]="HYPHEN_MINUS",e[e.SOLIDUS=47]="SOLIDUS",e[e.DIGIT_0=48]="DIGIT_0",e[e.DIGIT_9=57]="DIGIT_9",e[e.SEMICOLON=59]="SEMICOLON",e[e.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",e[e.EQUALS_SIGN=61]="EQUALS_SIGN",e[e.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",e[e.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",e[e.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",e[e.GRAVE_ACCENT=96]="GRAVE_ACCENT",e[e.LATIN_SMALL_A=97]="LATIN_SMALL_A",e[e.LATIN_SMALL_Z=122]="LATIN_SMALL_Z"})(i||(i={}));var k={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function Tt(e){return e>=55296&&e<=57343}function Pr(e){return e>=56320&&e<=57343}function Mr(e,t){return(e-55296)*1024+9216+t}function ut(e){return e!==32&&e!==10&&e!==13&&e!==9&&e!==12&&e>=1&&e<=31||e>=127&&e<=159}function dt(e){return e>=64976&&e<=65007||Ii.has(e)}var u;(function(e){e.controlCharacterInInputStream="control-character-in-input-stream",e.noncharacterInInputStream="noncharacter-in-input-stream",e.surrogateInInputStream="surrogate-in-input-stream",e.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",e.endTagWithAttributes="end-tag-with-attributes",e.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",e.unexpectedSolidusInTag="unexpected-solidus-in-tag",e.unexpectedNullCharacter="unexpected-null-character",e.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",e.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",e.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",e.missingEndTagName="missing-end-tag-name",e.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",e.unknownNamedCharacterReference="unknown-named-character-reference",e.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",e.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",e.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",e.eofBeforeTagName="eof-before-tag-name",e.eofInTag="eof-in-tag",e.missingAttributeValue="missing-attribute-value",e.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",e.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",e.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",e.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",e.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",e.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",e.missingDoctypePublicIdentifier="missing-doctype-public-identifier",e.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",e.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",e.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",e.cdataInHtmlContent="cdata-in-html-content",e.incorrectlyOpenedComment="incorrectly-opened-comment",e.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",e.eofInDoctype="eof-in-doctype",e.nestedComment="nested-comment",e.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",e.eofInComment="eof-in-comment",e.incorrectlyClosedComment="incorrectly-closed-comment",e.eofInCdata="eof-in-cdata",e.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",e.nullCharacterReference="null-character-reference",e.surrogateCharacterReference="surrogate-character-reference",e.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",e.controlCharacterReference="control-character-reference",e.noncharacterCharacterReference="noncharacter-character-reference",e.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",e.missingDoctypeName="missing-doctype-name",e.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",e.duplicateAttribute="duplicate-attribute",e.nonConformingDoctype="non-conforming-doctype",e.missingDoctype="missing-doctype",e.misplacedDoctype="misplaced-doctype",e.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",e.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",e.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",e.openElementsLeftAfterEof="open-elements-left-after-eof",e.abandonedHeadElementChild="abandoned-head-element-child",e.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",e.nestedNoscriptInHead="nested-noscript-in-head",e.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(u||(u={}));var Ni=1<<16,mt=class{constructor(t){this.handler=t,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=Ni,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+Number(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(t,s){let{line:n,col:a,offset:c}=this,E=a+s,T=c+s;return{code:t,startLine:n,endLine:n,startCol:E,endCol:E,startOffset:T,endOffset:T}}_err(t){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(t,0)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(t){if(this.pos!==this.html.length-1){let s=this.html.charCodeAt(this.pos+1);if(Pr(s))return this.pos++,this._addGap(),Mr(t,s)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,i.EOF;return this._err(u.surrogateInInputStream),t}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(t,s){this.html.length>0?this.html+=t:this.html=t,this.endOfChunkHit=!1,this.lastChunkWritten=s}insertHtmlAtCurrentPos(t){this.html=this.html.substring(0,this.pos+1)+t+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(t,s){if(this.pos+t.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(s)return this.html.startsWith(t,this.pos);for(let n=0;n<t.length;n++)if((this.html.charCodeAt(this.pos+n)|32)!==t.charCodeAt(n))return!1;return!0}peek(t){let s=this.pos+t;if(s>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,i.EOF;let n=this.html.charCodeAt(s);return n===i.CARRIAGE_RETURN?i.LINE_FEED:n}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,i.EOF;let t=this.html.charCodeAt(this.pos);return t===i.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,i.LINE_FEED):t===i.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,Tt(t)&&(t=this._processSurrogate(t)),this.handler.onParseError===null||t>31&&t<127||t===i.LINE_FEED||t===i.CARRIAGE_RETURN||t>159&&t<64976||this._checkForProblematicCharacters(t),t)}_checkForProblematicCharacters(t){ut(t)?this._err(u.controlCharacterInInputStream):dt(t)&&this._err(u.noncharacterInInputStream)}retreat(t){for(this.pos-=t;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}};var ns={};K(ns,{TokenType:()=>O,getTokenAttr:()=>Le});var O;(function(e){e[e.CHARACTER=0]="CHARACTER",e[e.NULL_CHARACTER=1]="NULL_CHARACTER",e[e.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",e[e.START_TAG=3]="START_TAG",e[e.END_TAG=4]="END_TAG",e[e.COMMENT=5]="COMMENT",e[e.DOCTYPE=6]="DOCTYPE",e[e.EOF=7]="EOF",e[e.HIBERNATION=8]="HIBERNATION"})(O||(O={}));function Le(e,t){for(let s=e.attrs.length-1;s>=0;s--)if(e.attrs[s].name===t)return e.attrs[s].value;return null}var De={};K(De,{ATTRS:()=>G,DOCUMENT_MODE:()=>P,NS:()=>m,NUMBERED_HEADERS:()=>de,SPECIAL_ELEMENTS:()=>as,TAG_ID:()=>r,TAG_NAMES:()=>h,getTagID:()=>ee,hasUnescapedText:()=>is});var m;(function(e){e.HTML="http://www.w3.org/1999/xhtml",e.MATHML="http://www.w3.org/1998/Math/MathML",e.SVG="http://www.w3.org/2000/svg",e.XLINK="http://www.w3.org/1999/xlink",e.XML="http://www.w3.org/XML/1998/namespace",e.XMLNS="http://www.w3.org/2000/xmlns/"})(m||(m={}));var G;(function(e){e.TYPE="type",e.ACTION="action",e.ENCODING="encoding",e.PROMPT="prompt",e.NAME="name",e.COLOR="color",e.FACE="face",e.SIZE="size"})(G||(G={}));var P;(function(e){e.NO_QUIRKS="no-quirks",e.QUIRKS="quirks",e.LIMITED_QUIRKS="limited-quirks"})(P||(P={}));var h;(function(e){e.A="a",e.ADDRESS="address",e.ANNOTATION_XML="annotation-xml",e.APPLET="applet",e.AREA="area",e.ARTICLE="article",e.ASIDE="aside",e.B="b",e.BASE="base",e.BASEFONT="basefont",e.BGSOUND="bgsound",e.BIG="big",e.BLOCKQUOTE="blockquote",e.BODY="body",e.BR="br",e.BUTTON="button",e.CAPTION="caption",e.CENTER="center",e.CODE="code",e.COL="col",e.COLGROUP="colgroup",e.DD="dd",e.DESC="desc",e.DETAILS="details",e.DIALOG="dialog",e.DIR="dir",e.DIV="div",e.DL="dl",e.DT="dt",e.EM="em",e.EMBED="embed",e.FIELDSET="fieldset",e.FIGCAPTION="figcaption",e.FIGURE="figure",e.FONT="font",e.FOOTER="footer",e.FOREIGN_OBJECT="foreignObject",e.FORM="form",e.FRAME="frame",e.FRAMESET="frameset",e.H1="h1",e.H2="h2",e.H3="h3",e.H4="h4",e.H5="h5",e.H6="h6",e.HEAD="head",e.HEADER="header",e.HGROUP="hgroup",e.HR="hr",e.HTML="html",e.I="i",e.IMG="img",e.IMAGE="image",e.INPUT="input",e.IFRAME="iframe",e.KEYGEN="keygen",e.LABEL="label",e.LI="li",e.LINK="link",e.LISTING="listing",e.MAIN="main",e.MALIGNMARK="malignmark",e.MARQUEE="marquee",e.MATH="math",e.MENU="menu",e.META="meta",e.MGLYPH="mglyph",e.MI="mi",e.MO="mo",e.MN="mn",e.MS="ms",e.MTEXT="mtext",e.NAV="nav",e.NOBR="nobr",e.NOFRAMES="noframes",e.NOEMBED="noembed",e.NOSCRIPT="noscript",e.OBJECT="object",e.OL="ol",e.OPTGROUP="optgroup",e.OPTION="option",e.P="p",e.PARAM="param",e.PLAINTEXT="plaintext",e.PRE="pre",e.RB="rb",e.RP="rp",e.RT="rt",e.RTC="rtc",e.RUBY="ruby",e.S="s",e.SCRIPT="script",e.SEARCH="search",e.SECTION="section",e.SELECT="select",e.SOURCE="source",e.SMALL="small",e.SPAN="span",e.STRIKE="strike",e.STRONG="strong",e.STYLE="style",e.SUB="sub",e.SUMMARY="summary",e.SUP="sup",e.TABLE="table",e.TBODY="tbody",e.TEMPLATE="template",e.TEXTAREA="textarea",e.TFOOT="tfoot",e.TD="td",e.TH="th",e.THEAD="thead",e.TITLE="title",e.TR="tr",e.TRACK="track",e.TT="tt",e.U="u",e.UL="ul",e.SVG="svg",e.VAR="var",e.WBR="wbr",e.XMP="xmp"})(h||(h={}));var r;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.A=1]="A",e[e.ADDRESS=2]="ADDRESS",e[e.ANNOTATION_XML=3]="ANNOTATION_XML",e[e.APPLET=4]="APPLET",e[e.AREA=5]="AREA",e[e.ARTICLE=6]="ARTICLE",e[e.ASIDE=7]="ASIDE",e[e.B=8]="B",e[e.BASE=9]="BASE",e[e.BASEFONT=10]="BASEFONT",e[e.BGSOUND=11]="BGSOUND",e[e.BIG=12]="BIG",e[e.BLOCKQUOTE=13]="BLOCKQUOTE",e[e.BODY=14]="BODY",e[e.BR=15]="BR",e[e.BUTTON=16]="BUTTON",e[e.CAPTION=17]="CAPTION",e[e.CENTER=18]="CENTER",e[e.CODE=19]="CODE",e[e.COL=20]="COL",e[e.COLGROUP=21]="COLGROUP",e[e.DD=22]="DD",e[e.DESC=23]="DESC",e[e.DETAILS=24]="DETAILS",e[e.DIALOG=25]="DIALOG",e[e.DIR=26]="DIR",e[e.DIV=27]="DIV",e[e.DL=28]="DL",e[e.DT=29]="DT",e[e.EM=30]="EM",e[e.EMBED=31]="EMBED",e[e.FIELDSET=32]="FIELDSET",e[e.FIGCAPTION=33]="FIGCAPTION",e[e.FIGURE=34]="FIGURE",e[e.FONT=35]="FONT",e[e.FOOTER=36]="FOOTER",e[e.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",e[e.FORM=38]="FORM",e[e.FRAME=39]="FRAME",e[e.FRAMESET=40]="FRAMESET",e[e.H1=41]="H1",e[e.H2=42]="H2",e[e.H3=43]="H3",e[e.H4=44]="H4",e[e.H5=45]="H5",e[e.H6=46]="H6",e[e.HEAD=47]="HEAD",e[e.HEADER=48]="HEADER",e[e.HGROUP=49]="HGROUP",e[e.HR=50]="HR",e[e.HTML=51]="HTML",e[e.I=52]="I",e[e.IMG=53]="IMG",e[e.IMAGE=54]="IMAGE",e[e.INPUT=55]="INPUT",e[e.IFRAME=56]="IFRAME",e[e.KEYGEN=57]="KEYGEN",e[e.LABEL=58]="LABEL",e[e.LI=59]="LI",e[e.LINK=60]="LINK",e[e.LISTING=61]="LISTING",e[e.MAIN=62]="MAIN",e[e.MALIGNMARK=63]="MALIGNMARK",e[e.MARQUEE=64]="MARQUEE",e[e.MATH=65]="MATH",e[e.MENU=66]="MENU",e[e.META=67]="META",e[e.MGLYPH=68]="MGLYPH",e[e.MI=69]="MI",e[e.MO=70]="MO",e[e.MN=71]="MN",e[e.MS=72]="MS",e[e.MTEXT=73]="MTEXT",e[e.NAV=74]="NAV",e[e.NOBR=75]="NOBR",e[e.NOFRAMES=76]="NOFRAMES",e[e.NOEMBED=77]="NOEMBED",e[e.NOSCRIPT=78]="NOSCRIPT",e[e.OBJECT=79]="OBJECT",e[e.OL=80]="OL",e[e.OPTGROUP=81]="OPTGROUP",e[e.OPTION=82]="OPTION",e[e.P=83]="P",e[e.PARAM=84]="PARAM",e[e.PLAINTEXT=85]="PLAINTEXT",e[e.PRE=86]="PRE",e[e.RB=87]="RB",e[e.RP=88]="RP",e[e.RT=89]="RT",e[e.RTC=90]="RTC",e[e.RUBY=91]="RUBY",e[e.S=92]="S",e[e.SCRIPT=93]="SCRIPT",e[e.SEARCH=94]="SEARCH",e[e.SECTION=95]="SECTION",e[e.SELECT=96]="SELECT",e[e.SOURCE=97]="SOURCE",e[e.SMALL=98]="SMALL",e[e.SPAN=99]="SPAN",e[e.STRIKE=100]="STRIKE",e[e.STRONG=101]="STRONG",e[e.STYLE=102]="STYLE",e[e.SUB=103]="SUB",e[e.SUMMARY=104]="SUMMARY",e[e.SUP=105]="SUP",e[e.TABLE=106]="TABLE",e[e.TBODY=107]="TBODY",e[e.TEMPLATE=108]="TEMPLATE",e[e.TEXTAREA=109]="TEXTAREA",e[e.TFOOT=110]="TFOOT",e[e.TD=111]="TD",e[e.TH=112]="TH",e[e.THEAD=113]="THEAD",e[e.TITLE=114]="TITLE",e[e.TR=115]="TR",e[e.TRACK=116]="TRACK",e[e.TT=117]="TT",e[e.U=118]="U",e[e.UL=119]="UL",e[e.SVG=120]="SVG",e[e.VAR=121]="VAR",e[e.WBR=122]="WBR",e[e.XMP=123]="XMP"})(r||(r={}));var gi=new Map([[h.A,r.A],[h.ADDRESS,r.ADDRESS],[h.ANNOTATION_XML,r.ANNOTATION_XML],[h.APPLET,r.APPLET],[h.AREA,r.AREA],[h.ARTICLE,r.ARTICLE],[h.ASIDE,r.ASIDE],[h.B,r.B],[h.BASE,r.BASE],[h.BASEFONT,r.BASEFONT],[h.BGSOUND,r.BGSOUND],[h.BIG,r.BIG],[h.BLOCKQUOTE,r.BLOCKQUOTE],[h.BODY,r.BODY],[h.BR,r.BR],[h.BUTTON,r.BUTTON],[h.CAPTION,r.CAPTION],[h.CENTER,r.CENTER],[h.CODE,r.CODE],[h.COL,r.COL],[h.COLGROUP,r.COLGROUP],[h.DD,r.DD],[h.DESC,r.DESC],[h.DETAILS,r.DETAILS],[h.DIALOG,r.DIALOG],[h.DIR,r.DIR],[h.DIV,r.DIV],[h.DL,r.DL],[h.DT,r.DT],[h.EM,r.EM],[h.EMBED,r.EMBED],[h.FIELDSET,r.FIELDSET],[h.FIGCAPTION,r.FIGCAPTION],[h.FIGURE,r.FIGURE],[h.FONT,r.FONT],[h.FOOTER,r.FOOTER],[h.FOREIGN_OBJECT,r.FOREIGN_OBJECT],[h.FORM,r.FORM],[h.FRAME,r.FRAME],[h.FRAMESET,r.FRAMESET],[h.H1,r.H1],[h.H2,r.H2],[h.H3,r.H3],[h.H4,r.H4],[h.H5,r.H5],[h.H6,r.H6],[h.HEAD,r.HEAD],[h.HEADER,r.HEADER],[h.HGROUP,r.HGROUP],[h.HR,r.HR],[h.HTML,r.HTML],[h.I,r.I],[h.IMG,r.IMG],[h.IMAGE,r.IMAGE],[h.INPUT,r.INPUT],[h.IFRAME,r.IFRAME],[h.KEYGEN,r.KEYGEN],[h.LABEL,r.LABEL],[h.LI,r.LI],[h.LINK,r.LINK],[h.LISTING,r.LISTING],[h.MAIN,r.MAIN],[h.MALIGNMARK,r.MALIGNMARK],[h.MARQUEE,r.MARQUEE],[h.MATH,r.MATH],[h.MENU,r.MENU],[h.META,r.META],[h.MGLYPH,r.MGLYPH],[h.MI,r.MI],[h.MO,r.MO],[h.MN,r.MN],[h.MS,r.MS],[h.MTEXT,r.MTEXT],[h.NAV,r.NAV],[h.NOBR,r.NOBR],[h.NOFRAMES,r.NOFRAMES],[h.NOEMBED,r.NOEMBED],[h.NOSCRIPT,r.NOSCRIPT],[h.OBJECT,r.OBJECT],[h.OL,r.OL],[h.OPTGROUP,r.OPTGROUP],[h.OPTION,r.OPTION],[h.P,r.P],[h.PARAM,r.PARAM],[h.PLAINTEXT,r.PLAINTEXT],[h.PRE,r.PRE],[h.RB,r.RB],[h.RP,r.RP],[h.RT,r.RT],[h.RTC,r.RTC],[h.RUBY,r.RUBY],[h.S,r.S],[h.SCRIPT,r.SCRIPT],[h.SEARCH,r.SEARCH],[h.SECTION,r.SECTION],[h.SELECT,r.SELECT],[h.SOURCE,r.SOURCE],[h.SMALL,r.SMALL],[h.SPAN,r.SPAN],[h.STRIKE,r.STRIKE],[h.STRONG,r.STRONG],[h.STYLE,r.STYLE],[h.SUB,r.SUB],[h.SUMMARY,r.SUMMARY],[h.SUP,r.SUP],[h.TABLE,r.TABLE],[h.TBODY,r.TBODY],[h.TEMPLATE,r.TEMPLATE],[h.TEXTAREA,r.TEXTAREA],[h.TFOOT,r.TFOOT],[h.TD,r.TD],[h.TH,r.TH],[h.THEAD,r.THEAD],[h.TITLE,r.TITLE],[h.TR,r.TR],[h.TRACK,r.TRACK],[h.TT,r.TT],[h.U,r.U],[h.UL,r.UL],[h.SVG,r.SVG],[h.VAR,r.VAR],[h.WBR,r.WBR],[h.XMP,r.XMP]]);function ee(e){var t;return(t=gi.get(e))!==null&&t!==void 0?t:r.UNKNOWN}var f=r,as={[m.HTML]:new Set([f.ADDRESS,f.APPLET,f.AREA,f.ARTICLE,f.ASIDE,f.BASE,f.BASEFONT,f.BGSOUND,f.BLOCKQUOTE,f.BODY,f.BR,f.BUTTON,f.CAPTION,f.CENTER,f.COL,f.COLGROUP,f.DD,f.DETAILS,f.DIR,f.DIV,f.DL,f.DT,f.EMBED,f.FIELDSET,f.FIGCAPTION,f.FIGURE,f.FOOTER,f.FORM,f.FRAME,f.FRAMESET,f.H1,f.H2,f.H3,f.H4,f.H5,f.H6,f.HEAD,f.HEADER,f.HGROUP,f.HR,f.HTML,f.IFRAME,f.IMG,f.INPUT,f.LI,f.LINK,f.LISTING,f.MAIN,f.MARQUEE,f.MENU,f.META,f.NAV,f.NOEMBED,f.NOFRAMES,f.NOSCRIPT,f.OBJECT,f.OL,f.P,f.PARAM,f.PLAINTEXT,f.PRE,f.SCRIPT,f.SECTION,f.SELECT,f.SOURCE,f.STYLE,f.SUMMARY,f.TABLE,f.TBODY,f.TD,f.TEMPLATE,f.TEXTAREA,f.TFOOT,f.TH,f.THEAD,f.TITLE,f.TR,f.TRACK,f.UL,f.WBR,f.XMP]),[m.MATHML]:new Set([f.MI,f.MO,f.MN,f.MS,f.MTEXT,f.ANNOTATION_XML]),[m.SVG]:new Set([f.TITLE,f.FOREIGN_OBJECT,f.DESC]),[m.XLINK]:new Set,[m.XML]:new Set,[m.XMLNS]:new Set},de=new Set([f.H1,f.H2,f.H3,f.H4,f.H5,f.H6]),Oi=new Set([h.STYLE,h.SCRIPT,h.XMP,h.IFRAME,h.NOEMBED,h.NOFRAMES,h.PLAINTEXT]);function is(e,t){return Oi.has(e)||t&&e===h.NOSCRIPT}var o;(function(e){e[e.DATA=0]="DATA",e[e.RCDATA=1]="RCDATA",e[e.RAWTEXT=2]="RAWTEXT",e[e.SCRIPT_DATA=3]="SCRIPT_DATA",e[e.PLAINTEXT=4]="PLAINTEXT",e[e.TAG_OPEN=5]="TAG_OPEN",e[e.END_TAG_OPEN=6]="END_TAG_OPEN",e[e.TAG_NAME=7]="TAG_NAME",e[e.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",e[e.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",e[e.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",e[e.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",e[e.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",e[e.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",e[e.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",e[e.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",e[e.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",e[e.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",e[e.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",e[e.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",e[e.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",e[e.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",e[e.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",e[e.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",e[e.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",e[e.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",e[e.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",e[e.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",e[e.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",e[e.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",e[e.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",e[e.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",e[e.BOGUS_COMMENT=40]="BOGUS_COMMENT",e[e.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",e[e.COMMENT_START=42]="COMMENT_START",e[e.COMMENT_START_DASH=43]="COMMENT_START_DASH",e[e.COMMENT=44]="COMMENT",e[e.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",e[e.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",e[e.COMMENT_END_DASH=49]="COMMENT_END_DASH",e[e.COMMENT_END=50]="COMMENT_END",e[e.COMMENT_END_BANG=51]="COMMENT_END_BANG",e[e.DOCTYPE=52]="DOCTYPE",e[e.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",e[e.DOCTYPE_NAME=54]="DOCTYPE_NAME",e[e.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",e[e.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",e[e.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",e[e.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",e[e.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",e[e.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",e[e.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",e[e.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",e[e.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",e[e.CDATA_SECTION=68]="CDATA_SECTION",e[e.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",e[e.CDATA_SECTION_END=70]="CDATA_SECTION_END",e[e.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",e[e.AMBIGUOUS_AMPERSAND=72]="AMBIGUOUS_AMPERSAND"})(o||(o={}));var M={DATA:o.DATA,RCDATA:o.RCDATA,RAWTEXT:o.RAWTEXT,SCRIPT_DATA:o.SCRIPT_DATA,PLAINTEXT:o.PLAINTEXT,CDATA_SECTION:o.CDATA_SECTION};function Si(e){return e>=i.DIGIT_0&&e<=i.DIGIT_9}function be(e){return e>=i.LATIN_CAPITAL_A&&e<=i.LATIN_CAPITAL_Z}function Ri(e){return e>=i.LATIN_SMALL_A&&e<=i.LATIN_SMALL_Z}function te(e){return Ri(e)||be(e)}function Br(e){return te(e)||Si(e)}function ft(e){return e+32}function Ur(e){return e===i.SPACE||e===i.LINE_FEED||e===i.TABULATION||e===i.FORM_FEED}function kr(e){return Ur(e)||e===i.SOLIDUS||e===i.GREATER_THAN_SIGN}function Li(e){return e===i.NULL?u.nullCharacterReference:e>1114111?u.characterReferenceOutsideUnicodeRange:Tt(e)?u.surrogateCharacterReference:dt(e)?u.noncharacterCharacterReference:ut(e)||e===i.CARRIAGE_RETURN?u.controlCharacterReference:null}var Pe=class{constructor(t,s){this.options=t,this.handler=s,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=o.DATA,this.returnState=o.DATA,this.entityStartPos=0,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new mt(s),this.currentLocation=this.getCurrentLocation(-1),this.entityDecoder=new Ss(Os,(n,a)=>{this.preprocessor.pos=this.entityStartPos+a-1,this._flushCodePointConsumedAsCharacterReference(n)},s.onParseError?{missingSemicolonAfterCharacterReference:()=>{this._err(u.missingSemicolonAfterCharacterReference,1)},absenceOfDigitsInNumericCharacterReference:n=>{this._err(u.absenceOfDigitsInNumericCharacterReference,this.entityStartPos-this.preprocessor.pos+n)},validateNumericCharacterReference:n=>{let a=Li(n);a&&this._err(a,1)}}:void 0)}_err(t,s=0){var n,a;(a=(n=this.handler).onParseError)===null||a===void 0||a.call(n,this.preprocessor.getError(t,s))}getCurrentLocation(t){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-t,startOffset:this.preprocessor.offset-t,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;let t=this._consume();this._ensureHibernation()||this._callState(t)}this.inLoop=!1}}pause(){this.paused=!0}resume(t){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||t==null||t())}write(t,s,n){this.active=!0,this.preprocessor.write(t,s),this._runParsingLoop(),this.paused||n==null||n()}insertHtmlAtCurrentPos(t){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(t),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this.preprocessor.retreat(this.consumedAfterSnapshot),this.consumedAfterSnapshot=0,this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_advanceBy(t){this.consumedAfterSnapshot+=t;for(let s=0;s<t;s++)this.preprocessor.advance()}_consumeSequenceIfMatch(t,s){return this.preprocessor.startsWith(t,s)?(this._advanceBy(t.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:O.START_TAG,tagName:"",tagID:r.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:O.END_TAG,tagName:"",tagID:r.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(t){this.currentToken={type:O.COMMENT,data:"",location:this.getCurrentLocation(t)}}_createDoctypeToken(t){this.currentToken={type:O.DOCTYPE,name:t,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(t,s){this.currentCharacterToken={type:t,chars:s,location:this.currentLocation}}_createAttr(t){this.currentAttr={name:t,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var t,s;let n=this.currentToken;if(Le(n,this.currentAttr.name)===null){if(n.attrs.push(this.currentAttr),n.location&&this.currentLocation){let a=(t=(s=n.location).attrs)!==null&&t!==void 0?t:s.attrs=Object.create(null);a[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(u.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(t){this._emitCurrentCharacterToken(t.location),this.currentToken=null,t.location&&(t.location.endLine=this.preprocessor.line,t.location.endCol=this.preprocessor.col+1,t.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){let t=this.currentToken;this.prepareToken(t),t.tagID=ee(t.tagName),t.type===O.START_TAG?(this.lastStartTagName=t.tagName,this.handler.onStartTag(t)):(t.attrs.length>0&&this._err(u.endTagWithAttributes),t.selfClosing&&this._err(u.endTagWithTrailingSolidus),this.handler.onEndTag(t)),this.preprocessor.dropParsedChunk()}emitCurrentComment(t){this.prepareToken(t),this.handler.onComment(t),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(t){this.prepareToken(t),this.handler.onDoctype(t),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(t){if(this.currentCharacterToken){switch(t&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=t.startLine,this.currentCharacterToken.location.endCol=t.startCol,this.currentCharacterToken.location.endOffset=t.startOffset),this.currentCharacterToken.type){case O.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case O.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case O.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){let t=this.getCurrentLocation(0);t&&(t.endLine=t.startLine,t.endCol=t.startCol,t.endOffset=t.startOffset),this._emitCurrentCharacterToken(t),this.handler.onEof({type:O.EOF,location:t}),this.active=!1}_appendCharToCurrentCharacterToken(t,s){if(this.currentCharacterToken)if(this.currentCharacterToken.type===t){this.currentCharacterToken.chars+=s;return}else this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();this._createCharacterToken(t,s)}_emitCodePoint(t){let s=Ur(t)?O.WHITESPACE_CHARACTER:t===i.NULL?O.NULL_CHARACTER:O.CHARACTER;this._appendCharToCurrentCharacterToken(s,String.fromCodePoint(t))}_emitChars(t){this._appendCharToCurrentCharacterToken(O.CHARACTER,t)}_startCharacterReference(){this.returnState=this.state,this.state=o.CHARACTER_REFERENCE,this.entityStartPos=this.preprocessor.pos,this.entityDecoder.startEntity(this._isCharacterReferenceInAttribute()?kt.Attribute:kt.Legacy)}_isCharacterReferenceInAttribute(){return this.returnState===o.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===o.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===o.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(t){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(t):this._emitCodePoint(t)}_callState(t){switch(this.state){case o.DATA:{this._stateData(t);break}case o.RCDATA:{this._stateRcdata(t);break}case o.RAWTEXT:{this._stateRawtext(t);break}case o.SCRIPT_DATA:{this._stateScriptData(t);break}case o.PLAINTEXT:{this._statePlaintext(t);break}case o.TAG_OPEN:{this._stateTagOpen(t);break}case o.END_TAG_OPEN:{this._stateEndTagOpen(t);break}case o.TAG_NAME:{this._stateTagName(t);break}case o.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(t);break}case o.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(t);break}case o.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(t);break}case o.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(t);break}case o.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(t);break}case o.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(t);break}case o.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(t);break}case o.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(t);break}case o.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(t);break}case o.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(t);break}case o.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(t);break}case o.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(t);break}case o.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(t);break}case o.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(t);break}case o.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(t);break}case o.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(t);break}case o.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(t);break}case o.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(t);break}case o.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(t);break}case o.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(t);break}case o.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(t);break}case o.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(t);break}case o.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(t);break}case o.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(t);break}case o.ATTRIBUTE_NAME:{this._stateAttributeName(t);break}case o.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(t);break}case o.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(t);break}case o.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(t);break}case o.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(t);break}case o.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(t);break}case o.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(t);break}case o.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(t);break}case o.BOGUS_COMMENT:{this._stateBogusComment(t);break}case o.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(t);break}case o.COMMENT_START:{this._stateCommentStart(t);break}case o.COMMENT_START_DASH:{this._stateCommentStartDash(t);break}case o.COMMENT:{this._stateComment(t);break}case o.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(t);break}case o.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(t);break}case o.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(t);break}case o.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(t);break}case o.COMMENT_END_DASH:{this._stateCommentEndDash(t);break}case o.COMMENT_END:{this._stateCommentEnd(t);break}case o.COMMENT_END_BANG:{this._stateCommentEndBang(t);break}case o.DOCTYPE:{this._stateDoctype(t);break}case o.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(t);break}case o.DOCTYPE_NAME:{this._stateDoctypeName(t);break}case o.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(t);break}case o.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(t);break}case o.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(t);break}case o.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(t);break}case o.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(t);break}case o.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(t);break}case o.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(t);break}case o.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(t);break}case o.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(t);break}case o.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(t);break}case o.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(t);break}case o.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(t);break}case o.BOGUS_DOCTYPE:{this._stateBogusDoctype(t);break}case o.CDATA_SECTION:{this._stateCdataSection(t);break}case o.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(t);break}case o.CDATA_SECTION_END:{this._stateCdataSectionEnd(t);break}case o.CHARACTER_REFERENCE:{this._stateCharacterReference();break}case o.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(t);break}default:throw new Error("Unknown state")}}_stateData(t){switch(t){case i.LESS_THAN_SIGN:{this.state=o.TAG_OPEN;break}case i.AMPERSAND:{this._startCharacterReference();break}case i.NULL:{this._err(u.unexpectedNullCharacter),this._emitCodePoint(t);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRcdata(t){switch(t){case i.AMPERSAND:{this._startCharacterReference();break}case i.LESS_THAN_SIGN:{this.state=o.RCDATA_LESS_THAN_SIGN;break}case i.NULL:{this._err(u.unexpectedNullCharacter),this._emitChars(D);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRawtext(t){switch(t){case i.LESS_THAN_SIGN:{this.state=o.RAWTEXT_LESS_THAN_SIGN;break}case i.NULL:{this._err(u.unexpectedNullCharacter),this._emitChars(D);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptData(t){switch(t){case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_LESS_THAN_SIGN;break}case i.NULL:{this._err(u.unexpectedNullCharacter),this._emitChars(D);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_statePlaintext(t){switch(t){case i.NULL:{this._err(u.unexpectedNullCharacter),this._emitChars(D);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateTagOpen(t){if(te(t))this._createStartTagToken(),this.state=o.TAG_NAME,this._stateTagName(t);else switch(t){case i.EXCLAMATION_MARK:{this.state=o.MARKUP_DECLARATION_OPEN;break}case i.SOLIDUS:{this.state=o.END_TAG_OPEN;break}case i.QUESTION_MARK:{this._err(u.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=o.BOGUS_COMMENT,this._stateBogusComment(t);break}case i.EOF:{this._err(u.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(u.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=o.DATA,this._stateData(t)}}_stateEndTagOpen(t){if(te(t))this._createEndTagToken(),this.state=o.TAG_NAME,this._stateTagName(t);else switch(t){case i.GREATER_THAN_SIGN:{this._err(u.missingEndTagName),this.state=o.DATA;break}case i.EOF:{this._err(u.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(u.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=o.BOGUS_COMMENT,this._stateBogusComment(t)}}_stateTagName(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=o.BEFORE_ATTRIBUTE_NAME;break}case i.SOLIDUS:{this.state=o.SELF_CLOSING_START_TAG;break}case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentTagToken();break}case i.NULL:{this._err(u.unexpectedNullCharacter),s.tagName+=D;break}case i.EOF:{this._err(u.eofInTag),this._emitEOFToken();break}default:s.tagName+=String.fromCodePoint(be(t)?ft(t):t)}}_stateRcdataLessThanSign(t){t===i.SOLIDUS?this.state=o.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=o.RCDATA,this._stateRcdata(t))}_stateRcdataEndTagOpen(t){te(t)?(this.state=o.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(t)):(this._emitChars("</"),this.state=o.RCDATA,this._stateRcdata(t))}handleSpecialEndTag(t){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();let s=this.currentToken;switch(s.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=o.BEFORE_ATTRIBUTE_NAME,!1;case i.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=o.SELF_CLOSING_START_TAG,!1;case i.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=o.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=o.RCDATA,this._stateRcdata(t))}_stateRawtextLessThanSign(t){t===i.SOLIDUS?this.state=o.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=o.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagOpen(t){te(t)?(this.state=o.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(t)):(this._emitChars("</"),this.state=o.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=o.RAWTEXT,this._stateRawtext(t))}_stateScriptDataLessThanSign(t){switch(t){case i.SOLIDUS:{this.state=o.SCRIPT_DATA_END_TAG_OPEN;break}case i.EXCLAMATION_MARK:{this.state=o.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=o.SCRIPT_DATA,this._stateScriptData(t)}}_stateScriptDataEndTagOpen(t){te(t)?(this.state=o.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(t)):(this._emitChars("</"),this.state=o.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=o.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStart(t){t===i.HYPHEN_MINUS?(this.state=o.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=o.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStartDash(t){t===i.HYPHEN_MINUS?(this.state=o.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=o.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscaped(t){switch(t){case i.HYPHEN_MINUS:{this.state=o.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case i.NULL:{this._err(u.unexpectedNullCharacter),this._emitChars(D);break}case i.EOF:{this._err(u.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataEscapedDash(t){switch(t){case i.HYPHEN_MINUS:{this.state=o.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case i.NULL:{this._err(u.unexpectedNullCharacter),this.state=o.SCRIPT_DATA_ESCAPED,this._emitChars(D);break}case i.EOF:{this._err(u.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=o.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedDashDash(t){switch(t){case i.HYPHEN_MINUS:{this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case i.GREATER_THAN_SIGN:{this.state=o.SCRIPT_DATA,this._emitChars(">");break}case i.NULL:{this._err(u.unexpectedNullCharacter),this.state=o.SCRIPT_DATA_ESCAPED,this._emitChars(D);break}case i.EOF:{this._err(u.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=o.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedLessThanSign(t){t===i.SOLIDUS?this.state=o.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:te(t)?(this._emitChars("<"),this.state=o.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(t)):(this._emitChars("<"),this.state=o.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagOpen(t){te(t)?(this.state=o.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(t)):(this._emitChars("</"),this.state=o.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=o.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscapeStart(t){if(this.preprocessor.startsWith(k.SCRIPT,!1)&&kr(this.preprocessor.peek(k.SCRIPT.length))){this._emitCodePoint(t);for(let s=0;s<k.SCRIPT.length;s++)this._emitCodePoint(this._consume());this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=o.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscaped(t){switch(t){case i.HYPHEN_MINUS:{this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case i.NULL:{this._err(u.unexpectedNullCharacter),this._emitChars(D);break}case i.EOF:{this._err(u.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDash(t){switch(t){case i.HYPHEN_MINUS:{this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case i.NULL:{this._err(u.unexpectedNullCharacter),this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(D);break}case i.EOF:{this._err(u.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDashDash(t){switch(t){case i.HYPHEN_MINUS:{this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case i.GREATER_THAN_SIGN:{this.state=o.SCRIPT_DATA,this._emitChars(">");break}case i.NULL:{this._err(u.unexpectedNullCharacter),this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(D);break}case i.EOF:{this._err(u.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedLessThanSign(t){t===i.SOLIDUS?(this.state=o.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateScriptDataDoubleEscapeEnd(t){if(this.preprocessor.startsWith(k.SCRIPT,!1)&&kr(this.preprocessor.peek(k.SCRIPT.length))){this._emitCodePoint(t);for(let s=0;s<k.SCRIPT.length;s++)this._emitCodePoint(this._consume());this.state=o.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateBeforeAttributeName(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.SOLIDUS:case i.GREATER_THAN_SIGN:case i.EOF:{this.state=o.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case i.EQUALS_SIGN:{this._err(u.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=o.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=o.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateAttributeName(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:case i.SOLIDUS:case i.GREATER_THAN_SIGN:case i.EOF:{this._leaveAttrName(),this.state=o.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case i.EQUALS_SIGN:{this._leaveAttrName(),this.state=o.BEFORE_ATTRIBUTE_VALUE;break}case i.QUOTATION_MARK:case i.APOSTROPHE:case i.LESS_THAN_SIGN:{this._err(u.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(t);break}case i.NULL:{this._err(u.unexpectedNullCharacter),this.currentAttr.name+=D;break}default:this.currentAttr.name+=String.fromCodePoint(be(t)?ft(t):t)}}_stateAfterAttributeName(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.SOLIDUS:{this.state=o.SELF_CLOSING_START_TAG;break}case i.EQUALS_SIGN:{this.state=o.BEFORE_ATTRIBUTE_VALUE;break}case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentTagToken();break}case i.EOF:{this._err(u.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=o.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateBeforeAttributeValue(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.QUOTATION_MARK:{this.state=o.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case i.APOSTROPHE:{this.state=o.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(u.missingAttributeValue),this.state=o.DATA,this.emitCurrentTagToken();break}default:this.state=o.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(t)}}_stateAttributeValueDoubleQuoted(t){switch(t){case i.QUOTATION_MARK:{this.state=o.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case i.AMPERSAND:{this._startCharacterReference();break}case i.NULL:{this._err(u.unexpectedNullCharacter),this.currentAttr.value+=D;break}case i.EOF:{this._err(u.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueSingleQuoted(t){switch(t){case i.APOSTROPHE:{this.state=o.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case i.AMPERSAND:{this._startCharacterReference();break}case i.NULL:{this._err(u.unexpectedNullCharacter),this.currentAttr.value+=D;break}case i.EOF:{this._err(u.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueUnquoted(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this._leaveAttrValue(),this.state=o.BEFORE_ATTRIBUTE_NAME;break}case i.AMPERSAND:{this._startCharacterReference();break}case i.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=o.DATA,this.emitCurrentTagToken();break}case i.NULL:{this._err(u.unexpectedNullCharacter),this.currentAttr.value+=D;break}case i.QUOTATION_MARK:case i.APOSTROPHE:case i.LESS_THAN_SIGN:case i.EQUALS_SIGN:case i.GRAVE_ACCENT:{this._err(u.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(t);break}case i.EOF:{this._err(u.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAfterAttributeValueQuoted(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this._leaveAttrValue(),this.state=o.BEFORE_ATTRIBUTE_NAME;break}case i.SOLIDUS:{this._leaveAttrValue(),this.state=o.SELF_CLOSING_START_TAG;break}case i.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=o.DATA,this.emitCurrentTagToken();break}case i.EOF:{this._err(u.eofInTag),this._emitEOFToken();break}default:this._err(u.missingWhitespaceBetweenAttributes),this.state=o.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateSelfClosingStartTag(t){switch(t){case i.GREATER_THAN_SIGN:{let s=this.currentToken;s.selfClosing=!0,this.state=o.DATA,this.emitCurrentTagToken();break}case i.EOF:{this._err(u.eofInTag),this._emitEOFToken();break}default:this._err(u.unexpectedSolidusInTag),this.state=o.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateBogusComment(t){let s=this.currentToken;switch(t){case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentComment(s);break}case i.EOF:{this.emitCurrentComment(s),this._emitEOFToken();break}case i.NULL:{this._err(u.unexpectedNullCharacter),s.data+=D;break}default:s.data+=String.fromCodePoint(t)}}_stateMarkupDeclarationOpen(t){this._consumeSequenceIfMatch(k.DASH_DASH,!0)?(this._createCommentToken(k.DASH_DASH.length+1),this.state=o.COMMENT_START):this._consumeSequenceIfMatch(k.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(k.DOCTYPE.length+1),this.state=o.DOCTYPE):this._consumeSequenceIfMatch(k.CDATA_START,!0)?this.inForeignNode?this.state=o.CDATA_SECTION:(this._err(u.cdataInHtmlContent),this._createCommentToken(k.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=o.BOGUS_COMMENT):this._ensureHibernation()||(this._err(u.incorrectlyOpenedComment),this._createCommentToken(2),this.state=o.BOGUS_COMMENT,this._stateBogusComment(t))}_stateCommentStart(t){switch(t){case i.HYPHEN_MINUS:{this.state=o.COMMENT_START_DASH;break}case i.GREATER_THAN_SIGN:{this._err(u.abruptClosingOfEmptyComment),this.state=o.DATA;let s=this.currentToken;this.emitCurrentComment(s);break}default:this.state=o.COMMENT,this._stateComment(t)}}_stateCommentStartDash(t){let s=this.currentToken;switch(t){case i.HYPHEN_MINUS:{this.state=o.COMMENT_END;break}case i.GREATER_THAN_SIGN:{this._err(u.abruptClosingOfEmptyComment),this.state=o.DATA,this.emitCurrentComment(s);break}case i.EOF:{this._err(u.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="-",this.state=o.COMMENT,this._stateComment(t)}}_stateComment(t){let s=this.currentToken;switch(t){case i.HYPHEN_MINUS:{this.state=o.COMMENT_END_DASH;break}case i.LESS_THAN_SIGN:{s.data+="<",this.state=o.COMMENT_LESS_THAN_SIGN;break}case i.NULL:{this._err(u.unexpectedNullCharacter),s.data+=D;break}case i.EOF:{this._err(u.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+=String.fromCodePoint(t)}}_stateCommentLessThanSign(t){let s=this.currentToken;switch(t){case i.EXCLAMATION_MARK:{s.data+="!",this.state=o.COMMENT_LESS_THAN_SIGN_BANG;break}case i.LESS_THAN_SIGN:{s.data+="<";break}default:this.state=o.COMMENT,this._stateComment(t)}}_stateCommentLessThanSignBang(t){t===i.HYPHEN_MINUS?this.state=o.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=o.COMMENT,this._stateComment(t))}_stateCommentLessThanSignBangDash(t){t===i.HYPHEN_MINUS?this.state=o.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=o.COMMENT_END_DASH,this._stateCommentEndDash(t))}_stateCommentLessThanSignBangDashDash(t){t!==i.GREATER_THAN_SIGN&&t!==i.EOF&&this._err(u.nestedComment),this.state=o.COMMENT_END,this._stateCommentEnd(t)}_stateCommentEndDash(t){let s=this.currentToken;switch(t){case i.HYPHEN_MINUS:{this.state=o.COMMENT_END;break}case i.EOF:{this._err(u.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="-",this.state=o.COMMENT,this._stateComment(t)}}_stateCommentEnd(t){let s=this.currentToken;switch(t){case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentComment(s);break}case i.EXCLAMATION_MARK:{this.state=o.COMMENT_END_BANG;break}case i.HYPHEN_MINUS:{s.data+="-";break}case i.EOF:{this._err(u.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="--",this.state=o.COMMENT,this._stateComment(t)}}_stateCommentEndBang(t){let s=this.currentToken;switch(t){case i.HYPHEN_MINUS:{s.data+="--!",this.state=o.COMMENT_END_DASH;break}case i.GREATER_THAN_SIGN:{this._err(u.incorrectlyClosedComment),this.state=o.DATA,this.emitCurrentComment(s);break}case i.EOF:{this._err(u.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="--!",this.state=o.COMMENT,this._stateComment(t)}}_stateDoctype(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=o.BEFORE_DOCTYPE_NAME;break}case i.GREATER_THAN_SIGN:{this.state=o.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t);break}case i.EOF:{this._err(u.eofInDoctype),this._createDoctypeToken(null);let s=this.currentToken;s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(u.missingWhitespaceBeforeDoctypeName),this.state=o.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t)}}_stateBeforeDoctypeName(t){if(be(t))this._createDoctypeToken(String.fromCharCode(ft(t))),this.state=o.DOCTYPE_NAME;else switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.NULL:{this._err(u.unexpectedNullCharacter),this._createDoctypeToken(D),this.state=o.DOCTYPE_NAME;break}case i.GREATER_THAN_SIGN:{this._err(u.missingDoctypeName),this._createDoctypeToken(null);let s=this.currentToken;s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.EOF:{this._err(u.eofInDoctype),this._createDoctypeToken(null);let s=this.currentToken;s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(t)),this.state=o.DOCTYPE_NAME}}_stateDoctypeName(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=o.AFTER_DOCTYPE_NAME;break}case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.NULL:{this._err(u.unexpectedNullCharacter),s.name+=D;break}case i.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.name+=String.fromCodePoint(be(t)?ft(t):t)}}_stateAfterDoctypeName(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(k.PUBLIC,!1)?this.state=o.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(k.SYSTEM,!1)?this.state=o.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(u.invalidCharacterSequenceAfterDoctypeName),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t))}}_stateAfterDoctypePublicKeyword(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=o.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case i.QUOTATION_MARK:{this._err(u.missingWhitespaceAfterDoctypePublicKeyword),s.publicId="",this.state=o.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{this._err(u.missingWhitespaceAfterDoctypePublicKeyword),s.publicId="",this.state=o.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(u.missingDoctypePublicIdentifier),s.forceQuirks=!0,this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(u.missingQuoteBeforeDoctypePublicIdentifier),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypePublicIdentifier(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.QUOTATION_MARK:{s.publicId="",this.state=o.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{s.publicId="",this.state=o.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(u.missingDoctypePublicIdentifier),s.forceQuirks=!0,this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(u.missingQuoteBeforeDoctypePublicIdentifier),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypePublicIdentifierDoubleQuoted(t){let s=this.currentToken;switch(t){case i.QUOTATION_MARK:{this.state=o.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case i.NULL:{this._err(u.unexpectedNullCharacter),s.publicId+=D;break}case i.GREATER_THAN_SIGN:{this._err(u.abruptDoctypePublicIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.publicId+=String.fromCodePoint(t)}}_stateDoctypePublicIdentifierSingleQuoted(t){let s=this.currentToken;switch(t){case i.APOSTROPHE:{this.state=o.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case i.NULL:{this._err(u.unexpectedNullCharacter),s.publicId+=D;break}case i.GREATER_THAN_SIGN:{this._err(u.abruptDoctypePublicIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.publicId+=String.fromCodePoint(t)}}_stateAfterDoctypePublicIdentifier(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=o.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.QUOTATION_MARK:{this._err(u.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{this._err(u.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case i.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(u.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBetweenDoctypePublicAndSystemIdentifiers(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.GREATER_THAN_SIGN:{this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.QUOTATION_MARK:{s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case i.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(u.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateAfterDoctypeSystemKeyword(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=o.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case i.QUOTATION_MARK:{this._err(u.missingWhitespaceAfterDoctypeSystemKeyword),s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{this._err(u.missingWhitespaceAfterDoctypeSystemKeyword),s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(u.missingDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(u.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypeSystemIdentifier(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.QUOTATION_MARK:{s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(u.missingDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(u.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypeSystemIdentifierDoubleQuoted(t){let s=this.currentToken;switch(t){case i.QUOTATION_MARK:{this.state=o.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case i.NULL:{this._err(u.unexpectedNullCharacter),s.systemId+=D;break}case i.GREATER_THAN_SIGN:{this._err(u.abruptDoctypeSystemIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.systemId+=String.fromCodePoint(t)}}_stateDoctypeSystemIdentifierSingleQuoted(t){let s=this.currentToken;switch(t){case i.APOSTROPHE:{this.state=o.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case i.NULL:{this._err(u.unexpectedNullCharacter),s.systemId+=D;break}case i.GREATER_THAN_SIGN:{this._err(u.abruptDoctypeSystemIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.systemId+=String.fromCodePoint(t)}}_stateAfterDoctypeSystemIdentifier(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.GREATER_THAN_SIGN:{this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(u.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBogusDoctype(t){let s=this.currentToken;switch(t){case i.GREATER_THAN_SIGN:{this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.NULL:{this._err(u.unexpectedNullCharacter);break}case i.EOF:{this.emitCurrentDoctype(s),this._emitEOFToken();break}default:}}_stateCdataSection(t){switch(t){case i.RIGHT_SQUARE_BRACKET:{this.state=o.CDATA_SECTION_BRACKET;break}case i.EOF:{this._err(u.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateCdataSectionBracket(t){t===i.RIGHT_SQUARE_BRACKET?this.state=o.CDATA_SECTION_END:(this._emitChars("]"),this.state=o.CDATA_SECTION,this._stateCdataSection(t))}_stateCdataSectionEnd(t){switch(t){case i.GREATER_THAN_SIGN:{this.state=o.DATA;break}case i.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=o.CDATA_SECTION,this._stateCdataSection(t)}}_stateCharacterReference(){let t=this.entityDecoder.write(this.preprocessor.html,this.preprocessor.pos);if(t<0)if(this.preprocessor.lastChunkWritten)t=this.entityDecoder.end();else{this.active=!1,this.preprocessor.pos=this.preprocessor.html.length-1,this.consumedAfterSnapshot=0,this.preprocessor.endOfChunkHit=!0;return}t===0?(this.preprocessor.pos=this.entityStartPos,this._flushCodePointConsumedAsCharacterReference(i.AMPERSAND),this.state=!this._isCharacterReferenceInAttribute()&&Br(this.preprocessor.peek(1))?o.AMBIGUOUS_AMPERSAND:this.returnState):this.state=this.returnState}_stateAmbiguousAmpersand(t){Br(t)?this._flushCodePointConsumedAsCharacterReference(t):(t===i.SEMICOLON&&this._err(u.unknownNamedCharacterReference),this.state=this.returnState,this._callState(t))}};var yr=new Set([r.DD,r.DT,r.LI,r.OPTGROUP,r.OPTION,r.P,r.RB,r.RP,r.RT,r.RTC]),Fr=new Set([...yr,r.CAPTION,r.COLGROUP,r.TBODY,r.TD,r.TFOOT,r.TH,r.THEAD,r.TR]),_t=new Set([r.APPLET,r.CAPTION,r.HTML,r.MARQUEE,r.OBJECT,r.TABLE,r.TD,r.TEMPLATE,r.TH]),Di=new Set([..._t,r.OL,r.UL]),bi=new Set([..._t,r.BUTTON]),xr=new Set([r.ANNOTATION_XML,r.MI,r.MN,r.MO,r.MS,r.MTEXT]),Hr=new Set([r.DESC,r.FOREIGN_OBJECT,r.TITLE]),Pi=new Set([r.TR,r.TEMPLATE,r.HTML]),Mi=new Set([r.TBODY,r.TFOOT,r.THEAD,r.TEMPLATE,r.HTML]),Bi=new Set([r.TABLE,r.TEMPLATE,r.HTML]),ki=new Set([r.TD,r.TH]),At=class{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(t,s,n){this.treeAdapter=s,this.handler=n,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=r.UNKNOWN,this.current=t}_indexOf(t){return this.items.lastIndexOf(t,this.stackTop)}_isInTemplate(){return this.currentTagId===r.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===m.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(t,s){this.stackTop++,this.items[this.stackTop]=t,this.current=t,this.tagIDs[this.stackTop]=s,this.currentTagId=s,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(t,s,!0)}pop(){let t=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!0)}replace(t,s){let n=this._indexOf(t);this.items[n]=s,n===this.stackTop&&(this.current=s)}insertAfter(t,s,n){let a=this._indexOf(t)+1;this.items.splice(a,0,s),this.tagIDs.splice(a,0,n),this.stackTop++,a===this.stackTop&&this._updateCurrentElement(),this.handler.onItemPush(this.current,this.currentTagId,a===this.stackTop)}popUntilTagNamePopped(t){let s=this.stackTop+1;do s=this.tagIDs.lastIndexOf(t,s-1);while(s>0&&this.treeAdapter.getNamespaceURI(this.items[s])!==m.HTML);this.shortenToLength(s<0?0:s)}shortenToLength(t){for(;this.stackTop>=t;){let s=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(s,this.stackTop<t)}}popUntilElementPopped(t){let s=this._indexOf(t);this.shortenToLength(s<0?0:s)}popUntilPopped(t,s){let n=this._indexOfTagNames(t,s);this.shortenToLength(n<0?0:n)}popUntilNumberedHeaderPopped(){this.popUntilPopped(de,m.HTML)}popUntilTableCellPopped(){this.popUntilPopped(ki,m.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(t,s){for(let n=this.stackTop;n>=0;n--)if(t.has(this.tagIDs[n])&&this.treeAdapter.getNamespaceURI(this.items[n])===s)return n;return-1}clearBackTo(t,s){let n=this._indexOfTagNames(t,s);this.shortenToLength(n+1)}clearBackToTableContext(){this.clearBackTo(Bi,m.HTML)}clearBackToTableBodyContext(){this.clearBackTo(Mi,m.HTML)}clearBackToTableRowContext(){this.clearBackTo(Pi,m.HTML)}remove(t){let s=this._indexOf(t);s>=0&&(s===this.stackTop?this.pop():(this.items.splice(s,1),this.tagIDs.splice(s,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===r.BODY?this.items[1]:null}contains(t){return this._indexOf(t)>-1}getCommonAncestor(t){let s=this._indexOf(t)-1;return s>=0?this.items[s]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===r.HTML}hasInDynamicScope(t,s){for(let n=this.stackTop;n>=0;n--){let a=this.tagIDs[n];switch(this.treeAdapter.getNamespaceURI(this.items[n])){case m.HTML:{if(a===t)return!0;if(s.has(a))return!1;break}case m.SVG:{if(Hr.has(a))return!1;break}case m.MATHML:{if(xr.has(a))return!1;break}}}return!0}hasInScope(t){return this.hasInDynamicScope(t,_t)}hasInListItemScope(t){return this.hasInDynamicScope(t,Di)}hasInButtonScope(t){return this.hasInDynamicScope(t,bi)}hasNumberedHeaderInScope(){for(let t=this.stackTop;t>=0;t--){let s=this.tagIDs[t];switch(this.treeAdapter.getNamespaceURI(this.items[t])){case m.HTML:{if(de.has(s))return!0;if(_t.has(s))return!1;break}case m.SVG:{if(Hr.has(s))return!1;break}case m.MATHML:{if(xr.has(s))return!1;break}}}return!0}hasInTableScope(t){for(let s=this.stackTop;s>=0;s--)if(this.treeAdapter.getNamespaceURI(this.items[s])===m.HTML)switch(this.tagIDs[s]){case t:return!0;case r.TABLE:case r.HTML:return!1}return!0}hasTableBodyContextInTableScope(){for(let t=this.stackTop;t>=0;t--)if(this.treeAdapter.getNamespaceURI(this.items[t])===m.HTML)switch(this.tagIDs[t]){case r.TBODY:case r.THEAD:case r.TFOOT:return!0;case r.TABLE:case r.HTML:return!1}return!0}hasInSelectScope(t){for(let s=this.stackTop;s>=0;s--)if(this.treeAdapter.getNamespaceURI(this.items[s])===m.HTML)switch(this.tagIDs[s]){case t:return!0;case r.OPTION:case r.OPTGROUP:break;default:return!1}return!0}generateImpliedEndTags(){for(;yr.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;Fr.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(t){for(;this.currentTagId!==t&&Fr.has(this.currentTagId);)this.pop()}};var v;(function(e){e[e.Marker=0]="Marker",e[e.Element=1]="Element"})(v||(v={}));var wr={type:v.Marker},pt=class{constructor(t){this.treeAdapter=t,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(t,s){let n=[],a=s.length,c=this.treeAdapter.getTagName(t),E=this.treeAdapter.getNamespaceURI(t);for(let T=0;T<this.entries.length;T++){let d=this.entries[T];if(d.type===v.Marker)break;let{element:A}=d;if(this.treeAdapter.getTagName(A)===c&&this.treeAdapter.getNamespaceURI(A)===E){let _=this.treeAdapter.getAttrList(A);_.length===a&&n.push({idx:T,attrs:_})}}return n}_ensureNoahArkCondition(t){if(this.entries.length<3)return;let s=this.treeAdapter.getAttrList(t),n=this._getNoahArkConditionCandidates(t,s);if(n.length<3)return;let a=new Map(s.map(E=>[E.name,E.value])),c=0;for(let E=0;E<n.length;E++){let T=n[E];T.attrs.every(d=>a.get(d.name)===d.value)&&(c+=1,c>=3&&this.entries.splice(T.idx,1))}}insertMarker(){this.entries.unshift(wr)}pushElement(t,s){this._ensureNoahArkCondition(t),this.entries.unshift({type:v.Element,element:t,token:s})}insertElementAfterBookmark(t,s){let n=this.entries.indexOf(this.bookmark);this.entries.splice(n,0,{type:v.Element,element:t,token:s})}removeEntry(t){let s=this.entries.indexOf(t);s>=0&&this.entries.splice(s,1)}clearToLastMarker(){let t=this.entries.indexOf(wr);t>=0?this.entries.splice(0,t+1):this.entries.length=0}getElementEntryInScopeWithTagName(t){let s=this.entries.find(n=>n.type===v.Marker||this.treeAdapter.getTagName(n.element)===t);return s&&s.type===v.Element?s:null}getElementEntry(t){return this.entries.find(s=>s.type===v.Element&&s.element===t)}};var y={createDocument(){return{nodeName:"#document",mode:P.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(e,t,s){return{nodeName:e,tagName:e,attrs:s,namespaceURI:t,childNodes:[],parentNode:null}},createCommentNode(e){return{nodeName:"#comment",data:e,parentNode:null}},createTextNode(e){return{nodeName:"#text",value:e,parentNode:null}},appendChild(e,t){e.childNodes.push(t),t.parentNode=e},insertBefore(e,t,s){let n=e.childNodes.indexOf(s);e.childNodes.splice(n,0,t),t.parentNode=e},setTemplateContent(e,t){e.content=t},getTemplateContent(e){return e.content},setDocumentType(e,t,s,n){let a=e.childNodes.find(c=>c.nodeName==="#documentType");if(a)a.name=t,a.publicId=s,a.systemId=n;else{let c={nodeName:"#documentType",name:t,publicId:s,systemId:n,parentNode:null};y.appendChild(e,c)}},setDocumentMode(e,t){e.mode=t},getDocumentMode(e){return e.mode},detachNode(e){if(e.parentNode){let t=e.parentNode.childNodes.indexOf(e);e.parentNode.childNodes.splice(t,1),e.parentNode=null}},insertText(e,t){if(e.childNodes.length>0){let s=e.childNodes[e.childNodes.length-1];if(y.isTextNode(s)){s.value+=t;return}}y.appendChild(e,y.createTextNode(t))},insertTextBefore(e,t,s){let n=e.childNodes[e.childNodes.indexOf(s)-1];n&&y.isTextNode(n)?n.value+=t:y.insertBefore(e,y.createTextNode(t),s)},adoptAttributes(e,t){let s=new Set(e.attrs.map(n=>n.name));for(let n=0;n<t.length;n++)s.has(t[n].name)||e.attrs.push(t[n])},getFirstChild(e){return e.childNodes[0]},getChildNodes(e){return e.childNodes},getParentNode(e){return e.parentNode},getAttrList(e){return e.attrs},getTagName(e){return e.tagName},getNamespaceURI(e){return e.namespaceURI},getTextNodeContent(e){return e.value},getCommentNodeContent(e){return e.data},getDocumentTypeNodeName(e){return e.name},getDocumentTypeNodePublicId(e){return e.publicId},getDocumentTypeNodeSystemId(e){return e.systemId},isTextNode(e){return e.nodeName==="#text"},isCommentNode(e){return e.nodeName==="#comment"},isDocumentTypeNode(e){return e.nodeName==="#documentType"},isElementNode(e){return Object.prototype.hasOwnProperty.call(e,"tagName")},setNodeSourceCodeLocation(e,t){e.sourceCodeLocation=t},getNodeSourceCodeLocation(e){return e.sourceCodeLocation},updateNodeSourceCodeLocation(e,t){e.sourceCodeLocation={...e.sourceCodeLocation,...t}}};var Yr="html",Ui="about:legacy-compat",Fi="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",Wr=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],xi=[...Wr,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],Hi=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),Qr=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],yi=[...Qr,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function vr(e,t){return t.some(s=>e.startsWith(s))}function Gr(e){return e.name===Yr&&e.publicId===null&&(e.systemId===null||e.systemId===Ui)}function Kr(e){if(e.name!==Yr)return P.QUIRKS;let{systemId:t}=e;if(t&&t.toLowerCase()===Fi)return P.QUIRKS;let{publicId:s}=e;if(s!==null){if(s=s.toLowerCase(),Hi.has(s))return P.QUIRKS;let n=t===null?xi:Wr;if(vr(s,n))return P.QUIRKS;if(n=t===null?Qr:yi,vr(s,n))return P.LIMITED_QUIRKS}return P.NO_QUIRKS}var Nt={};K(Nt,{SVG_TAG_NAMES_ADJUSTMENT_MAP:()=>Vr,adjustTokenMathMLAttrs:()=>It,adjustTokenSVGAttrs:()=>Ct,adjustTokenSVGTagName:()=>cs,adjustTokenXMLAttrs:()=>Me,causesExit:()=>os,isIntegrationPoint:()=>ls});var Xr={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},vi="definitionurl",Yi="definitionURL",Wi=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(e=>[e.toLowerCase(),e])),Qi=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:m.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:m.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:m.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:m.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:m.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:m.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:m.XLINK}],["xml:lang",{prefix:"xml",name:"lang",namespace:m.XML}],["xml:space",{prefix:"xml",name:"space",namespace:m.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:m.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:m.XMLNS}]]),Vr=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(e=>[e.toLowerCase(),e])),Gi=new Set([r.B,r.BIG,r.BLOCKQUOTE,r.BODY,r.BR,r.CENTER,r.CODE,r.DD,r.DIV,r.DL,r.DT,r.EM,r.EMBED,r.H1,r.H2,r.H3,r.H4,r.H5,r.H6,r.HEAD,r.HR,r.I,r.IMG,r.LI,r.LISTING,r.MENU,r.META,r.NOBR,r.OL,r.P,r.PRE,r.RUBY,r.S,r.SMALL,r.SPAN,r.STRONG,r.STRIKE,r.SUB,r.SUP,r.TABLE,r.TT,r.U,r.UL,r.VAR]);function os(e){let t=e.tagID;return t===r.FONT&&e.attrs.some(({name:n})=>n===G.COLOR||n===G.SIZE||n===G.FACE)||Gi.has(t)}function It(e){for(let t=0;t<e.attrs.length;t++)if(e.attrs[t].name===vi){e.attrs[t].name=Yi;break}}function Ct(e){for(let t=0;t<e.attrs.length;t++){let s=Wi.get(e.attrs[t].name);s!=null&&(e.attrs[t].name=s)}}function Me(e){for(let t=0;t<e.attrs.length;t++){let s=Qi.get(e.attrs[t].name);s&&(e.attrs[t].prefix=s.prefix,e.attrs[t].name=s.name,e.attrs[t].namespace=s.namespace)}}function cs(e){let t=Vr.get(e.tagName);t!=null&&(e.tagName=t,e.tagID=ee(e.tagName))}function Ki(e,t){return t===m.MATHML&&(e===r.MI||e===r.MO||e===r.MN||e===r.MS||e===r.MTEXT)}function Xi(e,t,s){if(t===m.MATHML&&e===r.ANNOTATION_XML){for(let n=0;n<s.length;n++)if(s[n].name===G.ENCODING){let a=s[n].value.toLowerCase();return a===Xr.TEXT_HTML||a===Xr.APPLICATION_XML}}return t===m.SVG&&(e===r.FOREIGN_OBJECT||e===r.DESC||e===r.TITLE)}function ls(e,t,s,n){return(!n||n===m.HTML)&&Xi(e,t,s)||(!n||n===m.MATHML)&&Ki(e,t)}var Vi="hidden",ji=8,qi=3,l;(function(e){e[e.INITIAL=0]="INITIAL",e[e.BEFORE_HTML=1]="BEFORE_HTML",e[e.BEFORE_HEAD=2]="BEFORE_HEAD",e[e.IN_HEAD=3]="IN_HEAD",e[e.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",e[e.AFTER_HEAD=5]="AFTER_HEAD",e[e.IN_BODY=6]="IN_BODY",e[e.TEXT=7]="TEXT",e[e.IN_TABLE=8]="IN_TABLE",e[e.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",e[e.IN_CAPTION=10]="IN_CAPTION",e[e.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",e[e.IN_TABLE_BODY=12]="IN_TABLE_BODY",e[e.IN_ROW=13]="IN_ROW",e[e.IN_CELL=14]="IN_CELL",e[e.IN_SELECT=15]="IN_SELECT",e[e.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",e[e.IN_TEMPLATE=17]="IN_TEMPLATE",e[e.AFTER_BODY=18]="AFTER_BODY",e[e.IN_FRAMESET=19]="IN_FRAMESET",e[e.AFTER_FRAMESET=20]="AFTER_FRAMESET",e[e.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",e[e.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(l||(l={}));var zi={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},$r=new Set([r.TABLE,r.TBODY,r.TFOOT,r.THEAD,r.TR]),jr={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:y,onParseError:null},me=class{constructor(t,s,n=null,a=null){this.fragmentContext=n,this.scriptHandler=a,this.currentToken=null,this.stopped=!1,this.insertionMode=l.INITIAL,this.originalInsertionMode=l.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...jr,...t},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=s!=null?s:this.treeAdapter.createDocument(),this.tokenizer=new Pe(this.options,this),this.activeFormattingElements=new pt(this.treeAdapter),this.fragmentContextID=n?ee(this.treeAdapter.getTagName(n)):r.UNKNOWN,this._setContextModes(n!=null?n:this.document,this.fragmentContextID),this.openElements=new At(this.document,this.treeAdapter,this)}static parse(t,s){let n=new this(s);return n.tokenizer.write(t,!0),n.document}static getFragmentParser(t,s){let n={...jr,...s};t!=null||(t=n.treeAdapter.createElement(h.TEMPLATE,m.HTML,[]));let a=n.treeAdapter.createElement("documentmock",m.HTML,[]),c=new this(n,a,t);return c.fragmentContextID===r.TEMPLATE&&c.tmplInsertionModeStack.unshift(l.IN_TEMPLATE),c._initTokenizerForFragmentParsing(),c._insertFakeRootElement(),c._resetInsertionMode(),c._findFormInFragmentContext(),c}getFragment(){let t=this.treeAdapter.getFirstChild(this.document),s=this.treeAdapter.createDocumentFragment();return this._adoptNodes(t,s),s}_err(t,s,n){var a;if(!this.onParseError)return;let c=(a=t.location)!==null&&a!==void 0?a:zi,E={code:s,startLine:c.startLine,startCol:c.startCol,startOffset:c.startOffset,endLine:n?c.startLine:c.endLine,endCol:n?c.startCol:c.endCol,endOffset:n?c.startOffset:c.endOffset};this.onParseError(E)}onItemPush(t,s,n){var a,c;(c=(a=this.treeAdapter).onItemPush)===null||c===void 0||c.call(a,t),n&&this.openElements.stackTop>0&&this._setContextModes(t,s)}onItemPop(t,s){var n,a;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(t,this.currentToken),(a=(n=this.treeAdapter).onItemPop)===null||a===void 0||a.call(n,t,this.openElements.current),s){let c,E;this.openElements.stackTop===0&&this.fragmentContext?(c=this.fragmentContext,E=this.fragmentContextID):{current:c,currentTagId:E}=this.openElements,this._setContextModes(c,E)}}_setContextModes(t,s){let n=t===this.document||this.treeAdapter.getNamespaceURI(t)===m.HTML;this.currentNotInHTML=!n,this.tokenizer.inForeignNode=!n&&!this._isIntegrationPoint(s,t)}_switchToTextParsing(t,s){this._insertElement(t,m.HTML),this.tokenizer.state=s,this.originalInsertionMode=this.insertionMode,this.insertionMode=l.TEXT}switchToPlaintextParsing(){this.insertionMode=l.TEXT,this.originalInsertionMode=l.IN_BODY,this.tokenizer.state=M.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let t=this.fragmentContext;for(;t;){if(this.treeAdapter.getTagName(t)===h.FORM){this.formElement=t;break}t=this.treeAdapter.getParentNode(t)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==m.HTML))switch(this.fragmentContextID){case r.TITLE:case r.TEXTAREA:{this.tokenizer.state=M.RCDATA;break}case r.STYLE:case r.XMP:case r.IFRAME:case r.NOEMBED:case r.NOFRAMES:case r.NOSCRIPT:{this.tokenizer.state=M.RAWTEXT;break}case r.SCRIPT:{this.tokenizer.state=M.SCRIPT_DATA;break}case r.PLAINTEXT:{this.tokenizer.state=M.PLAINTEXT;break}default:}}_setDocumentType(t){let s=t.name||"",n=t.publicId||"",a=t.systemId||"";if(this.treeAdapter.setDocumentType(this.document,s,n,a),t.location){let E=this.treeAdapter.getChildNodes(this.document).find(T=>this.treeAdapter.isDocumentTypeNode(T));E&&this.treeAdapter.setNodeSourceCodeLocation(E,t.location)}}_attachElementToTree(t,s){if(this.options.sourceCodeLocationInfo){let n=s&&{...s,startTag:s};this.treeAdapter.setNodeSourceCodeLocation(t,n)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(t);else{let n=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(n,t)}}_appendElement(t,s){let n=this.treeAdapter.createElement(t.tagName,s,t.attrs);this._attachElementToTree(n,t.location)}_insertElement(t,s){let n=this.treeAdapter.createElement(t.tagName,s,t.attrs);this._attachElementToTree(n,t.location),this.openElements.push(n,t.tagID)}_insertFakeElement(t,s){let n=this.treeAdapter.createElement(t,m.HTML,[]);this._attachElementToTree(n,null),this.openElements.push(n,s)}_insertTemplate(t){let s=this.treeAdapter.createElement(t.tagName,m.HTML,t.attrs),n=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(s,n),this._attachElementToTree(s,t.location),this.openElements.push(s,t.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,null)}_insertFakeRootElement(){let t=this.treeAdapter.createElement(h.HTML,m.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(t,null),this.treeAdapter.appendChild(this.openElements.current,t),this.openElements.push(t,r.HTML)}_appendCommentNode(t,s){let n=this.treeAdapter.createCommentNode(t.data);this.treeAdapter.appendChild(s,n),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,t.location)}_insertCharacters(t){let s,n;if(this._shouldFosterParentOnInsertion()?({parent:s,beforeElement:n}=this._findFosterParentingLocation(),n?this.treeAdapter.insertTextBefore(s,t.chars,n):this.treeAdapter.insertText(s,t.chars)):(s=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(s,t.chars)),!t.location)return;let a=this.treeAdapter.getChildNodes(s),c=n?a.lastIndexOf(n):a.length,E=a[c-1];if(this.treeAdapter.getNodeSourceCodeLocation(E)){let{endLine:d,endCol:A,endOffset:_}=t.location;this.treeAdapter.updateNodeSourceCodeLocation(E,{endLine:d,endCol:A,endOffset:_})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(E,t.location)}_adoptNodes(t,s){for(let n=this.treeAdapter.getFirstChild(t);n;n=this.treeAdapter.getFirstChild(t))this.treeAdapter.detachNode(n),this.treeAdapter.appendChild(s,n)}_setEndLocation(t,s){if(this.treeAdapter.getNodeSourceCodeLocation(t)&&s.location){let n=s.location,a=this.treeAdapter.getTagName(t),c=s.type===O.END_TAG&&a===s.tagName?{endTag:{...n},endLine:n.endLine,endCol:n.endCol,endOffset:n.endOffset}:{endLine:n.startLine,endCol:n.startCol,endOffset:n.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(t,c)}}shouldProcessStartTagTokenInForeignContent(t){if(!this.currentNotInHTML)return!1;let s,n;return this.openElements.stackTop===0&&this.fragmentContext?(s=this.fragmentContext,n=this.fragmentContextID):{current:s,currentTagId:n}=this.openElements,t.tagID===r.SVG&&this.treeAdapter.getTagName(s)===h.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(s)===m.MATHML?!1:this.tokenizer.inForeignNode||(t.tagID===r.MGLYPH||t.tagID===r.MALIGNMARK)&&!this._isIntegrationPoint(n,s,m.HTML)}_processToken(t){switch(t.type){case O.CHARACTER:{this.onCharacter(t);break}case O.NULL_CHARACTER:{this.onNullCharacter(t);break}case O.COMMENT:{this.onComment(t);break}case O.DOCTYPE:{this.onDoctype(t);break}case O.START_TAG:{this._processStartTag(t);break}case O.END_TAG:{this.onEndTag(t);break}case O.EOF:{this.onEof(t);break}case O.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(t);break}}}_isIntegrationPoint(t,s,n){let a=this.treeAdapter.getNamespaceURI(s),c=this.treeAdapter.getAttrList(s);return ls(t,a,c,n)}_reconstructActiveFormattingElements(){let t=this.activeFormattingElements.entries.length;if(t){let s=this.activeFormattingElements.entries.findIndex(a=>a.type===v.Marker||this.openElements.contains(a.element)),n=s<0?t-1:s-1;for(let a=n;a>=0;a--){let c=this.activeFormattingElements.entries[a];this._insertElement(c.token,this.treeAdapter.getNamespaceURI(c.element)),c.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=l.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(r.P),this.openElements.popUntilTagNamePopped(r.P)}_resetInsertionMode(){for(let t=this.openElements.stackTop;t>=0;t--)switch(t===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[t]){case r.TR:{this.insertionMode=l.IN_ROW;return}case r.TBODY:case r.THEAD:case r.TFOOT:{this.insertionMode=l.IN_TABLE_BODY;return}case r.CAPTION:{this.insertionMode=l.IN_CAPTION;return}case r.COLGROUP:{this.insertionMode=l.IN_COLUMN_GROUP;return}case r.TABLE:{this.insertionMode=l.IN_TABLE;return}case r.BODY:{this.insertionMode=l.IN_BODY;return}case r.FRAMESET:{this.insertionMode=l.IN_FRAMESET;return}case r.SELECT:{this._resetInsertionModeForSelect(t);return}case r.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case r.HTML:{this.insertionMode=this.headElement?l.AFTER_HEAD:l.BEFORE_HEAD;return}case r.TD:case r.TH:{if(t>0){this.insertionMode=l.IN_CELL;return}break}case r.HEAD:{if(t>0){this.insertionMode=l.IN_HEAD;return}break}}this.insertionMode=l.IN_BODY}_resetInsertionModeForSelect(t){if(t>0)for(let s=t-1;s>0;s--){let n=this.openElements.tagIDs[s];if(n===r.TEMPLATE)break;if(n===r.TABLE){this.insertionMode=l.IN_SELECT_IN_TABLE;return}}this.insertionMode=l.IN_SELECT}_isElementCausesFosterParenting(t){return $r.has(t)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let t=this.openElements.stackTop;t>=0;t--){let s=this.openElements.items[t];switch(this.openElements.tagIDs[t]){case r.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(s)===m.HTML)return{parent:this.treeAdapter.getTemplateContent(s),beforeElement:null};break}case r.TABLE:{let n=this.treeAdapter.getParentNode(s);return n?{parent:n,beforeElement:s}:{parent:this.openElements.items[t-1],beforeElement:null}}default:}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(t){let s=this._findFosterParentingLocation();s.beforeElement?this.treeAdapter.insertBefore(s.parent,t,s.beforeElement):this.treeAdapter.appendChild(s.parent,t)}_isSpecialElement(t,s){let n=this.treeAdapter.getNamespaceURI(t);return as[n].has(s)}onCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){Lc(this,t);return}switch(this.insertionMode){case l.INITIAL:{Be(this,t);break}case l.BEFORE_HTML:{Ue(this,t);break}case l.BEFORE_HEAD:{Fe(this,t);break}case l.IN_HEAD:{xe(this,t);break}case l.IN_HEAD_NO_SCRIPT:{He(this,t);break}case l.AFTER_HEAD:{ye(this,t);break}case l.IN_BODY:case l.IN_CAPTION:case l.IN_CELL:case l.IN_TEMPLATE:{Zr(this,t);break}case l.TEXT:case l.IN_SELECT:case l.IN_SELECT_IN_TABLE:{this._insertCharacters(t);break}case l.IN_TABLE:case l.IN_TABLE_BODY:case l.IN_ROW:{Es(this,t);break}case l.IN_TABLE_TEXT:{an(this,t);break}case l.IN_COLUMN_GROUP:{Ot(this,t);break}case l.AFTER_BODY:{St(this,t);break}case l.AFTER_AFTER_BODY:{gt(this,t);break}default:}}onNullCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){Rc(this,t);return}switch(this.insertionMode){case l.INITIAL:{Be(this,t);break}case l.BEFORE_HTML:{Ue(this,t);break}case l.BEFORE_HEAD:{Fe(this,t);break}case l.IN_HEAD:{xe(this,t);break}case l.IN_HEAD_NO_SCRIPT:{He(this,t);break}case l.AFTER_HEAD:{ye(this,t);break}case l.TEXT:{this._insertCharacters(t);break}case l.IN_TABLE:case l.IN_TABLE_BODY:case l.IN_ROW:{Es(this,t);break}case l.IN_COLUMN_GROUP:{Ot(this,t);break}case l.AFTER_BODY:{St(this,t);break}case l.AFTER_AFTER_BODY:{gt(this,t);break}default:}}onComment(t){if(this.skipNextNewLine=!1,this.currentNotInHTML){hs(this,t);return}switch(this.insertionMode){case l.INITIAL:case l.BEFORE_HTML:case l.BEFORE_HEAD:case l.IN_HEAD:case l.IN_HEAD_NO_SCRIPT:case l.AFTER_HEAD:case l.IN_BODY:case l.IN_TABLE:case l.IN_CAPTION:case l.IN_COLUMN_GROUP:case l.IN_TABLE_BODY:case l.IN_ROW:case l.IN_CELL:case l.IN_SELECT:case l.IN_SELECT_IN_TABLE:case l.IN_TEMPLATE:case l.IN_FRAMESET:case l.AFTER_FRAMESET:{hs(this,t);break}case l.IN_TABLE_TEXT:{ke(this,t);break}case l.AFTER_BODY:{ro(this,t);break}case l.AFTER_AFTER_BODY:case l.AFTER_AFTER_FRAMESET:{no(this,t);break}default:}}onDoctype(t){switch(this.skipNextNewLine=!1,this.insertionMode){case l.INITIAL:{ao(this,t);break}case l.BEFORE_HEAD:case l.IN_HEAD:case l.IN_HEAD_NO_SCRIPT:case l.AFTER_HEAD:{this._err(t,u.misplacedDoctype);break}case l.IN_TABLE_TEXT:{ke(this,t);break}default:}}onStartTag(t){this.skipNextNewLine=!1,this.currentToken=t,this._processStartTag(t),t.selfClosing&&!t.ackSelfClosing&&this._err(t,u.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(t){this.shouldProcessStartTagTokenInForeignContent(t)?Dc(this,t):this._startTagOutsideForeignContent(t)}_startTagOutsideForeignContent(t){switch(this.insertionMode){case l.INITIAL:{Be(this,t);break}case l.BEFORE_HTML:{io(this,t);break}case l.BEFORE_HEAD:{co(this,t);break}case l.IN_HEAD:{Y(this,t);break}case l.IN_HEAD_NO_SCRIPT:{ho(this,t);break}case l.AFTER_HEAD:{uo(this,t);break}case l.IN_BODY:{B(this,t);break}case l.IN_TABLE:{fe(this,t);break}case l.IN_TABLE_TEXT:{ke(this,t);break}case l.IN_CAPTION:{Ec(this,t);break}case l.IN_COLUMN_GROUP:{ms(this,t);break}case l.IN_TABLE_BODY:{Dt(this,t);break}case l.IN_ROW:{bt(this,t);break}case l.IN_CELL:{uc(this,t);break}case l.IN_SELECT:{ln(this,t);break}case l.IN_SELECT_IN_TABLE:{mc(this,t);break}case l.IN_TEMPLATE:{_c(this,t);break}case l.AFTER_BODY:{pc(this,t);break}case l.IN_FRAMESET:{Ic(this,t);break}case l.AFTER_FRAMESET:{Nc(this,t);break}case l.AFTER_AFTER_BODY:{Oc(this,t);break}case l.AFTER_AFTER_FRAMESET:{Sc(this,t);break}default:}}onEndTag(t){this.skipNextNewLine=!1,this.currentToken=t,this.currentNotInHTML?bc(this,t):this._endTagOutsideForeignContent(t)}_endTagOutsideForeignContent(t){switch(this.insertionMode){case l.INITIAL:{Be(this,t);break}case l.BEFORE_HTML:{oo(this,t);break}case l.BEFORE_HEAD:{lo(this,t);break}case l.IN_HEAD:{Eo(this,t);break}case l.IN_HEAD_NO_SCRIPT:{To(this,t);break}case l.AFTER_HEAD:{mo(this,t);break}case l.IN_BODY:{Lt(this,t);break}case l.TEXT:{ec(this,t);break}case l.IN_TABLE:{we(this,t);break}case l.IN_TABLE_TEXT:{ke(this,t);break}case l.IN_CAPTION:{hc(this,t);break}case l.IN_COLUMN_GROUP:{Tc(this,t);break}case l.IN_TABLE_BODY:{Ts(this,t);break}case l.IN_ROW:{cn(this,t);break}case l.IN_CELL:{dc(this,t);break}case l.IN_SELECT:{En(this,t);break}case l.IN_SELECT_IN_TABLE:{fc(this,t);break}case l.IN_TEMPLATE:{Ac(this,t);break}case l.AFTER_BODY:{Tn(this,t);break}case l.IN_FRAMESET:{Cc(this,t);break}case l.AFTER_FRAMESET:{gc(this,t);break}case l.AFTER_AFTER_BODY:{gt(this,t);break}default:}}onEof(t){switch(this.insertionMode){case l.INITIAL:{Be(this,t);break}case l.BEFORE_HTML:{Ue(this,t);break}case l.BEFORE_HEAD:{Fe(this,t);break}case l.IN_HEAD:{xe(this,t);break}case l.IN_HEAD_NO_SCRIPT:{He(this,t);break}case l.AFTER_HEAD:{ye(this,t);break}case l.IN_BODY:case l.IN_TABLE:case l.IN_CAPTION:case l.IN_COLUMN_GROUP:case l.IN_TABLE_BODY:case l.IN_ROW:case l.IN_CELL:case l.IN_SELECT:case l.IN_SELECT_IN_TABLE:{rn(this,t);break}case l.TEXT:{tc(this,t);break}case l.IN_TABLE_TEXT:{ke(this,t);break}case l.IN_TEMPLATE:{hn(this,t);break}case l.AFTER_BODY:case l.IN_FRAMESET:case l.AFTER_FRAMESET:case l.AFTER_AFTER_BODY:case l.AFTER_AFTER_FRAMESET:{ds(this,t);break}default:}}onWhitespaceCharacter(t){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,t.chars.charCodeAt(0)===i.LINE_FEED)){if(t.chars.length===1)return;t.chars=t.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(t);return}switch(this.insertionMode){case l.IN_HEAD:case l.IN_HEAD_NO_SCRIPT:case l.AFTER_HEAD:case l.TEXT:case l.IN_COLUMN_GROUP:case l.IN_SELECT:case l.IN_SELECT_IN_TABLE:case l.IN_FRAMESET:case l.AFTER_FRAMESET:{this._insertCharacters(t);break}case l.IN_BODY:case l.IN_CAPTION:case l.IN_CELL:case l.IN_TEMPLATE:case l.AFTER_BODY:case l.AFTER_AFTER_BODY:case l.AFTER_AFTER_FRAMESET:{Jr(this,t);break}case l.IN_TABLE:case l.IN_TABLE_BODY:case l.IN_ROW:{Es(this,t);break}case l.IN_TABLE_TEXT:{nn(this,t);break}default:}}};function $i(e,t){let s=e.activeFormattingElements.getElementEntryInScopeWithTagName(t.tagName);return s?e.openElements.contains(s.element)?e.openElements.hasInScope(t.tagID)||(s=null):(e.activeFormattingElements.removeEntry(s),s=null):sn(e,t),s}function Ji(e,t){let s=null,n=e.openElements.stackTop;for(;n>=0;n--){let a=e.openElements.items[n];if(a===t.element)break;e._isSpecialElement(a,e.openElements.tagIDs[n])&&(s=a)}return s||(e.openElements.shortenToLength(n<0?0:n),e.activeFormattingElements.removeEntry(t)),s}function Zi(e,t,s){let n=t,a=e.openElements.getCommonAncestor(t);for(let c=0,E=a;E!==s;c++,E=a){a=e.openElements.getCommonAncestor(E);let T=e.activeFormattingElements.getElementEntry(E),d=T&&c>=qi;!T||d?(d&&e.activeFormattingElements.removeEntry(T),e.openElements.remove(E)):(E=eo(e,T),n===t&&(e.activeFormattingElements.bookmark=T),e.treeAdapter.detachNode(n),e.treeAdapter.appendChild(E,n),n=E)}return n}function eo(e,t){let s=e.treeAdapter.getNamespaceURI(t.element),n=e.treeAdapter.createElement(t.token.tagName,s,t.token.attrs);return e.openElements.replace(t.element,n),t.element=n,n}function to(e,t,s){let n=e.treeAdapter.getTagName(t),a=ee(n);if(e._isElementCausesFosterParenting(a))e._fosterParentElement(s);else{let c=e.treeAdapter.getNamespaceURI(t);a===r.TEMPLATE&&c===m.HTML&&(t=e.treeAdapter.getTemplateContent(t)),e.treeAdapter.appendChild(t,s)}}function so(e,t,s){let n=e.treeAdapter.getNamespaceURI(s.element),{token:a}=s,c=e.treeAdapter.createElement(a.tagName,n,a.attrs);e._adoptNodes(t,c),e.treeAdapter.appendChild(t,c),e.activeFormattingElements.insertElementAfterBookmark(c,a),e.activeFormattingElements.removeEntry(s),e.openElements.remove(s.element),e.openElements.insertAfter(t,c,a.tagID)}function us(e,t){for(let s=0;s<ji;s++){let n=$i(e,t);if(!n)break;let a=Ji(e,n);if(!a)break;e.activeFormattingElements.bookmark=n;let c=Zi(e,a,n.element),E=e.openElements.getCommonAncestor(n.element);e.treeAdapter.detachNode(c),E&&to(e,E,c),so(e,a,n)}}function hs(e,t){e._appendCommentNode(t,e.openElements.currentTmplContentOrNode)}function ro(e,t){e._appendCommentNode(t,e.openElements.items[0])}function no(e,t){e._appendCommentNode(t,e.document)}function ds(e,t){if(e.stopped=!0,t.location){let s=e.fragmentContext?0:2;for(let n=e.openElements.stackTop;n>=s;n--)e._setEndLocation(e.openElements.items[n],t);if(!e.fragmentContext&&e.openElements.stackTop>=0){let n=e.openElements.items[0],a=e.treeAdapter.getNodeSourceCodeLocation(n);if(a&&!a.endTag&&(e._setEndLocation(n,t),e.openElements.stackTop>=1)){let c=e.openElements.items[1],E=e.treeAdapter.getNodeSourceCodeLocation(c);E&&!E.endTag&&e._setEndLocation(c,t)}}}}function ao(e,t){e._setDocumentType(t);let s=t.forceQuirks?P.QUIRKS:Kr(t);Gr(t)||e._err(t,u.nonConformingDoctype),e.treeAdapter.setDocumentMode(e.document,s),e.insertionMode=l.BEFORE_HTML}function Be(e,t){e._err(t,u.missingDoctype,!0),e.treeAdapter.setDocumentMode(e.document,P.QUIRKS),e.insertionMode=l.BEFORE_HTML,e._processToken(t)}function io(e,t){t.tagID===r.HTML?(e._insertElement(t,m.HTML),e.insertionMode=l.BEFORE_HEAD):Ue(e,t)}function oo(e,t){let s=t.tagID;(s===r.HTML||s===r.HEAD||s===r.BODY||s===r.BR)&&Ue(e,t)}function Ue(e,t){e._insertFakeRootElement(),e.insertionMode=l.BEFORE_HEAD,e._processToken(t)}function co(e,t){switch(t.tagID){case r.HTML:{B(e,t);break}case r.HEAD:{e._insertElement(t,m.HTML),e.headElement=e.openElements.current,e.insertionMode=l.IN_HEAD;break}default:Fe(e,t)}}function lo(e,t){let s=t.tagID;s===r.HEAD||s===r.BODY||s===r.HTML||s===r.BR?Fe(e,t):e._err(t,u.endTagWithoutMatchingOpenElement)}function Fe(e,t){e._insertFakeElement(h.HEAD,r.HEAD),e.headElement=e.openElements.current,e.insertionMode=l.IN_HEAD,e._processToken(t)}function Y(e,t){switch(t.tagID){case r.HTML:{B(e,t);break}case r.BASE:case r.BASEFONT:case r.BGSOUND:case r.LINK:case r.META:{e._appendElement(t,m.HTML),t.ackSelfClosing=!0;break}case r.TITLE:{e._switchToTextParsing(t,M.RCDATA);break}case r.NOSCRIPT:{e.options.scriptingEnabled?e._switchToTextParsing(t,M.RAWTEXT):(e._insertElement(t,m.HTML),e.insertionMode=l.IN_HEAD_NO_SCRIPT);break}case r.NOFRAMES:case r.STYLE:{e._switchToTextParsing(t,M.RAWTEXT);break}case r.SCRIPT:{e._switchToTextParsing(t,M.SCRIPT_DATA);break}case r.TEMPLATE:{e._insertTemplate(t),e.activeFormattingElements.insertMarker(),e.framesetOk=!1,e.insertionMode=l.IN_TEMPLATE,e.tmplInsertionModeStack.unshift(l.IN_TEMPLATE);break}case r.HEAD:{e._err(t,u.misplacedStartTagForHeadElement);break}default:xe(e,t)}}function Eo(e,t){switch(t.tagID){case r.HEAD:{e.openElements.pop(),e.insertionMode=l.AFTER_HEAD;break}case r.BODY:case r.BR:case r.HTML:{xe(e,t);break}case r.TEMPLATE:{ie(e,t);break}default:e._err(t,u.endTagWithoutMatchingOpenElement)}}function ie(e,t){e.openElements.tmplCount>0?(e.openElements.generateImpliedEndTagsThoroughly(),e.openElements.currentTagId!==r.TEMPLATE&&e._err(t,u.closingOfElementWithOpenChildElements),e.openElements.popUntilTagNamePopped(r.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode()):e._err(t,u.endTagWithoutMatchingOpenElement)}function xe(e,t){e.openElements.pop(),e.insertionMode=l.AFTER_HEAD,e._processToken(t)}function ho(e,t){switch(t.tagID){case r.HTML:{B(e,t);break}case r.BASEFONT:case r.BGSOUND:case r.HEAD:case r.LINK:case r.META:case r.NOFRAMES:case r.STYLE:{Y(e,t);break}case r.NOSCRIPT:{e._err(t,u.nestedNoscriptInHead);break}default:He(e,t)}}function To(e,t){switch(t.tagID){case r.NOSCRIPT:{e.openElements.pop(),e.insertionMode=l.IN_HEAD;break}case r.BR:{He(e,t);break}default:e._err(t,u.endTagWithoutMatchingOpenElement)}}function He(e,t){let s=t.type===O.EOF?u.openElementsLeftAfterEof:u.disallowedContentInNoscriptInHead;e._err(t,s),e.openElements.pop(),e.insertionMode=l.IN_HEAD,e._processToken(t)}function uo(e,t){switch(t.tagID){case r.HTML:{B(e,t);break}case r.BODY:{e._insertElement(t,m.HTML),e.framesetOk=!1,e.insertionMode=l.IN_BODY;break}case r.FRAMESET:{e._insertElement(t,m.HTML),e.insertionMode=l.IN_FRAMESET;break}case r.BASE:case r.BASEFONT:case r.BGSOUND:case r.LINK:case r.META:case r.NOFRAMES:case r.SCRIPT:case r.STYLE:case r.TEMPLATE:case r.TITLE:{e._err(t,u.abandonedHeadElementChild),e.openElements.push(e.headElement,r.HEAD),Y(e,t),e.openElements.remove(e.headElement);break}case r.HEAD:{e._err(t,u.misplacedStartTagForHeadElement);break}default:ye(e,t)}}function mo(e,t){switch(t.tagID){case r.BODY:case r.HTML:case r.BR:{ye(e,t);break}case r.TEMPLATE:{ie(e,t);break}default:e._err(t,u.endTagWithoutMatchingOpenElement)}}function ye(e,t){e._insertFakeElement(h.BODY,r.BODY),e.insertionMode=l.IN_BODY,Rt(e,t)}function Rt(e,t){switch(t.type){case O.CHARACTER:{Zr(e,t);break}case O.WHITESPACE_CHARACTER:{Jr(e,t);break}case O.COMMENT:{hs(e,t);break}case O.START_TAG:{B(e,t);break}case O.END_TAG:{Lt(e,t);break}case O.EOF:{rn(e,t);break}default:}}function Jr(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t)}function Zr(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t),e.framesetOk=!1}function fo(e,t){e.openElements.tmplCount===0&&e.treeAdapter.adoptAttributes(e.openElements.items[0],t.attrs)}function _o(e,t){let s=e.openElements.tryPeekProperlyNestedBodyElement();s&&e.openElements.tmplCount===0&&(e.framesetOk=!1,e.treeAdapter.adoptAttributes(s,t.attrs))}function Ao(e,t){let s=e.openElements.tryPeekProperlyNestedBodyElement();e.framesetOk&&s&&(e.treeAdapter.detachNode(s),e.openElements.popAllUpToHtmlElement(),e._insertElement(t,m.HTML),e.insertionMode=l.IN_FRAMESET)}function po(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,m.HTML)}function Io(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),de.has(e.openElements.currentTagId)&&e.openElements.pop(),e._insertElement(t,m.HTML)}function Co(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,m.HTML),e.skipNextNewLine=!0,e.framesetOk=!1}function No(e,t){let s=e.openElements.tmplCount>0;(!e.formElement||s)&&(e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,m.HTML),s||(e.formElement=e.openElements.current))}function go(e,t){e.framesetOk=!1;let s=t.tagID;for(let n=e.openElements.stackTop;n>=0;n--){let a=e.openElements.tagIDs[n];if(s===r.LI&&a===r.LI||(s===r.DD||s===r.DT)&&(a===r.DD||a===r.DT)){e.openElements.generateImpliedEndTagsWithExclusion(a),e.openElements.popUntilTagNamePopped(a);break}if(a!==r.ADDRESS&&a!==r.DIV&&a!==r.P&&e._isSpecialElement(e.openElements.items[n],a))break}e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,m.HTML)}function Oo(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,m.HTML),e.tokenizer.state=M.PLAINTEXT}function So(e,t){e.openElements.hasInScope(r.BUTTON)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r.BUTTON)),e._reconstructActiveFormattingElements(),e._insertElement(t,m.HTML),e.framesetOk=!1}function Ro(e,t){let s=e.activeFormattingElements.getElementEntryInScopeWithTagName(h.A);s&&(us(e,t),e.openElements.remove(s.element),e.activeFormattingElements.removeEntry(s)),e._reconstructActiveFormattingElements(),e._insertElement(t,m.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function Lo(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,m.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function Do(e,t){e._reconstructActiveFormattingElements(),e.openElements.hasInScope(r.NOBR)&&(us(e,t),e._reconstructActiveFormattingElements()),e._insertElement(t,m.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function bo(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,m.HTML),e.activeFormattingElements.insertMarker(),e.framesetOk=!1}function Po(e,t){e.treeAdapter.getDocumentMode(e.document)!==P.QUIRKS&&e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,m.HTML),e.framesetOk=!1,e.insertionMode=l.IN_TABLE}function en(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,m.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function tn(e){let t=Le(e,G.TYPE);return t!=null&&t.toLowerCase()===Vi}function Mo(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,m.HTML),tn(t)||(e.framesetOk=!1),t.ackSelfClosing=!0}function Bo(e,t){e._appendElement(t,m.HTML),t.ackSelfClosing=!0}function ko(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._appendElement(t,m.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function Uo(e,t){t.tagName=h.IMG,t.tagID=r.IMG,en(e,t)}function Fo(e,t){e._insertElement(t,m.HTML),e.skipNextNewLine=!0,e.tokenizer.state=M.RCDATA,e.originalInsertionMode=e.insertionMode,e.framesetOk=!1,e.insertionMode=l.TEXT}function xo(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._reconstructActiveFormattingElements(),e.framesetOk=!1,e._switchToTextParsing(t,M.RAWTEXT)}function Ho(e,t){e.framesetOk=!1,e._switchToTextParsing(t,M.RAWTEXT)}function qr(e,t){e._switchToTextParsing(t,M.RAWTEXT)}function yo(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,m.HTML),e.framesetOk=!1,e.insertionMode=e.insertionMode===l.IN_TABLE||e.insertionMode===l.IN_CAPTION||e.insertionMode===l.IN_TABLE_BODY||e.insertionMode===l.IN_ROW||e.insertionMode===l.IN_CELL?l.IN_SELECT_IN_TABLE:l.IN_SELECT}function wo(e,t){e.openElements.currentTagId===r.OPTION&&e.openElements.pop(),e._reconstructActiveFormattingElements(),e._insertElement(t,m.HTML)}function vo(e,t){e.openElements.hasInScope(r.RUBY)&&e.openElements.generateImpliedEndTags(),e._insertElement(t,m.HTML)}function Yo(e,t){e.openElements.hasInScope(r.RUBY)&&e.openElements.generateImpliedEndTagsWithExclusion(r.RTC),e._insertElement(t,m.HTML)}function Wo(e,t){e._reconstructActiveFormattingElements(),It(t),Me(t),t.selfClosing?e._appendElement(t,m.MATHML):e._insertElement(t,m.MATHML),t.ackSelfClosing=!0}function Qo(e,t){e._reconstructActiveFormattingElements(),Ct(t),Me(t),t.selfClosing?e._appendElement(t,m.SVG):e._insertElement(t,m.SVG),t.ackSelfClosing=!0}function zr(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,m.HTML)}function B(e,t){switch(t.tagID){case r.I:case r.S:case r.B:case r.U:case r.EM:case r.TT:case r.BIG:case r.CODE:case r.FONT:case r.SMALL:case r.STRIKE:case r.STRONG:{Lo(e,t);break}case r.A:{Ro(e,t);break}case r.H1:case r.H2:case r.H3:case r.H4:case r.H5:case r.H6:{Io(e,t);break}case r.P:case r.DL:case r.OL:case r.UL:case r.DIV:case r.DIR:case r.NAV:case r.MAIN:case r.MENU:case r.ASIDE:case r.CENTER:case r.FIGURE:case r.FOOTER:case r.HEADER:case r.HGROUP:case r.DIALOG:case r.DETAILS:case r.ADDRESS:case r.ARTICLE:case r.SEARCH:case r.SECTION:case r.SUMMARY:case r.FIELDSET:case r.BLOCKQUOTE:case r.FIGCAPTION:{po(e,t);break}case r.LI:case r.DD:case r.DT:{go(e,t);break}case r.BR:case r.IMG:case r.WBR:case r.AREA:case r.EMBED:case r.KEYGEN:{en(e,t);break}case r.HR:{ko(e,t);break}case r.RB:case r.RTC:{vo(e,t);break}case r.RT:case r.RP:{Yo(e,t);break}case r.PRE:case r.LISTING:{Co(e,t);break}case r.XMP:{xo(e,t);break}case r.SVG:{Qo(e,t);break}case r.HTML:{fo(e,t);break}case r.BASE:case r.LINK:case r.META:case r.STYLE:case r.TITLE:case r.SCRIPT:case r.BGSOUND:case r.BASEFONT:case r.TEMPLATE:{Y(e,t);break}case r.BODY:{_o(e,t);break}case r.FORM:{No(e,t);break}case r.NOBR:{Do(e,t);break}case r.MATH:{Wo(e,t);break}case r.TABLE:{Po(e,t);break}case r.INPUT:{Mo(e,t);break}case r.PARAM:case r.TRACK:case r.SOURCE:{Bo(e,t);break}case r.IMAGE:{Uo(e,t);break}case r.BUTTON:{So(e,t);break}case r.APPLET:case r.OBJECT:case r.MARQUEE:{bo(e,t);break}case r.IFRAME:{Ho(e,t);break}case r.SELECT:{yo(e,t);break}case r.OPTION:case r.OPTGROUP:{wo(e,t);break}case r.NOEMBED:case r.NOFRAMES:{qr(e,t);break}case r.FRAMESET:{Ao(e,t);break}case r.TEXTAREA:{Fo(e,t);break}case r.NOSCRIPT:{e.options.scriptingEnabled?qr(e,t):zr(e,t);break}case r.PLAINTEXT:{Oo(e,t);break}case r.COL:case r.TH:case r.TD:case r.TR:case r.HEAD:case r.FRAME:case r.TBODY:case r.TFOOT:case r.THEAD:case r.CAPTION:case r.COLGROUP:break;default:zr(e,t)}}function Go(e,t){if(e.openElements.hasInScope(r.BODY)&&(e.insertionMode=l.AFTER_BODY,e.options.sourceCodeLocationInfo)){let s=e.openElements.tryPeekProperlyNestedBodyElement();s&&e._setEndLocation(s,t)}}function Ko(e,t){e.openElements.hasInScope(r.BODY)&&(e.insertionMode=l.AFTER_BODY,Tn(e,t))}function Xo(e,t){let s=t.tagID;e.openElements.hasInScope(s)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(s))}function Vo(e){let t=e.openElements.tmplCount>0,{formElement:s}=e;t||(e.formElement=null),(s||t)&&e.openElements.hasInScope(r.FORM)&&(e.openElements.generateImpliedEndTags(),t?e.openElements.popUntilTagNamePopped(r.FORM):s&&e.openElements.remove(s))}function jo(e){e.openElements.hasInButtonScope(r.P)||e._insertFakeElement(h.P,r.P),e._closePElement()}function qo(e){e.openElements.hasInListItemScope(r.LI)&&(e.openElements.generateImpliedEndTagsWithExclusion(r.LI),e.openElements.popUntilTagNamePopped(r.LI))}function zo(e,t){let s=t.tagID;e.openElements.hasInScope(s)&&(e.openElements.generateImpliedEndTagsWithExclusion(s),e.openElements.popUntilTagNamePopped(s))}function $o(e){e.openElements.hasNumberedHeaderInScope()&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilNumberedHeaderPopped())}function Jo(e,t){let s=t.tagID;e.openElements.hasInScope(s)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(s),e.activeFormattingElements.clearToLastMarker())}function Zo(e){e._reconstructActiveFormattingElements(),e._insertFakeElement(h.BR,r.BR),e.openElements.pop(),e.framesetOk=!1}function sn(e,t){let s=t.tagName,n=t.tagID;for(let a=e.openElements.stackTop;a>0;a--){let c=e.openElements.items[a],E=e.openElements.tagIDs[a];if(n===E&&(n!==r.UNKNOWN||e.treeAdapter.getTagName(c)===s)){e.openElements.generateImpliedEndTagsWithExclusion(n),e.openElements.stackTop>=a&&e.openElements.shortenToLength(a);break}if(e._isSpecialElement(c,E))break}}function Lt(e,t){switch(t.tagID){case r.A:case r.B:case r.I:case r.S:case r.U:case r.EM:case r.TT:case r.BIG:case r.CODE:case r.FONT:case r.NOBR:case r.SMALL:case r.STRIKE:case r.STRONG:{us(e,t);break}case r.P:{jo(e);break}case r.DL:case r.UL:case r.OL:case r.DIR:case r.DIV:case r.NAV:case r.PRE:case r.MAIN:case r.MENU:case r.ASIDE:case r.BUTTON:case r.CENTER:case r.FIGURE:case r.FOOTER:case r.HEADER:case r.HGROUP:case r.DIALOG:case r.ADDRESS:case r.ARTICLE:case r.DETAILS:case r.SEARCH:case r.SECTION:case r.SUMMARY:case r.LISTING:case r.FIELDSET:case r.BLOCKQUOTE:case r.FIGCAPTION:{Xo(e,t);break}case r.LI:{qo(e);break}case r.DD:case r.DT:{zo(e,t);break}case r.H1:case r.H2:case r.H3:case r.H4:case r.H5:case r.H6:{$o(e);break}case r.BR:{Zo(e);break}case r.BODY:{Go(e,t);break}case r.HTML:{Ko(e,t);break}case r.FORM:{Vo(e);break}case r.APPLET:case r.OBJECT:case r.MARQUEE:{Jo(e,t);break}case r.TEMPLATE:{ie(e,t);break}default:sn(e,t)}}function rn(e,t){e.tmplInsertionModeStack.length>0?hn(e,t):ds(e,t)}function ec(e,t){var s;t.tagID===r.SCRIPT&&((s=e.scriptHandler)===null||s===void 0||s.call(e,e.openElements.current)),e.openElements.pop(),e.insertionMode=e.originalInsertionMode}function tc(e,t){e._err(t,u.eofInElementThatCanContainOnlyText),e.openElements.pop(),e.insertionMode=e.originalInsertionMode,e.onEof(t)}function Es(e,t){if($r.has(e.openElements.currentTagId))switch(e.pendingCharacterTokens.length=0,e.hasNonWhitespacePendingCharacterToken=!1,e.originalInsertionMode=e.insertionMode,e.insertionMode=l.IN_TABLE_TEXT,t.type){case O.CHARACTER:{an(e,t);break}case O.WHITESPACE_CHARACTER:{nn(e,t);break}}else ve(e,t)}function sc(e,t){e.openElements.clearBackToTableContext(),e.activeFormattingElements.insertMarker(),e._insertElement(t,m.HTML),e.insertionMode=l.IN_CAPTION}function rc(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,m.HTML),e.insertionMode=l.IN_COLUMN_GROUP}function nc(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(h.COLGROUP,r.COLGROUP),e.insertionMode=l.IN_COLUMN_GROUP,ms(e,t)}function ac(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,m.HTML),e.insertionMode=l.IN_TABLE_BODY}function ic(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(h.TBODY,r.TBODY),e.insertionMode=l.IN_TABLE_BODY,Dt(e,t)}function oc(e,t){e.openElements.hasInTableScope(r.TABLE)&&(e.openElements.popUntilTagNamePopped(r.TABLE),e._resetInsertionMode(),e._processStartTag(t))}function cc(e,t){tn(t)?e._appendElement(t,m.HTML):ve(e,t),t.ackSelfClosing=!0}function lc(e,t){!e.formElement&&e.openElements.tmplCount===0&&(e._insertElement(t,m.HTML),e.formElement=e.openElements.current,e.openElements.pop())}function fe(e,t){switch(t.tagID){case r.TD:case r.TH:case r.TR:{ic(e,t);break}case r.STYLE:case r.SCRIPT:case r.TEMPLATE:{Y(e,t);break}case r.COL:{nc(e,t);break}case r.FORM:{lc(e,t);break}case r.TABLE:{oc(e,t);break}case r.TBODY:case r.TFOOT:case r.THEAD:{ac(e,t);break}case r.INPUT:{cc(e,t);break}case r.CAPTION:{sc(e,t);break}case r.COLGROUP:{rc(e,t);break}default:ve(e,t)}}function we(e,t){switch(t.tagID){case r.TABLE:{e.openElements.hasInTableScope(r.TABLE)&&(e.openElements.popUntilTagNamePopped(r.TABLE),e._resetInsertionMode());break}case r.TEMPLATE:{ie(e,t);break}case r.BODY:case r.CAPTION:case r.COL:case r.COLGROUP:case r.HTML:case r.TBODY:case r.TD:case r.TFOOT:case r.TH:case r.THEAD:case r.TR:break;default:ve(e,t)}}function ve(e,t){let s=e.fosterParentingEnabled;e.fosterParentingEnabled=!0,Rt(e,t),e.fosterParentingEnabled=s}function nn(e,t){e.pendingCharacterTokens.push(t)}function an(e,t){e.pendingCharacterTokens.push(t),e.hasNonWhitespacePendingCharacterToken=!0}function ke(e,t){let s=0;if(e.hasNonWhitespacePendingCharacterToken)for(;s<e.pendingCharacterTokens.length;s++)ve(e,e.pendingCharacterTokens[s]);else for(;s<e.pendingCharacterTokens.length;s++)e._insertCharacters(e.pendingCharacterTokens[s]);e.insertionMode=e.originalInsertionMode,e._processToken(t)}var on=new Set([r.CAPTION,r.COL,r.COLGROUP,r.TBODY,r.TD,r.TFOOT,r.TH,r.THEAD,r.TR]);function Ec(e,t){let s=t.tagID;on.has(s)?e.openElements.hasInTableScope(r.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=l.IN_TABLE,fe(e,t)):B(e,t)}function hc(e,t){let s=t.tagID;switch(s){case r.CAPTION:case r.TABLE:{e.openElements.hasInTableScope(r.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=l.IN_TABLE,s===r.TABLE&&we(e,t));break}case r.BODY:case r.COL:case r.COLGROUP:case r.HTML:case r.TBODY:case r.TD:case r.TFOOT:case r.TH:case r.THEAD:case r.TR:break;default:Lt(e,t)}}function ms(e,t){switch(t.tagID){case r.HTML:{B(e,t);break}case r.COL:{e._appendElement(t,m.HTML),t.ackSelfClosing=!0;break}case r.TEMPLATE:{Y(e,t);break}default:Ot(e,t)}}function Tc(e,t){switch(t.tagID){case r.COLGROUP:{e.openElements.currentTagId===r.COLGROUP&&(e.openElements.pop(),e.insertionMode=l.IN_TABLE);break}case r.TEMPLATE:{ie(e,t);break}case r.COL:break;default:Ot(e,t)}}function Ot(e,t){e.openElements.currentTagId===r.COLGROUP&&(e.openElements.pop(),e.insertionMode=l.IN_TABLE,e._processToken(t))}function Dt(e,t){switch(t.tagID){case r.TR:{e.openElements.clearBackToTableBodyContext(),e._insertElement(t,m.HTML),e.insertionMode=l.IN_ROW;break}case r.TH:case r.TD:{e.openElements.clearBackToTableBodyContext(),e._insertFakeElement(h.TR,r.TR),e.insertionMode=l.IN_ROW,bt(e,t);break}case r.CAPTION:case r.COL:case r.COLGROUP:case r.TBODY:case r.TFOOT:case r.THEAD:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=l.IN_TABLE,fe(e,t));break}default:fe(e,t)}}function Ts(e,t){let s=t.tagID;switch(t.tagID){case r.TBODY:case r.TFOOT:case r.THEAD:{e.openElements.hasInTableScope(s)&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=l.IN_TABLE);break}case r.TABLE:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=l.IN_TABLE,we(e,t));break}case r.BODY:case r.CAPTION:case r.COL:case r.COLGROUP:case r.HTML:case r.TD:case r.TH:case r.TR:break;default:we(e,t)}}function bt(e,t){switch(t.tagID){case r.TH:case r.TD:{e.openElements.clearBackToTableRowContext(),e._insertElement(t,m.HTML),e.insertionMode=l.IN_CELL,e.activeFormattingElements.insertMarker();break}case r.CAPTION:case r.COL:case r.COLGROUP:case r.TBODY:case r.TFOOT:case r.THEAD:case r.TR:{e.openElements.hasInTableScope(r.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=l.IN_TABLE_BODY,Dt(e,t));break}default:fe(e,t)}}function cn(e,t){switch(t.tagID){case r.TR:{e.openElements.hasInTableScope(r.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=l.IN_TABLE_BODY);break}case r.TABLE:{e.openElements.hasInTableScope(r.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=l.IN_TABLE_BODY,Ts(e,t));break}case r.TBODY:case r.TFOOT:case r.THEAD:{(e.openElements.hasInTableScope(t.tagID)||e.openElements.hasInTableScope(r.TR))&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=l.IN_TABLE_BODY,Ts(e,t));break}case r.BODY:case r.CAPTION:case r.COL:case r.COLGROUP:case r.HTML:case r.TD:case r.TH:break;default:we(e,t)}}function uc(e,t){let s=t.tagID;on.has(s)?(e.openElements.hasInTableScope(r.TD)||e.openElements.hasInTableScope(r.TH))&&(e._closeTableCell(),bt(e,t)):B(e,t)}function dc(e,t){let s=t.tagID;switch(s){case r.TD:case r.TH:{e.openElements.hasInTableScope(s)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(s),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=l.IN_ROW);break}case r.TABLE:case r.TBODY:case r.TFOOT:case r.THEAD:case r.TR:{e.openElements.hasInTableScope(s)&&(e._closeTableCell(),cn(e,t));break}case r.BODY:case r.CAPTION:case r.COL:case r.COLGROUP:case r.HTML:break;default:Lt(e,t)}}function ln(e,t){switch(t.tagID){case r.HTML:{B(e,t);break}case r.OPTION:{e.openElements.currentTagId===r.OPTION&&e.openElements.pop(),e._insertElement(t,m.HTML);break}case r.OPTGROUP:{e.openElements.currentTagId===r.OPTION&&e.openElements.pop(),e.openElements.currentTagId===r.OPTGROUP&&e.openElements.pop(),e._insertElement(t,m.HTML);break}case r.HR:{e.openElements.currentTagId===r.OPTION&&e.openElements.pop(),e.openElements.currentTagId===r.OPTGROUP&&e.openElements.pop(),e._appendElement(t,m.HTML),t.ackSelfClosing=!0;break}case r.INPUT:case r.KEYGEN:case r.TEXTAREA:case r.SELECT:{e.openElements.hasInSelectScope(r.SELECT)&&(e.openElements.popUntilTagNamePopped(r.SELECT),e._resetInsertionMode(),t.tagID!==r.SELECT&&e._processStartTag(t));break}case r.SCRIPT:case r.TEMPLATE:{Y(e,t);break}default:}}function En(e,t){switch(t.tagID){case r.OPTGROUP:{e.openElements.stackTop>0&&e.openElements.currentTagId===r.OPTION&&e.openElements.tagIDs[e.openElements.stackTop-1]===r.OPTGROUP&&e.openElements.pop(),e.openElements.currentTagId===r.OPTGROUP&&e.openElements.pop();break}case r.OPTION:{e.openElements.currentTagId===r.OPTION&&e.openElements.pop();break}case r.SELECT:{e.openElements.hasInSelectScope(r.SELECT)&&(e.openElements.popUntilTagNamePopped(r.SELECT),e._resetInsertionMode());break}case r.TEMPLATE:{ie(e,t);break}default:}}function mc(e,t){let s=t.tagID;s===r.CAPTION||s===r.TABLE||s===r.TBODY||s===r.TFOOT||s===r.THEAD||s===r.TR||s===r.TD||s===r.TH?(e.openElements.popUntilTagNamePopped(r.SELECT),e._resetInsertionMode(),e._processStartTag(t)):ln(e,t)}function fc(e,t){let s=t.tagID;s===r.CAPTION||s===r.TABLE||s===r.TBODY||s===r.TFOOT||s===r.THEAD||s===r.TR||s===r.TD||s===r.TH?e.openElements.hasInTableScope(s)&&(e.openElements.popUntilTagNamePopped(r.SELECT),e._resetInsertionMode(),e.onEndTag(t)):En(e,t)}function _c(e,t){switch(t.tagID){case r.BASE:case r.BASEFONT:case r.BGSOUND:case r.LINK:case r.META:case r.NOFRAMES:case r.SCRIPT:case r.STYLE:case r.TEMPLATE:case r.TITLE:{Y(e,t);break}case r.CAPTION:case r.COLGROUP:case r.TBODY:case r.TFOOT:case r.THEAD:{e.tmplInsertionModeStack[0]=l.IN_TABLE,e.insertionMode=l.IN_TABLE,fe(e,t);break}case r.COL:{e.tmplInsertionModeStack[0]=l.IN_COLUMN_GROUP,e.insertionMode=l.IN_COLUMN_GROUP,ms(e,t);break}case r.TR:{e.tmplInsertionModeStack[0]=l.IN_TABLE_BODY,e.insertionMode=l.IN_TABLE_BODY,Dt(e,t);break}case r.TD:case r.TH:{e.tmplInsertionModeStack[0]=l.IN_ROW,e.insertionMode=l.IN_ROW,bt(e,t);break}default:e.tmplInsertionModeStack[0]=l.IN_BODY,e.insertionMode=l.IN_BODY,B(e,t)}}function Ac(e,t){t.tagID===r.TEMPLATE&&ie(e,t)}function hn(e,t){e.openElements.tmplCount>0?(e.openElements.popUntilTagNamePopped(r.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode(),e.onEof(t)):ds(e,t)}function pc(e,t){t.tagID===r.HTML?B(e,t):St(e,t)}function Tn(e,t){var s;if(t.tagID===r.HTML){if(e.fragmentContext||(e.insertionMode=l.AFTER_AFTER_BODY),e.options.sourceCodeLocationInfo&&e.openElements.tagIDs[0]===r.HTML){e._setEndLocation(e.openElements.items[0],t);let n=e.openElements.items[1];n&&!(!((s=e.treeAdapter.getNodeSourceCodeLocation(n))===null||s===void 0)&&s.endTag)&&e._setEndLocation(n,t)}}else St(e,t)}function St(e,t){e.insertionMode=l.IN_BODY,Rt(e,t)}function Ic(e,t){switch(t.tagID){case r.HTML:{B(e,t);break}case r.FRAMESET:{e._insertElement(t,m.HTML);break}case r.FRAME:{e._appendElement(t,m.HTML),t.ackSelfClosing=!0;break}case r.NOFRAMES:{Y(e,t);break}default:}}function Cc(e,t){t.tagID===r.FRAMESET&&!e.openElements.isRootHtmlElementCurrent()&&(e.openElements.pop(),!e.fragmentContext&&e.openElements.currentTagId!==r.FRAMESET&&(e.insertionMode=l.AFTER_FRAMESET))}function Nc(e,t){switch(t.tagID){case r.HTML:{B(e,t);break}case r.NOFRAMES:{Y(e,t);break}default:}}function gc(e,t){t.tagID===r.HTML&&(e.insertionMode=l.AFTER_AFTER_FRAMESET)}function Oc(e,t){t.tagID===r.HTML?B(e,t):gt(e,t)}function gt(e,t){e.insertionMode=l.IN_BODY,Rt(e,t)}function Sc(e,t){switch(t.tagID){case r.HTML:{B(e,t);break}case r.NOFRAMES:{Y(e,t);break}default:}}function Rc(e,t){t.chars=D,e._insertCharacters(t)}function Lc(e,t){e._insertCharacters(t),e.framesetOk=!1}function un(e){for(;e.treeAdapter.getNamespaceURI(e.openElements.current)!==m.HTML&&!e._isIntegrationPoint(e.openElements.currentTagId,e.openElements.current);)e.openElements.pop()}function Dc(e,t){if(os(t))un(e),e._startTagOutsideForeignContent(t);else{let s=e._getAdjustedCurrentElement(),n=e.treeAdapter.getNamespaceURI(s);n===m.MATHML?It(t):n===m.SVG&&(cs(t),Ct(t)),Me(t),t.selfClosing?e._appendElement(t,n):e._insertElement(t,n),t.ackSelfClosing=!0}}function bc(e,t){if(t.tagID===r.P||t.tagID===r.BR){un(e),e._endTagOutsideForeignContent(t);return}for(let s=e.openElements.stackTop;s>0;s--){let n=e.openElements.items[s];if(e.treeAdapter.getNamespaceURI(n)===m.HTML){e._endTagOutsideForeignContent(t);break}let a=e.treeAdapter.getTagName(n);if(a.toLowerCase()===t.tagName){t.tagName=a,e.openElements.shortenToLength(s);break}}}var Pc=new Set([h.AREA,h.BASE,h.BASEFONT,h.BGSOUND,h.BR,h.COL,h.EMBED,h.FRAME,h.HR,h.IMG,h.INPUT,h.KEYGEN,h.LINK,h.META,h.PARAM,h.SOURCE,h.TRACK,h.WBR]);function Mc(e,t){return t.treeAdapter.isElementNode(e)&&t.treeAdapter.getNamespaceURI(e)===m.HTML&&Pc.has(t.treeAdapter.getTagName(e))}var Bc={treeAdapter:y,scriptingEnabled:!0};function fs(e,t){let s={...Bc,...t};return dn(e,s)}function kc(e,t){let s="",n=t.treeAdapter.isElementNode(e)&&t.treeAdapter.getTagName(e)===h.TEMPLATE&&t.treeAdapter.getNamespaceURI(e)===m.HTML?t.treeAdapter.getTemplateContent(e):e,a=t.treeAdapter.getChildNodes(n);if(a)for(let c of a)s+=dn(c,t);return s}function dn(e,t){return t.treeAdapter.isElementNode(e)?Uc(e,t):t.treeAdapter.isTextNode(e)?xc(e,t):t.treeAdapter.isCommentNode(e)?Hc(e,t):t.treeAdapter.isDocumentTypeNode(e)?yc(e,t):""}function Uc(e,t){let s=t.treeAdapter.getTagName(e);return`<${s}${Fc(e,t)}>${Mc(e,t)?"":`${kc(e,t)}</${s}>`}`}function Fc(e,{treeAdapter:t}){let s="";for(let n of t.getAttrList(e)){if(s+=" ",n.namespace)switch(n.namespace){case m.XML:{s+=`xml:${n.name}`;break}case m.XMLNS:{n.name!=="xmlns"&&(s+="xmlns:"),s+=n.name;break}case m.XLINK:{s+=`xlink:${n.name}`;break}default:s+=`${n.prefix}:${n.name}`}else s+=n.name;s+=`="${Ps(n.value)}"`}return s}function xc(e,t){let{treeAdapter:s}=t,n=s.getTextNodeContent(e),a=s.getParentNode(e),c=a&&s.isElementNode(a)&&s.getTagName(a);return c&&s.getNamespaceURI(a)===m.HTML&&is(c,t.scriptingEnabled)?n:Ms(n)}function Hc(e,{treeAdapter:t}){return`<!--${t.getCommentNodeContent(e)}-->`}function yc(e,{treeAdapter:t}){return`<!DOCTYPE ${t.getDocumentTypeNodeName(e)}>`}function mn(e,t){return me.parse(e,t)}function fn(e,t,s){typeof e=="string"&&(s=t,t=e,e=null);let n=me.getFragmentParser(e,s);return n.tokenizer.write(t,!0),n.getFragment()}function _n(e){let t=e.includes('"')?"'":'"';return t+e+t}function wc(e,t,s){let n="!DOCTYPE ";return e&&(n+=e),t?n+=` PUBLIC ${_n(t)}`:s&&(n+=" SYSTEM"),s&&(n+=` ${_n(s)}`),n}var V={isCommentNode:bs,isElementNode:g,isTextNode:Ke,createDocument(){let e=new se([]);return e["x-mode"]=De.DOCUMENT_MODE.NO_QUIRKS,e},createDocumentFragment(){return new se([])},createElement(e,t,s){let n=Object.create(null),a=Object.create(null),c=Object.create(null);for(let T=0;T<s.length;T++){let d=s[T].name;n[d]=s[T].value,a[d]=s[T].namespace,c[d]=s[T].prefix}let E=new Ds(e,n,[]);return E.namespace=t,E["x-attribsNamespace"]=a,E["x-attribsPrefix"]=c,E},createCommentNode(e){return new Rs(e)},createTextNode(e){return new Ge(e)},appendChild(e,t){let s=e.children[e.children.length-1];s&&(s.next=t,t.prev=s),e.children.push(t),t.parent=e},insertBefore(e,t,s){let n=e.children.indexOf(s),{prev:a}=s;a&&(a.next=t,t.prev=a),s.prev=t,t.next=s,e.children.splice(n,0,t),t.parent=e},setTemplateContent(e,t){V.appendChild(e,t)},getTemplateContent(e){return e.children[0]},setDocumentType(e,t,s,n){let a=wc(t,s,n),c=e.children.find(E=>Ut(E)&&E.name==="!doctype");c?c.data=a!=null?a:null:(c=new Ls("!doctype",a),V.appendChild(e,c)),c["x-name"]=t,c["x-publicId"]=s,c["x-systemId"]=n},setDocumentMode(e,t){e["x-mode"]=t},getDocumentMode(e){return e["x-mode"]},detachNode(e){if(e.parent){let t=e.parent.children.indexOf(e),{prev:s,next:n}=e;e.prev=null,e.next=null,s&&(s.next=n),n&&(n.prev=s),e.parent.children.splice(t,1),e.parent=null}},insertText(e,t){let s=e.children[e.children.length-1];s&&Ke(s)?s.data+=t:V.appendChild(e,V.createTextNode(t))},insertTextBefore(e,t,s){let n=e.children[e.children.indexOf(s)-1];n&&Ke(n)?n.data+=t:V.insertBefore(e,V.createTextNode(t),s)},adoptAttributes(e,t){for(let s=0;s<t.length;s++){let n=t[s].name;e.attribs[n]===void 0&&(e.attribs[n]=t[s].value,e["x-attribsNamespace"][n]=t[s].namespace,e["x-attribsPrefix"][n]=t[s].prefix)}},getFirstChild(e){return e.children[0]},getChildNodes(e){return e.children},getParentNode(e){return e.parent},getAttrList(e){return e.attributes},getTagName(e){return e.name},getNamespaceURI(e){return e.namespace},getTextNodeContent(e){return e.data},getCommentNodeContent(e){return e.data},getDocumentTypeNodeName(e){var t;return(t=e["x-name"])!==null&&t!==void 0?t:""},getDocumentTypeNodePublicId(e){var t;return(t=e["x-publicId"])!==null&&t!==void 0?t:""},getDocumentTypeNodeSystemId(e){var t;return(t=e["x-systemId"])!==null&&t!==void 0?t:""},isDocumentTypeNode(e){return Ut(e)&&e.name==="!doctype"},setNodeSourceCodeLocation(e,t){t&&(e.startIndex=t.startOffset,e.endIndex=t.endOffset),e.sourceCodeLocation=t},getNodeSourceCodeLocation(e){return e.sourceCodeLocation},updateNodeSourceCodeLocation(e,t){t.endOffset!=null&&(e.endIndex=t.endOffset),e.sourceCodeLocation={...e.sourceCodeLocation,...t}}};function An(e,t,s,n){let a={scriptingEnabled:typeof t.scriptingEnabled=="boolean"?t.scriptingEnabled:!0,treeAdapter:V,sourceCodeLocationInfo:t.sourceCodeLocationInfo};return s?mn(e,a):fn(n,e,a)}var vc={treeAdapter:V};function pn(e){let t="length"in e?e:[e];for(let n=0;n<t.length;n+=1){let a=t[n];j(a)&&Array.prototype.splice.call(t,n,1,...a.children)}let s="";for(let n=0;n<t.length;n+=1){let a=t[n];s+=fs(a,vc)}return s}var Yc=Nr((e,t,s,n)=>t.xmlMode||t._useHtmlParser2?xs(e,t):An(e,t,s,n)),Wc=br(Yc,(e,t)=>t.xmlMode||t._useHtmlParser2?Bs(e,t):pn(e)),In=Wc([]),{contains:uh}=z,{merge:dh}=z,{parseHTML:mh}=z,{root:fh}=z;var Cn=e=>new RegExp(/^(((ht|f)tps?):\/\/)?([^!@#$%^&*?.\s-]([^!@#$%^&*?.\s]{0,63}[^!@#$%^&*?.\s])?\.)+[a-z]{2,6}\/?/).test(e),Qc=e=>{if(!e)return"";try{let t=/^(?:https?:\/\/)?(?:www\.)?((?:(?!www\.|\.).)+\.[-a-zA-Z0-9.]+)/gm,s=e.match(t);return(s?s[0]:"").toLowerCase()}catch(t){return e}},_s=(e,t=16)=>{let s=Qc(e)||`${e==null?void 0:e.toLowerCase()}.com`;return`https://www.google.com/s2/favicons?sz=${t}&domain_url=${s}`},Nn=e=>e?(e.search(/^http[s]?:\/\//)==-1&&(e="https://"+e),e):"";var gn=e=>{let t=[];return e("#search #rso > div").filter((a,c)=>!!e(c).find("a > h3").text()).each((a,c)=>{var N,L,S,b,w,x,W,Mt,Ye,Ae;let E=e(c),T=E.find("a > h3"),d=T.closest("a"),A=E.find("div.MUxGbd").text();if(A||(A=(L=(N=d==null?void 0:d.parent())==null?void 0:N.parent())==null?void 0:L.parent().next().text().trim()),A||(A=(b=(S=d==null?void 0:d.parent())==null?void 0:S.parent())==null?void 0:b.parent().next().next().text().trim()),!A){let We=E.find("div[style]").filter((zc,Sn)=>{var ps,Is;return!!((Is=(ps=e(Sn))==null?void 0:ps.attr("style"))!=null&&Is.includes("-webkit-line-clamp"))});A=e(We[0]).text().trim()}let _=T.text(),p=T.next(),I=U((w=d.attr("href"))!=null?w:""),C=(Ye=(Mt=(W=(x=p==null?void 0:p.children())==null?void 0:x.last())==null?void 0:W.children())==null?void 0:Mt.first())==null?void 0:Ye.text();t.push({title:_,body:A||_,url:I,from:C,imgLink:(Ae=p==null?void 0:p.find("img"))==null?void 0:Ae.attr("src")})}),e("#rso #kp-wp-tab-overview:not([style])").length>0&&e('#rso #kp-wp-tab-overview:not([style]) div[class*="K7khPe"]').each((a,c)=>{var N,L,S,b,w,x;let E=e(c),T=E.find("a > h3"),d=T.closest("a"),A=E.find("div.MUxGbd").text();if(!A){let W=E.find("div[style]").filter((Mt,Ye)=>{var Ae,We;return!!((We=(Ae=e(Ye))==null?void 0:Ae.attr("style"))!=null&&We.includes("-webkit-line-clamp"))});A=e(W[0]).text().trim()}let _=T.next(),p=U((N=d.attr("href"))!=null?N:""),I=(w=(b=(S=(L=_==null?void 0:_.children())==null?void 0:L.last())==null?void 0:S.children())==null?void 0:b.first())==null?void 0:w.text(),C=T.text();C&&t.push({title:C,body:A||C,url:p,from:I,imgLink:(x=_==null?void 0:_.find("img"))==null?void 0:x.attr("src")})}),e("#search #rso > div a[data-ved]").filter((a,c)=>!!e(c).find("div[role=heading]").text()).each((a,c)=>{var I,C;let E=e(c),T=E.find("div[role=heading]"),d=T.text(),A=T.next().text(),_=T.prev(),p=U((I=E.attr("href"))!=null?I:"");t.push({title:d,body:A||d,url:p,from:_.text(),imgLink:(C=_.find("img"))==null?void 0:C.attr("src")})}),e('#search #rso div[role="tabpanel"] div[jscontroller="SC7lYd"]').each((a,c)=>{var N,L;let E=e(c),T=E.find("a > h3"),d=T.text(),A=T.closest("a"),_=E.find('div[style="-webkit-line-clamp:2"]').text(),p=T.next(),I=U((N=A.attr("href"))!=null?N:""),C=p.find("span.VuuXrf").text();t.push({title:d,body:_||d,url:I,from:C,imgLink:(L=p.find("img"))==null?void 0:L.attr("src")})}),t};var On=e=>{let t=[];return e("ol#b_results li.b_algo").each((s,n)=>{var T,d;let a=e(n),c=a.find("h2 > a"),E=a.find(".b_algoSlug").text();E||(E=a.find(".b_wikiRichcard .tab-content").text().trim()),t.push({title:(T=c.text())!=null?T:"",body:E!=null?E:"",url:U((d=c.attr("href"))!=null?d:""),from:a.find("a .tptt").text(),imgLink:a.find("img.rms_img").attr("src")})}),t};function Bh({html:e,searchEngine:t}){try{return Gc(e,t).filter(a=>er(a.url)?!1:a.url&&(a.body||a.title))}catch(s){return[]}}function U(e){let t=e.match(/RU=([^/]+)/);return t&&t[1]?decodeURIComponent(t[1]):e}var Gc=(e,t)=>{try{let s=In.load(e),n=[];switch(t){case"google":{n=gn(s);break}case"baidu":{let E=[],T=[];s("div#content_left div[class^=result]").each((d,A)=>{var x,W;let _=s(A),p=_.find("h3"),I=p.find("a"),C=_.attr("tpl"),N=_.attr("mu")||"",L=!1;N&&C==="se_com_default"?(N=U(N),L=!0):(N=U((x=I.attr("href"))!=null?x:""),N=N.replace("http://www.baidu","https://www.baidu"));let S=_.find("div[class*=description_]").text();if(S||(S=_.find(".op_dict_content").text()),S||(S=_.find("div[class*=basis-info_]").text()),S||(S=_.find(".c-color-text").text()),S||(S=p.next().next().text()),!S.trim()&&!N.trim())return;let b=_.find("a[class^=siteLink]"),w={title:p.text(),body:S!=null?S:"",url:N,from:b.text(),imgLink:(W=b.find("img"))==null?void 0:W.attr("src")};L?E.push(w):T.push(w)}),n=[...E,...T];break}case"duckduckgo":{s("ol.react-results--main li[data-layout=organic]").each((E,T)=>{var C,N;let d=s(T),A=d.find("h2 > a"),_=d.find("a[data-testid=result-extras-url-link]"),p=_.parent(),I=U((C=A.attr("href"))!=null?C:"");n.push({title:A.text(),body:d.find("div[data-result=snippet]").text(),url:I,from:_e(I)||_.children().first().text(),imgLink:(N=p.find("a > img"))==null?void 0:N.attr("src")})});break}case"yahoo":{s('.algo:not([class*="ad"])').each((E,T)=>{var I,C;let d=s(T),A=d.find("h3.title a"),_=U((I=A.attr("href"))!=null?I:""),p=A.find("span").text().split(" \u203A ");n.push({title:(C=A.attr("aria-label"))!=null?C:"",body:d.find(".compText").text(),url:_,from:_e(_)||p[0]})});break}case"naver":{s("ul.lst_total > li.bx").each((E,T)=>{var I;let d=s(T),A=d.find("a.link_tit");(!A||A.length<=0)&&(A=d.find("a.total_tit"));let _=U((I=A.attr("href"))!=null?I:""),p=d.find("a.thumb img").attr("src");n.push({title:A.text(),body:d.find(".dsc_txt").text(),url:_,from:_e(_),imgLink:p})});break}case"yandex":{s(".content__left ul.serp-list > li.serp-item").each((E,T)=>{var C;let d=s(T),A=d.find("a.organic__url"),_=U((C=A.attr("href"))!=null?C:""),p=d.find(".Favicon-Icon").css("background-image"),I=p==null?void 0:p.slice(5).slice(0,-2);n.push({title:A.text(),body:d.find(".organic__content-wrapper").text(),url:_,imgLink:I,from:_e(_)})});break}case"sogou":{s(".results div.vrwrap").each((E,T)=>{var L;let d=s(T),A=d.find("h3.vr-title a"),_=d.find(".text-layout").text();_||(_=d.find(".word-result").text()),_||(_=d.find(".space-txt").text());let p=U((L=A.attr("href"))!=null?L:"");p=p.startsWith("/")?location.origin+p:p;let C=d.find(".citeurl").text().replace(/\n\s*/g,"").split("-").find(S=>{try{let b=S.trim().replace("...","");return b.includes("/")&&(b=b.split("/")[0]),Cn(b)}catch(b){return!1}}),N=_e(C||"");n.push({title:A.text(),body:_,url:p,from:N,imgLink:_s(N)})});break}case"brave":{s("#results > .snippet[data-type=web]").each((E,T)=>{var b;let d=s(T),A=d.find(".snippet-title"),_=A.text(),p=A.closest("a"),I=d.find("img.favicon").attr("src");_||(A=d.find("a > div.url"),_=A.text(),p=A.closest("a"));let C=d.find(".snippet-content").text();C||(C=d.find(".snippet-description").text());let L=d.find(".snippet-url").children().first().text();d.attr("id")==="discussions"&&(_=d.find(".question > p.title").text(),C=d.find(".faq-a").text(),p=d.find("a.source").first(),L=d.find("img.forum-name").text());let S=U((b=p.attr("href"))!=null?b:"");n.push({title:_,body:C,url:S,imgLink:I,from:L})});break}case"bing":{n=On(s);break}default:return[]}n=n.map(E=>{let T={...E};return T.from||(T.from=_e(T.url)),T.from&&(T.from=T.from.replace(/\.[^.]*$/,"")),!T.imgLink&&T.url&&(T.imgLink=_s(T.url)),T.from=As(T.from),T.body=As(T.body),T.title=As(T.title),T});let a=new Map;return n.filter(E=>a.has(E.url)?!1:(a.set(E.url,!0),!0))}catch(s){return[]}};function As(e){return e.trim().replaceAll(`
`,"")||""}function _e(e){try{let t=Nn(e.trim().replaceAll("...","")),n=new URL(t).host.split(".");return n.length>=3?n[1]:n[0]}catch(t){return e}}export{js as a,ll as b,El as c,hl as d,Tl as e,ul as f,Ol as g,bl as h,Pl as i,Cn as j,Bh as k,Vn as l,Jn as m,qc as n};
