/*! For license information please see 255.js.LICENSE.txt */
"use strict";(self.webpackChunkjump_cutter=self.webpackChunkjump_cutter||[]).push([[255],{8255:(e,t,n)=>{n.d(t,{default:()=>_});var s=n(1647),i=n(845),a=n(3452),o=n(6943),r=n(9136);async function c(e){return r.I.set(e)}var l=n(6717),d=n(4022),h=n(2803),m=n(4866);function u(e){let t;try{t=new URL(e.currentSrc)}catch(e){if(!(e instanceof TypeError))throw e;return!1}return t.origin!==document.location.origin}var v=n(7891);function g(e){let t="relativeToSoundedSpeed"===e.silenceSpeedSpecificationMethod?e.silenceSpeedRaw*e.soundedSpeed:e.silenceSpeedRaw;return t>v.c&&(t=v.c),t}function E(e){return{soundedSpeed:e.soundedSpeed,volumeThreshold:e.volumeThreshold,marginBefore:e.marginBefore,marginAfter:e.marginAfter,enableDesyncCorrection:e.enableDesyncCorrection,silenceSpeed:g(e)}}var b=n(9182),y=n(8059),p=n.n(y),f=n(8221),w=n.n(f),S=n(8757),k=n(4149);function A(e,t){for(const n of t)switch(n.action){case"rewind":e.currentTime-=n.actionArgument;break;case"advance":e.currentTime+=n.actionArgument;break;case"pause_toggle":e.paused?e.play():e.pause();break;case"mute_toggle":e.muted=!e.muted;break;case"volume+":case"volume-":{const t=("volume+"===n.action?1:-1)*n.actionArgument/100;e.volume=(0,l.q)(e.volume+t,0,1);break}default:(0,d.x)(n.action)}}const C=["experimentalControllerType","dontAttachToCrossOriginMedia"];function T(e,t){return t&&e.dontAttachToCrossOriginMedia?3:e.experimentalControllerType}async function M(e,t){let s;switch(e){case 1:s=(await Promise.all([n.e(577),n.e(29),n.e(701),n.e(526),n.e(356)]).then(n.bind(n,8356))).default;break;case 2:s=(await Promise.all([n.e(350),n.e(577),n.e(29),n.e(701),n.e(99)]).then(n.bind(n,99))).default;break;case 3:s=(await Promise.all([n.e(577),n.e(526),n.e(290)]).then(n.bind(n,8290))).default;break;default:(0,d.x)(e)}return new s(...t())}function L(e,t){return!!t.omitMutedElements&&e.muted}class _{constructor(){this.unhandledNewElements=new Set,this.handledElements=new WeakSet,this.handledMutedElements=new WeakSet,this._destroyedPromise=new Promise((e=>this._resolveDestroyedPromise=e)),this._onDetachFromActiveElementCallbacks=[],this.ensureLoadSettings=p()(this._loadSettings),this.onConnect=e=>{let t;switch(e.name){case"telemetry":{let n=!0;const s=()=>n=!0;t=t=>{if(!n)return;if(n=!1,(0,m._)(s),setTimeout(s,200),!this.controller?.initialized||!this.timeSavedTracker)return;(0,h.K)("boolean"==typeof this.activeMediaElementSourceIsCrossOrigin),(0,h.K)(this.activeMediaElement);const i=this.activeMediaElementSourceIsCrossOrigin,a={...this.controller.telemetry,...this.timeSavedTracker.timeSavedData,controllerType:this.controller.constructor.controllerType,elementLikelyCorsRestricted:i,elementCurrentSrc:i?this.activeMediaElement.currentSrc:void 0,createMediaElementSourceCalledForElement:!!S.F.get(this.activeMediaElement)};e.postMessage(a)};break}case"nonSettingsActions":t=e=>{this.activeMediaElement&&A(this.activeMediaElement,e)};break;default:return}e.onMessage.addListener(t),this._destroyedPromise.then((()=>e.onMessage.removeListener(t)))},this.ensureAddOnConnectListener=p()(this._addOnConnectListener),this.ensureInitHotkeyListener=p()(this._initHotkeyListener),this.ensureAttachToEventTargetElementIfEligible=async e=>{await this.basicSettingsP,(0,h.K)(this.basicSettings);const t=e.target;L(t,this.basicSettings)||this.ensureAttachToElement(t)},this.onvolumechange=async e=>{const t=e.target,n=this.handledMutedElements.has(t)&&!t.muted;this.handledMutedElements.delete(t),n&&!t.paused&&(await this.basicSettingsP,(0,h.K)(this.basicSettings),this.basicSettings.omitMutedElements&&this.ensureAttachToElement(t))},this.debouncedHandleNewElements=w()(this.handleNewElements,0,{maxWait:3e3}),this.basicSettingsP=(0,i.m)("omitMutedElements").then((e=>this.basicSettings=e));const e=e=>{this.reactToSettingsNewValues((0,a.P)(e))};(0,o.oo)(e),this._destroyedPromise.then((()=>(0,o.dt)(e)))}destroy(){this.detachFromActiveElement(),this._resolveDestroyedPromise()}detachFromActiveElement(){this.controller?.destroy(),this.controller=void 0,this._onDetachFromActiveElementCallbacks.forEach((e=>e())),this._onDetachFromActiveElementCallbacks=[]}broadcastStatus(){(0,b.A)({elementLastActivatedAt:this.elementLastActivatedAt})}async _loadSettings(){this.settings=await(0,i.m)()}reactToSettingsNewValues(e){if(!1!==e.enabled){if(0!==Object.keys(e).length&&(this.basicSettings&&Object.assign(this.basicSettings,e),this.settings))if(Object.assign(this.settings,e),(0,h.K)(this.controller),C.some((t=>t in e))){const e=this.controller,t=e.element;(0,h.K)("boolean"==typeof this.activeMediaElementSourceIsCrossOrigin);const n=T(this.settings,this.activeMediaElementSourceIsCrossOrigin);if(n!==e.constructor.controllerType){const s=e;this.controller=void 0,(async()=>{await s.destroy(),(0,h.K)(this.settings),(this.controller=await M(n,(()=>[t,E(this.settings),this.timeSavedTracker]))).init()})()}}else this.controller=this.controller.updateSettingsAndMaybeCreateNewInstance(E(this.settings))}else this.destroy()}_addOnConnectListener(){s.y.runtime.onConnect.addListener(this.onConnect),this._destroyedPromise.then((()=>s.y.runtime.onConnect.removeListener(this.onConnect)))}async _initHotkeyListener(){const e=await Promise.all([n.e(481),n.e(868)]).then(n.bind(n,8868)),t=e.keydownEventToActions,s=e.eventTargetIsInput,i=e=>{if(s(e))return;(0,h.K)(this.settings);const n=t(e,this.settings);if(!n)return;const[i,a,o]=n;o&&(e.preventDefault(),e.stopPropagation()),this.reactToSettingsNewValues(i),c(i),A(this.activeMediaElement,a)};if((0,h.K)(this.settings),this.settings.hotkeys.some((e=>e.overrideWebsiteHotkeys)))document.addEventListener("keydown",i,!0),this._destroyedPromise.then((()=>document.removeEventListener("keydown",i,!0)));else{const e=(...e)=>setTimeout(i,void 0,...e);document.addEventListener("keydown",e,{passive:!0}),this._destroyedPromise.then((()=>document.removeEventListener("keydown",e)))}}async ensureAttachToElement(e){const t=Date.now();if(this.activeMediaElement===e)return void(this.elementLastActivatedAt=t);let s;this.activeMediaElement&&this.detachFromActiveElement(),this.activeMediaElement=e,(0,h.K)(0===this._onDetachFromActiveElementCallbacks.length,`I think \`_onDetachFromActiveElementCallbacks\` should be empty here. Instead it it is ${this._onDetachFromActiveElementCallbacks.length} items long`),this._onDetachFromActiveElementCallbacks.push((()=>this.activeMediaElement=void 0)),await this.ensureLoadSettings(),(0,h.K)(this.settings);const i=new Promise((e=>s=e)),a=this.activeMediaElementSourceIsCrossOrigin=u(e),r=()=>{this.activeMediaElementSourceIsCrossOrigin=u(e)};e.addEventListener("loadstart",r,{passive:!0}),this._onDetachFromActiveElementCallbacks.push((()=>e.removeEventListener("loadstart",r)));const l=M(T(this.settings,a),(()=>[e,E(this.settings),i])).then((async e=>(this.controller=e,await e.init(),e)));let d;this.settings.enableHotkeys&&(d=this.ensureInitHotkeyListener()),(async()=>{const t=(await Promise.all([n.e(577),n.e(29),n.e(239)]).then(n.bind(n,6239))).default;await l;const i=this.timeSavedTracker=new t(e,this.settings,o.oo,o.dt);this._onDetachFromActiveElementCallbacks.push((()=>i.destroy())),s(i)})();{k.o0.set(e,e.playbackRate),k.bs.set(e,e.defaultPlaybackRate);const t=[void 0,"updateSoundedSpeed"].includes(this.settings.onPlaybackRateChangeFromOtherScripts)&&!this.settings.dontForcePreventPlaybackRateChangesOnTwitch&&["www.twitch.tv","twitch.tv"].includes(document.location.host)&&Date.now()<2524608e6,n=e=>{const n=e.target;switch(t?"prevent":this.settings.onPlaybackRateChangeFromOtherScripts){case"updateSoundedSpeed":{const e=k.o0.get(n);if(n.playbackRate!==e&&void 0!==e){const e={soundedSpeed:n.playbackRate};this.reactToSettingsNewValues(e),c(e)}break}case"prevent":{const t=k.o0.get(n);n.playbackRate!==t&&void 0!==t&&((0,k.Nz)(n,t),e.stopImmediatePropagation());break}}},s={capture:!0,passive:!0};e.addEventListener("ratechange",n,s),this._onDetachFromActiveElementCallbacks.push((()=>e.removeEventListener("ratechange",n,s)))}await l,d&&await d,await i,this.ensureAddOnConnectListener(),this.elementLastActivatedAt=t,this.broadcastStatus()}handleNewElements(e){const t=this.unhandledNewElements;this.unhandledNewElements=new Set;for(const e of t)this.handledElements.has(e)||(this.handledElements.add(e),e.addEventListener("playing",this.ensureAttachToEventTargetElementIfEligible,{passive:!0}),this._destroyedPromise.then((()=>e.removeEventListener("playing",this.ensureAttachToEventTargetElementIfEligible))),e.muted&&this.handledMutedElements.add(e),e.addEventListener("volumechange",this.onvolumechange,{passive:!0}),this._destroyedPromise.then((()=>e.removeEventListener("volumechange",this.onvolumechange))));const n=[];t.forEach((t=>{L(t,e)||n.push(t)}));for(const e of n)if(!e.paused){this.ensureAttachToElement(e);break}if(!this.activeMediaElement)for(const e of n)if(e.currentTime>0&&e.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA){this.ensureAttachToElement(e);break}}onNewMediaElements(...e){e.forEach((e=>this.unhandledNewElements.add(e))),this.basicSettingsP.then((()=>{(0,h.K)(this.basicSettings),this.debouncedHandleNewElements(this.basicSettings)}))}}},8757:(e,t,n)=>{n.d(t,{F:()=>s,n:()=>i});const s=new WeakMap;function i(e,t){const n=s.get(e);if(n)return n[1].disconnect(),n;{const n=t(),i=n.createMediaElementSource(e),a=[n,i];return s.set(e,a),a}}},4149:(e,t,n)=>{n.d(t,{Nz:()=>a,bs:()=>i,o0:()=>s,y1:()=>o});const s=new WeakMap,i=new WeakMap;function a(e,t){e.playbackRate=t,s.set(e,t)}function o(e,t){e.defaultPlaybackRate=t,i.set(e,t)}},2803:(e,t,n)=>{function s(e,t){}n.d(t,{K:()=>s})},7891:(e,t,n)=>{n.d(t,{c:()=>s});const s=16},3452:(e,t,n)=>{function s(e){const t={};for(const[n,s]of Object.entries(e))t[n]=s.newValue;return t}n.d(t,{P:()=>s})}}]);