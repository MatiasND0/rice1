(()=>{"use strict";function e(e,t,n,r=!0){const o=e[t];e[t]=function(e,t){return new Proxy(e,{apply(e,n,r,...o){const i=Reflect.apply(e,n,r,...o);try{t(r,i)}catch(e){}return i}})}(e[t],n);const i=`_jumpCutterExtensionOriginal_${t}`;return r&&(e[i]=o),()=>{e[t]=o,delete e[i]}}function t(e,t,n,r){const o=n.prototype,i=Object.getOwnPropertyDescriptor(o,t);if(!i)return;const c=i.set;return c?(Object.defineProperty(e,t,{...i,set(e,...t){const n=c.call(this,e,...t);try{r(e)}catch(e){}return n}}),()=>{delete e[t]}):void 0}function n(e,t){let n=r.get(e);if(n&&n.length>0)return void n.push(t);if(!e.updating)return void t();n?n.push(t):(n=[t],r.set(e,n)),e.updating;const o=()=>{if(!e.updating){do{e.updating;if(n.shift()(),e.updating,0===n.length)return void e.removeEventListener("updateend",o)}while(!e.updating);e.updating}};e.addEventListener("updateend",o,{passive:!0})}const r=new WeakMap,o=function(){const e=document.getElementById("__jumpCutterBridgeElement");return e.id="",e.remove(),e}(),[i,c]=function(){const[r,o]=function(){const t=new Map,n=e(URL,"createObjectURL",(([e],n)=>{e instanceof MediaSource&&t.set(n,new WeakRef(e))}));return[t,n]}(),[i,c]=function(){const r=new WeakMap,o=function(o){const i=MediaSource;return globalThis.MediaSource=new Proxy(MediaSource,{construct(o,i,c,...u){const s=Reflect.construct(o,i,c,...u);try{((o,i)=>{const c=function(r,o){const i=new globalThis._jumpCutterExtensionOriginal_MediaSource(...o),c=new Promise((e=>{i.addEventListener("sourceopen",(()=>e(i)),{once:!0,passive:!0})})),u=new WeakMap;return e(r,"addSourceBuffer",((r,o)=>{const i=function(r,o,i){const c=i.then((e=>e.addSourceBuffer(...o))),u=["appendBuffer","abort","remove","changeType"];for(const t of u)e(r,t,(async e=>{const r=await c;n(r,(()=>{r[t](...e)}))}));const s=["appendWindowStart","appendWindowEnd","mode","timestampOffset"];for(const e of s)t(r,e,SourceBuffer,(async t=>{const r=await c;n(r,(()=>{r[e]=t}))}));return c}(o,r,c);u.set(o,i)})),e(r,"removeSourceBuffer",(([e])=>{u.get(e).then((e=>{i.removeSourceBuffer(e)}))})),e(r,"endOfStream",(e=>{c.then((t=>{t.endOfStream(...e)}))})),t(r,"duration",MediaSource,(e=>{c.then((t=>{t.duration=e}))})),i}(i,o),u=document.createElement("audio"),s=URL.createObjectURL(c);u.src=s;{const e=()=>{URL.revokeObjectURL(s),u.removeEventListener("loadstart",e),clearTimeout(t)};u.addEventListener("loadstart",e,{once:!0,passive:!0});let t=setTimeout((()=>{t=setTimeout(e)}),1e4)}r.set(i,u)})(i,s)}catch(e){}return s},get:(e,t,n)=>"canConstructInDedicatedWorker"!==t&&Reflect.get(e,t,n)}),globalThis._jumpCutterExtensionOriginal_MediaSource=i,()=>{globalThis.MediaSource=i,delete globalThis._jumpCutterExtensionOriginal_MediaSource}}();return[r,()=>o()]}();return[function(e){const t=function(e){const{currentSrc:t}=e;if(!t){const{srcObject:t}=e;if(!t)return;if(!(t instanceof MediaSource))return;return t}const n=r.get(t);if(!n)return;const o=n.deref();return o||void 0}(e);if(!t)return;return i.get(t)||void 0},()=>{o(),c()}]}();function u(e,t){e.dispatchEvent(new CustomEvent("jumpCutterGetCloneResponse",{bubbles:!0,detail:t}))}document.addEventListener("jumpCutterGetCloneRequest",(async e=>{if(!(e instanceof CustomEvent))return;const t=e,n=t.detail&&"object"==typeof t.detail&&"requestId"in t.detail&&t.detail.requestId;if(!n)return;const r=()=>u(o,{requestId:n}),c=t.target;if(!(c instanceof HTMLMediaElement))return console.warn("Requested a clone for an element that is not an HTMLMediaElement"),void r();const s=i(c);s?(o.appendChild(s),u(s,{requestId:n})):r()}),{passive:!0})})();